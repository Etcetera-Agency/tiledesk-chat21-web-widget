(self.webpackChunkwidget=self.webpackChunkwidget||[]).push([[179],{764:(ze,Ln,be)=>{"use strict";var S=be(1481),e=be(9798);const J="mqtt",v="native",g=200,N="text",W="image",M="file",q=230,ee="direct",U="INFO",$="MINE",te="OTHERS",X="CHAT_REOPENED",s="CHAT_CLOSED",a="MEMBER_JOINED_GROUP",d="MEMBER_LEFT_GROUP",T="LEAD_UPDATED",B="TOUCHING_OPERATOR",H="LIVE_PAGE",pe="tiledesk_widget_",Oe={ERROR:0,WARN:1,INFO:2,DEBUG:3},Te={"show-delay":500,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},Ie={production:!0,version:be(4147).i8,remoteConfig:!0,remoteConfigUrl:"/widget-config.json",loadRemoteTranslations:!0,remoteTranslationsUrl:"http://localhost:3000/",chatEngine:"CHANGEIT",uploadEngine:"CHANGEIT",fileUploadAccept:"*/*",logLevel:"INFO",firebaseConfig:{apiKey:"CHANGEIT",authDomain:"CHANGEIT",databaseURL:"CHANGEIT",projectId:"CHANGEIT",storageBucket:"CHANGEIT",messagingSenderId:"CHANGEIT",appId:"CHANGEIT",tenant:"CHANGEIT"},chat21Config:{appId:"tilechat",MQTTendpoint:"mqtt://localhost:15675/ws",APIendpoint:"http://localhost:8004/api"},apiUrl:"http://localhost:3000/",baseImageUrl:"https://firebasestorage.googleapis.com/v0/b/",dashboardUrl:"https://console.tiledesk.com/v2/dashboard/",defaultLang:"en",storage_prefix:"widget_sv5",authPersistence:"LOCAL",supportMode:!0,enbedJs:!0};var xt=be(5439),Nn=be(1042),Se=be(7340);class fe{static getInstance(){return fe.instance}static setInstance(t){fe.instance=t}}fe.\u0275fac=function(t){return new(t||fe)},fe.\u0275prov=e.Yz7({token:fe,factory:fe.\u0275fac});var _e=be(591);class Vo{constructor(t,n,o,i,l,E,V,Q,se,ge,me,ce,ve,we,Me,Ne,ht,ot,it,rt,Rn,lo){this.id=t,this.activeOperatingHours=n,this.channels=o,this.name=i,this.createdAt=l,this.createdBy=E,this.isActiveSubscription=V,this.profile=Q,this.agents=se,this.trialDays=ge,this.type=me,this.status=ce,this.trialDaysLeft=ve,this.trialExpired=we,this.updatedAt=Me,this.versions=Ne,this.widgetTitle=ht,this.logoChat=ot,this.avatar=it,this.color=rt,this.welcomeTitle=Rn,this.welcomeMsg=lo}initialize(t,n,o,i,l,E,V,Q,se,ge,me,ce,ve,we,Me,Ne){this.id=t,this.activeOperatingHours=n,this.channels=o,this.name=i,this.createdAt=l,this.createdBy=E,this.isActiveSubscription=V,this.profile=Q,this.agents=se,this.trialDays=ge,this.type=me,this.status=ce,this.trialDaysLeft=ve,this.trialExpired=we,this.updatedAt=Me,this.versions=Ne}customization(t,n,o,i,l,E){this.widgetTitle=t,this.logoChat=n,this.avatar=o,this.color=i,this.welcomeTitle=l,this.welcomeMsg=E}}be(4211),be(1589);const Fn="text",po="support-group-",$e=230;function Vn(r){return r&&(r=function _o(r){return(r=(r=(r=(r=r.replace(/&/g,"&amp;")).replace(/>/g,"&gt;")).replace(/</g,"&lt;")).replace(/"/g,"&quot;")).replace(/'/g,"&#039;")}(r)),r}function mo(r){try{const t=r.split("popup=")[1];return!!t&&!!t.startsWith("true")}catch{return!1}}function Yo(r,t,n){const o=this.strip_tags(t),E=screen.width/2-300,V=screen.height/2-300,Q=r.open(o,"_blank","fullscreen=1, titlebar=0, toolbar=no, location=0, status=0, menubar=0, scrollbars=0, resizable=0, width=600, height=600, top="+V+", left="+E);r.focus&&Q.focus()}function Jo(r){return r.replace(/<.*?>/g,"").trim()}function Gn(r){let t="";return r&&r.split(" ").forEach(o=>{o.trim().length>1&&t.length<3&&(t+=o.substring(0,1).toUpperCase())}),t}function qn(r){const t=["#fba76f","#80d066","#73cdd0","#ecd074","#6fb1e4","#f98bae"];let n=0;if(r){const o=r.charCodeAt(r.length-1);n=Math.round(o%t.length)}return t[n]}function vo(r){let t=!1;return t=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(r.navigator.userAgent),t}function xe(r,t){let n=r;if(r&&r.indexOf("#")>-1)r=r.replace("#",""),n="rgba("+parseInt(r.substring(0,2),16)+","+parseInt(r.substring(2,4),16)+","+parseInt(r.substring(4,6),16)+","+t/100+")";else if(r&&r.indexOf("rgba")>-1){const o=r.split(",");n="rgba("+o[0].substring(5)+","+o[1]+","+o[2]+","+t/100+")"}else if(r&&r.indexOf("rgb(")>-1){const o=r.split(",");n="rgba("+o[0].substring(4)+","+o[1]+","+o[2].substring(0,o[2].length-1)+","+t/100+")"}return n}function le(r,t){const n=r.location.href;t=t.replace(/[\[\]]/g,"\\$&");const i=new RegExp("[?&]"+t+"(=([^&]*)|&|$)").exec(n);return i?i[2]?"false"===i[2]||"0"===i[2]?"false":decodeURIComponent(i[2].replace(/\+/g," ")):"true":null}function ue(r){let t=r;if("string"!=typeof r)return t;if(r)switch(t.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return t}}function Bn(r,t){return"/apps/"+r+"/users/"+t+"/conversations"}function Wn(r,t){return"/apps/"+r+"/users/"+t+"/archived_conversations"}function dt(){try{return"localStorage"in window&&null!==window.localStorage}catch(r){return console.log("supports_html5_storage > Error :"+r),!1}}function Yn(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(r){return console.log("supports_html5_session > Error :"+r),!1}}function Le(r,t){return r.findIndex(n=>n.uid===t)}function $o(r){try{const t=r.split("popup=")[1];return!!t&&!!t.startsWith("true")}catch{return!1}}function Jn(r,t,n){const o=function Xo(r){return r.replace(/<.*?>/g,"").trim()}(t),E=screen.width/2-300,V=screen.height/2-300,Q=r.open(o,"_blank","fullscreen=1, titlebar=0, toolbar=no, location=0, status=0, menubar=0, scrollbars=0, resizable=0, width=600, height=600, top="+V+", left="+E);r.focus&&Q.focus()}function Ae(r,t){let n=r;if(r&&r.indexOf("#")>-1)r=r.replace("#",""),n="rgba("+parseInt(r.substring(0,2),16)+","+parseInt(r.substring(2,4),16)+","+parseInt(r.substring(4,6),16)+","+t/100+")";else if(r&&r.indexOf("rgba")>-1){const o=r.split(",");n="rgba("+o[0].substring(5)+","+o[1]+","+o[2]+","+t/100+")"}else if(r&&r.indexOf("rgb(")>-1){const o=r.split(",");n="rgba("+o[0].substring(4)+","+o[1]+","+o[2].substring(0,o[2].length-1)+","+t/100+")"}return n}function ut(r,t="asc"){return function(n,o){if(!n.hasOwnProperty(r)||!o.hasOwnProperty(r))return 0;const i="string"==typeof n[r]?n[r].toUpperCase():n[r],l="string"==typeof o[r]?o[r].toUpperCase():o[r];let E=0;return i>l?E=1:i<l&&(E=-1),"desc"===t?-1*E:E}}function Xt(r){return xt.locale(window.navigator.language),xt.unix(r).fromNow()}function yo(r){return!(!r||!r.recipient||!r.recipient.startsWith("group-")&&!r.recipient.startsWith("support-group"))}function qe(r,t){let n,o,i;if(r.includes("rgb")&&(r=function si(r){var n,E="";return(n=/^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/.exec(r))&&(E="#"+(16777216+(Kn(n[1],n[2])<<16)+(Kn(n[3],n[4])<<8)+Kn(n[5],n[6])).toString(16).slice(1)),E}(r)),0===r.indexOf("#")&&(r=r.slice(1)),3===r.length&&(r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]),6!==r.length)throw new Error("Invalid HEX color.");return n=parseInt(r.slice(0,2),16),o=parseInt(r.slice(2,4),16),i=parseInt(r.slice(4,6),16),t?.299*n+.587*o+.114*i>186?"#000000":"#FFFFFF":(n=(255-n).toString(16),o=(255-o).toString(16),i=(255-i).toString(16),"#"+Qn(n,2)+Qn(o,2)+Qn(i,2))}function Qn(r,t){return t=t||2,(new Array(t).join("0")+r).slice(-t)}function Kn(r,t){var n=Math.max(0,parseInt(r,10));return t?Math.floor(255*Math.min(100,n)/100):Math.min(255,n)}class Pe{constructor(){this.obsObjChanged=new _e.X(null),this.obsIsOpen=new _e.X(null),this.BASE_LOCATION="https://widget.tiledesk.com/v2",this.POWERED_BY='<a tabindex="-1" target="_blank" href="http://www.tiledesk.com/"><img src="https://support-pre.tiledesk.com/dashboard/assets/img/logos/tiledesk-logo_new_gray.svg"/></a>',this.DEFAULT_LOGO_CHAT="/assets/images/tiledesk_logo_white_small.svg",this.WIDGET_TITLE="Tiledesk",this.convertColorToRGBA=Ae,this.project=new Vo,this.availableAgents=[],this.isLogout=!1,this.availableAgentsStatus=!1,this.firstOpen=!0,this.departmentID=null,this.privacyApproved=!1,this.startedAt=new Date}initDefafultParameters(){this.globalsParameters={},this.filterSystemMsg=!0;let t=window;window.frameElement&&"parent"===window.frameElement.getAttribute("tiledesk_context")&&(t=window.parent);const n=le(window,"windowcontext");null!==n&&"window.parent"===n&&(t=window.parent),this.windowContext=t,this.baseLocation=this.BASE_LOCATION,this.autoStart=!0,this.startHidden=!1,this.isShown=!0,this.isOpen=!1,this.startFromHome=!0,this.isOpenPrechatForm=!0,this.isOpenStartRating=!1,this.projectid="",this.preChatForm=!1,this.align="",this.calloutTimer=-1,this.calloutTitle="",this.calloutMsg="",this.calloutStaus=!0,this.userFullname="",this.userEmail="",this.widgetTitle="",this.dynamicWaitTimeReply=!0,this.hideHeaderCloseButton=!1,this.fullscreenMode=!1,this.themeColor=Ae("#2a6ac1",100),this.themeColorOpacity=100,this.themeForegroundColor=Ae("#ffffff",100),this.allowTranscriptDownload=!1,this.poweredBy=this.POWERED_BY,this.logoChat=this.BASE_LOCATION+this.DEFAULT_LOGO_CHAT,this.marginX="20px",this.marginY="20px",this.mobileMarginX="0px",this.mobileMarginY="0px",this.launcherWidth="60px",this.launcherHeight="60px",this.baloonImage="",this.baloonShape="50%",this.isLogEnabled=!1,this.openExternalLinkButton=!0,this.hideHeaderConversationOptionsMenu=!1,this.hideCloseConversationOptionMenu=!1,this.hideRestartConversationOptionsMenu=!1,this.hideSettings=!1,this.filterByRequester=!1,this.persistence="local",this.preChatFormJson=[{name:"userFullname",type:"text",mandatory:!0,label:"LABEL_FIELD_NAME"},{name:"userEmail",type:"text",mandatory:!0,regex:"/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)+$/",label:"LABEL_FIELD_EMAIL",errorLabel:"LABEL_ERROR_FIELD_EMAIL"}],this.bubbleSentBackground=Ae("#2a6ac1",100),this.bubbleSentTextColor=Ae("#ffffff",100),this.bubbleReceivedBackground=Ae("#f0f2f7",100),this.bubbleReceivedTextColor=Ae("#06132b",100),this.fontSize="1.4em",this.fontFamily="'Roboto','Google Sans', Helvetica, Arial, sans-serif'",this.buttonFontSize="15px",this.buttonBackgroundColor=Ae("#ffffff",100),this.buttonTextColor=Ae("#2a6ac1",100),this.buttonHoverBackgroundColor=Ae("#2a6ac1",100),this.buttonHoverTextColor=Ae("#ffffff",100),this.singleConversation=!1,this.restartConversation=!1,this.nativeRating=!0,this.showInfoMessage="MEMBER_JOINED_GROUP".split(",").map(o=>o.trim()),this.typingLocation="content",this.allowReopen=!1,this.continueConversationBeforeTime=48,this.participants=[],this.whatsappNumber="",this.messangerPageTitle="",this.telegramUsername="",this.showWaitTime=!0,this.showAvailableAgents=!0,this.showLogoutOption=!1,this.offline_msg=this.LABEL_FIRST_MSG_NO_AGENTS,this.online_msg=this.LABEL_FIRST_MSG,this.isOpenNewMessage=!1,this.showAttachmentButton=!0,this.showAllConversations=!0,this.tenant=Ie.firebaseConfig.tenant,this.channelType="group",this.default_settings={},this.isMobile=!1,this.isLogged=!1,this.BUILD_VERSION="v."+Ie.version,this.filterSystemMsg=!0,this.soundEnabled=!0,this.conversationsBadge=0,this.isOpenMenuOptions=!1,this.signInWithCustomToken=!1,this.displayEyeCatcherCard="none",this.supportMode=!0,this.newConversationStart=!0}initialize(){this.createDefaultSettingsObject(),this.setParameter("isMobile",vo(this.windowContext)),this.setParameter("attributes",this.attributes),this.setProjectParameters()}setProjectParameters(){let t=this.project.name;this.widgetTitle&&""!==this.widgetTitle&&(t=this.widgetTitle),this.project.customization(t,this.logoChat,Gn(t),qn(t),this.welcomeTitle,this.welcomeMsg)}createDefaultSettingsObject(){this.default_settings={align:this.align,allowReopen:this.allowReopen,allowTranscriptDownload:this.allowTranscriptDownload,autoStart:this.autoStart,baloonShape:this.baloonShape,baloonImage:this.baloonImage,bubbleSentBackground:this.bubbleSentBackground,bubbleSentTextColor:this.bubbleSentTextColor,bubbleReceivedBackground:this.bubbleReceivedBackground,bubbleReceivedTextColor:this.bubbleReceivedTextColor,buttonBackgroundColor:this.buttonBackgroundColor,buttonTextColor:this.buttonTextColor,buttonFontSize:this.buttonFontSize,buttonHoverBackgroundColor:this.buttonHoverBackgroundColor,buttonHoverTextColor:this.buttonHoverTextColor,calloutTitle:this.calloutTitle,calloutMsg:this.calloutMsg,calloutTimer:this.calloutTimer,calloutStaus:this.calloutStaus,channelType:this.channelType,dynamicWaitTimeReply:this.dynamicWaitTimeReply,fontSize:this.fontSize,fontFamily:this.fontFamily,fullscreenMode:this.fullscreenMode,filterByRequester:this.filterByRequester,hideHeaderConversationOptionsMenu:this.hideHeaderConversationOptionsMenu,hideHeaderCloseButton:this.hideHeaderCloseButton,hideCloseConversationOptionMenu:this.hideCloseConversationOptionMenu,hideRestartConversationOptionsMenu:this.hideRestartConversationOptionsMenu,hideSettings:this.hideSettings,isLogEnabled:this.isLogEnabled,isOpen:this.isOpen,isShown:this.isShown,jwt:this.jwt,logLevel:this.logLevel,logoChat:this.logoChat,lang:this.lang,lancherWidth:this.launcherWidth,lancherHeight:this.launcherHeight,marginX:this.marginX,marginY:this.marginY,mobileMarginX:this.mobileMarginX,mobileMarginY:this.mobileMarginY,nativeRating:this.nativeRating,openExternalLinkButton:this.openExternalLinkButton,participants:this.participants,persistence:this.persistence,poweredBy:this.poweredBy,preChatForm:this.preChatForm,preChatFormJson:this.preChatFormJson,projectid:this.projectid,recipientId:this.recipientId,restartConversation:this.restartConversation,singleConversation:this.singleConversation,showInfoMessage:this.showInfoMessage,showAllConversations:this.showAllConversations,showWaitTime:this.showWaitTime,showAvailableAgents:this.showAvailableAgents,showLogoutOption:this.showLogoutOption,showAttachmentButton:this.showAttachmentButton,soundEnabled:this.soundEnabled,startHidden:this.startHidden,startFromHome:this.startFromHome,tenant:this.tenant,themeColor:this.themeColor,themeColorOpacity:this.themeColorOpacity,themeForegroundColor:this.themeForegroundColor,typingLocation:this.typingLocation,userEmail:this.userEmail,userFullname:this.userFullname,widgetTitle:this.widgetTitle,welcomeMsg:this.welcomeMsg,welcomeTitle:this.welcomeTitle}}setColorWithGradient(){this.colorGradient="linear-gradient("+this.themeColor+", "+Ae(this.themeColor,this.themeColorOpacity)+")",this.colorGradient180="linear-gradient( 180grad, "+this.themeColor+", "+Ae(this.themeColor,this.themeColorOpacity)+")",this.bubbleSentBackground="linear-gradient( 135grad, "+this.bubbleSentBackground+", "+Ae(this.bubbleSentBackground,80)+")"}setParentBodyStyleMobile(t,n){t&&n?(window.parent.document.body.style.height="0",window.parent.document.body.style.width="100%",window.parent.document.body.style.overflowY="hidden",window.parent.document.body.style.position="fixed"):!t&&n&&(window.parent.document.body.style.removeProperty("height"),window.parent.document.body.style.removeProperty("width"),window.parent.document.body.style.removeProperty("overflow-y"),window.parent.document.body.style.removeProperty("position"))}setElementStyle(t){const n=this.windowContext.document.getElementById("tiledeskdiv"),o=document.getElementById("chat21-conversations");t&&n?setTimeout(()=>{n.classList.add("shadow"),o.classList.add("shadow")},1e3):!t&&n&&(n.classList.remove("shadow"),o.classList.remove("shadow")),t&&this.isMobile&&o?o.classList.add("isMobile"):!t&&o&&o.classList.remove("isMobile")}setIsOpen(t){this.isOpen=t,this.setParentBodyStyleMobile(t,this.isMobile),this.setElementStyle(t),this.obsIsOpen.next(t)}setParameter(t,n,o){this[t]=n,!0===o&&this.obsObjChanged.next({key:t,val:n})}setAttributeParameter(t,n){this.attributes[t]=n,this.setParameter("attributes",this.attributes,!0)}}Pe.\u0275fac=function(t){return new(t||Pe)},Pe.\u0275prov=e.Yz7({token:Pe,factory:Pe.\u0275fac,providedIn:"root"});var de=be(6895);function ai(r,t){if(1&r&&(e.TgZ(0,"span",16),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.Oqu(n.emoticon)}}function li(r,t){if(1&r&&(e.TgZ(0,"p",17),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.g.calloutMsg," ")}}function ci(r,t){if(1&r&&(e.TgZ(0,"p",17),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.g.CALLOUT_MSG_PLACEHOLDER," ")}}const hi=function(r,t){return{"c21-align-left":r,"c21-align-right":t}},di=function(r,t,n,o){return{display:r,bottom:t,left:n,right:o}};function ui(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",1),e.NdJ("mouseenter",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseEnter())})("mouseleave",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseLeave())}),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.closeEyeCatcherCard())}),e.O4$(),e.TgZ(4,"svg",5),e._UZ(5,"path",6)(6,"path",7),e.qZA()()(),e.kcU(),e.TgZ(7,"div",8),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openChatFromEyeCatcherCard())}),e.TgZ(8,"div",9),e.YNc(9,ai,2,1,"span",10),e.qZA()(),e.TgZ(10,"div",11),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openChatFromEyeCatcherCard())}),e.TgZ(11,"div",12)(12,"p",13),e._uU(13),e.qZA(),e.YNc(14,li,2,1,"p",14),e.YNc(15,ci,2,1,"ng-template",null,15,e.W1O),e.qZA()()()()}if(2&r){const n=e.MAs(16),o=e.oxw();e.ekj("mobile",o.g.isMobile),e.Q6J("ngClass",e.WLB(9,hi,"left"===o.g.align,"left"!==o.g.align))("ngStyle",e.l5B(12,di,o.g.displayEyeCatcherCard,o.g.marginY+"px","left"===o.g.align?o.g.marginX+"px":"","right"===o.g.align?o.g.marginX+"px":"")),e.xp6(8),e.Q6J("@rotatedState",o.state),e.xp6(1),e.Q6J("ngIf",o.emoticon),e.xp6(4),e.Oqu(o.title),e.xp6(1),e.Q6J("ngIf",""!==o.g.calloutMsg)("ngIfElse",n)}}class Mt{constructor(t){this.g=t,this.onOpenChat=new e.vpe,this.onCloseEyeCatcherCard=new e.vpe,this.logger=fe.getInstance()}ngOnInit(){this.state="default",this.g.setParameter("displayEyeCatcherCard","none"),this.displayEyeCatcherCardCloseBtnWrapper="none",this.displayEyeCatcherCardCloseBtnIsMobileWrapper="none",this.displayEyeCatcherCardCloseBtn="none",this.openIfCallOutTimer()}openIfCallOutTimer(){const t=this,n=this.g.calloutTimer;n>=0&&setTimeout(function(){t.openEyeCatcher()},1e3*n)}openEyeCatcher(){this.checkIsEmoji();const t=this.g.isOpen;this.logger.debug("[EYEEYE-CATCHER-CARD] openEyeCatcher: calloutStaus ---------\x3e ",this.g.calloutStaus),!1===t&&this.g.calloutStaus?(this.onCloseEyeCatcherCard.emit(!0),this.g.setParameter("displayEyeCatcherCard","block"),this.displayEyeCatcherCardCloseBtnWrapper="block",this.displayEyeCatcherCardCloseBtnIsMobileWrapper="block"):this.logger.debug("[EYEEYE-CATCHER-CARD] openEyeCatcher: \xbb\xbb\xbb\xbb\xbb\xbb\xbb CALLING OPEN-EYE-CATCHER BUT NOT DISPLAY THE CARD BECAUSE THE CHAT IS ALREADY OPEN ")}checkIsEmoji(){let t=this.g.CALLOUT_TITLE_PLACEHOLDER.trim();this.g.calloutTitle&&""!==this.g.calloutTitle&&(t=this.g.calloutTitle.trim()),this.title=t;const o=be(9747)();let i;for(;i=o.exec(t);){const l=i[0];this.logger.debug("[EYEEYE-CATCHER-CARD]--\x3e match",i),0===t.indexOf(l)&&(this.title=t.replace(l,""),this.emoticon=l);break}}openChatFromEyeCatcherCard(){this.g.setParameter("displayEyeCatcherCard","none"),this.onOpenChat.emit()}mouseEnter(){}mouseLeave(){}closeEyeCatcherCard(){this.onCloseEyeCatcherCard.emit(!1),this.g.setParameter("displayEyeCatcherCard","none"),this.g.setParameter("calloutStaus",!1,!0),this.displayEyeCatcherCardCloseBtnWrapper="none"}}function $n(r){return!!(r&&r.type&&r.metadata&&r.metadata.src&&"image"===r.type)}function Oo(r){return!!(r&&r.type&&r.metadata&&r.metadata.src&&"frame"===r.type)}function gi(r){return!!(r&&r.type&&r.metadata&&r.metadata.src&&"file"===r.type)}function Un(r){return!(!r||!r.attributes||"info"!==r.attributes.subtype&&"info/support"!==r.attributes.subtype)}function xo(r){return!!(r&&r.attributes&&"info"===r.attributes.subtype&&r.attributes.messagelabel&&"USER_BANNED"===r.attributes.messagelabel.key)}function Xn(r){return!(!r||!r.isSender)}function We(r,t){return r===U?Un(t):r===$?Xn(t):r===te?!1===Un(t)&&!1===Xn(t):void 0}function pi(r){try{if(!r)return!1;const t=r.replace(new RegExp("[\0-\u1eeff]","g"),""),n=r.replace(new RegExp("[\n\rs]+|( )+","g"),""),o=r.replace(new RegExp("[\u4e00-\u9fa5]","g"),"");return""!==t&&""!=n&&""!=o&&t.length===n.length&&t.length<=2}catch{return!1}}function Et(r,t){return t>r}function Mo(r,t){return!(!(r&&r.attributes&&r.attributes.messagelabel&&"MEMBER_JOINED_GROUP"===r.attributes.messagelabel.key&&r.attributes.messagelabel.parameters.member_id!==t.uid)||r.attributes.messagelabel.parameters.member_id.includes("bot")||r.attributes.messagelabel.parameters.member_id.includes("system"))||!!(r&&r.attributes&&r.attributes.messagelabel&&"MEMBER_JOINED_GROUP"!==r.attributes.messagelabel.key)}function Dn(r,t){return!(r&&r.attributes&&r.attributes.messagelabel&&t.includes(r.attributes.messagelabel.key))}Mt.\u0275fac=function(t){return new(t||Mt)(e.Y36(Pe))},Mt.\u0275cmp=e.Xpm({type:Mt,selectors:[["chat-eyeeye-catcher-card"]],outputs:{onOpenChat:"onOpenChat",onCloseEyeCatcherCard:"onCloseEyeCatcherCard"},decls:1,vars:1,consts:[["class","eye-catcher-card scale-in-center",3,"mobile","ngClass","ngStyle","mouseenter","mouseleave",4,"ngIf"],[1,"eye-catcher-card","scale-in-center",3,"ngClass","ngStyle","mouseenter","mouseleave"],[1,"eye-catcher_row"],[1,"eye-catcher-card-close-btn-wrapper"],[1,"eye-catcher-card-close-btn",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","white","width","24px","height","24px",1,"eye-catcher-card-close-btn-img"],["d","M0 0h24v24H0V0z","fill","none"],["d","M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"],[1,"eye-catcher_column","ec_left",3,"click"],[1,"eye-catcher-card-emoticons-wrapper"],["class","chat21-card-emoticons",4,"ngIf"],[1,"eye-catcher_column","ec_right",3,"click"],[1,"eye-catcher-card-text-wrapper"],[1,"eye-catcher-card-title"],["class","eye-catcher-card-msg",4,"ngIf","ngIfElse"],["calloutMsg_placeholder",""],[1,"chat21-card-emoticons"],[1,"eye-catcher-card-msg"]],template:function(t,n){1&t&&e.YNc(0,ui,17,17,"div",0),2&t&&e.Q6J("ngIf",!n.g.isOpenNewMessage)},dependencies:[de.mk,de.O5,de.PC],styles:['.eye-catcher_column[_ngcontent-%COMP%]{float:left}.ec_right[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.eye-catcher_row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}.eye-catcher-card-emoticons-wrapper[_ngcontent-%COMP%]{text-align:center}.eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{z-index:1;height:40px;width:40px;position:absolute;top:-14px;display:none}.eye-catcher-card-close-btn[_ngcontent-%COMP%]{z-index:2;background-color:#5d6c80;width:24px;height:24px;border-radius:50%;position:relative;left:0;right:0;cursor:pointer;float:right;margin:4px;box-shadow:0 2px 8px #232f351a}.eye-catcher-card-close-btn-img[_ngcontent-%COMP%]{fill:#fff;width:18px;height:18px;margin:calc(50% - 9px)}.eye-catcher-card-close-btn-img-is-mobile-wrapper[_ngcontent-%COMP%]{z-index:1;position:absolute;top:-39px;right:-14px;cursor:pointer}.eye-catcher-card-close-btn-img-is-mobile[_ngcontent-%COMP%]{width:40px;position:relative;max-width:none}.eye-catcher-card[_ngcontent-%COMP%]{position:absolute;z-index:1;bottom:0;cursor:pointer;background-color:#fff;border:0px solid #dedfde;box-shadow:#232f3517 0 2px 8px;width:300px;height:70px;border-radius:35px}.eye-catcher-card[_ngcontent-%COMP%]   .eye-catcher_row[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]{margin:16px 14px 15px 16px;padding-left:70px}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{right:0}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .ec_left[_ngcontent-%COMP%]{width:40px;height:auto;margin:20px 4px 16px 0;overflow:hidden;position:absolute;top:0;right:0}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .ec_right[_ngcontent-%COMP%]{overflow:hidden;width:calc(100% - 40px);height:100%;padding:0;vertical-align:middle;display:inline-table;position:absolute;top:0;left:0}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .eye-catcher_row[_ngcontent-%COMP%]{width:calc(100% - 70px)}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]{margin:16px 14px 15px 16px;padding-right:70px}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{left:-14px}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]   .ec_left[_ngcontent-%COMP%]{width:40px;height:auto;margin:18px 3px;overflow:hidden;position:absolute;top:0;left:0}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]   .ec_right[_ngcontent-%COMP%]{overflow:hidden;width:calc(100% - 115px);height:100%;padding:0;vertical-align:middle;display:inline-table;position:absolute;top:0;left:46px}.eye-catcher-card[_ngcontent-%COMP%]:hover   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{display:block}.eye-catcher-card-text-wrapper[_ngcontent-%COMP%]{width:100%;height:auto;vertical-align:middle;font-family:Helvetica Neue,"Apple Color Emoji",Helvetica,Arial,sans-serif;font-weight:400;word-wrap:break-word;margin:0;position:absolute;line-height:normal;top:50%;transform:translateY(-50%)}.eye-catcher-card-title[_ngcontent-%COMP%]{font-size:15px;color:#3b3c40;display:block;margin:0;padding:0 0 4px}.eye-catcher-card-msg[_ngcontent-%COMP%]{letter-spacing:1px;font-size:13px;color:#7b7b7b;display:block;padding:0;margin:0;line-height:normal;width:100%}.eye-catcher-card-img-wrapper[_ngcontent-%COMP%]{border:1px solid #dedfde;border-radius:100px;height:65px;width:65px}.eye-catcher-card[_ngcontent-%COMP%]   .chat21-card-img[_ngcontent-%COMP%]{position:relative;bottom:14px;right:15px;width:95px;max-width:none}.chat21-card-emoticons[_ngcontent-%COMP%]{font-size:26px}.eye-catcher-card.mobile[_ngcontent-%COMP%]{max-width:calc(100% - 100px)}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-img-wrapper[_ngcontent-%COMP%]{border:1px solid #dedfde;border-radius:100px;height:65px;width:65px}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-close-btn[_ngcontent-%COMP%]{background-color:#fcfcfc;width:30px;height:30px;margin:4px -4px;box-shadow:0 2px 8px #232f3533}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{display:block}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-img[_ngcontent-%COMP%]{fill:#5d6c80}'],data:{animation:[(0,Se.X$)("rotatedState",[])]}});class Eo{constructor(){this.url=window.location,this.logger=fe.getInstance()}initRules(){console.log("locationnnnnnn",this.url)}}class gt{constructor(){this.logger=fe.getInstance()}setElement(t){this.el=t}setWindowContext(t){this.windowContext=t}triggerBeforeSendMessageEvent(t){this.logger.debug(" ---------------- triggerBeforeSendMessageEvent ---------------- ",t);try{const n=new CustomEvent("onBeforeMessageSend",{detail:{message:t}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerAfterSendMessageEvent(t){this.logger.debug(" ---------------- triggerAfterSendMessageEvent ---------------- ",t);try{const n=new CustomEvent("onAfterMessageSend",{detail:{message:t}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerOnNewConversationInit(t){this.logger.debug(" ---------------- triggerOnNewConversationComponentInit ---------------- ",t);const n=new CustomEvent("onNewConversationComponentInit",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerBeforeMessageRender(t){try{const n=new CustomEvent("beforeMessageRender",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerAfterMessageRender(t){try{const n=new CustomEvent("afterMessageRender",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerOnMessageCreated(t){this.logger.debug(" ---------------- triggerOnMessageCreated ---------------- ",t);const n=new CustomEvent("onMessageCreated",{detail:{message:t}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnViewInit(t){this.logger.debug(" ---------------- triggerOnInit ---------------- ",t);const n=new CustomEvent("onInit",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnOpenEvent(t){this.logger.debug(" ---------------- triggerOnOpenEvent ---------------- ",t);const n=new CustomEvent("onOpen",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnCloseEvent(t){this.logger.debug(" ---------------- triggerOnCloseEvent ---------------- ",t);const n=new CustomEvent("onClose",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnOpenEyeCatcherEvent(t){this.logger.debug(" ---------------- triggerOnOpenEyeCatcherEvent ---------------- ",t);const n=new CustomEvent("onOpenEyeCatcher",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnClosedEyeCatcherEvent(){this.logger.debug(" ---------------- triggerOnClosedEyeCatcherEvent ---------------- ");const t=new CustomEvent("onClosedEyeCatcher",{detail:{}}),n=this.windowContext;n.tiledesk&&n.tiledesk.tiledeskroot?(n.tiledesk.tiledeskroot.dispatchEvent(t),this.windowContext=n):this.el.nativeElement.dispatchEvent(t)}triggerOnLoggedIn(t){this.logger.debug(" ---------------- triggerOnLoggedIn ---------------- ",t);const n=new CustomEvent("onLoggedIn",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnLoggedOut(t){this.logger.debug(" ---------------- triggerOnLoggedOut ---------------- ",t);const n=new CustomEvent("onLoggedOut",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnAuthStateChanged(t){this.logger.debug(" ---------------- triggerOnAuthStateChanged ---------------- ",t);const n=new CustomEvent("onAuthStateChanged",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerNewConversationEvent(t){this.logger.debug(" ---------------- triggerNewConversationEvent ---------------- ",t);const n=new CustomEvent("onNewConversation",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerLoadParamsEvent(t){this.logger.debug(" ---------------- triggerOnLoadParamsEvent ---------------- ",t);const n=new CustomEvent("onLoadParams",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnBeforeInit(t){this.logger.debug(" ---------------- triggerOnBeforeInitEvent ---------------- ",t);const n=new CustomEvent("onBeforeInit",{detail:t}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnConversationUpdated(t){this.logger.debug(" ---------------- triggerOnConversationUpdated ---------------- ",t);try{const n=new CustomEvent("onConversationUpdated",{detail:{conversation:t}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerOnCloseMessagePreview(){this.logger.debug(" ---------------- triggerOnCloseMessagePreview ---------------- ");try{const t=new CustomEvent("onCloseMessagePreview",{detail:{}}),n=this.windowContext;n.tiledesk&&n.tiledesk.tiledeskroot?(n.tiledesk.tiledeskroot.dispatchEvent(t),this.windowContext=n):this.el.nativeElement.dispatchEvent(t)}catch(t){this.logger.error("[TRIGGER-HANDLER] > Error:"+t)}}triggerOnbeforeDepartmentsFormRender(t){this.logger.debug(" ---------------- triggerOnbeforeDepartmentsFormRender ---------------- ");const n=new CustomEvent("onBeforeDepartmentsFormRender",{detail:{departments:t}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerGetImageUrlThumb(t){this.logger.debug(" ---------------- getImageUrlThumb ---------------- ");try{const n=new CustomEvent("getImageUrlThumb",{detail:{message:t}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot&&o.tiledesk.tiledeskroot.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}}gt.\u0275fac=function(t){return new(t||gt)},gt.\u0275prov=e.Yz7({token:gt,factory:gt.\u0275fac});var Ee=be(529),fi=be(5732);class Re{constructor(){}}Re.\u0275fac=function(t){return new(t||Re)},Re.\u0275prov=e.Yz7({token:Re,factory:Re.\u0275fac});class ke{constructor(t,n){this.http=t,this.g=n,this.appConfig=Ie}loadAppConfig(){let t=this.appConfig.remoteConfigUrl;if(!this.appConfig.remoteConfigUrl.startsWith("http")){let o=window;window.frameElement&&"parent"===window.frameElement.getAttribute("tiledesk_context")&&(o=window.parent);const i=function ni(r,t){const n=r.location.href;t=t.replace(/[\[\]]/g,"\\$&");const i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(n);return i?i[2]?"false"===i[2]||"0"===i[2]?"false":decodeURIComponent(i[2].replace(/\+/g," ")):"true":null}(window,"windowcontext");if(null!==i&&"window.parent"===i&&(o=window.parent),!o.tiledesk)return;{const l=o.tiledesk.getBaseLocation();void 0!==l&&(this.g.baseLocation=l,t=this.g.baseLocation+this.appConfig.remoteConfigUrl)}}const n=this;return this.http.get(t).toPromise().then(o=>{n.appConfig=o}).catch(o=>{console.error("error loadAppConfig",o)})}getConfig(){return this.appConfig}}ke.\u0275fac=function(t){return new(t||ke)(e.LFG(Ee.eN),e.LFG(Pe))},ke.\u0275prov=e.Yz7({token:ke,factory:ke.\u0275fac,providedIn:"root"});class pt{constructor(t,n,o){this.http=t,this.appStorageService=n,this.appConfigService=o,this.logger=fe.getInstance(),this.obsSettingsService=new _e.X(null)}initWidgetParamiters(t,n){const o=this;let i;this.globals=t,this.el=n,this.globals.initDefafultParameters();try{i=this.setProjectId()}catch(l){return void this.logger.error("[GLOBAL-SET] > Error :"+l)}this.setMainParametersFromSettings(t),this.globals.tenant=this.appConfigService.getConfig().firebaseConfig.tenant,this.globals.logLevel=this.appConfigService.getConfig().logLevel,this.globals.persistence=this.appConfigService.getConfig().authPersistence,this.getProjectParametersById(i).subscribe(l=>{const E=l.project;E&&o.globals.project.initialize(E.id,E.activeOperatingHours,E.channels,E.name,E.createdAt,E.createdBy,E.isActiveSubscription,E.profile,E.agents,E.trialDays,E.type,E.status,E.trialDaysLeft,E.trialExpired,E.updatedAt,E.versions),o.setParameters(l)},l=>{o.setParameters(null)},()=>{})}setProjectId(){try{const t=this.globals.windowContext.tiledeskSettings.projectid;t&&(this.globals.projectid=t)}catch(t){this.logger.error("[GLOBAL-SET] setProjectId 1 > Error :"+t)}try{const t=this.el.nativeElement.getAttribute("projectid");t&&(this.globals.projectid=t)}catch(t){this.logger.error("[GLOBAL-SET] setProjectId 2 > Error :"+t)}try{const t=le(this.globals.windowContext,"tiledesk_projectid");t&&(this.globals.projectid=t)}catch(t){this.logger.error("[GLOBAL-SET] setProjectId 3 > Error :"+t)}return this.globals.projectid}setMainParametersFromSettings(t){let n;try{const o=this.globals.windowContext.tiledesk.getBaseLocation();this.logger.debug("[GLOBAL-SET] 1 > baseLocation: ",o),typeof o<"u"&&(this.globals.baseLocation=o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings baseLocation > Error :",o)}try{n=this.globals.windowContext.tiledeskSettings}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings tiledeskSettings > Error :",o)}try{const o=n.persistence;typeof o<"u"&&(this.globals.persistence=o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings persistence > Error :",o)}try{const o=n.filterByRequester;this.logger.debug("[GLOBAL-SET] setMainParametersFromSettings  > filterByRequester: ",o),typeof o<"u"&&(this.globals.filterByRequester=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings filterByRequester > Error :",o)}try{const o=n.isLogEnabled;typeof o<"u"&&(this.globals.isLogEnabled=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings isLogEnabled > Error :",o)}try{const o=n.departmentID;typeof o<"u"&&(this.globals.departmentID=o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings departmentID > Error :",o)}try{const o=n.showAttachmentButton;typeof o<"u"&&(this.globals.showAttachmentButton=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings showAttachmentButton > Error :",o)}try{const o=n.showAllConversations;typeof o<"u"&&(this.globals.showAllConversations=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings showAllConversations > Error :",o)}}setParameters(t){this.logger.debug("[GLOBAL-SET] ***** setParameters ***** ",t),null!==t&&this.setVariablesFromService(this.globals,t),this.setVariableFromStorage(this.globals),this.setVariablesFromSettings(this.globals),this.setVariablesFromAttributeHtml(this.globals,this.el),this.setVariablesFromUrlParameters(this.globals),this.setDepartmentFromExternal(),this.globals.setColorWithGradient(),this.setCssIframe(),this.logger.debug("[GLOBAL-SET] ***** END SET PARAMETERS *****"),this.obsSettingsService.next(!0)}setCssIframe(){this.globals.setParameter("isMobile",vo(this.globals.windowContext));const t=this.globals.windowContext.document.getElementById("tiledeskdiv");if(!t)return;let n;"left"===this.globals.align?(t.classList.add("align-left"),n=this.globals.isMobile?this.globals.mobileMarginX:this.globals.marginX,t.style.left=n):(t.classList.add("align-right"),n=this.globals.isMobile?this.globals.mobileMarginX:this.globals.marginX,t.style.right=n),t.style.bottom=this.globals.isMobile?this.globals.mobileMarginY:this.globals.marginY,!0===this.globals.fullscreenMode&&(t.style.left=0,t.style.right=0,t.style.top=0,t.style.bottom=0,t.style.width="100%",t.style.height="100%",t.style.maxHeight="none",t.style.maxWidth="none")}setVariablesFromService(t,n){this.logger.debug("[GLOBAL-SET] > setVariablesFromService :",n),this.globals=t;try{const o=n.departments;typeof o<"u"&&this.initDepartments(o)}catch(o){this.initDepartments(null),this.logger.error("[GLOBAL-SET] setVariablesFromService > Error is departments: ",o)}try{const o=n.user_available;typeof o<"u"&&(this.logger.debug("[GLOBAL-SET] setVariablesFromService > user_available ::::",o),this.setAvailableAgentsStatus(o))}catch(o){this.setAvailableAgentsStatus(null),this.logger.error("[GLOBAL-SET] setVariablesFromService > Error is departments: ",o)}try{const o=n.project.widget;if(typeof o<"u")for(const i of Object.keys(o))"align"===i&&"left"===o[i]?(t.windowContext.document.getElementById("tiledeskdiv").style.left="0!important",t.align="left"):"align"===i&&"right"===o[i]&&(t.windowContext.document.getElementById("tiledeskdiv").style.right="0!important",t.align="right"),o.hasOwnProperty("calloutTimer")&&(t.calloutTimer=o.calloutTimer),o.hasOwnProperty("dynamicWaitTimeReply")&&(t.dynamicWaitTimeReply=ue(o.dynamicWaitTimeReply)),o.hasOwnProperty("logoChat")&&(t.logoChat=o.logoChat),o.hasOwnProperty("preChatForm")&&(t.preChatForm=o.preChatForm),o.hasOwnProperty("preChatFormCustomFieldsEnabled")&&o.hasOwnProperty("preChatFormJson")&&(t.preChatFormJson=o.preChatFormJson),o.hasOwnProperty("themeColor")&&(t.themeColor=o.themeColor,t.bubbleSentBackground=o.themeColor,t.bubbleSentTextColor=qe(o.themeColor,!0),t.buttonTextColor=o.themeColor,t.buttonHoverBackgroundColor=o.themeColor),o.hasOwnProperty("themeColorOpacity")&&(t.themeColorOpacity=o.themeColorOpacity),o.hasOwnProperty("themeForegroundColor")&&(t.themeForegroundColor=o.themeForegroundColor),o.hasOwnProperty("nativeRating")&&(t.nativeRating=o.nativeRating),o.hasOwnProperty("poweredBy")&&(t.poweredBy=o.poweredBy),o.hasOwnProperty("baloonImage")&&(t.baloonImage=o.baloonImage),o.hasOwnProperty("allowReopen")&&(t.allowReopen=o.allowReopen,t.allowReopen&&!t.showInfoMessage.includes("CHAT_CLOSED")&&t.showInfoMessage.push("CHAT_CLOSED")),o.hasOwnProperty("singleConversation")&&(t.singleConversation=o.singleConversation),o.hasOwnProperty("themeColorOpacity")&&(t.themeColorOpacity=o.themeColorOpacity)}catch(o){this.logger.error("[GLOBAL-SET] setVariablesFromService widget > Error :",o)}try{const i=n.ip.split(",").shift();this.globals.attributes||(this.globals.attributes={}),this.globals.attributes.ipAddress=i,this.globals.setAttributeParameter("ipAddress",i),this.logger.debug("[GLOBAL-SET] setVariablesFromService > ipAddress :",i)}catch(o){this.logger.error("[GLOBAL-SET] setVariablesFromService > ipAddress > Error :",o)}this.appStorageService.setItem("attributes",JSON.stringify(this.globals.attributes))}setVariablesFromSettings(t){const n=t.windowContext;if(!n.tiledesk)return;{const l=n.tiledesk.getBaseLocation();void 0!==l&&(t.baseLocation=l)}let o;const i=n.tiledeskSettings;o=i.tenant,void 0!==o&&(t.tenant=o),o=i.recipientId,void 0!==o&&(t.recipientId=o),o=i.widgetTitle,void 0!==o&&(t.widgetTitle=o),o=i.userEmail,void 0!==o&&(t.userEmail=o),o=i.userFullname,void 0!==o&&(t.userFullname=o),o=i.preChatForm,void 0!==o&&(t.preChatForm=!0===o),o=i.isOpen,void 0!==o&&(t.isOpen=!0===o),o=i.open,void 0!==o&&(t.isOpen=!0===o),o=i.channelType,void 0!==o&&(t.channelType=o),o=i.lang,fi.XAE&&(t.lang=o),o=i.align,void 0!==o&&(t.align=o),o=i.marginX,void 0!==o&&(t.marginX=o),o=i.marginY,void 0!==o&&(t.marginY=o),o=i.mobileMarginX,void 0!==o&&(t.mobileMarginX=o),o=i.mobileMarginY,void 0!==o&&(t.mobileMarginY=o),o=i.launcherWidth,void 0!==o&&(t.launcherWidth=o),o=i.launcherHeight,void 0!==o&&(t.launcherHeight=o),o=i.baloonImage,void 0!==o&&(t.baloonImage=o),o=i.baloonShape,void 0!==o&&(t.baloonShape=o),o=i.calloutTimer,void 0!==o&&(t.calloutTimer=o),o=i.calloutTitle,void 0!==o&&(t.calloutTitle=o),o=i.calloutMsg,void 0!==o&&(t.calloutMsg=o),o=i.fullscreenMode,void 0!==o&&(t.fullscreenMode=o),o=i.hideHeaderCloseButton,void 0!==o&&(t.hideHeaderCloseButton=o),o=i.themeColor,void 0!==o&&(t.themeColor=xe(o,100),t.bubbleSentBackground=xe(o,100),t.bubbleSentTextColor=qe(o,!0),t.buttonTextColor=xe(o,100),t.buttonHoverBackgroundColor=xe(o,100)),o=i.themeColorOpacity,void 0!==o&&(t.themeColorOpacity=+o),o=i.themeForegroundColor,void 0!==o&&(t.themeForegroundColor=xe(o,100)),o=i.allowTranscriptDownload,void 0!==o&&(t.allowTranscriptDownload=!0===o),o=i.startFromHome,void 0!==o&&(t.startFromHome=!0===o),o=i.logoChat,void 0!==o&&(t.logoChat=o),o=i.welcomeTitle,void 0!==o&&(t.welcomeTitle=o),o=i.welcomeMsg,void 0!==o&&(t.welcomeMsg=o),o=i.autoStart,void 0!==o&&(t.autoStart=!0===o),o=i.startHidden,void 0!==o&&(t.startHidden=!0===o),o=i.isShown,void 0!==o&&(t.isShown=!0===o),o=i.filterByRequester,void 0!==o&&(t.filterByRequester=!0===o),o=i.showWaitTime,void 0!==o&&(t.showWaitTime=!0===o),o=i.showAvailableAgents,void 0!==o&&(t.showAvailableAgents=!0===o),o=i.showLogoutOption,void 0!==o&&(t.showLogoutOption=!0===o),o=i.customAttributes,void 0!==o&&(t.customAttributes=o),o=i.showAttachmentButton,void 0!==o&&(t.showAttachmentButton=!0===o),o=i.showAllConversations,void 0!==o&&(t.showAllConversations=!0===o),o=i.dynamicWaitTimeReply,void 0!==o&&(t.dynamicWaitTimeReply=ue(o)),o=i.soundEnabled,void 0!==o&&(t.soundEnabled=o),o=i.openExternalLinkButton,void 0!==o&&(t.openExternalLinkButton=o),o=i.hideCloseConversationOptionMenu,void 0!==o&&(t.hideCloseConversationOptionMenu=!0===o),o=i.hideRestartConversationOptionsMenu,void 0!==o&&(t.hideRestartConversationOptionsMenu=!0===o),o=i.hideHeaderConversationOptionsMenu,void 0!==o&&(t.hideHeaderConversationOptionsMenu=!0===o),o=i.hideSettings,void 0!==o&&(t.hideSettings=!0===o),o=i.logLevel,void 0!==o&&(t.logLevel=o),o=i.preChatFormJson,void 0!==o&&function ii(r){var t=!0;return Array.isArray(r)&&r.forEach(function(n){if("object"!=typeof n)return t=!1}),t}(o)&&(t.preChatFormJson=o),o=i.bubbleSentBackground,void 0!==o&&(t.bubbleSentBackground=xe(o,100),t.bubbleSentTextColor=qe(o,!0),t.buttonTextColor=xe(o,100),t.buttonHoverBackgroundColor=xe(o,100)),o=i.bubbleSentTextColor,void 0!==o&&(t.bubbleSentTextColor=xe(o,100)),o=i.bubbleReceivedBackground,void 0!==o&&(t.bubbleReceivedBackground=xe(o,100),t.bubbleReceivedTextColor=qe(o,!0)),o=i.bubbleReceivedTextColor,void 0!==o&&(t.bubbleReceivedTextColor=xe(o,100)),o=i.fontSize,void 0!==o&&(t.fontSize=o),o=i.fontFamily,void 0!==o&&(t.fontFamily=o),o=i.buttonFontSize,void 0!==o&&(t.buttonFontSize=o),o=i.buttonBackgroundColor,void 0!==o&&(t.buttonBackgroundColor=xe(o,100),t.buttonTextColor=qe(o,!0),t.buttonHoverBackgroundColor=qe(o,!0),t.buttonHoverTextColor=xe(o,100)),o=i.buttonTextColor,void 0!==o&&(t.buttonTextColor=xe(o,100),t.buttonHoverBackgroundColor=xe(o,100)),o=i.buttonHoverBackgroundColor,void 0!==o&&(t.buttonHoverBackgroundColor=xe(o,100)),o=i.buttonHoverTextColor,void 0!==o&&(t.buttonHoverTextColor=xe(o,100)),o=i.singleConversation,void 0!==o&&(t.singleConversation=!0===o),o=i.restartConversation,void 0!==o&&(t.restartConversation=!0===o),o=i.nativeRating,void 0!==o&&(t.nativeRating=!0===o),o=i.showInfoMessage,void 0!==o&&(t.showInfoMessage=o.split(",").map(l=>l.trim())),o=i.typingLocation,void 0!==o&&(t.typingLocation=o),o=i.allowReopen,void 0!==o&&(t.allowReopen=!0===o,t.allowReopen&&!t.showInfoMessage.includes("CHAT_CLOSED")&&t.showInfoMessage.push("CHAT_CLOSED")),o=i.continueConversationBeforeTime,void 0!==o&&(t.continueConversationBeforeTime=+o),o=i.participants,void 0!==o&&(t.participants=o.split(",").map(l=>l.trim())),o=i.whatsappNumber,void 0!==o&&(t.whatsappNumber=o),o=i.messangerPageTitle,void 0!==o&&(t.messangerPageTitle=o),o=i.telegramUsername,void 0!==o&&(t.telegramUsername=o)}setVariablesFromAttributeHtml(t,n){let o;o=n.nativeElement.getAttribute("tenant"),null!==o&&(this.globals.tenant=o),o=n.nativeElement.getAttribute("recipientId"),null!==o&&(this.globals.recipientId=o),o=n.nativeElement.getAttribute("widgetTitle"),null!==o&&(this.globals.widgetTitle=o),o=n.nativeElement.getAttribute("userEmail"),null!==o&&(this.globals.userEmail=o),o=n.nativeElement.getAttribute("userFullname"),null!==o&&(this.globals.userFullname=o),o=n.nativeElement.getAttribute("preChatForm"),null!==o&&(this.globals.preChatForm=!0===o),o=n.nativeElement.getAttribute("isOpen"),null!==o&&(this.globals.isOpen=!0===o),o=n.nativeElement.getAttribute("open"),null!==o&&(this.globals.isOpen=!0===o),o=n.nativeElement.getAttribute("channelType"),null!==o&&(this.globals.channelType=o),o=n.nativeElement.getAttribute("lang"),null!==o&&(this.globals.lang=o),o=n.nativeElement.getAttribute("align"),null!==o&&(this.globals.align=o),o=n.nativeElement.getAttribute("marginX"),null!==o&&(this.globals.marginX=o),o=n.nativeElement.getAttribute("marginY"),null!==o&&(this.globals.marginY=o),o=n.nativeElement.getAttribute("mobileMarginX"),null!==o&&(this.globals.mobileMarginX=o),o=n.nativeElement.getAttribute("mobileMarginY"),null!==o&&(this.globals.mobileMarginY=o),o=n.nativeElement.getAttribute("launcherWidth"),null!==o&&(this.globals.launcherWidth=o),o=n.nativeElement.getAttribute("launcherHeight"),null!==o&&(this.globals.launcherHeight=o),o=n.nativeElement.getAttribute("baloonImage"),null!==o&&(this.globals.baloonImage=o),o=n.nativeElement.getAttribute("baloonShape"),null!==o&&(this.globals.baloonShape=o),o=n.nativeElement.getAttribute("calloutTimer"),null!==o&&(this.globals.calloutTimer=o),o=n.nativeElement.getAttribute("welcomeMsg"),null!==o&&(this.globals.welcomeMsg=o),o=n.nativeElement.getAttribute("welcomeTitle"),null!==o&&(this.globals.welcomeTitle=o),o=n.nativeElement.getAttribute("calloutTitle"),null!==o&&(this.globals.calloutTitle=o),o=n.nativeElement.getAttribute("calloutMsg"),null!==o&&(this.globals.calloutMsg=o),o=n.nativeElement.getAttribute("startFromHome"),null!==o&&(this.globals.startFromHome=!0===o),o=n.nativeElement.getAttribute("logoChat"),null!==o&&(this.globals.logoChat=o),o=n.nativeElement.getAttribute("autoStart"),null!==o&&(this.globals.autoStart=!0===o),o=n.nativeElement.getAttribute("startHidden"),null!==o&&(this.globals.startHidden=!0===o),o=n.nativeElement.getAttribute("isShown"),null!==o&&(this.globals.isShown=!0===o),o=n.nativeElement.getAttribute("isLogEnabled"),null!==o&&(this.globals.isLogEnabled=!0===o),o=n.nativeElement.getAttribute("filterByRequester"),null!==o&&(this.globals.filterByRequester=!0===o),o=n.nativeElement.getAttribute("showAttachmentButton"),null!==o&&(this.globals.showAttachmentButton=!0===o),o=n.nativeElement.getAttribute("departmentID"),null!==o&&(this.globals.departmentID=o),o=n.nativeElement.getAttribute("showAllConversations"),null!==o&&(this.globals.showAllConversations=!0===o),o=n.nativeElement.getAttribute("dynamicWaitTimeReply"),null!==o&&(this.globals.dynamicWaitTimeReply=ue(o)),o=n.nativeElement.getAttribute("soundEnabled"),null!==o&&(this.globals.soundEnabled=o),o=n.nativeElement.getAttribute("openExternalLinkButton"),null!==o&&(this.globals.openExternalLinkButton=o),o=n.nativeElement.getAttribute("hideHeaderConversationOptionsMenu"),null!==o&&(this.globals.hideHeaderConversationOptionsMenu=o),o=n.nativeElement.getAttribute("hideCloseConversationOptionMenu"),null!==o&&(this.globals.hideCloseConversationOptionMenu=o),o=n.nativeElement.getAttribute("hideRestartConversationOptionsMenu"),null!==o&&(this.globals.hideRestartConversationOptionsMenu=o),o=n.nativeElement.getAttribute("hideSettings"),null!==o&&(this.globals.hideSettings=o),o=n.nativeElement.getAttribute("logLevel"),null!==o&&(this.globals.logLevel=o),o=n.nativeElement.getAttribute("preChatFormJson"),null!==o&&(this.globals.preChatFormJson=o),o=n.nativeElement.getAttribute("fontSize"),null!==o&&(this.globals.fontSize=o),o=n.nativeElement.getAttribute("fontFamily"),null!==o&&(this.globals.fontFamily=o),o=n.nativeElement.getAttribute("buttonFontSize"),null!==o&&(this.globals.buttonFontSize=o),o=n.nativeElement.getAttribute("buttonBackgroundColor"),null!==o&&(this.globals.buttonBackgroundColor=o),o=n.nativeElement.getAttribute("buttonTextColor"),null!==o&&(this.globals.buttonTextColor=o),o=n.nativeElement.getAttribute("buttonHoverBackgroundColor"),null!==o&&(this.globals.buttonHoverBackgroundColor=o),o=n.nativeElement.getAttribute("buttonHoverTextColor"),null!==o&&(this.globals.buttonHoverTextColor=o),o=n.nativeElement.getAttribute("singleConversation"),null!==o&&(this.globals.singleConversation=!0===o),o=n.nativeElement.getAttribute("restartConversation"),null!==o&&(this.globals.restartConversation=!0===o),o=n.nativeElement.getAttribute("nativeRating"),null!==o&&(this.globals.nativeRating=!0===o),o=n.nativeElement.getAttribute("showInfoMessage"),null!==o&&(this.globals.showInfoMessage=o.split(",").map(i=>i.trim())),o=n.nativeElement.getAttribute("typingLocation"),null!==o&&(this.globals.typingLocation=o),o=n.nativeElement.getAttribute("allowReopen"),null!==o&&(this.globals.allowReopen=o,this.globals.allowReopen&&!this.globals.showInfoMessage.includes("CHAT_CLOSED")&&this.globals.showInfoMessage.push("CHAT_CLOSED")),o=n.nativeElement.getAttribute("continueConversationBeforeTime"),null!==o&&(this.globals.continueConversationBeforeTime=+o),o=n.nativeElement.getAttribute("participants"),null!==o&&(this.globals.participants=o.split(",").map(i=>i.trim()))}setVariablesFromUrlParameters(t){this.logger.debug("[GLOBAL-SET] setVariablesFromUrlParameters: ");const n=t.windowContext;let o;if(o=le(n,"tiledesk_tenant"),o&&(t.tenant=ue(o)),o=le(n,"tiledesk_recipientId"),o&&(t.recipientId=ue(o)),o=le(n,"tiledesk_widgetTitle"),o&&(t.widgetTitle=ue(o)),o=le(n,"tiledesk_userEmail"),o&&(t.userEmail=ue(o)),o=le(n,"tiledesk_userFullname"),o&&(t.userFullname=ue(o)),o=le(n,"tiledesk_channelType"),o&&(t.channelType=ue(o)),o=le(n,"tiledesk_lang"),o&&(t.lang=ue(o)),o=le(n,"tiledesk_calloutTimer"),o&&(t.calloutTimer=Number(o)),o=le(n,"tiledesk_align"),o&&(t.align=ue(o)),o=le(n,"tiledesk_marginX"),o&&(t.marginX=ue(o)),o=le(n,"tiledesk_marginY"),o&&(t.marginY=ue(o)),o=le(n,"tiledesk_mobileMarginX"),o&&(t.mobileMarginX=ue(o)),o=le(n,"tiledesk_mobileMarginY"),o&&(t.mobileMarginY=ue(o)),o=le(n,"tiledesk_launcherWidth"),o&&(t.launcherWidth=ue(o)),o=le(n,"tiledesk_launcherHeight"),o&&(t.launcherHeight=ue(o)),o=le(n,"tiledesk_baloonImage"),o&&(t.baloonImage=ue(o)),o=le(n,"tiledesk_baloonShape"),o&&(t.baloonShape=ue(o)),o=le(n,"tiledesk_welcomeMsg"),o&&(t.welcomeMsg=ue(o)),o=le(n,"tiledesk_calloutTitle"),o&&(t.calloutTitle=ue(o)),o=le(n,"tiledesk_calloutMsg"),o&&(t.calloutMsg=ue(o)),o=le(n,"tiledesk_hideHeaderCloseButton"),o&&(t.hideHeaderCloseButton=ue(o)),o=le(n,"tiledesk_themeColor"),o){const i=ue(o);t.themeColor=xe(i,100),t.bubbleSentBackground=xe(i,100),t.buttonTextColor=xe(i,100),t.buttonHoverBackgroundColor=xe(i,100)}if(o=le(n,"tiledesk_themeColorOpacity"),o&&(t.themeColorOpacity=+o),o=le(n,"tiledesk_themeForegroundColor"),o){const i=ue(o);t.themeForegroundColor=xe(i,100),t.bubbleSentTextColor=xe(i,100)}if(o=le(n,"tiledesk_logoChat"),o&&(t.logoChat=ue(o)),o=le(n,"tiledesk_welcomeTitle"),o&&(t.welcomeTitle=ue(o)),o=le(n,"tiledesk_autoStart"),o&&(t.autoStart=ue(o)),o=le(n,"tiledesk_startHidden"),o&&(t.startHidden=ue(o)),o=le(n,"tiledesk_isShown"),o&&(t.isShown=ue(o)),o=le(n,"tiledesk_isLogEnabled"),o&&(t.isLogEnabled=ue(o)),o=le(n,"tiledesk_filterByRequester"),o&&(t.filterByRequester=ue(o)),o=le(n,"tiledesk_showWaitTime"),o&&(t.showWaitTime=ue(o)),o=le(n,"tiledesk_showAvailableAgents"),o&&(t.showAvailableAgents=ue(o)),o=le(n,"tiledesk_showLogoutOption"),o&&(t.showLogoutOption=ue(o)),o=le(n,"tiledesk_preChatForm"),o&&(t.preChatForm=ue(o)),o=le(n,"tiledesk_isOpen"),o&&(t.isOpen=ue(o)),o=le(n,"tiledesk_open"),o&&(t.isOpen=ue(o)),o=le(n,"tiledesk_allowTranscriptDownload"),o&&(t.allowTranscriptDownload=ue(o)),o=le(n,"tiledesk_startFromHome"),o&&(t.startFromHome=ue(o)),o=le(n,"tiledesk_fullscreenMode"),o&&(t.fullscreenMode=ue(o)),o=le(n,"tiledesk_customAttributes"),o&&(t.customAttributes=JSON.parse(o)),o=le(n,"tiledesk_showAttachmentButton"),o&&(t.showAttachmentButton=ue(o)),o=le(n,"tiledesk_departmentID"),o&&(t.departmentID=o),o=le(n,"tiledesk_persistence"),o&&(t.persistence=o),o=le(n,"tiledesk_showAllConversations"),o&&(t.showAllConversations=ue(o)),o=le(n,"tiledesk_jwt"),o&&(t.jwt=o),o=le(n,"tiledesk_dynamicWaitTimeReply"),o&&(t.dynamicWaitTimeReply=ue(o)),o=le(n,"tiledesk_soundEnabled"),o&&(t.soundEnabled=ue(o)),o=le(n,"tiledesk_openExternalLinkButton"),o&&(t.openExternalLinkButton=ue(o)),o=le(n,"tiledesk_hideHeaderConversationOptionsMenu"),o&&(t.hideHeaderConversationOptionsMenu=ue(o)),o=le(n,"tiledesk_hideCloseConversationOptionMenu"),o&&(t.hideCloseConversationOptionMenu=ue(o)),o=le(n,"tiledesk_hideRestartConversationOptionsMenu"),o&&(t.hideRestartConversationOptionsMenu=ue(o)),o=le(n,"tiledesk_hideSettings"),o&&(t.hideSettings=ue(o)),o=le(n,"tiledesk_logLevel"),o&&(t.logLevel=o),o=le(n,"tiledesk_preChatFormJson"),o&&(t.preChatFormJson=JSON.parse(o)),o=le(n,"tiledesk_bubbleSentBackground"),o){const i=ue(o);t.bubbleSentBackground=xe(i,100),t.bubbleSentTextColor=qe(i,!0),t.buttonTextColor=xe(i,100),t.buttonHoverBackgroundColor=xe(i,100)}if(o=le(n,"tiledesk_bubbleSentTextColor"),o){const i=ue(o);t.bubbleSentTextColor=xe(i,100)}if(o=le(n,"tiledesk_bubbleReceivedBackground"),o){const i=ue(o);t.bubbleReceivedBackground=xe(i,100),t.bubbleReceivedTextColor=qe(o,!0)}if(o=le(n,"tiledesk_bubbleReceivedTextColor"),o){const i=ue(o);t.bubbleReceivedTextColor=xe(i,100)}if(o=le(n,"tiledesk_fontSize"),o&&(t.fontSize=o),o=le(n,"tiledesk_fontFamily"),o&&(t.fontFamily=o),o=le(n,"tiledesk_buttonFontSize"),o&&(t.buttonFontSize=o),o=le(n,"tiledesk_buttonBackgroundColor"),o){const i=ue(o);t.buttonBackgroundColor=xe(i,100),t.buttonTextColor=qe(i,!0),t.buttonHoverBackgroundColor=qe(i,!0),t.buttonHoverTextColor=xe(i,100)}if(o=le(n,"tiledesk_buttonTextColor"),o){const i=ue(o);t.buttonTextColor=xe(i,100)}if(o=le(n,"tiledesk_buttonHoverBackgroundColor"),o){const i=ue(o);t.buttonHoverBackgroundColor=xe(i,100)}if(o=le(n,"tiledesk_buttonHoverTextColor"),o){const i=ue(o);t.buttonHoverTextColor=xe(i,100)}o=le(n,"tiledesk_singleConversation"),o&&(t.singleConversation=ue(o)),o=le(n,"tiledesk_restartConversation"),o&&(t.restartConversation=ue(o)),o=le(n,"tiledesk_nativeRating"),o&&(t.nativeRating=ue(o)),o=le(n,"tiledesk_typingLocation"),o&&(t.typingLocation=o),o=le(n,"tiledesk_showInfoMessage"),o&&(t.showInfoMessage=o.split(",").map(i=>i.trim())),o=le(n,"tiledesk_allowReopen"),o&&(t.allowReopen=ue(o),t.allowReopen&&!t.showInfoMessage.includes("CHAT_CLOSED")&&t.showInfoMessage.push("CHAT_CLOSED")),o=le(n,"tiledesk_continueConversationBeforeTime"),o&&(t.continueConversationBeforeTime=+o),o=le(n,"tiledesk_participants"),o&&(t.participants=o.split(",").map(i=>i.trim()))}setVariableFromStorage(t){this.logger.debug("[GLOBAL-SET] setVariableFromStorage :::::::: SET VARIABLE ----------\x3e",Object.keys(t));for(const n of Object.keys(t)){const o=this.appStorageService.getItem(n);o&&null!==o&&(t[n]=ue(o))}}initDepartments(t){if(this.globals.setParameter("departmentSelected",null),this.globals.setParameter("departmentDefault",null),this.logger.info("[GLOBAL-SET] initDepartments departments ::::",t),null!==t)if(this.globals.departments=t,1===t.length){const n=t[0];this.logger.debug("[GLOBAL-SET] initDepartments DEPARTMENT FIRST ::::",t[0]),this.globals.setParameter("departmentDefault",t[0]),n&&n.online_msg&&""!==n.online_msg&&(this.globals.online_msg=n.online_msg),n&&n.offline_msg&&""!==n.offline_msg&&(this.globals.offline_msg=n.offline_msg),this.setDepartment(t[0])}else if(t.length>1){this.logger.debug("[GLOBAL-SET] initDepartments > MORE THAN 1 DEPARTMENT ::::",t[0]);let n=0;t.forEach(o=>{if(!0===o.default)return o&&o.online_msg&&""!==o.online_msg&&(this.globals.online_msg=o.online_msg),o&&o.offline_msg&&""!==o.offline_msg&&(this.globals.offline_msg=o.offline_msg),this.globals.setParameter("departmentDefault",t[n]),void this.setDepartment(t[n]);n++})}else this.logger.error("[GLOBAL-SET] initDepartments > DEPARTMENT DEFAULT NON RESTITUISCE RISULTATI ::::")}setDepartmentFromExternal(){let t=!1;this.globals.departmentID&&(this.globals.departments.forEach(n=>{if(n._id===this.globals.departmentID)return this.logger.debug("[GLOBAL-SET] setDepartmentFromExternal > EXTERNAL DEPARTMENT ::::"+n._id),this.globals.setParameter("departmentDefault",n),this.setDepartment(n),void(t=!0)}),!1===t&&(this.globals.departmentID=null),this.logger.debug("[GLOBAL-SET] setDepartmentFromExternal > END departmentID ::::"+this.globals.departmentID+t)),this.globals.departments=this.globals.departments.filter(n=>!0!==n.default),this.globals.departments&&1===this.globals.departments.length&&this.setDepartment(this.globals.departments[0])}setDepartment(t){this.logger.debug("[GLOBAL-SET] setDepartment: ",JSON.stringify(t)),this.globals.setParameter("departmentSelected",t);let n=JSON.parse(this.appStorageService.getItem("attributes"));n?(n.departmentId=t._id,n.departmentName=t.name):n={departmentId:t._id,departmentName:t.name},this.logger.debug("[GLOBAL-SET] setDepartment > setAttributes: ",JSON.stringify(n)),this.globals.setParameter("departmentSelected",t),this.globals.setParameter("attributes",n)}setAvailableAgentsStatus(t){if(this.globals.setParameter("availableAgentsStatus",!1),null!==t&&t.length>0){const n=[];t.forEach((o,i)=>{o.imageurl=function bo(r){return"https://firebasestorage.googleapis.com/v0/b/"+Ie.firebaseConfig.storageBucket+"/o/profiles%2F"+r+"%2Fthumb_photo.jpg?alt=media"}(o.id),n.push(o)}),this.globals.availableAgents=n,this.globals.setParameter("availableAgentsStatus",!0)}}getProjectParametersById(t){if(t){const o=this.appConfigService.getConfig().apiUrl+t+"/widgets",i=new Ee.WM;return i.append("Content-Type","application/json"),this.http.get(o,{headers:i})}}}pt.\u0275fac=function(t){return new(t||pt)(e.LFG(Ee.eN),e.LFG(Re),e.LFG(ke))},pt.\u0275prov=e.Yz7({token:pt,factory:pt.\u0275fac});class ft{constructor(t,n){this.g=t,this.appStorageService=n}initialize(){this.setGlobalsSubscription()}setGlobalsSubscription(){const t=this;this.g.obsObjChanged.subscribe(n=>{n&&t.setVariable(n.key,n.val)})}setVariable(t,n){JSON.stringify(n)}}ft.\u0275fac=function(t){return new(t||ft)(e.LFG(Pe),e.LFG(Re))},ft.\u0275prov=e.Yz7({token:ft,factory:ft.\u0275fac});var mi=be(1737),_i=be(7221),eo=be(4065);class st{constructor(t,n,o,i){this._translate=t,this.http=n,this.g=o,this.appConfigService=i,this.defaultLanguage="en",this.logger=fe.getInstance();let l=window;window.frameElement&&"parent"===window.frameElement.getAttribute("tiledesk_context")&&(l=window.parent),l.tiledesk&&(this.baseLocation=l.tiledesk.getBaseLocation())}getLanguage(){return this.language}initializeTransaltorService(){this._translate.setDefaultLang("it");const t=this._translate.getBrowserLang();this.logger.debug("[TRANSLATOR-SERV] initializeTransaltorService--\x3e DEVICE LANG ",t),t&&("it"===t?(this._translate.use("it"),this.http.get(this.baseLocation+`/assets/i18n/${t}.json`).subscribe(n=>{this._translate.setTranslation("it",JSON.parse(n._body)),this._translate.get("LABEL_PREVIEW").subscribe(o=>{})})):this._translate.use("en"))}getTranslationFileUrl(t){this.remoteTranslationsUrl=Ie.remoteTranslationsUrl;const n=this.appConfigService.getConfig().remoteTranslationsUrl;return n&&(this.remoteTranslationsUrl=n),Ie.loadRemoteTranslations?this.remoteTranslationsUrl+this.g.projectid+"/labels/"+t.toUpperCase():this.baseLocation+`/assets/i18n/${t}.json`}initI18n(){this._translate.addLangs(["en","it"]),this.logger.debug("[TRANSLATOR-SERV]\xbb\xbb\xbb\xbb initI18n getLangs ",this._translate.getLangs());const t="en";this.logger.debug("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n setDefaultLang "),this._translate.setDefaultLang(t),this.language=t;let n=this._translate.getBrowserLang();return this.g.lang&&""!==this.g.lang?(n=this.g.lang,this.language=this.g.lang):this.g.lang=n,new Promise((o,i)=>{this.http.get(this.getTranslationFileUrl(n)).pipe((0,_i.K)(E=>(this._translate.use(t),this.http.get(this.getTranslationFileUrl(t)).subscribe(V=>{this.translateWithBrowserLang(V.data,t)},V=>{this.logger.error("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n Get default language - ERROR ",V),this.logger.error("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n - \xbb\xbb\xbb loadRemoteTranslations IN ERROR ?",Ie.loadRemoteTranslations)},()=>{o(!0)}),(0,mi._)(E)))).subscribe(E=>{this.logger.debug(`[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n Successfully initialized '${n}' language from URL'`,this.getTranslationFileUrl(n)),E.data&&void 0!==E.data&&""!==E.data?(this.language=E.lang.toLowerCase(),this.translateWithBrowserLang(E.data,this.language)):(n=t,this.language=t,this.g.lang=t,this._translate.use(t),this.http.get(this.getTranslationFileUrl(t)).subscribe(V=>{this.translateWithBrowserLang(V.data,n)}))},E=>{this.logger.error(`[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n Get '${n}' language - ERROR `,E)},()=>{o(!0)})})}translateWithBrowserLang(t,n){this._translate.use(n),this.logger.debug("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n - \xbb\xbb\xbb loadRemoteTranslations ?",Ie.loadRemoteTranslations),this._translate.setTranslation(n,t,!0)}translate(t){this._translate.get(["LABEL_TU","LABEL_PLACEHOLDER","LABEL_START_NW_CONV","LABEL_FIRST_MSG","LABEL_FIRST_MSG_NO_AGENTS","LABEL_SELECT_TOPIC","LABEL_COMPLETE_FORM","LABEL_FIELD_NAME","LABEL_ERROR_FIELD_NAME","LABEL_FIELD_EMAIL","LABEL_ERROR_FIELD_EMAIL","LABEL_ERROR_FIELD_REQUIRED","LABEL_WRITING","LABEL_SEND_NEW_MESSAGE","AGENT_NOT_AVAILABLE","AGENT_AVAILABLE","GUEST_LABEL","ALL_AGENTS_OFFLINE_LABEL","CALLOUT_TITLE_PLACEHOLDER","CALLOUT_MSG_PLACEHOLDER","ALERT_LEAVE_CHAT","YES","NO","BUTTON_CLOSE_TO_ICON","BUTTON_EDIT_PROFILE","DOWNLOAD_TRANSCRIPT","RATE_CHAT","WELLCOME_TITLE","WELLCOME_MSG","OPTIONS","SOUND_ON","SOUND_OFF","LOGOUT","CUSTOMER_SATISFACTION","YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE","YOUR_RATING","WRITE_YOUR_OPINION","SUBMIT","THANK_YOU_FOR_YOUR_EVALUATION","YOUR_RATING_HAS_BEEN_RECEIVED","CLOSE","PREV_CONVERSATIONS","YOU","SHOW_ALL_CONV","START_A_CONVERSATION","NO_CONVERSATION","SEE_PREVIOUS","WAITING_TIME_FOUND","WAITING_TIME_NOT_FOUND","CLOSED","LABEL_PREVIEW"]).subscribe(o=>{t.LABEL_TU=o.LABEL_TU,t.LABEL_PLACEHOLDER=o.LABEL_PLACEHOLDER,t.LABEL_START_NW_CONV=o.LABEL_START_NW_CONV,t.LABEL_FIRST_MSG=o.LABEL_FIRST_MSG,t.LABEL_FIRST_MSG_NO_AGENTS=o.LABEL_FIRST_MSG_NO_AGENTS,t.LABEL_SELECT_TOPIC=o.LABEL_SELECT_TOPIC,t.LABEL_COMPLETE_FORM=o.LABEL_COMPLETE_FORM,t.LABEL_FIELD_NAME=o.LABEL_FIELD_NAME,t.LABEL_ERROR_FIELD_NAME=o.LABEL_ERROR_FIELD_NAME,t.LABEL_FIELD_EMAIL=o.LABEL_FIELD_EMAIL,t.LABEL_ERROR_FIELD_EMAIL=o.LABEL_ERROR_FIELD_EMAIL,t.LABEL_WRITING=o.LABEL_WRITING,t.LABEL_SEND_NEW_MESSAGE=o.LABEL_SEND_NEW_MESSAGE,t.AGENT_NOT_AVAILABLE=o.AGENT_NOT_AVAILABLE,t.AGENT_AVAILABLE=o.AGENT_AVAILABLE,t.GUEST_LABEL=o.GUEST_LABEL,t.ALL_AGENTS_OFFLINE_LABEL=o.ALL_AGENTS_OFFLINE_LABEL,t.CALLOUT_TITLE_PLACEHOLDER=o.CALLOUT_TITLE_PLACEHOLDER,t.CALLOUT_MSG_PLACEHOLDER=o.CALLOUT_MSG_PLACEHOLDER,t.ALERT_LEAVE_CHAT=o.ALERT_LEAVE_CHAT,t.YES=o.YES,t.NO=o.NO,t.BUTTON_CLOSE_TO_ICON=o.BUTTON_CLOSE_TO_ICON,t.BUTTON_EDIT_PROFILE=o.BUTTON_EDIT_PROFILE,t.DOWNLOAD_TRANSCRIPT=o.DOWNLOAD_TRANSCRIPT,t.RATE_CHAT=o.RATE_CHAT,t.WELLCOME_TITLE=o.WELLCOME_TITLE,t.WELLCOME_MSG=o.WELLCOME_MSG,t.OPTIONS=o.OPTIONS,t.SOUND_ON=o.SOUND_ON,t.SOUND_OFF=o.SOUND_OFF,t.LOGOUT=o.LOGOUT,t.CUSTOMER_SATISFACTION=o.CUSTOMER_SATISFACTION,t.YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE=o.YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE,t.YOUR_RATING=o.YOUR_RATING,t.WRITE_YOUR_OPINION=o.WRITE_YOUR_OPINION,t.SUBMIT=o.SUBMIT,t.THANK_YOU_FOR_YOUR_EVALUATION=o.THANK_YOU_FOR_YOUR_EVALUATION,t.YOUR_RATING_HAS_BEEN_RECEIVED=o.YOUR_RATING_HAS_BEEN_RECEIVED,t.CLOSE=o.CLOSE,t.PREV_CONVERSATIONS=o.PREV_CONVERSATIONS,t.YOU=o.YOU,t.SHOW_ALL_CONV=o.SHOW_ALL_CONV,t.START_A_CONVERSATION=o.START_A_CONVERSATION,t.NO_CONVERSATION=o.NO_CONVERSATION,t.SEE_PREVIOUS=o.SEE_PREVIOUS,t.WAITING_TIME_FOUND=o.WAITING_TIME_FOUND,t.WAITING_TIME_NOT_FOUND=o.WAITING_TIME_NOT_FOUND,t.CLOSED=o.CLOSED,t.LABEL_PREVIEW=o.LABEL_PREVIEW,t.LABEL_ERROR_FIELD_REQUIRED=o.LABEL_ERROR_FIELD_REQUIRED,t.welcomeTitle||(t.welcomeTitle=t.WELLCOME_TITLE),t.welcomeMsg||(t.welcomeMsg=t.WELLCOME_MSG)},o=>{this.logger.error("[TRANSLATOR-SERV]\xbb\xbb\xbb\xbb\xbb\xbb \xbb\xbb\xbb\xbb\xbb\xbb GET TRANSLATED LABELS - ERROR ",o)},()=>{})}}st.\u0275fac=function(t){return new(t||st)(e.LFG(eo.sK),e.LFG(Ee.eN),e.LFG(Pe),e.LFG(ke))},st.\u0275prov=e.Yz7({token:st,factory:st.\u0275fac});const To=JSON.parse('{"LABEL_TU":"","LABEL_PLACEHOLDER":"type your message..","LABEL_START_NW_CONV":"New conversation","LABEL_WHATSAPP":"Message us","LABEL_FIRST_MSG":"Describe shortly your problem, you will be contacted by an agent.","LABEL_FIRST_MSG_NO_AGENTS":"\u{1f914} All operators are offline at the moment. You can anyway describe your problem. It will be assigned to the support team who will answer you as soon as possible.","LABEL_SELECT_TOPIC":"Select a topic","LABEL_COMPLETE_FORM":"Complete the form to start a conversation with the next available agent.","LABEL_FIELD_NAME":"Name","LABEL_ERROR_FIELD_NAME":"Required field (minimum 5 characters).","LABEL_FIELD_EMAIL":"Email","LABEL_ERROR_FIELD_EMAIL":"Enter a valid email address.","LABEL_ERROR_FIELD_REQUIRED":"Required field","LABEL_WRITING":"is writing...","LABEL_SEND_NEW_MESSAGE":"Send a new message","AGENT_NOT_AVAILABLE":" Offline","AGENT_AVAILABLE":" Online","GUEST_LABEL":"Guest","ALL_AGENTS_OFFLINE_LABEL":"All operators are offline at the moment","LABEL_LOADING":"Loading...","CALLOUT_TITLE_PLACEHOLDER":"Need Help?","CALLOUT_MSG_PLACEHOLDER":"Click here and start chatting with us!","CUSTOMER_SATISFACTION":"Customer satisfaction","YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE":"your opinion on our customer service","DOWNLOAD_TRANSCRIPT":"Download transcript","BACK":"Back","CONTINUE":"Continue","YOUR_RATING":"your rating","WRITE_YOUR_OPINION":"Write your opinion ... (optional)","SUBMIT":"Submit","THANK_YOU_FOR_YOUR_EVALUATION":"Thank you for your evaluation","YOUR_RATING_HAS_BEEN_RECEIVED":"your rating has been received","ALERT_LEAVE_CHAT":"Do you want to leave the chat?","YES":"Yes","NO":"No","BUTTON_CLOSE_TO_ICON":"Minimize chat","BUTTON_EDIT_PROFILE":"Update profile","RATE_CHAT":"Rate chat","WELLCOME_TITLE":"Hi, welcome to Tiledesk \u{1f44b}","WELLCOME_MSG":"How can we help?","OPTIONS":"options","SOUND_OFF":"Sound off","SOUND_ON":"Sound on","LOGOUT":"Logout","CLOSE":"Close","RESTART":"Restart","PREV_CONVERSATIONS":"Your conversations","YOU":"You","SHOW_ALL_CONV":"show all","START_A_CONVERSATION":"Start a conversation","NO_CONVERSATION":"No conversation","SEE_PREVIOUS":"see previous","WAITING_TIME_FOUND":"The team typically replies in $reply_time","WAITING_TIME_NOT_FOUND":"The team will reply as soon as possible","CLOSED":"CLOSED","CLOSE_CHAT":"Close chat","MINIMIZE":"Minimize","MAXIMIZE":"Maximize","INFO_SUPPORT_USER_ADDED_SUBJECT":"you","INFO_SUPPORT_USER_ADDED_YOU_VERB":"have been added to ","INFO_SUPPORT_USER_ADDED_COMPLEMENT":"joined","INFO_SUPPORT_USER_ADDED_VERB":"the chat","INFO_SUPPORT_CHAT_REOPENED":"Chat reopened","INFO_SUPPORT_CHAT_CLOSED":"Chat closed","INFO_SUPPORT_LEAD_UPDATED":"Lead updated","INFO_SUPPORT_MEMBER_LEFT_GROUP":"removed from group","INFO_SUPPORT_MEMBER_ABANDONED_GROUP":"has left the conversation","INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU":"A new support request has been assigned to you","LABEL_PRECHAT_USER_FULLNAME":"Full name","LABEL_PRECHAT_USER_EMAIL":"Email","LABEL_PRECHAT_USER_EMAIL_ERROR":"Invalid email address","LABEL_PRECHAT_USER_PHONE":"Phone","LABEL_PRECHAT_USER_PHONE_ERROR":"Phone is required","LABEL_PRECHAT_FIRST_MESSAGE":"Your message for the support team","LABEL_PRECHAT_STATIC_TERMS_PRIVACY":"Before proceeding in the conversation please agree to our <a href=\'https://tiledesk.com/termsofservice/\' target=\'_blank\'>Terms</a> and <a href=\'https://tiledesk.com/privacy.html\' target=\'_blank\'>Privacy Policy</a>","LABEL_PRECHAT_ACCEPT_TERMS_PRIVACY":"I agree","PRECHAT_REQUIRED_ERROR":"This field is required","LABEL_TODAY":"today","LABEL_TOMORROW":"yesterday","LABEL_LAST_ACCESS":"last access","LABEL_TO":"at","ARRAY_DAYS":["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],"SENT_AN_ATTACHMENT":"sent an attachment","SENT_AN_IMAGE":"sent an image","LABEL_PREVIEW":"Preview","SWITCH_TO":"Or switch to:"}');class He{constructor(t){this.translateService=t}translateLanguage(t,n){return this.initialiseTranslation(t)}initialiseTranslation(t){const n=new Map;return t.forEach(o=>{this.translateService.get(o).subscribe(i=>{o===i&&To[o]&&(i=To[o]),n.set(o,i)})}),n}}He.\u0275fac=function(t){return new(t||He)(e.LFG(eo.sK))},He.\u0275prov=e.Yz7({token:He,factory:He.\u0275fac});class Ye{}Ye.\u0275fac=function(t){return new(t||Ye)},Ye.\u0275prov=e.Yz7({token:Ye,factory:Ye.\u0275fac});class Je{}Je.\u0275fac=function(t){return new(t||Je)},Je.\u0275prov=e.Yz7({token:Je,factory:Je.\u0275fac});class Xe{constructor(t,n){this.conversationsHandlerService=t,this.archivedConversationsService=n,this.BSStart=new _e.X(null),this.logger=fe.getInstance()}initialize(){this.handlers=[],this.openInfoConversation=!0,this.currentUser=null,this.logger.info("[CHAT MANAGER]**** init ****",this.handlers)}setTiledeskToken(t){this.tiledeskToken=t}getTiledeskToken(){return this.tiledeskToken}setCurrentUser(t){this.currentUser=t}getCurrentUser(){return this.currentUser}startApp(){this.BSStart.next(this.currentUser)}getOpenInfoConversation(){return this.openInfoConversation}dispose(){this.logger.debug("[CHAT MANAGER] 1 - setOffAllReferences"),this.handlers&&this.setOffAllReferences(),this.logger.debug("[CHAT MANAGER] 2 - disposeConversationsHandler"),this.conversationsHandlerService&&this.disposeConversationsHandler(),this.logger.debug("[CHAT MANAGER] 3 - disposeArchivedConversationsHandler"),this.archivedConversationsService&&this.disposeArchivedConversationsHandler(),this.logger.debug("[CHAT MANAGER] 4 - disposeContactsSynchronizer"),this.logger.debug("[CHAT MANAGER] OKK "),this.conversationsHandlerService=null,this.archivedConversationsService=null}goOffLine(){this.currentUser=null,this.logger.debug("[CHAT MANAGER] 1 - CANCELLO TUTTE LE REFERENCES"),this.dispose()}addConversationHandler(t){this.logger.debug("[CHAT MANAGER] -----\x3e addConversationHandler",this.handlers,t),this.handlers.push(t)}removeConversationHandler(t){this.logger.debug("[CHAT MANAGER] -----\x3e removeConversationHandler: ",t);const n=this.handlers.findIndex(o=>o.conversationWith===t);this.handlers.splice(n,1)}getConversationHandlerByConversationId(t){let n=null;return this.handlers.forEach(o=>{o.conversationWith!==t||(n=o)}),n}setOffAllReferences(){this.handlers.forEach(t=>{}),this.handlers=[]}setConversationsHandler(t){this.conversationsHandlerService=t}setArchivedConversationsHandler(t){this.archivedConversationsService=t}disposeConversationsHandler(){this.logger.debug("[CHAT MANAGER] 2 - this.conversationsHandler:: ",this.conversationsHandlerService),this.conversationsHandlerService.dispose()}disposeArchivedConversationsHandler(){this.logger.debug("[CHAT MANAGER] 3 - this.archivedConversationsService:: ",this.archivedConversationsService),this.archivedConversationsService.dispose()}}Xe.\u0275fac=function(t){return new(t||Xe)(e.LFG(Ye),e.LFG(Je))},Xe.\u0275prov=e.Yz7({token:Xe,factory:Xe.\u0275fac,providedIn:"root"});class at{constructor(t,n){this.http=t,this.appStorage=n,this.logger=fe.getInstance()}initialize(t,n){this.logger.debug("[TILEDESK-REQUEST-SERV] - initialize",n),this.SERVER_BASE_URL=t,this.URL_TILEDESK_CLOSE_REQUEST=this.SERVER_BASE_URL+n+"/requests/"}closeSupportGroup(t){this.tiledeskToken=this.appStorage.getItem("tiledeskToken"),this.logger.debug("[TILEDESK-REQUEST-SERV] - closeSupportGroup",t);const o={headers:new Ee.WM({Accept:"application/json","Content-Type":"application/json",Authorization:this.tiledeskToken})},l=this.URL_TILEDESK_CLOSE_REQUEST+t+"/closeg";return new Promise((E,V)=>{this.logger.debug("[TILEDESK-REQUEST-SERV] - closeSupportGroup URLLLL",l,o),this.http.put(l,null,o).subscribe(Q=>{this.logger.debug("[TILEDESK-REQUEST-SERV] - closeSupportGroup response",Q),E("closed")},Q=>{V(Q)})})}}at.\u0275fac=function(t){return new(t||at)(e.LFG(Ee.eN),e.LFG(Re))},at.\u0275prov=e.Yz7({token:at,factory:at.\u0275fac});class vi{constructor(t,n,o,i,l,E,V,Q,se,ge,me,ce){this.uid=t,this.email=n,this.firstname=o,this.lastname=i,this.fullname=l,this.imageurl=E,this.avatar=V,this.color=Q,this.checked=se,this.online=ge,this.lastConnection=me,this.decoded=ce}}function en(r){const t=["#E17076","#7BC862","#65aadd","#a695e7","#ee7aae","#6ec9cb","#faa774"];let n=0;if(r){const o=r.charCodeAt(r.length-1);n=Math.round(o%t.length)}return t[n]}function tn(r){let t="";return r&&r.split(" ").forEach(o=>{o.trim().length>1&&t.length<3&&(t+=o.substring(0,1).toUpperCase()),1==o.trim().length&&(t+=o.substring(0,1).toUpperCase())}),t}class mt{constructor(t,n){this.http=t,this.appStorage=n,this.logger=fe.getInstance()}initialize(t){this.logger.log("[TILEDESK-AUTH-SERV] - initialize serverBaseUrl",t),this.SERVER_BASE_URL=t,this.URL_TILEDESK_SIGNIN=this.SERVER_BASE_URL+"auth/signin",this.URL_TILEDESK_SIGNIN_ANONYMOUSLY=this.SERVER_BASE_URL+"auth/signinAnonymously",this.URL_TILEDESK_SIGNIN_WITH_CUSTOM_TOKEN=this.SERVER_BASE_URL+"auth/signinWithCustomToken"}signInWithEmailAndPassword(t,n){this.logger.debug("[TILEDESK-AUTH]-SERV] - signInWithEmailAndPassword",t,n);const o=new Ee.WM;o.append("Accept","application/json"),o.append("Content-Type","application/json");const i={headers:o},l={email:t,password:n},E=this;return new Promise((V,Q)=>{this.http.post(this.URL_TILEDESK_SIGNIN,l,i).subscribe(se=>{se.success&&se.token&&(E.tiledeskToken=se.token,E.createCompleteUser(se.user),E.appStorage.setItem("tiledeskToken",E.tiledeskToken),V(E.tiledeskToken))},se=>{Q(se)})})}signInAnonymously(t){this.logger.debug("[TILEDESK-AUTH] - signInAnonymously - projectID",t);const n=new Ee.WM;n.append("Accept","application/json"),n.append("Content-Type","application/json");const o={headers:n},i={id_project:t},l=this;return new Promise((E,V)=>{this.http.post(this.URL_TILEDESK_SIGNIN_ANONYMOUSLY,i,o).subscribe(Q=>{Q.success&&Q.token&&(l.tiledeskToken=Q.token,l.createCompleteUser(Q.user),l.appStorage.setItem("tiledeskToken",l.tiledeskToken),E(l.tiledeskToken))},Q=>{V(Q)})})}signInWithCustomToken(t){const o={headers:new Ee.WM({"Content-type":"application/json",Authorization:t})},i=this;return new Promise((l,E)=>{this.http.post(this.URL_TILEDESK_SIGNIN_WITH_CUSTOM_TOKEN,null,o).subscribe(V=>{V.success&&V.token&&(i.tiledeskToken=V.token,i.createCompleteUser(V.user),this.checkAndSetInStorageTiledeskToken(i.tiledeskToken),l(this.currentUser))},V=>{E(V)})})}logOut(){this.logger.debug("[TILEDESK-AUTH] logOut()"),this.appStorage.removeItem("tiledeskToken"),this.appStorage.removeItem("currentUser"),this.setCurrentUser(null)}createCompleteUser(t){const n=new vi(t._id);try{const o=t._id,i=t.firstname?t.firstname:"",l=t.lastname?t.lastname:"",E=t.email?t.email:"",V=(i+" "+l).trim(),Q=tn(V),se=en(V);n.uid=o,n.email=E,n.firstname=i,n.lastname=l,n.fullname=V,n.avatar=Q,n.color=se,this.currentUser=n,this.logger.debug("[TILEDESK-AUTH] - createCompleteUser member ",n),this.appStorage.setItem("currentUser",JSON.stringify(this.currentUser))}catch(o){this.logger.error("[TILEDESK-AUTH]- createCompleteUser ERR ",o)}}checkAndSetInStorageTiledeskToken(t){this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken tiledeskToken from request",t);const n=this.appStorage.getItem("tiledeskToken");this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken storedTiledeskToken ",n),n?n&&n!==t?(this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken STORED-TOKEN EXIST BUT IS != FROM TOKEN - RUN SET "),this.appStorage.setItem("tiledeskToken",t)):n&&n===t&&this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken STORED-TOKEN EXIST AND IS = TO TOKEN "):(this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken TOKEN DOES NOT EXIST - RUN SET "),this.appStorage.setItem("tiledeskToken",t))}getCurrentUser(){return this.currentUser}setCurrentUser(t){this.currentUser=t}getTiledeskToken(){return this.tiledeskToken}}mt.\u0275fac=function(t){return new(t||mt)(e.LFG(Ee.eN),e.LFG(Re))},mt.\u0275prov=e.Yz7({token:mt,factory:mt.\u0275fac});class et{constructor(){this.DEFAULT_PERSISTENCE="NONE",this.DEFAULT_URL="https://api.tiledesk.com/v2/auth/"}setPersistence(t){this.persistence=t}getPersistence(){return this.persistence?this.persistence:this.DEFAULT_PERSISTENCE}setBaseUrl(t){this.baseUrl=t}getBaseUrl(){return this.baseUrl?this.baseUrl:this.DEFAULT_URL}}et.\u0275fac=function(t){return new(t||et)},et.\u0275prov=e.Yz7({token:et,factory:et.\u0275fac});class Qe{constructor(){}}Qe.\u0275fac=function(t){return new(t||Qe)},Qe.\u0275prov=e.Yz7({token:Qe,factory:Qe.\u0275fac});class Ze{constructor(){this.DEFAULT_URL=Ie.baseImageUrl}setImageBaseUrl(t){this.baseImageUrl=t}getImageBaseUrl(){return this.baseImageUrl?this.baseImageUrl:this.DEFAULT_URL}}Ze.\u0275fac=function(t){return new(t||Ze)},Ze.\u0275prov=e.Yz7({token:Ze,factory:Ze.\u0275fac});class je{}je.\u0275fac=function(t){return new(t||je)},je.\u0275prov=e.Yz7({token:je,factory:je.\u0275fac});class tt{}tt.\u0275fac=function(t){return new(t||tt)},tt.\u0275prov=e.Yz7({token:tt,factory:tt.\u0275fac});class Ve{constructor(){this.DEFAULT_URL=Ie.apiUrl}setBaseUrl(t){this.baseUrl=t}getBaseUrl(){return this.baseUrl?this.baseUrl:this.DEFAULT_URL}}function bi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",9)(1,"chat-home",10),e.NdJ("onNewConversation",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onNewConversation())})("onConversationSelected",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onSelectedConversation(i))})("onOpenAllConvesations",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onOpenAllConversation())})("onCloseWidget",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onCloseWidget())})("onSignOut",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onSignOut())})("onImageLoaded",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onImageLoaded(i))})("onConversationLoaded",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onConversationLoaded(i))}),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("listConversations",n.listConversations)("archivedConversations",n.archivedConversations)("hideSettings",n.g.hideSettings)("stylesMap",n.styleMapConversation)}}function Ci(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",9)(1,"chat-list-all-conversations",11),e.NdJ("onCloseWidget",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onCloseAllConversation())})("onConversationSelected",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onSelectedConversation(i))}),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("listConversations",n.listConversations)("archivedConversations",n.archivedConversations)("stylesMap",n.styleMapConversation)}}function wi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",9)(1,"chat-conversation",12),e.NdJ("onBackHome",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onBackConversation())})("onCloseWidget",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onCloseWidget())})("onSoundChange",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onSoundChange(i))})("onConversationClosed",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onConversationClosed(i))})("onSignOut",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onMenuOptionSignOut())})("onNewConversationButtonClicked",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onNewConversationButtonClicked(i))})("onBeforeMessageSent",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.triggerHandler.triggerBeforeSendMessageEvent(i))})("onAfterSendMessage",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.triggerHandler.triggerAfterSendMessageEvent(i))})("onNewMessageCreated",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.triggerHandler.triggerOnMessageCreated(i))})("onNewConversationInit",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.triggerHandler.triggerOnNewConversationInit(i))})("onBeforeMessageRender",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.triggerHandler.triggerBeforeMessageRender(i))})("onAfterMessageRender",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.triggerHandler.triggerAfterMessageRender(i))}),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("senderId",n.g.senderId)("conversationId",n.g.recipientId)("isOpen",n.g.isOpen)("isConversationArchived",n.isConversationArchived)("stylesMap",n.styleMapConversation)}}function yi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",13)(1,"chat-selection-department",14),e.NdJ("onBeforeDepartmentsFormRender",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.triggerHandler.triggerOnbeforeDepartmentsFormRender(i))})("onClose",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onCloseModalDepartment())})("onDepartmentSelected",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onDepartmentSelected(i))}),e.qZA()()}}function Oi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",15)(1,"chat-prechat-form",16),e.NdJ("onClosePage",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onCloseModalPrechatForm())})("onCloseForm",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onPrechatFormComplete())}),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("stylesMap",n.styleMapConversation)}}function xi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",17)(1,"chat-star-rating-widget",18),e.NdJ("onClosePage",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onCloseModalRateChat())})("onCloseRate",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onRateChatComplete())}),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("recipientId",n.g.recipientId)("stylesMap",n.styleMapConversation)}}function Mi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-eyeeye-catcher-card",19),e.NdJ("onOpenChat",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onOpenChatEyeEyeCatcherCard())})("onCloseEyeCatcherCard",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onCloseEyeCatcherCard(i))}),e.qZA()}}function Ei(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div")(1,"chat-last-message",20),e.NdJ("onCloseMessagePreview",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.triggerHandler.triggerOnCloseMessagePreview())})("onSelectedConversation",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onSelectedConversation(i))}),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("conversation",n.lastConversation)("baseLocation",null==n.g||null==n.g.windowContext.tiledesk?null:n.g.windowContext.tiledesk.getBaseLocation())("stylesMap",n.styleMapConversation)}}function Ti(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-launcher-button",21),e.NdJ("onButtonClicked",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onOpenCloseWidget(i))}),e.qZA()}}Ve.\u0275fac=function(t){return new(t||Ve)},Ve.\u0275prov=e.Yz7({token:Ve,factory:Ve.\u0275fac});const Si=function(r,t,n,o){return{"swing-in-bottom-fwd":r,"full-screen-mode":t,"c21-align-left":n,"c21-align-right":o}},Pi=function(r,t,n,o){return{display:r,bottom:t,left:n,right:o}};class _t{constructor(t,n,o,i,l,E,V,Q,se,ge,me,ce,ve,we,Me,Ne,ht,ot,it,rt,Rn,lo){this.el=t,this.ngZone=n,this.g=o,this.rules=i,this.triggerHandler=l,this.globalSettingsService=E,this.settingsSaverService=V,this.appConfigService=Q,this.appStorageService=se,this.translatorService=ge,this.translateService=me,this.chatManager=ce,this.tiledeskRequestsService=ve,this.tiledeskAuthService=we,this.messagingAuthService=Me,this.conversationsHandlerService=Ne,this.archivedConversationsService=ht,this.conversationHandlerBuilderService=ot,this.imageRepoService=it,this.typingService=rt,this.presenceService=Rn,this.uploadService=lo,this.subscriptions=[],this.isTabVisible=!0,this.isOpenHome=!0,this.isOpenConversation=!1,this.isOpenAllConversation=!1,this.isOpenSelectionDepartment=!1,this.isOpenStartRating=!1,this.isConversationArchived=!1,this.isInitialized=!1,this.isSentMessage=!1,this.styleMapConversation=new Map,this.logger=fe.getInstance()}ngOnInit(){this.logger.info("[APP-CONF]---------------- ngOnInit: APP.COMPONENT ---------------- "),this.initWidgetParamiters()}ngAfterViewInit(){this.logger.info("[APP-CONF]---------------- ngAfterViewInit: APP.COMPONENT ---------------- "),this.ngZone.run(()=>{const t=this,n=this.conversationsHandlerService.conversationChanged.subscribe(E=>{if(E)if(this.onImageLoaded(E),this.onConversationLoaded(E),E.recipient===this.g.senderId&&xo(E))t.disposeWidget();else{if(E.is_new&&E.sender!==this.g.senderId&&!Un(E)&&t.manageTabNotification(),!0===t.g.isOpen){if(t.g.setParameter("displayEyeCatcherCard","none"),this.logger.debug("[APP-COMP] obsChangeConversation ::: ",E),E.attributes&&"info"===E.attributes.subtype)return}else{t.lastConversation=E,t.g.isOpenNewMessage=!0,t.logger.debug("[APP-COMP] lastconversationnn",t.lastConversation);let V=t.conversationsHandlerService.countIsNew();t.g.setParameter("conversationsBadge",V)}t.triggerOnConversationUpdated(E)}else this.logger.debug("[APP-COMP] oBSconversationChanged null: errorrr")});this.subscriptions.push(n);const o=this.conversationsHandlerService.conversationAdded.subscribe(E=>{if(!0===t.g.isOpen&&E){if(t.g.setParameter("displayEyeCatcherCard","none"),t.triggerOnConversationUpdated(E),t.logger.debug("[APP-COMP] obsAddedConversation ::: ",E),E.attributes&&"info"===E.attributes.subtype)return;E.is_new&&t.manageTabNotification(),!1===this.g.isOpen&&(t.lastConversation=E,t.g.isOpenNewMessage=!0)}else{let V=t.conversationsHandlerService.countIsNew();t.g.setParameter("conversationsBadge",V)}E&&(this.onImageLoaded(E),this.onConversationLoaded(E))});this.subscriptions.push(o);const i=this.archivedConversationsService.archivedConversationAdded.subscribe(E=>{E&&(t.triggerOnConversationUpdated(E),this.onImageLoaded(E),this.onConversationLoaded(E))});this.subscriptions.push(i);const l=this.archivedConversationsService.archivedConversationRemoved.subscribe(E=>{E&&(this.isConversationArchived=!1,t.triggerOnConversationUpdated(E))});this.subscriptions.push(l)}),this.appStorageService.initialize(Ie.storage_prefix,this.g.persistence,this.g.projectid),this.tiledeskAuthService.initialize(this.appConfigService.getConfig().apiUrl),this.tiledeskRequestsService.initialize(this.appConfigService.getConfig().apiUrl,this.g.projectid),this.messagingAuthService.initialize(),this.chatManager.initialize(),this.uploadService.initialize()}initWidgetParamiters(){const t=this,n=this.globalSettingsService.obsSettingsService.subscribe(o=>{o&&(this.logger.setLoggerConfig(this.g.isLogEnabled,this.g.logLevel),this.tabTitle=this.g.windowContext.window.document.title,this.appStorageService.initialize(Ie.storage_prefix,this.g.persistence,this.g.projectid),this.logger.debug("[APP-COMP] check if token is passed throw url: ",this.g.jwt),this.g.jwt&&(this.logger.debug("[APP-COMP]  ----------------  logging in with custom token from url ---------------- "),this.appStorageService.getItem("tiledeskToken")===this.g.jwt||this.appStorageService.setItem("tiledeskToken",this.g.jwt),this.g.tiledeskToken=this.g.jwt),this.translatorService.initI18n().then(i=>{this.logger.debug("[APP-COMP] \xbb\xbb\xbb\xbb APP-COMPONENT.TS initI18n result",i);const l=this.translatorService.getLanguage();xt.locale(l),this.translatorService.translate(this.g)}).then(()=>{t.initAll(),t.triggerOnBeforeInit(),t.setAuthSubscription()}))});this.subscriptions.push(n),this.globalSettingsService.initWidgetParamiters(this.g,this.el),this.audio=new Audio,this.audio.src=this.g.baseLocation+"/assets/sounds/pling.mp3",this.audio.load()}initAll(){this.addComponentToWindow(this.ngZone),this.triggerHandler.setElement(this.el),this.triggerHandler.setWindowContext(this.g.windowContext);const t=this.setAttributesFromStorageService();t&&(this.g.attributes=t),this.setStyleMap(),this.settingsSaverService.initialize(),this.g.initialize(),this.removeFirebasewebsocketFromLocalStorage(),this.initLauncherButton(),this.triggerLoadParamsEvent()}setAuthSubscription(){this.logger.debug("[APP-COMP] setLoginSubscription : ");const t=this,n=this.messagingAuthService.BSAuthStateChanged.subscribe(i=>{const l=this.appStorageService.getItem("tiledeskToken");l&&void 0!==l&&(t.g.tiledeskToken=l);const E=this.messagingAuthService.getToken();E&&void 0!==E&&(t.g.firebaseToken=E);const V=this.g.autoStart;if(t.stateLoggedUser=i,i&&"online"===i){const Q=t.tiledeskAuthService.getCurrentUser();t.logger.info("[APP-COMP] ONLINE - LOGGED SUCCESSFULLY",Q),t.g.setParameter("senderId",Q.uid),t.g.setParameter("isLogged",!0),t.g.setParameter("attributes",t.setAttributesFromStorageService()),this.initConversationsHandler(this.g.tenant,t.g.senderId),t.g.singleConversation||t.startUI(),t.triggerOnAuthStateChanged(t.stateLoggedUser),t.logger.debug("[APP-COMP]  1 - IMPOSTO STATO CONNESSO UTENTE ",V),t.typingService.initialize(this.g.tenant),t.presenceService.initialize(this.g.tenant),t.presenceService.setPresence(Q.uid),V&&!t.g.singleConversation&&t.showWidget()}else i&&"offline"===i&&(t.logger.info("[APP-COMP] OFFLINE - NO CURRENT USER AUTENTICATE: "),t.g.setParameter("isLogged",!1),t.hideWidget(),t.triggerOnAuthStateChanged(t.stateLoggedUser),V&&t.authenticate())});this.subscriptions.push(n);const o=this.messagingAuthService.BSSignOut.subscribe(i=>{!0===i&&(t.logger.debug("[APP-COMP] sono nel caso logout -1"),t.g.tiledeskToken=null,t.g.setParameter("isLogged",!1),t.g.setParameter("isOpenPrechatForm",!1),t.g.setParameter("userFullname",null),t.g.setParameter("userEmail",null),t.g.setAttributeParameter("userFullname",null),t.g.setAttributeParameter("userEmail",null),this.g.setAttributeParameter("preChatForm",null),this.g.setParameter("conversationsBadge",0),this.g.setParameter("recipientId",null,!1),t.hideWidget(),t.g.isLogout=!0,t.triggerOnAuthStateChanged("offline"))});this.subscriptions.push(o)}authenticate(){const t=this.g.tiledeskToken,n=this.appStorageService.getItem("currentUser");this.logger.debug("[APP-COMP] tiledesktokennn",t,n),t?(this.logger.debug("[APP-COMP]  ---------------- 13 ---------------- "),this.logger.debug("[APP-COMP]  ----------- sono gi\xe0 loggato ------- "),this.signInWithCustomToken(t)):(this.logger.debug("[APP-COMP]  ---------------- 14 ---------------- "),this.logger.debug("[APP-COMP]  authenticateFirebaseAnonymously"),this.tiledeskAuthService.signInAnonymously(this.g.projectid).then(o=>{this.messagingAuthService.createCustomToken(o);const i=this.tiledeskAuthService.getCurrentUser();if((i.firstname||i.lastname)&&!this.g.userFullname){const l=i.firstname+" "+i.lastname;this.g.setParameter("userFullname",l),this.g.setAttributeParameter("userFullname",l)}i.email&&!this.g.userEmail&&(this.g.setParameter("userEmail",i.email),this.g.setAttributeParameter("userEmail",i.email))}))}signInWithCustomToken(t){const n=this;return this.appStorageService.getItem("tiledeskToken")===t||this.appStorageService.removeItem("recipientId"),this.tiledeskAuthService.signInWithCustomToken(t).then(i=>{if(this.messagingAuthService.createCustomToken(t),this.logger.debug("[APP-COMP] signInWithCustomToken user::",i,this.g.userFullname),(i.firstname||i.lastname)&&!this.g.userFullname){const l=i.firstname+" "+i.lastname;this.g.setParameter("userFullname",l),this.g.setAttributeParameter("userFullname",l)}return i.email&&!this.g.userEmail&&(this.g.setParameter("userEmail",i.email),this.g.setAttributeParameter("userEmail",i.email)),Promise.resolve(i)}).catch(i=>(this.logger.debug("[APP-COMP] signInWithCustomToken ERR ",i),n.signOut(),Promise.reject(i)))}signInAnonymous(){return this.logger.debug("[APP-COMP] signInAnonymous"),this.tiledeskAuthService.signInAnonymously(this.g.projectid).then(t=>{this.messagingAuthService.createCustomToken(t);const n=this.tiledeskAuthService.getCurrentUser();if(n.firstname||n.lastname){const o=n.firstname+" "+n.lastname;this.g.setParameter("userFullname",o),this.g.setAttributeParameter("userFullname",o)}return n.email&&(this.g.setParameter("userEmail",n.email),this.g.setAttributeParameter("userEmail",n.email)),Promise.resolve(n)}).catch(t=>(this.logger.error("[APP-COMP] signInAnonymous ERR",t),Promise.reject(t)))}startUI(){this.logger.debug("[APP-COMP]  ============ startUI ===============");const t=this.g.departments,n=this.g.attributes,o=this.g.preChatForm;this.isOpenHome=!0,this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenSelectionDepartment=!1,this.isOpenAllConversation=!1;const i=this.appStorageService.getItem("recipientId");this.logger.debug("[APP-COMP]  ============ idConversation ===============",i,this.g.recipientId),this.logger.debug("[APP-COMP] singleConversation conv da ...",this.g.recipientId),this.g.restartConversation&&this.g.singleConversation?(this.logger.debug("[APP-COMP] RESTART-CONVERSARION::: start a new conversations...",this.g.restartConversation),this.onNewConversation()):this.g.recipientId&&this.g.singleConversation?(this.logger.debug("[APP-COMP] singleConversation conv da API",this.g.recipientId),this.isOpenHome=!1,this.isOpenConversation=!0,this.isOpenSelectionDepartment=!1):!this.g.recipientId&&this.g.singleConversation?(this.logger.debug("[APP-COMP] singleConversation start new conv ",this.g.recipientId),this.isOpenHome=!1,this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,this.onNewConversation()):this.g.recipientId?(this.logger.debug("[APP-COMP]  conv da urll",this.g.recipientId),this.g.isOpen&&(this.isOpenConversation=!0),this.g.setParameter("recipientId",this.g.recipientId),this.appStorageService.setItem("recipientId",this.g.recipientId)):i?(this.logger.debug("[APP-COMP]  conv da storagee",i),this.g.isOpen&&(this.isOpenConversation=!0),this.g.recipientId=i,this.g.setParameter("recipientId",i)):this.g.startFromHome?(this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenSelectionDepartment=!1):!o||n&&n.userFullname&&n.userEmail?(this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,t.length>1&&null==!this.g.departmentID?this.isOpenSelectionDepartment=!0:(this.isOpenConversation=!1,!this.g.recipientId&&this.g.isOpen&&this.onNewConversation())):(this.g.setParameter("isOpenPrechatForm",!0),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,t.length>1&&null==this.g.departmentID&&(this.isOpenSelectionDepartment=!0)),this.triggerOnViewInit(),this.g.setParentBodyStyleMobile(this.g.isOpen,this.g.isMobile),this.g.setElementStyle(this.g.isOpen)}generateNewUidConversation(){return this.logger.debug("[APP-COMP] generateUidConversation **************: senderId= ",this.g.senderId),po+this.g.projectid+"-"+(0,Nn.Z)().replace(/-/g,"")}startNewConversation(){this.logger.debug("[APP-COMP] AppComponent::startNewConversation");const t=this.generateNewUidConversation();this.g.setParameter("recipientId",t),this.appStorageService.setItem("recipientId",t),this.logger.debug("[APP-COMP]  recipientId: ",this.g.recipientId),this.isConversationArchived=!1,this.triggerNewConversationEvent(t)}setAttributesFromStorageService(){let t={};try{t=JSON.parse(this.appStorageService.getItem("attributes"))}catch(Q){this.logger.debug("[APP-COMP] > Error  setAttributesFromStorageService:"+Q)}const n=navigator.userAgent,o=this.g.projectid,i=this.g.userEmail,l=this.g.userFullname,E=this.g.senderId,V=this.g.BUILD_VERSION;!t&&null===t&&(t=this.g.attributes?this.g.attributes:{}),n&&(t.client=n),location.href&&(t.sourcePage=location.href),document.title&&(t.sourceTitle=document.title),o&&(t.projectId=o),i&&(t.userEmail=i),l&&(t.userFullname=l),E&&(t.requester_id=E),V&&(t.widgetVer=V);try{t.payload=[],this.g.customAttributes&&(t.payload=this.g.customAttributes)}catch(Q){this.logger.debug("[APP-COMP] > Error is handled payload: ",Q)}try{const Q=t.preChatForm;Q&&Q.userEmail&&(this.g.userEmail=Q.userEmail),Q&&Q.userFullname&&(this.g.userFullname=Q.userFullname)}catch(Q){this.logger.debug("[APP-COMP] > Error is handled preChatForm: ",Q)}return this.appStorageService.setItem("attributes",JSON.stringify(t)),t}initConversationsHandler(t,n){this.logger.debug("[APP-COMP] initialize: ListConversationsComponent");const i=this.translateService.translateLanguage(["YOU"]);this.listConversations=[],this.archivedConversations=[],this.logger.debug("[APP-COMP] senderId: ",n),this.logger.debug("[APP-COMP] tenant: ",t),this.conversationsHandlerService.initialize(t,n,i),this.archivedConversationsService.initialize(t,n,i),this.g.singleConversation&&this.g.isOpen?this.manageWidgetSingleConversation():this.g.singleConversation&&!this.g.isOpen&&this.showWidget(),this.conversationsHandlerService.subscribeToConversations(()=>{}),this.archivedConversationsService.subscribeToConversations(()=>{}),this.listConversations=this.conversationsHandlerService.conversations,this.archivedConversations=this.archivedConversationsService.archivedConversations,this.chatManager.setConversationsHandler(this.conversationsHandlerService),this.chatManager.setArchivedConversationsHandler(this.archivedConversationsService),this.logger.debug("[APP-COMP] this.listConversations.length",this.listConversations.length),this.logger.debug("[APP-COMP] this.listConversations appcomponent",this.listConversations,this.archivedConversations)}initConversationHandler(t){const n=this.g.tenant,i=this.translateService.translateLanguage(["INFO_SUPPORT_USER_ADDED_SUBJECT","INFO_SUPPORT_USER_ADDED_YOU_VERB","INFO_SUPPORT_USER_ADDED_COMPLEMENT","INFO_SUPPORT_USER_ADDED_VERB","INFO_SUPPORT_CHAT_REOPENED","INFO_SUPPORT_CHAT_CLOSED","INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU","INFO_SUPPORT_LEAD_UPDATED","INFO_SUPPORT_MEMBER_LEFT_GROUP","LABEL_TODAY","LABEL_TOMORROW","LABEL_LOADING","LABEL_TO","ARRAY_DAYS"]),l={uid:this.g.senderId},E=this.g.recipientFullname;let V=this.chatManager.getConversationHandlerByConversationId(t);if(this.logger.debug("[APP-COMP] DETTAGLIO CONV - handler **************",V,t),!V){const Q=this.conversationHandlerBuilderService.build();Q.initialize(t,E,l,n,i),this.logger.debug("[APP-COMP] DETTAGLIO CONV - NEW handler **************",Q),this.chatManager.addConversationHandler(Q),V=Q}return V}initLauncherButton(){this.isInitialized=!0,this.marginBottom=+this.g.marginY+70}manageWidgetSingleConversation(){if(this.g.recipientId)return this.appStorageService.setItem("recipientId",this.g.recipientId),void new Promise((t,n)=>{this.startUI(),t("ok")}).then(t=>{this.showWidget()});this.conversationsHandlerService.getLastConversation((t,n)=>{if(this.logger.debug("[APP-COMP] getConverationRESTApi: conversation from rest API --\x3e ",t),n&&this.logger.error("[APP-COMP] getConverationRESTApi: ERORR while retriving data",n),t){const o=t.uid;this.g.setParameter("recipientId",o),this.appStorageService.setItem("recipientId",o)}else this.logger.debug("[APP-COMP] getConverationRESTApi: NO active conversations");new Promise((o,i)=>{this.startUI(),o("ok")}).then(o=>{this.showWidget()})})}signOut(){if(this.logger.debug("[APP-COMP] SIGNOUT"),!0===this.g.isLogged)return this.logger.debug("[APP-COMP] prima ero loggato allora mi sloggo!"),this.g.setIsOpen(!1),this.appStorageService.clear(),this.presenceService.removePresence(),this.tiledeskAuthService.logOut(),this.messagingAuthService.logout()}showWidget(){this.logger.debug("[APP-COMP] show widget--\x3e autoStart:",this.g.autoStart,"startHidden",this.g.startHidden,"isShown",this.g.isShown);const t=this.g.startHidden,n=this.g.windowContext.document.getElementById("tiledesk-container");n&&!1===t?(n.style.display="block",this.g.setParameter("isShown",!0,!0)):(this.g.startHidden=!1,this.g.setParameter("isShown",!1,!0))}hideWidget(){const t=this.g.windowContext.document.getElementById("tiledesk-container");t&&(t.style.display="none"),this.g.setParameter("isShown",!1,!0)}disposeWidget(){const t=this.g.windowContext.document.getElementById("tiledesk-container");t&&t.remove()}sendMessage(t){const o=t.senderId,i=t.senderFullname,l=t.message,E=t.type,V=t.metadata,Q=t.recipientId,se=t.recipientFullname,ge=t.attributes,ce=t.channelType;this.logger.debug("[APP-COMP] sendMessage from window.tiledesk *********** ",t.tenant,o,i,l,E,V,Q,se,ge,t.projectid,ce),this.initConversationHandler(Q).sendMessage(l,E,V,Q,se,o,i,ce,ge)}setPreChatForm(t){null!=t&&(this.g.setParameter("preChatForm",t),!0===t?this.appStorageService.setItem("preChatForm",t):this.appStorageService.removeItem("preChatForm"))}setPreChatFormJson(t){t&&this.g.setParameter("preChatFormJson",t),this.logger.debug("[APP-COMP] setPreChatFormJson from external",t)}getPreChatFormJson(){let t={};return this.g.preChatFormJson&&(t=this.g.preChatFormJson),this.logger.debug("[APP-COMP] getPreChatFormJson from external",t),t}setPrivacyPolicy(){this.g.privacyApproved=!0,this.g.setAttributeParameter("privacyApproved",this.g.privacyApproved),this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes)),this.g.setParameter("preChatForm",!1),this.appStorageService.removeItem("preChatForm")}reInit(){this.tiledeskAuthService.getCurrentUser()?(this.tiledeskAuthService.logOut(),this.messagingAuthService.logout(),this.logger.debug("[APP-COMP] sono nel caso reinit -2"),this.g.setParameter("isLogged",!1),this.hideWidget(),this.appStorageService.removeItem("tiledeskToken"),this.g.isLogout=!0,!1!==this.g.autoStart&&(this.authenticate(),this.initAll()),this.appStorageService.clear()):this.logger.debug("[APP-COMP] reInit ma NON SONO LOGGATO!");const t=this.g.windowContext.document.getElementsByTagName("chat-root")[0];this.g.windowContext.document.getElementById("tiledesk-container").remove(),t.remove(),this.g.windowContext.initWidget()}restart(){this.hideWidget(),!1!==this.g.autoStart&&(this.authenticate(),this.initAll());const t=this.g.windowContext.document.getElementsByTagName("chat-root")[0];this.g.windowContext.document.getElementById("tiledesk-container").remove(),t.remove(),this.g.windowContext.initWidget()}logout(){return this.signOut()}showCallout(){!1===this.g.isOpen&&(this.eyeeyeCatcherCardComponent.openEyeCatcher(),this.g.setParameter("displayEyeCatcherCard","block"),this.triggerOnOpenEyeCatcherEvent())}f21_open(){const t=this.g.senderId;this.logger.debug("[APP-COMP] f21_open senderId: ",t),t&&(this.g.setParameter("displayEyeCatcherCard","none"),this.g.setIsOpen(!0),this.isInitialized=!0,this.appStorageService.setItem("isOpen","true"),this.triggerOnOpenEvent())}f21_close(){this.g.setIsOpen(!1),this.g.isOpenNewMessage=!1,this.appStorageService.setItem("isOpen","false"),this.triggerOnCloseEvent()}_f21_open(){this.g.setParameter("displayEyeCatcherCard","none"),this.g.setIsOpen(!0),this.appStorageService.setItem("isOpen","true"),this.triggerOnOpenEvent()}setParameter(t){this.g.setParameter(t.key,t.value)}setAttributeParameter(t){this.g.setAttributeParameter(t.key,t.value)}removeFirebasewebsocketFromLocalStorage(){this.logger.debug("[APP-COMP]  ---------------- A1 ---------------- "),dt()&&this.appStorageService.removeItem("firebase:previous_websocket_failure")}addComponentToWindow(t){const o=this.g.windowContext;o&&o.tiledesk&&(o.tiledesk.angularcomponent={component:this,ngZone:t},o.tiledesk.signInWithCustomToken=function(i){return t.run(()=>o.tiledesk.angularcomponent.component.signInWithCustomToken(i))},o.tiledesk.signInAnonymous=function(){return t.run(()=>o.tiledesk.angularcomponent.component.signInAnonymous())},o.tiledesk.show=function(){t.run(()=>{o.tiledesk.angularcomponent.component.showWidget()})},o.tiledesk.hide=function(){t.run(()=>{o.tiledesk.angularcomponent.component.hideWidget()})},o.tiledesk.dispose=function(){t.run(()=>{o.tiledesk.angularcomponent.component.disposeWidget()})},o.tiledesk.close=function(){t.run(()=>{o.tiledesk.angularcomponent.component.onCloseWidget()})},o.tiledesk.open=function(){t.run(()=>{o.tiledesk.angularcomponent.component.onOpenCloseWidget()})},o.tiledesk.setPreChatForm=function(i){t.run(()=>{o.tiledesk.angularcomponent.component.setPreChatForm(i)})},o.tiledesk.setPrivacyPolicy=function(){t.run(()=>{o.tiledesk.angularcomponent.component.setPrivacyPolicy()})},o.tiledesk.sendMessage=function(i){const l=o.tiledesk.angularcomponent.component.g;let E=i.tenant?i.tenant:null,V=i.senderId?i.senderId:null,Q=i.senderFullname?i.senderFullname:null,se=i.message?i.message:null,ge=i.type?i.type:null,me=i.metadata?i.metadata:null,ce=i.recipientId?i.recipientId:null,ve=i.recipientFullname?i.recipientFullname:null,we=i.attributes?i.attributes:null,Me=i.projectid?i.projectid:null,Ne=i.channelType?i.channelType:null;E||(E=l.tenant),V||(V=l.senderId),Q||(Q=l.senderFullname),se||(se="hello"),ge||(ge="text"),me||(me=""),ce||(ce=l.recipientId),ve||(ve=l.recipientFullname),Me||(Me=l.projectId),(!Ne||void 0===Ne)&&(Ne="group");const ht=l.attributes,ot={};if(ht)for(const[it,rt]of Object.entries(ht))ot[it]=rt;if(we)for(const[it,rt]of Object.entries(we))ot[it]=rt;t.run(()=>{o.tiledesk.angularcomponent.component.sendMessage({tenant:E,senderId:V,senderFullname:Q,message:se,type:ge,metadata:me,recipientId:ce,recipientFullname:ve,attributes:ot,projectid:Me,channel_type:Ne})})},o.tiledesk.sendSupportMessage=function(i){const l=o.tiledesk.angularcomponent.component.g;let E=i.message?i.message:null,V=i.recipientId?i.recipientId:null,Q=i.recipientFullname?i.recipientFullname:null,se=i.type?i.type:null,ge=i.metadata?i.metadata:null,me=i.attributes?i.attributes:null;E||(E="hello"),V||(V=l.recipientId),se||(se="text"),ge||(ge={});const ce=l.attributes,ve={};if(ce)for(const[we,Me]of Object.entries(ce))ve[we]=Me;if(me)for(const[we,Me]of Object.entries(me))ve[we]=Me;t.run(()=>{o.tiledesk.angularcomponent.component.sendMessage({tenant:l.tenant,senderId:l.senderId,senderFullname:l.userFullname,message:E,type:se,metadata:ge,recipientId:V,recipientFullname:Q,attributes:ve,projectid:l.projectid,channelType:l.channelType})})},o.tiledesk.startConversation=function(){t.run(()=>{o.tiledesk.angularcomponent.component.onNewConversation()})},o.tiledesk.reInit=function(){t.run(()=>{o.tiledesk.angularcomponent.component.reInit()})},o.tiledesk.restart=function(){t.run(()=>{o.tiledesk.angularcomponent.component.restart()})},o.tiledesk.logout=function(){return t.run(()=>o.tiledesk.angularcomponent.component.logout())},o.tiledesk.showCallout=function(){t.run(()=>{o.tiledesk.angularcomponent.component.showCallout()})},o.tiledesk.setPreChatFormJson=function(i){t.run(()=>{o.tiledesk.angularcomponent.component.setPreChatFormJson(i)})},o.tiledesk.getPreChatFormJson=function(){let i={};return t.run(()=>{i=o.tiledesk.angularcomponent.component.getPreChatFormJson()}),i},o.tiledesk.setParameter=function(i){t.run(()=>{o.tiledesk.angularcomponent.component.setParameter(i)})},o.tiledesk.setAttributeParameter=function(i){t.run(()=>{o.tiledesk.angularcomponent.component.setAttributeParameter(i)})})}visibilitychange(){document.hidden?this.isTabVisible=!1:(clearInterval(this.setIntervalTime),this.setIntervalTime=null,this.isTabVisible=!0,this.g.windowContext.window.document.title=this.tabTitle)}manageTabNotification(){if(!this.isTabVisible){let t=this.conversationsHandlerService.countIsNew();this.logger.debug("[APP-COMP] badgeNewConverstionNumber::",t),t>0||(t=1),this.g.windowContext.window.document.title="("+t+") "+this.tabTitle,clearInterval(this.setIntervalTime);const n=this;this.setIntervalTime=window.setInterval(function(){n.g.windowContext.window.document.title="("===n.g.windowContext.window.document.title.charAt(0)?n.tabTitle:"("+t+") "+n.tabTitle},1e3)}this.soundMessage()}soundMessage(){const t=this;this.g.soundEnabled&&(this.logger.debug("[APP-COMP] ****** soundMessage *****",this.audio),this.audio.pause(),this.audio.currentTime=0,clearTimeout(this.setTimeoutSound),this.setTimeoutSound=setTimeout(()=>{t.audio.play().then(()=>{this.logger.debug("[APP-COMP] ****** soundMessage played *****")}).catch(o=>{this.logger.debug("[APP-COMP] ***soundMessage error*",o)})},1e3))}onCloseWidget(){this.isOpenConversation=!1;let t=this.conversationsHandlerService.countIsNew();this.g.setParameter("conversationsBadge",t),this.logger.debug("[APP-COMP] widgetclosed:::",this.g.conversationsBadge,this.conversationsHandlerService.countIsNew()),this.f21_close()}onOpenCloseWidget(t){this.g.setParameter("displayEyeCatcherCard","none");const n=this.appStorageService.getItem("recipientId");this.g.setParameter("recipientId",n),this.logger.debug("[APP-COMP] openCloseWidget",n,this.g.isOpen,this.g.startFromHome),!1===this.g.isOpen?(n?(this.isOpenHome=!1,this.isOpenConversation=!0,this.startUI()):this.g.singleConversation?(this.isOpenHome=!1,this.g.setParameter("isOpenPrechatForm",!1),this.manageWidgetSingleConversation()):this.g.startFromHome?(this.isOpenHome=!0,this.isOpenConversation=!1):(this.isOpenHome=!1,this.isOpenConversation=!0,this.onNewConversation()),this.triggerOnOpenEvent()):this.triggerOnCloseEvent(),this.g.setIsOpen(!this.g.isOpen),this.appStorageService.setItem("isOpen",this.g.isOpen)}onDepartmentSelected(t){t&&(this.logger.debug("[APP-COMP] onSelectDepartment: ",t),this.g.setParameter("departmentSelected",t),!1===this.g.isOpenPrechatForm&&(this.isOpenSelectionDepartment=!1,this.isOpenConversation=!0,setTimeout(()=>{this.isOpenHome=!1},0),this.startNewConversation()))}onCloseModalDepartment(){this.g.singleConversation?this.onCloseWidget():(this.logger.debug("[APP-COMP] returnCloseModalDepartment"),this.isOpenHome=!0,this.isOpenSelectionDepartment=!1,this.isOpenConversation=!1)}onPrechatFormComplete(){this.logger.debug("[APP-COMP] onPrechatFormComplete"),this.isOpenHome=!0,this.g.setParameter("isOpenPrechatForm",!1),!1===this.g.isOpenPrechatForm&&!1===this.isOpenSelectionDepartment&&(this.isOpenConversation=!0,this.startNewConversation())}onCloseModalPrechatForm(){this.logger.debug("[APP-COMP] onCloseModalPrechatForm"),this.g.singleConversation?this.onCloseWidget():(this.isOpenHome=!0,this.isOpenSelectionDepartment=!1,this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!1),this.g.newConversationStart=!1)}onSoundChange(t){this.g.setParameter("soundEnabled",t)}onMenuOptionSignOut(){this.logger.debug("[APP-COMP] onMenuOptionSignOut"),this.signOut(),this.isOpenConversation=!1}onSelectedConversation(t){t&&(!1===this.g.isOpen&&this._f21_open(),t.channel_type===ee?(this.g.setParameter("recipientId",t.sender),this.appStorageService.setItem("recipientId",t.sender)):(this.g.setParameter("recipientId",t.recipient),this.appStorageService.setItem("recipientId",t.recipient)),this.isOpenConversation=!0,this.isConversationArchived=!!t.archived&&t.archived,this.logger.debug("[APP-COMP] onSelectConversation in APP COMPONENT: ",t))}onNewConversation(){this.logger.debug("[APP-COMP] returnNewConversation in APP COMPONENT"),this.g.newConversationStart=!0;const t=this.g.preChatForm,n=this.g.attributes,o=this.g.departments;this.logger.debug("[APP-COMP] attributesssss",this.g.attributes,this.g.preChatForm),!t||n&&n.userFullname&&n.userEmail?(this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,o&&o.length>1&&null==this.g.departmentID?this.isOpenSelectionDepartment=!0:this.isOpenConversation=!0):(this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!0),this.isOpenSelectionDepartment=!1,o&&o.length>1&&null==this.g.departmentID&&(this.isOpenSelectionDepartment=!0)),this.logger.debug("[APP-COMP] isOpenPrechatForm",this.g.isOpenPrechatForm," isOpenSelectionDepartment:",this.isOpenSelectionDepartment),!1===this.g.isOpenPrechatForm&&!1===this.isOpenSelectionDepartment&&this.startNewConversation()}onOpenAllConversation(){this.isOpenHome=!0,this.isOpenConversation=!1,this.isOpenAllConversation=!0}onOpenChatEyeEyeCatcherCard(){this.f21_open()}onCloseEyeCatcherCard(t){!0===t?this.triggerOnOpenEyeCatcherEvent():this.triggerOnClosedEyeCatcherEvent()}onBackConversation(){this.logger.debug("[APP-COMP] onCloseConversation"),this.appStorageService.removeItem("recipientId"),this.g.setParameter("recipientId",null,!1),this.isOpenHome=!0,this.isOpenAllConversation=!1,this.isOpenConversation=!1}onConversationClosed(t){this.g.singleConversation||this.onBackConversation()}onNewConversationButtonClicked(t){this.logger.debug("[APP-COMP] onNewConversationButtonClicked"),this.isOpenConversation=!1,this.g.singleConversation&&(this.isOpenHome=!1),this.onNewConversation()}onCloseAllConversation(){this.logger.debug("[APP-COMP] Close all conversation");const t=this.isOpenHome,n=this.isOpenConversation;this.isOpenHome=!1,this.isOpenConversation=!1,setTimeout(()=>{this.isOpenHome=t,this.isOpenConversation=n,this.isOpenAllConversation=!1},200)}onAfterMessageSent(t){this.triggerHandler.triggerAfterSendMessageEvent(t),this.isSentMessage=!0}onImageLoaded(t){this.logger.debug("[APP-COMP] onLoadImage convvvv:::",t),t.image=this.imageRepoService.getImagePhotoUrl(t.sender)}onConversationLoaded(t){this.logger.debug("[APP-COMP] onConversationLoaded convvvv:::",t);const o=this.translateService.translateLanguage(["YOU","SENT_AN_IMAGE","SENT_AN_ATTACHMENT"]);if(t.sender===this.g.senderId){if(t.type===W){this.logger.log("[CONVS-LIST-PAGE] HAS SENT AN IMAGE");const i=t.last_message_text=o.get("SENT_AN_IMAGE");t.last_message_text=i}else if(t.type===M){this.logger.log("[CONVS-LIST-PAGE] HAS SENT FILE");const i=t.last_message_text=o.get("SENT_AN_ATTACHMENT");t.last_message_text=i}}else if(t.type===W){this.logger.log("[CONVS-LIST-PAGE] HAS SENT AN IMAGE");const i=t.last_message_text=o.get("SENT_AN_IMAGE");t.last_message_text=i}else if(t.type===M){this.logger.log("[CONVS-LIST-PAGE] HAS SENT FILE");const i=t.last_message_text=o.get("SENT_AN_ATTACHMENT");t.last_message_text=i}}onSignOut(){this.signOut()}onCloseModalRateChat(){!this.g.singleConversation&&this.g.nativeRating&&(this.isOpenHome=!0,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,this.g.setParameter("isOpenStartRating",!1),this.onBackConversation())}onRateChatComplete(){!this.g.singleConversation&&this.g.nativeRating&&(this.isOpenHome=!0,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,this.g.setParameter("isOpenStartRating",!1),this.onBackConversation())}triggerOnBeforeInit(){const t={global:this.g,default_settings:this.g.default_settings,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerOnBeforeInit(t)}triggerOnViewInit(){const t={global:this.g,default_settings:this.g.default_settings,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerOnViewInit(t)}triggerOnOpenEvent(){this.triggerHandler.triggerOnOpenEvent({default_settings:this.g.default_settings})}triggerOnCloseEvent(){this.triggerHandler.triggerOnCloseEvent({default_settings:this.g.default_settings})}triggerOnOpenEyeCatcherEvent(){this.triggerHandler.triggerOnOpenEyeCatcherEvent({default_settings:this.g.default_settings})}triggerOnClosedEyeCatcherEvent(){this.triggerHandler.triggerOnClosedEyeCatcherEvent()}triggerOnAuthStateChanged(t){const n={event:t,isLogged:this.g.isLogged,user_id:this.g.senderId,global:this.g,default_settings:this.g.default_settings,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerOnAuthStateChanged(n)}triggerNewConversationEvent(t){const n={global:this.g,default_settings:this.g.default_settings,newConvId:t,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerNewConversationEvent(n)}triggerLoadParamsEvent(){this.triggerHandler.triggerLoadParamsEvent({default_settings:this.g.default_settings})}triggerOnConversationUpdated(t){this.triggerHandler.triggerOnConversationUpdated(t)}triggerOnCloseMessagePreview(){this.triggerHandler.triggerOnCloseMessagePreview()}setStyleMap(){this.styleMapConversation.set("foregroundColor",this.g.themeForegroundColor),this.styleMapConversation.set("themeColor",this.g.themeColor),this.styleMapConversation.set("colorGradient",this.g.colorGradient180),this.styleMapConversation.set("bubbleSentBackground",this.g.bubbleSentBackground),this.styleMapConversation.set("bubbleSentTextColor",this.g.bubbleSentTextColor),this.styleMapConversation.set("bubbleReceivedBackground",this.g.bubbleReceivedBackground),this.styleMapConversation.set("bubbleReceivedTextColor",this.g.bubbleReceivedTextColor),this.styleMapConversation.set("fontSize",this.g.fontSize),this.styleMapConversation.set("fontFamily",this.g.fontFamily),this.styleMapConversation.set("buttonFontSize",this.g.buttonFontSize),this.styleMapConversation.set("buttonBackgroundColor",this.g.buttonBackgroundColor),this.styleMapConversation.set("buttonTextColor",this.g.buttonTextColor),this.styleMapConversation.set("buttonHoverBackgroundColor",this.g.buttonHoverBackgroundColor),this.styleMapConversation.set("buttonHoverTextColor",this.g.buttonHoverTextColor),this.styleMapConversation.set("iconColor","#5f6368"),this.el.nativeElement.style.setProperty("--button-in-msg-background-color",this.g.bubbleSentBackground),this.el.nativeElement.style.setProperty("--button-in-msg-font-size",this.g.buttonFontSize)}ngOnDestroy(){this.logger.debug("[APP-COMP] this.subscriptions",this.subscriptions);const t=this.g.windowContext;t&&t.tiledesk&&(t.tiledesk.angularcomponent=null,this.g.windowContext=t),this.unsubscribe()}unsubscribe(){this.subscriptions.forEach(function(t){t.unsubscribe()}),this.subscriptions=[],this.logger.debug("[APP-COMP] this.subscriptions",this.subscriptions)}}_t.\u0275fac=function(t){return new(t||_t)(e.Y36(e.SBq),e.Y36(e.R0b),e.Y36(Pe),e.Y36(Eo),e.Y36(gt),e.Y36(pt),e.Y36(ft),e.Y36(ke),e.Y36(Re),e.Y36(st),e.Y36(He),e.Y36(Xe),e.Y36(at),e.Y36(mt),e.Y36(et),e.Y36(Ye),e.Y36(Je),e.Y36(Qe),e.Y36(Ze),e.Y36(je),e.Y36(tt),e.Y36(Ve))},_t.\u0275cmp=e.Xpm({type:_t,selectors:[["chat-root"]],viewQuery:function(t,n){if(1&t&&e.Gf(Mt,5),2&t){let o;e.iGM(o=e.CRH())&&(n.eyeeyeCatcherCardComponent=o.first)}},hostBindings:function(t,n){1&t&&e.NdJ("visibilitychange",function(){return n.visibilitychange()},!1,e.evT)},decls:11,vars:23,consts:[["id","tiledesk-container","tabindex","9999"],["id","chat21-conversations",3,"ngClass","ngStyle"],["class","modal-page active",4,"ngIf"],["class","modal-page selection-department active",4,"ngIf"],["class","modal-page prechat-form active",4,"ngIf"],["class","modal-page star-rating-widget active",4,"ngIf"],[3,"onOpenChat","onCloseEyeCatcherCard",4,"ngIf"],[4,"ngIf"],[3,"onButtonClicked",4,"ngIf"],[1,"modal-page","active"],[3,"listConversations","archivedConversations","hideSettings","stylesMap","onNewConversation","onConversationSelected","onOpenAllConvesations","onCloseWidget","onSignOut","onImageLoaded","onConversationLoaded"],[3,"listConversations","archivedConversations","stylesMap","onCloseWidget","onConversationSelected"],[3,"senderId","conversationId","isOpen","isConversationArchived","stylesMap","onBackHome","onCloseWidget","onSoundChange","onConversationClosed","onSignOut","onNewConversationButtonClicked","onBeforeMessageSent","onAfterSendMessage","onNewMessageCreated","onNewConversationInit","onBeforeMessageRender","onAfterMessageRender"],[1,"modal-page","selection-department","active"],[3,"onBeforeDepartmentsFormRender","onClose","onDepartmentSelected"],[1,"modal-page","prechat-form","active"],[3,"stylesMap","onClosePage","onCloseForm"],[1,"modal-page","star-rating-widget","active"],[3,"recipientId","stylesMap","onClosePage","onCloseRate"],[3,"onOpenChat","onCloseEyeCatcherCard"],[3,"conversation","baseLocation","stylesMap","onCloseMessagePreview","onSelectedConversation"],[3,"onButtonClicked"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,bi,2,4,"div",2),e.YNc(3,Ci,2,3,"div",2),e.YNc(4,wi,2,5,"div",2),e.YNc(5,yi,2,0,"div",3),e.YNc(6,Oi,2,1,"div",4),e.YNc(7,xi,2,2,"div",5),e.qZA(),e.YNc(8,Mi,1,0,"chat-eyeeye-catcher-card",6),e.YNc(9,Ei,2,3,"div",7),e.YNc(10,Ti,1,0,"chat-launcher-button",8),e.qZA()),2&t&&(e.ekj("active",n.g.isShown),e.xp6(1),e.Q6J("ngClass",e.l5B(13,Si,!0===n.g.isOpen,!0===n.g.fullscreenMode,"left"===n.g.align,"left"!==n.g.align))("ngStyle",e.l5B(18,Pi,1==n.g.isOpen?"block":"none",n.g.marginY+"px","left"===n.g.align?n.g.marginX+"px":"","right"===n.g.align?n.g.marginX+"px":"")),e.xp6(1),e.Q6J("ngIf",n.isOpenHome&&n.g.senderId),e.xp6(1),e.Q6J("ngIf",n.isOpenAllConversation&&n.g.senderId),e.xp6(1),e.Q6J("ngIf",n.isOpenConversation&&n.g.senderId),e.xp6(1),e.Q6J("ngIf",n.isOpenSelectionDepartment),e.xp6(1),e.Q6J("ngIf",n.g.isOpenPrechatForm&&n.g.senderId),e.xp6(1),e.Q6J("ngIf",n.g.isOpenStartRating),e.xp6(1),e.Q6J("ngIf",n.g.senderId),e.xp6(1),e.Q6J("ngIf",!n.g.isOpen),e.xp6(1),e.Q6J("ngIf",n.isInitialized))},styles:['@import"https://fonts.googleapis.com/css?family=Google+Sans:200,400,800";@import"https://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons";@import"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,400;0,700;1,300;1,400";@keyframes modal-active-in{0%{left:100%;opacity:0}to{background-color:$trasp-black;opacity:1;left:0}}@keyframes modal-active-out{0%{opacity:1;left:0;display:block}99%{display:block}to{left:100%;opacity:0;display:none}}@keyframes slide-out-right{0%{transform:translate(0);opacity:1}99%{transform:translate(1000px);opacity:0}to{transform:translate(1000px);opacity:0}}@keyframes rotate-scale-up{0%{transform:scale(1) rotate(0)}50%{transform:scale(1.6) rotate(180deg)}to{transform:scale(1) rotate(360deg)}}@keyframes swirl-in-bck{0%{transform:rotate(540deg) scale(5);opacity:0}to{transform:rotate(0) scale(1);opacity:1}}@keyframes jello-horizontal{0%{transform:scaleZ(1)}30%{transform:scale3d(1.25,.75,1)}40%{transform:scale3d(.75,1.25,1)}50%{transform:scale3d(1.15,.85,1)}65%{transform:scale3d(.95,1.05,1)}75%{transform:scale3d(1.05,.95,1)}to{transform:scaleZ(1)}}@keyframes scale-in-center{0%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:1}}@keyframes rotate-center{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes swing-in-bottom-fwd{0%{transform:rotateX(100deg);transform-origin:bottom;opacity:0}to{transform:rotateX(0);transform-origin:bottom;opacity:1}}@keyframes fade{0%{transform:rotateX(0);transform-origin:bottom;opacity:0}50%{transform:rotateX(0);transform-origin:bottom;opacity:.5}to{transform:rotateX(0);transform-origin:bottom;opacity:1}}@keyframes heartbeat{0%{transform:scale(1);transform-origin:center center;animation-timing-function:ease-out}10%{transform:scale(.91);animation-timing-function:ease-in}17%{transform:scale(.98);animation-timing-function:ease-out}33%{transform:scale(.87);animation-timing-function:ease-in}45%{transform:scale(1);animation-timing-function:ease-out}}@keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fade-in-top{0%{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes fade-in-bottom{0%{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes fade-in-dw-up{0%{display:none;transform:translateY(50px);opacity:0}1%{display:block;transform:translateY(50px);opacity:0}to{display:block;transform:translateY(0);opacity:1}}@keyframes slide-in-right{0%{transform:translate(1000px);opacity:0}99%{transform:translate(0);opacity:1}to{transform:translate(0);opacity:1}}@keyframes slide-in-left{0%{transform:translate(-1000px);opacity:0}99%{transform:translate(0);opacity:1}to{transform:translate(0);opacity:1}}@keyframes slideIn{0%{transform:translate(-900px)}to{transform:translate(0)}}/*!\n * Hover.css (http://ianlunn.github.io/Hover/)\n * Version: 2.3.2\n * Author: Ian Lunn @IanLunn\n * Author URL: http://ianlunn.co.uk/\n * Github: https://github.com/IanLunn/Hover\n\n * Hover.css Copyright Ian Lunn 2017. Generated with Sass.\n */.hvr-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-grow:hover,.hvr-grow:focus,.hvr-grow:active{transform:scale(1.1)}.hvr-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-shrink:hover,.hvr-shrink:focus,.hvr-shrink:active{transform:scale(.9)}@keyframes hvr-pulse{25%{transform:scale(1.1)}75%{transform:scale(.9)}}.hvr-pulse{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pulse:hover,.hvr-pulse:focus,.hvr-pulse:active{animation-name:hvr-pulse;animation-duration:1s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-pulse-grow{to{transform:scale(1.1)}}.hvr-pulse-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pulse-grow:hover,.hvr-pulse-grow:focus,.hvr-pulse-grow:active{animation-name:hvr-pulse-grow;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-pulse-shrink{to{transform:scale(.9)}}.hvr-pulse-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pulse-shrink:hover,.hvr-pulse-shrink:focus,.hvr-pulse-shrink:active{animation-name:hvr-pulse-shrink;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-push{50%{transform:scale(.8)}to{transform:scale(1)}}.hvr-push{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-push:hover,.hvr-push:focus,.hvr-push:active{animation-name:hvr-push;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}@keyframes hvr-pop{50%{transform:scale(1.2)}}.hvr-pop{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pop:hover,.hvr-pop:focus,.hvr-pop:active{animation-name:hvr-pop;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}.hvr-bounce-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.5s}.hvr-bounce-in:hover,.hvr-bounce-in:focus,.hvr-bounce-in:active{transform:scale(1.2);transition-timing-function:cubic-bezier(.47,2.02,.31,-.36)}.hvr-bounce-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.5s}.hvr-bounce-out:hover,.hvr-bounce-out:focus,.hvr-bounce-out:active{transform:scale(.8);transition-timing-function:cubic-bezier(.47,2.02,.31,-.36)}.hvr-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-rotate:hover,.hvr-rotate:focus,.hvr-rotate:active{transform:rotate(4deg)}.hvr-grow-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-grow-rotate:hover,.hvr-grow-rotate:focus,.hvr-grow-rotate:active{transform:scale(1.1) rotate(4deg)}.hvr-float{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-float:hover,.hvr-float:focus,.hvr-float:active{transform:translateY(-8px)}.hvr-sink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-sink:hover,.hvr-sink:focus,.hvr-sink:active{transform:translateY(8px)}@keyframes hvr-bob{0%{transform:translateY(-8px)}50%{transform:translateY(-4px)}to{transform:translateY(-8px)}}@keyframes hvr-bob-float{to{transform:translateY(-8px)}}.hvr-bob{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-bob:hover,.hvr-bob:focus,.hvr-bob:active{animation-name:hvr-bob-float,hvr-bob;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}@keyframes hvr-hang{0%{transform:translateY(8px)}50%{transform:translateY(4px)}to{transform:translateY(8px)}}@keyframes hvr-hang-sink{to{transform:translateY(8px)}}.hvr-hang{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-hang:hover,.hvr-hang:focus,.hvr-hang:active{animation-name:hvr-hang-sink,hvr-hang;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}.hvr-skew{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-skew:hover,.hvr-skew:focus,.hvr-skew:active{transform:skew(-10deg)}.hvr-skew-forward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transform-origin:0 100%}.hvr-skew-forward:hover,.hvr-skew-forward:focus,.hvr-skew-forward:active{transform:skew(-10deg)}.hvr-skew-backward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transform-origin:0 100%}.hvr-skew-backward:hover,.hvr-skew-backward:focus,.hvr-skew-backward:active{transform:skew(10deg)}@keyframes hvr-wobble-vertical{16.65%{transform:translateY(8px)}33.3%{transform:translateY(-6px)}49.95%{transform:translateY(4px)}66.6%{transform:translateY(-2px)}83.25%{transform:translateY(1px)}to{transform:translateY(0)}}.hvr-wobble-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-vertical:hover,.hvr-wobble-vertical:focus,.hvr-wobble-vertical:active{animation-name:hvr-wobble-vertical;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-horizontal{16.65%{transform:translate(8px)}33.3%{transform:translate(-6px)}49.95%{transform:translate(4px)}66.6%{transform:translate(-2px)}83.25%{transform:translate(1px)}to{transform:translate(0)}}.hvr-wobble-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-horizontal:hover,.hvr-wobble-horizontal:focus,.hvr-wobble-horizontal:active{animation-name:hvr-wobble-horizontal;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-to-bottom-right{16.65%{transform:translate(8px,8px)}33.3%{transform:translate(-6px,-6px)}49.95%{transform:translate(4px,4px)}66.6%{transform:translate(-2px,-2px)}83.25%{transform:translate(1px,1px)}to{transform:translate(0)}}.hvr-wobble-to-bottom-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-to-bottom-right:hover,.hvr-wobble-to-bottom-right:focus,.hvr-wobble-to-bottom-right:active{animation-name:hvr-wobble-to-bottom-right;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-to-top-right{16.65%{transform:translate(8px,-8px)}33.3%{transform:translate(-6px,6px)}49.95%{transform:translate(4px,-4px)}66.6%{transform:translate(-2px,2px)}83.25%{transform:translate(1px,-1px)}to{transform:translate(0)}}.hvr-wobble-to-top-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-to-top-right:hover,.hvr-wobble-to-top-right:focus,.hvr-wobble-to-top-right:active{animation-name:hvr-wobble-to-top-right;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-top{16.65%{transform:skew(-12deg)}33.3%{transform:skew(10deg)}49.95%{transform:skew(-6deg)}66.6%{transform:skew(4deg)}83.25%{transform:skew(-2deg)}to{transform:skew(0)}}.hvr-wobble-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transform-origin:0 100%}.hvr-wobble-top:hover,.hvr-wobble-top:focus,.hvr-wobble-top:active{animation-name:hvr-wobble-top;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-bottom{16.65%{transform:skew(-12deg)}33.3%{transform:skew(10deg)}49.95%{transform:skew(-6deg)}66.6%{transform:skew(4deg)}83.25%{transform:skew(-2deg)}to{transform:skew(0)}}.hvr-wobble-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transform-origin:100% 0}.hvr-wobble-bottom:hover,.hvr-wobble-bottom:focus,.hvr-wobble-bottom:active{animation-name:hvr-wobble-bottom;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-skew{16.65%{transform:skew(-12deg)}33.3%{transform:skew(10deg)}49.95%{transform:skew(-6deg)}66.6%{transform:skew(4deg)}83.25%{transform:skew(-2deg)}to{transform:skew(0)}}.hvr-wobble-skew{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-skew:hover,.hvr-wobble-skew:focus,.hvr-wobble-skew:active{animation-name:hvr-wobble-skew;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-buzz{50%{transform:translate(3px) rotate(2deg)}to{transform:translate(-3px) rotate(-2deg)}}.hvr-buzz{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-buzz:hover,.hvr-buzz:focus,.hvr-buzz:active{animation-name:hvr-buzz;animation-duration:.15s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-buzz-out{10%{transform:translate(3px) rotate(2deg)}20%{transform:translate(-3px) rotate(-2deg)}30%{transform:translate(3px) rotate(2deg)}40%{transform:translate(-3px) rotate(-2deg)}50%{transform:translate(2px) rotate(1deg)}60%{transform:translate(-2px) rotate(-1deg)}70%{transform:translate(2px) rotate(1deg)}80%{transform:translate(-2px) rotate(-1deg)}90%{transform:translate(1px) rotate(0)}to{transform:translate(-1px) rotate(0)}}.hvr-buzz-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-buzz-out:hover,.hvr-buzz-out:focus,.hvr-buzz-out:active{animation-name:hvr-buzz-out;animation-duration:.75s;animation-timing-function:linear;animation-iteration-count:1}.hvr-forward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-forward:hover,.hvr-forward:focus,.hvr-forward:active{transform:translate(8px)}.hvr-backward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-backward:hover,.hvr-backward:focus,.hvr-backward:active{transform:translate(-8px)}.hvr-fade{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;overflow:hidden;transition-duration:.3s;transition-property:color,background-color}.hvr-fade:hover,.hvr-fade:focus,.hvr-fade:active{background-color:#2098d1;color:#fff}@keyframes hvr-back-pulse{50%{background-color:#2098d1bf}}.hvr-back-pulse{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;overflow:hidden;transition-duration:.5s;transition-property:color,background-color}.hvr-back-pulse:hover,.hvr-back-pulse:focus,.hvr-back-pulse:active{animation-name:hvr-back-pulse;animation-duration:1s;animation-delay:.5s;animation-timing-function:linear;animation-iteration-count:infinite;background-color:#2098d1;color:#fff}.hvr-sweep-to-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-right:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:0 50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-right:hover,.hvr-sweep-to-right:focus,.hvr-sweep-to-right:active{color:#fff}.hvr-sweep-to-right:hover:before,.hvr-sweep-to-right:focus:before,.hvr-sweep-to-right:active:before{transform:scaleX(1)}.hvr-sweep-to-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-left:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:100% 50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-left:hover,.hvr-sweep-to-left:focus,.hvr-sweep-to-left:active{color:#fff}.hvr-sweep-to-left:hover:before,.hvr-sweep-to-left:focus:before,.hvr-sweep-to-left:active:before{transform:scaleX(1)}.hvr-sweep-to-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-bottom:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 0;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-bottom:hover,.hvr-sweep-to-bottom:focus,.hvr-sweep-to-bottom:active{color:#fff}.hvr-sweep-to-bottom:hover:before,.hvr-sweep-to-bottom:focus:before,.hvr-sweep-to-bottom:active:before{transform:scaleY(1)}.hvr-sweep-to-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-top:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 100%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-top:hover,.hvr-sweep-to-top:focus,.hvr-sweep-to-top:active{color:#fff}.hvr-sweep-to-top:hover:before,.hvr-sweep-to-top:focus:before,.hvr-sweep-to-top:active:before{transform:scaleY(1)}.hvr-bounce-to-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-right:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:0 50%;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-right:hover,.hvr-bounce-to-right:focus,.hvr-bounce-to-right:active{color:#fff}.hvr-bounce-to-right:hover:before,.hvr-bounce-to-right:focus:before,.hvr-bounce-to-right:active:before{transform:scaleX(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-bounce-to-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-left:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:100% 50%;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-left:hover,.hvr-bounce-to-left:focus,.hvr-bounce-to-left:active{color:#fff}.hvr-bounce-to-left:hover:before,.hvr-bounce-to-left:focus:before,.hvr-bounce-to-left:active:before{transform:scaleX(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-bounce-to-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-bottom:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 0;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-bottom:hover,.hvr-bounce-to-bottom:focus,.hvr-bounce-to-bottom:active{color:#fff}.hvr-bounce-to-bottom:hover:before,.hvr-bounce-to-bottom:focus:before,.hvr-bounce-to-bottom:active:before{transform:scaleY(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-bounce-to-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-top:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 100%;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-top:hover,.hvr-bounce-to-top:focus,.hvr-bounce-to-top:active{color:#fff}.hvr-bounce-to-top:hover:before,.hvr-bounce-to-top:focus:before,.hvr-bounce-to-top:active:before{transform:scaleY(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-radial-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-radial-out:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;border-radius:100%;transform:scale(0);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-radial-out:hover,.hvr-radial-out:focus,.hvr-radial-out:active{color:#fff}.hvr-radial-out:hover:before,.hvr-radial-out:focus:before,.hvr-radial-out:active:before{transform:scale(2)}.hvr-radial-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-radial-in:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;border-radius:100%;transform:scale(2);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-radial-in:hover,.hvr-radial-in:focus,.hvr-radial-in:active{color:#fff}.hvr-radial-in:hover:before,.hvr-radial-in:focus:before,.hvr-radial-in:active:before{transform:scale(0)}.hvr-rectangle-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-rectangle-in:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;transform:scale(1);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-rectangle-in:hover,.hvr-rectangle-in:focus,.hvr-rectangle-in:active{color:#fff}.hvr-rectangle-in:hover:before,.hvr-rectangle-in:focus:before,.hvr-rectangle-in:active:before{transform:scale(0)}.hvr-rectangle-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-rectangle-out:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scale(0);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-rectangle-out:hover,.hvr-rectangle-out:focus,.hvr-rectangle-out:active{color:#fff}.hvr-rectangle-out:hover:before,.hvr-rectangle-out:focus:before,.hvr-rectangle-out:active:before{transform:scale(1)}.hvr-shutter-in-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-shutter-in-horizontal:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;transform:scaleX(1);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-in-horizontal:hover,.hvr-shutter-in-horizontal:focus,.hvr-shutter-in-horizontal:active{color:#fff}.hvr-shutter-in-horizontal:hover:before,.hvr-shutter-in-horizontal:focus:before,.hvr-shutter-in-horizontal:active:before{transform:scaleX(0)}.hvr-shutter-out-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-shutter-out-horizontal:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-out-horizontal:hover,.hvr-shutter-out-horizontal:focus,.hvr-shutter-out-horizontal:active{color:#fff}.hvr-shutter-out-horizontal:hover:before,.hvr-shutter-out-horizontal:focus:before,.hvr-shutter-out-horizontal:active:before{transform:scaleX(1)}.hvr-shutter-in-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-shutter-in-vertical:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;transform:scaleY(1);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-in-vertical:hover,.hvr-shutter-in-vertical:focus,.hvr-shutter-in-vertical:active{color:#fff}.hvr-shutter-in-vertical:hover:before,.hvr-shutter-in-vertical:focus:before,.hvr-shutter-in-vertical:active:before{transform:scaleY(0)}.hvr-shutter-out-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-shutter-out-vertical:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-out-vertical:hover,.hvr-shutter-out-vertical:focus,.hvr-shutter-out-vertical:active{color:#fff}.hvr-shutter-out-vertical:hover:before,.hvr-shutter-out-vertical:focus:before,.hvr-shutter-out-vertical:active:before{transform:scaleY(1)}.hvr-border-fade{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow;box-shadow:inset 0 0 0 4px #e1e1e1,0 0 1px #0000}.hvr-border-fade:hover,.hvr-border-fade:focus,.hvr-border-fade:active{box-shadow:inset 0 0 0 4px #2098d1,0 0 1px #0000}.hvr-hollow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:background;box-shadow:inset 0 0 0 4px #e1e1e1,0 0 1px #0000}.hvr-hollow:hover,.hvr-hollow:focus,.hvr-hollow:active{background:none}.hvr-trim{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-trim:before{content:"";position:absolute;border:white solid 4px;inset:4px;opacity:0;transition-duration:.3s;transition-property:opacity}.hvr-trim:hover:before,.hvr-trim:focus:before,.hvr-trim:active:before{opacity:1}@keyframes hvr-ripple-out{to{inset:-12px;opacity:0}}.hvr-ripple-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-ripple-out:before{content:"";position:absolute;border:#e1e1e1 solid 6px;inset:0;animation-duration:1s}.hvr-ripple-out:hover:before,.hvr-ripple-out:focus:before,.hvr-ripple-out:active:before{animation-name:hvr-ripple-out}@keyframes hvr-ripple-in{to{inset:0;opacity:1}}.hvr-ripple-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-ripple-in:before{content:"";position:absolute;border:#e1e1e1 solid 4px;inset:-12px;opacity:0;animation-duration:1s}.hvr-ripple-in:hover:before,.hvr-ripple-in:focus:before,.hvr-ripple-in:active:before{animation-name:hvr-ripple-in}.hvr-outline-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-outline-out:before{content:"";position:absolute;border:#e1e1e1 solid 4px;inset:0;transition-duration:.3s;transition-property:top,right,bottom,left}.hvr-outline-out:hover:before,.hvr-outline-out:focus:before,.hvr-outline-out:active:before{inset:-8px}.hvr-outline-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-outline-in:before{pointer-events:none;content:"";position:absolute;border:#e1e1e1 solid 4px;inset:-16px;opacity:0;transition-duration:.3s;transition-property:top,right,bottom,left}.hvr-outline-in:hover:before,.hvr-outline-in:focus:before,.hvr-outline-in:active:before{inset:-8px;opacity:1}.hvr-round-corners{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:border-radius}.hvr-round-corners:hover,.hvr-round-corners:focus,.hvr-round-corners:active{border-radius:1em}.hvr-underline-from-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-from-left:before{content:"";position:absolute;z-index:-1;left:0;right:100%;bottom:0;background:#2098D1;height:4px;transition-property:right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-from-left:hover:before,.hvr-underline-from-left:focus:before,.hvr-underline-from-left:active:before{right:0}.hvr-underline-from-center{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-from-center:before{content:"";position:absolute;z-index:-1;left:51%;right:51%;bottom:0;background:#2098D1;height:4px;transition-property:left,right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-from-center:hover:before,.hvr-underline-from-center:focus:before,.hvr-underline-from-center:active:before{left:0;right:0}.hvr-underline-from-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-from-right:before{content:"";position:absolute;z-index:-1;left:100%;right:0;bottom:0;background:#2098D1;height:4px;transition-property:left;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-from-right:hover:before,.hvr-underline-from-right:focus:before,.hvr-underline-from-right:active:before{left:0}.hvr-overline-from-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-from-left:before{content:"";position:absolute;z-index:-1;left:0;right:100%;top:0;background:#2098D1;height:4px;transition-property:right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-from-left:hover:before,.hvr-overline-from-left:focus:before,.hvr-overline-from-left:active:before{right:0}.hvr-overline-from-center{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-from-center:before{content:"";position:absolute;z-index:-1;left:51%;right:51%;top:0;background:#2098D1;height:4px;transition-property:left,right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-from-center:hover:before,.hvr-overline-from-center:focus:before,.hvr-overline-from-center:active:before{left:0;right:0}.hvr-overline-from-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-from-right:before{content:"";position:absolute;z-index:-1;left:100%;right:0;top:0;background:#2098D1;height:4px;transition-property:left;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-from-right:hover:before,.hvr-overline-from-right:focus:before,.hvr-overline-from-right:active:before{left:0}.hvr-reveal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-reveal:before{content:"";position:absolute;z-index:-1;inset:0;border-color:#2098d1;border-style:solid;border-width:0;transition-property:border-width;transition-duration:.1s;transition-timing-function:ease-out}.hvr-reveal:hover:before,.hvr-reveal:focus:before,.hvr-reveal:active:before{transform:translateY(0);border-width:4px}.hvr-underline-reveal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-reveal:before{content:"";position:absolute;z-index:-1;left:0;right:0;bottom:0;background:#2098D1;height:4px;transform:translateY(4px);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-reveal:hover:before,.hvr-underline-reveal:focus:before,.hvr-underline-reveal:active:before{transform:translateY(0)}.hvr-overline-reveal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-reveal:before{content:"";position:absolute;z-index:-1;left:0;right:0;top:0;background:#2098D1;height:4px;transform:translateY(-4px);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-reveal:hover:before,.hvr-overline-reveal:focus:before,.hvr-overline-reveal:active:before{transform:translateY(0)}.hvr-glow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow}.hvr-glow:hover,.hvr-glow:focus,.hvr-glow:active{box-shadow:0 0 8px #0009}.hvr-shadow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow}.hvr-shadow:hover,.hvr-shadow:focus,.hvr-shadow:active{box-shadow:0 10px 10px -10px #00000080}.hvr-grow-shadow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow,transform}.hvr-grow-shadow:hover,.hvr-grow-shadow:focus,.hvr-grow-shadow:active{box-shadow:0 10px 10px -10px #00000080;transform:scale(1.1)}.hvr-box-shadow-outset{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow}.hvr-box-shadow-outset:hover,.hvr-box-shadow-outset:focus,.hvr-box-shadow-outset:active{box-shadow:2px 2px 2px #0009}.hvr-box-shadow-inset{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow;box-shadow:inset 0 0 #0009,0 0 1px #0000}.hvr-box-shadow-inset:hover,.hvr-box-shadow-inset:focus,.hvr-box-shadow-inset:active{box-shadow:inset 2px 2px 2px #0009,0 0 1px #0000}.hvr-float-shadow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-float-shadow:before{pointer-events:none;position:absolute;z-index:-1;content:"";top:100%;left:5%;height:10px;width:90%;opacity:0;background:radial-gradient(ellipse at center,rgba(0,0,0,.35) 0%,rgba(0,0,0,0) 80%);transition-duration:.3s;transition-property:transform,opacity}.hvr-float-shadow:hover,.hvr-float-shadow:focus,.hvr-float-shadow:active{transform:translateY(-5px)}.hvr-float-shadow:hover:before,.hvr-float-shadow:focus:before,.hvr-float-shadow:active:before{opacity:1;transform:translateY(5px)}.hvr-shadow-radial{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-shadow-radial:before,.hvr-shadow-radial:after{pointer-events:none;position:absolute;content:"";left:0;width:100%;box-sizing:border-box;background-repeat:no-repeat;height:5px;opacity:0;transition-duration:.3s;transition-property:opacity}.hvr-shadow-radial:before{bottom:100%;background:radial-gradient(ellipse at 50% 150%,rgba(0,0,0,.6) 0%,rgba(0,0,0,0) 80%)}.hvr-shadow-radial:after{top:100%;background:radial-gradient(ellipse at 50% -50%,rgba(0,0,0,.6) 0%,rgba(0,0,0,0) 80%)}.hvr-shadow-radial:hover:before,.hvr-shadow-radial:focus:before,.hvr-shadow-radial:active:before,.hvr-shadow-radial:hover:after,.hvr-shadow-radial:focus:after,.hvr-shadow-radial:active:after{opacity:1}.hvr-bubble-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-top:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;left:calc(50% - 10px);top:0;border-width:0 10px 10px 10px;border-color:transparent transparent #e1e1e1 transparent}.hvr-bubble-top:hover:before,.hvr-bubble-top:focus:before,.hvr-bubble-top:active:before{transform:translateY(-10px)}.hvr-bubble-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-right:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;top:calc(50% - 10px);right:0;border-width:10px 0 10px 10px;border-color:transparent transparent transparent #e1e1e1}.hvr-bubble-right:hover:before,.hvr-bubble-right:focus:before,.hvr-bubble-right:active:before{transform:translate(10px)}.hvr-bubble-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-bottom:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;left:calc(50% - 10px);bottom:0;border-width:10px 10px 0 10px;border-color:#e1e1e1 transparent transparent transparent}.hvr-bubble-bottom:hover:before,.hvr-bubble-bottom:focus:before,.hvr-bubble-bottom:active:before{transform:translateY(10px)}.hvr-bubble-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-left:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;top:calc(50% - 10px);left:0;border-width:10px 10px 10px 0;border-color:transparent #e1e1e1 transparent transparent}.hvr-bubble-left:hover:before,.hvr-bubble-left:focus:before,.hvr-bubble-left:active:before{transform:translate(-10px)}.hvr-bubble-float-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-top:before{position:absolute;z-index:-1;content:"";left:calc(50% - 10px);top:0;border-style:solid;border-width:0 10px 10px 10px;border-color:transparent transparent #e1e1e1 transparent;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-top:hover,.hvr-bubble-float-top:focus,.hvr-bubble-float-top:active{transform:translateY(10px)}.hvr-bubble-float-top:hover:before,.hvr-bubble-float-top:focus:before,.hvr-bubble-float-top:active:before{transform:translateY(-10px)}.hvr-bubble-float-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-right:before{position:absolute;z-index:-1;top:calc(50% - 10px);right:0;content:"";border-style:solid;border-width:10px 0 10px 10px;border-color:transparent transparent transparent #e1e1e1;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-right:hover,.hvr-bubble-float-right:focus,.hvr-bubble-float-right:active{transform:translate(-10px)}.hvr-bubble-float-right:hover:before,.hvr-bubble-float-right:focus:before,.hvr-bubble-float-right:active:before{transform:translate(10px)}.hvr-bubble-float-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-bottom:before{position:absolute;z-index:-1;content:"";left:calc(50% - 10px);bottom:0;border-style:solid;border-width:10px 10px 0 10px;border-color:#e1e1e1 transparent transparent transparent;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-bottom:hover,.hvr-bubble-float-bottom:focus,.hvr-bubble-float-bottom:active{transform:translateY(-10px)}.hvr-bubble-float-bottom:hover:before,.hvr-bubble-float-bottom:focus:before,.hvr-bubble-float-bottom:active:before{transform:translateY(10px)}.hvr-bubble-float-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-left:before{position:absolute;z-index:-1;content:"";top:calc(50% - 10px);left:0;border-style:solid;border-width:10px 10px 10px 0;border-color:transparent #e1e1e1 transparent transparent;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-left:hover,.hvr-bubble-float-left:focus,.hvr-bubble-float-left:active{transform:translate(10px)}.hvr-bubble-float-left:hover:before,.hvr-bubble-float-left:focus:before,.hvr-bubble-float-left:active:before{transform:translate(-10px)}.hvr-icon-back{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.1s}.hvr-icon-back .hvr-icon{transform:translateZ(0);transition-duration:.1s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-back:hover .hvr-icon,.hvr-icon-back:focus .hvr-icon,.hvr-icon-back:active .hvr-icon{transform:translate(-4px)}.hvr-icon-forward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.1s}.hvr-icon-forward .hvr-icon{transform:translateZ(0);transition-duration:.1s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-forward:hover .hvr-icon,.hvr-icon-forward:focus .hvr-icon,.hvr-icon-forward:active .hvr-icon{transform:translate(4px)}@keyframes hvr-icon-down{0%,50%,to{transform:translateY(0)}25%,75%{transform:translateY(6px)}}.hvr-icon-down{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-down .hvr-icon{transform:translateZ(0)}.hvr-icon-down:hover .hvr-icon,.hvr-icon-down:focus .hvr-icon,.hvr-icon-down:active .hvr-icon{animation-name:hvr-icon-down;animation-duration:.75s;animation-timing-function:ease-out}@keyframes hvr-icon-up{0%,50%,to{transform:translateY(0)}25%,75%{transform:translateY(-6px)}}.hvr-icon-up{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-up .hvr-icon{transform:translateZ(0)}.hvr-icon-up:hover .hvr-icon,.hvr-icon-up:focus .hvr-icon,.hvr-icon-up:active .hvr-icon{animation-name:hvr-icon-up;animation-duration:.75s;animation-timing-function:ease-out}.hvr-icon-spin{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-spin .hvr-icon{transition-duration:1s;transition-property:transform;transition-timing-function:ease-in-out}.hvr-icon-spin:hover .hvr-icon,.hvr-icon-spin:focus .hvr-icon,.hvr-icon-spin:active .hvr-icon{transform:rotate(360deg)}@keyframes hvr-icon-drop{0%{opacity:0}50%{opacity:0;transform:translateY(-100%)}51%,to{opacity:1}}.hvr-icon-drop{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-drop .hvr-icon{transform:translateZ(0)}.hvr-icon-drop:hover .hvr-icon,.hvr-icon-drop:focus .hvr-icon,.hvr-icon-drop:active .hvr-icon{opacity:0;transition-duration:.3s;animation-name:hvr-icon-drop;animation-duration:.5s;animation-delay:.3s;animation-fill-mode:forwards;animation-timing-function:ease-in-out;animation-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-icon-fade{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-fade .hvr-icon{transform:translateZ(0);transition-duration:.5s;transition-property:color}.hvr-icon-fade:hover .hvr-icon,.hvr-icon-fade:focus .hvr-icon,.hvr-icon-fade:active .hvr-icon{color:#0f9e5e}@keyframes hvr-icon-float-away{0%{opacity:1}to{opacity:0;transform:translateY(-1em)}}.hvr-icon-float-away{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-float-away .hvr-icon{transform:translateZ(0);animation-duration:.5s;animation-fill-mode:forwards}.hvr-icon-float-away:hover .hvr-icon,.hvr-icon-float-away:focus .hvr-icon,.hvr-icon-float-away:active .hvr-icon{animation-name:hvr-icon-float-away;animation-timing-function:ease-out}@keyframes hvr-icon-sink-away{0%{opacity:1}to{opacity:0;transform:translateY(1em)}}.hvr-icon-sink-away{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-sink-away .hvr-icon{transform:translateZ(0);animation-duration:.5s;animation-fill-mode:forwards}.hvr-icon-sink-away:hover .hvr-icon,.hvr-icon-sink-away:focus .hvr-icon,.hvr-icon-sink-away:active .hvr-icon{animation-name:hvr-icon-sink-away;animation-timing-function:ease-out}.hvr-icon-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-grow .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-grow:hover .hvr-icon,.hvr-icon-grow:focus .hvr-icon,.hvr-icon-grow:active .hvr-icon{transform:scale(1.3) translateZ(0)}.hvr-icon-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-shrink .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-shrink:hover .hvr-icon,.hvr-icon-shrink:focus .hvr-icon,.hvr-icon-shrink:active .hvr-icon{transform:scale(.8)}@keyframes hvr-icon-pulse{25%{transform:scale(1.3)}75%{transform:scale(.8)}}.hvr-icon-pulse{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-pulse .hvr-icon{transform:translateZ(0);transition-timing-function:ease-out}.hvr-icon-pulse:hover .hvr-icon,.hvr-icon-pulse:focus .hvr-icon,.hvr-icon-pulse:active .hvr-icon{animation-name:hvr-icon-pulse;animation-duration:1s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-icon-pulse-grow{to{transform:scale(1.3)}}.hvr-icon-pulse-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-pulse-grow .hvr-icon{transform:translateZ(0);transition-timing-function:ease-out}.hvr-icon-pulse-grow:hover .hvr-icon,.hvr-icon-pulse-grow:focus .hvr-icon,.hvr-icon-pulse-grow:active .hvr-icon{animation-name:hvr-icon-pulse-grow;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-icon-pulse-shrink{to{transform:scale(.8)}}.hvr-icon-pulse-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-pulse-shrink .hvr-icon{transform:translateZ(0);transition-timing-function:ease-out}.hvr-icon-pulse-shrink:hover .hvr-icon,.hvr-icon-pulse-shrink:focus .hvr-icon,.hvr-icon-pulse-shrink:active .hvr-icon{animation-name:hvr-icon-pulse-shrink;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-icon-push{50%{transform:scale(.5)}}.hvr-icon-push{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-push .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-push:hover .hvr-icon,.hvr-icon-push:focus .hvr-icon,.hvr-icon-push:active .hvr-icon{animation-name:hvr-icon-push;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}@keyframes hvr-icon-pop{50%{transform:scale(1.5)}}.hvr-icon-pop{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-pop .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-pop:hover .hvr-icon,.hvr-icon-pop:focus .hvr-icon,.hvr-icon-pop:active .hvr-icon{animation-name:hvr-icon-pop;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}.hvr-icon-bounce{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-bounce .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-bounce:hover .hvr-icon,.hvr-icon-bounce:focus .hvr-icon,.hvr-icon-bounce:active .hvr-icon{transform:scale(1.5);transition-timing-function:cubic-bezier(.47,2.02,.31,-.36)}.hvr-icon-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-rotate .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-rotate:hover .hvr-icon,.hvr-icon-rotate:focus .hvr-icon,.hvr-icon-rotate:active .hvr-icon{transform:rotate(20deg)}.hvr-icon-grow-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-grow-rotate .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-grow-rotate:hover .hvr-icon,.hvr-icon-grow-rotate:focus .hvr-icon,.hvr-icon-grow-rotate:active .hvr-icon{transform:scale(1.5) rotate(12deg)}.hvr-icon-float{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-float .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-float:hover .hvr-icon,.hvr-icon-float:focus .hvr-icon,.hvr-icon-float:active .hvr-icon{transform:translateY(-4px)}.hvr-icon-sink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-sink .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-sink:hover .hvr-icon,.hvr-icon-sink:focus .hvr-icon,.hvr-icon-sink:active .hvr-icon{transform:translateY(4px)}@keyframes hvr-icon-bob{0%{transform:translateY(-6px)}50%{transform:translateY(-2px)}to{transform:translateY(-6px)}}@keyframes hvr-icon-bob-float{to{transform:translateY(-6px)}}.hvr-icon-bob{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-bob .hvr-icon{transform:translateZ(0)}.hvr-icon-bob:hover .hvr-icon,.hvr-icon-bob:focus .hvr-icon,.hvr-icon-bob:active .hvr-icon{animation-name:hvr-icon-bob-float,hvr-icon-bob;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}@keyframes hvr-icon-hang{0%{transform:translateY(6px)}50%{transform:translateY(2px)}to{transform:translateY(6px)}}@keyframes hvr-icon-hang-sink{to{transform:translateY(6px)}}.hvr-icon-hang{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-hang .hvr-icon{transform:translateZ(0)}.hvr-icon-hang:hover .hvr-icon,.hvr-icon-hang:focus .hvr-icon,.hvr-icon-hang:active .hvr-icon{animation-name:hvr-icon-hang-sink,hvr-icon-hang;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}@keyframes hvr-icon-wobble-horizontal{16.65%{transform:translate(6px)}33.3%{transform:translate(-5px)}49.95%{transform:translate(4px)}66.6%{transform:translate(-2px)}83.25%{transform:translate(1px)}to{transform:translate(0)}}.hvr-icon-wobble-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-wobble-horizontal .hvr-icon{transform:translateZ(0)}.hvr-icon-wobble-horizontal:hover .hvr-icon,.hvr-icon-wobble-horizontal:focus .hvr-icon,.hvr-icon-wobble-horizontal:active .hvr-icon{animation-name:hvr-icon-wobble-horizontal;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-icon-wobble-vertical{16.65%{transform:translateY(6px)}33.3%{transform:translateY(-5px)}49.95%{transform:translateY(4px)}66.6%{transform:translateY(-2px)}83.25%{transform:translateY(1px)}to{transform:translateY(0)}}.hvr-icon-wobble-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-wobble-vertical .hvr-icon{transform:translateZ(0)}.hvr-icon-wobble-vertical:hover .hvr-icon,.hvr-icon-wobble-vertical:focus .hvr-icon,.hvr-icon-wobble-vertical:active .hvr-icon{animation-name:hvr-icon-wobble-vertical;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-icon-buzz{50%{transform:translate(3px) rotate(2deg)}to{transform:translate(-3px) rotate(-2deg)}}.hvr-icon-buzz{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-buzz .hvr-icon{transform:translateZ(0)}.hvr-icon-buzz:hover .hvr-icon,.hvr-icon-buzz:focus .hvr-icon,.hvr-icon-buzz:active .hvr-icon{animation-name:hvr-icon-buzz;animation-duration:.15s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-icon-buzz-out{10%{transform:translate(3px) rotate(2deg)}20%{transform:translate(-3px) rotate(-2deg)}30%{transform:translate(3px) rotate(2deg)}40%{transform:translate(-3px) rotate(-2deg)}50%{transform:translate(2px) rotate(1deg)}60%{transform:translate(-2px) rotate(-1deg)}70%{transform:translate(2px) rotate(1deg)}80%{transform:translate(-2px) rotate(-1deg)}90%{transform:translate(1px) rotate(0)}to{transform:translate(-1px) rotate(0)}}.hvr-icon-buzz-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-buzz-out .hvr-icon{transform:translateZ(0)}.hvr-icon-buzz-out:hover .hvr-icon,.hvr-icon-buzz-out:focus .hvr-icon,.hvr-icon-buzz-out:active .hvr-icon{animation-name:hvr-icon-buzz-out;animation-duration:.75s;animation-timing-function:linear;animation-iteration-count:1}.hvr-curl-top-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-top-left:before{pointer-events:none;position:absolute;content:"";height:0;width:0;top:0;left:0;background:white;background:linear-gradient(135deg,white 45%,#aaa 50%,#ccc 56%,white 80%);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="#ffffff",endColorstr="#000000");z-index:1000;box-shadow:1px 1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-top-left:hover:before,.hvr-curl-top-left:focus:before,.hvr-curl-top-left:active:before{width:25px;height:25px}.hvr-curl-top-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-top-right:before{pointer-events:none;position:absolute;content:"";height:0;width:0;top:0;right:0;background:white;background:linear-gradient(225deg,white 45%,#aaa 50%,#ccc 56%,white 80%);box-shadow:-1px 1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-top-right:hover:before,.hvr-curl-top-right:focus:before,.hvr-curl-top-right:active:before{width:25px;height:25px}.hvr-curl-bottom-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-bottom-right:before{pointer-events:none;position:absolute;content:"";height:0;width:0;bottom:0;right:0;background:white;background:linear-gradient(315deg,white 45%,#aaa 50%,#ccc 56%,white 80%);box-shadow:-1px -1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-bottom-right:hover:before,.hvr-curl-bottom-right:focus:before,.hvr-curl-bottom-right:active:before{width:25px;height:25px}.hvr-curl-bottom-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-bottom-left:before{pointer-events:none;position:absolute;content:"";height:0;width:0;bottom:0;left:0;background:white;background:linear-gradient(45deg,white 45%,#aaa 50%,#ccc 56%,white 80%);box-shadow:1px -1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-bottom-left:hover:before,.hvr-curl-bottom-left:focus:before,.hvr-curl-bottom-left:active:before{width:25px;height:25px}/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */#tiledesk-container html{line-height:1.15;-webkit-text-size-adjust:100%}#tiledesk-container body{margin:0}#tiledesk-container main{display:block}#tiledesk-container h1{font-size:2em;margin:.67em 0}#tiledesk-container hr{box-sizing:content-box;height:0;overflow:visible}#tiledesk-container pre{font-family:monospace,monospace;font-size:1em}#tiledesk-container a{background-color:transparent}#tiledesk-container abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}#tiledesk-container b,#tiledesk-container strong{font-weight:bolder}#tiledesk-container code,#tiledesk-container kbd,#tiledesk-container samp{font-family:monospace,monospace;font-size:1em}#tiledesk-container small{font-size:80%}#tiledesk-container sub,#tiledesk-container sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}#tiledesk-container sub{bottom:-.25em}#tiledesk-container sup{top:-.5em}#tiledesk-container img{border-style:none;max-width:100%}#tiledesk-container button,#tiledesk-container input,#tiledesk-container optgroup,#tiledesk-container select,#tiledesk-container textarea{font-family:inherit;font-size:100%;line-height:1.15}#tiledesk-container button,#tiledesk-container input{overflow:visible}#tiledesk-container button,#tiledesk-container select{text-transform:none}#tiledesk-container button,#tiledesk-container [type=button],#tiledesk-container [type=reset],#tiledesk-container [type=submit]{-webkit-appearance:button}#tiledesk-container button::-moz-focus-inner,#tiledesk-container [type=button]::-moz-focus-inner,#tiledesk-container [type=reset]::-moz-focus-inner,#tiledesk-container [type=submit]::-moz-focus-inner{border-style:none;padding:0}#tiledesk-container button:-moz-focusring,#tiledesk-container [type=button]:-moz-focusring,#tiledesk-container [type=reset]:-moz-focusring,#tiledesk-container [type=submit]:-moz-focusring{outline:1px dotted ButtonText}#tiledesk-container fieldset{padding:.35em .75em .625em}#tiledesk-container legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}#tiledesk-container progress{vertical-align:baseline}#tiledesk-container textarea{overflow:auto}#tiledesk-container [type=checkbox],#tiledesk-container [type=radio]{box-sizing:border-box;padding:0}#tiledesk-container [type=number]::-webkit-inner-spin-button,#tiledesk-container [type=number]::-webkit-outer-spin-button{height:auto}#tiledesk-container [type=search]{-webkit-appearance:textfield;outline-offset:-2px}#tiledesk-container [type=search]::-webkit-search-decoration{-webkit-appearance:none}#tiledesk-container ::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}#tiledesk-container details{display:block}#tiledesk-container summary{display:list-item}#tiledesk-container template{display:none}#tiledesk-container [hidden]{display:none}.emoji-mart,.emoji-mart *{box-sizing:border-box;line-height:1.15}.emoji-mart{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,sans-serif;font-size:16px;display:inline-block;color:#222427;border:1px solid #d9d9d9;border-radius:5px;background:#fff}.emoji-mart .emoji-mart-emoji{padding:6px}.emoji-mart-bar{border:0 solid #d9d9d9}.emoji-mart-bar:first-child{border-bottom-width:1px;border-top-left-radius:5px;border-top-right-radius:5px}.emoji-mart-bar:last-child{border-top-width:1px;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.emoji-mart-anchors{display:flex;flex-direction:row;justify-content:space-between;padding:0 6px;line-height:0}.emoji-mart-anchor{position:relative;display:block;flex:1 1 auto;color:#858585;text-align:center;padding:12px 4px;overflow:hidden;transition:color .1s ease-out;margin:0;box-shadow:none;background:none;border:none}.emoji-mart-anchor:focus{outline:0}.emoji-mart-anchor:hover,.emoji-mart-anchor:focus,.emoji-mart-anchor-selected{color:#464646}.emoji-mart-anchor-selected .emoji-mart-anchor-bar{bottom:0}.emoji-mart-anchor-bar{position:absolute;bottom:-3px;left:0;width:100%;height:3px;background-color:#464646}.emoji-mart-anchors i{display:inline-block;width:100%;max-width:22px}.emoji-mart-anchors svg,.emoji-mart-anchors img{fill:currentColor;height:18px;width:18px}.emoji-mart-scroll{overflow-y:scroll;height:270px;padding:0 6px 6px;will-change:transform}.emoji-mart-search{margin-top:6px;padding:0 6px;position:relative}.emoji-mart-search input{font-size:16px;display:block;width:100%;padding:5px 25px 6px 10px;border-radius:5px;border:1px solid #d9d9d9;outline:0}.emoji-mart-search input,.emoji-mart-search input::-webkit-search-decoration,.emoji-mart-search input::-webkit-search-cancel-button,.emoji-mart-search input::-webkit-search-results-button,.emoji-mart-search input::-webkit-search-results-decoration{-webkit-appearance:none}.emoji-mart-search-icon{position:absolute;top:3px;right:11px;z-index:2;padding:2px 5px 1px;border:none;background:none}.emoji-mart-category .emoji-mart-emoji span{z-index:1;position:relative;text-align:center;cursor:default}.emoji-mart-category .emoji-mart-emoji:hover:before{z-index:0;content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#f4f4f4;border-radius:100%}.emoji-mart-category-label{z-index:2;position:relative;position:sticky;top:0}.emoji-mart-category-label span{display:block;width:100%;font-weight:500;padding:5px 6px;background-color:#fff;background-color:#fffffff2}.emoji-mart-category-list{margin:0;padding:0}.emoji-mart-category-list li{list-style:none;margin:0;padding:0;display:inline-block}.emoji-mart-emoji{position:relative;display:inline-block;font-size:0;margin:0;padding:0;border:none;background:none;box-shadow:none}.emoji-mart-emoji-native{font-family:"Segoe UI Emoji",Segoe UI Symbol,Segoe UI,"Apple Color Emoji",Twemoji Mozilla,"Noto Color Emoji","Android Emoji"}.emoji-mart-no-results{font-size:14px;text-align:center;padding-top:70px;color:#858585}.emoji-mart-no-results .emoji-mart-category-label{display:none}.emoji-mart-no-results .emoji-mart-no-results-label{margin-top:.2em}.emoji-mart-no-results .emoji-mart-emoji:hover:before{content:none}.emoji-mart-preview{position:relative;height:70px}.emoji-mart-preview-emoji,.emoji-mart-preview-data,.emoji-mart-preview-skins{position:absolute;top:50%;transform:translateY(-50%)}.emoji-mart-preview-emoji{left:12px}.emoji-mart-preview-data{left:68px;right:12px;word-break:break-all}.emoji-mart-preview-skins{right:30px;text-align:right}.emoji-mart-preview-skins.custom{right:10px;text-align:right}.emoji-mart-preview-name{font-size:14px}.emoji-mart-preview-shortname{font-size:12px;color:#888}.emoji-mart-preview-shortname+.emoji-mart-preview-shortname,.emoji-mart-preview-shortname+.emoji-mart-preview-emoticon,.emoji-mart-preview-emoticon+.emoji-mart-preview-emoticon{margin-left:.5em}.emoji-mart-preview-emoticon{font-size:11px;color:#bbb}.emoji-mart-title span{display:inline-block;vertical-align:middle}.emoji-mart-title .emoji-mart-emoji{padding:0}.emoji-mart-title-label{color:#999a9c;font-size:26px;font-weight:300}.emoji-mart-skin-swatches{font-size:0;padding:2px 0;border:1px solid #d9d9d9;border-radius:12px;background-color:#fff}.emoji-mart-skin-swatches.custom{font-size:0;border:none;background-color:#fff}.emoji-mart-skin-swatches.opened .emoji-mart-skin-swatch{width:16px;padding:0 2px}.emoji-mart-skin-swatches.opened .emoji-mart-skin-swatch.selected:after{opacity:.75}.emoji-mart-skin-swatch{display:inline-block;width:0;vertical-align:middle;transition-property:width,padding;transition-duration:.125s;transition-timing-function:ease-out}.emoji-mart-skin-swatch:nth-child(1){transition-delay:0s}.emoji-mart-skin-swatch:nth-child(2){transition-delay:.03s}.emoji-mart-skin-swatch:nth-child(3){transition-delay:.06s}.emoji-mart-skin-swatch:nth-child(4){transition-delay:.09s}.emoji-mart-skin-swatch:nth-child(5){transition-delay:.12s}.emoji-mart-skin-swatch:nth-child(6){transition-delay:.15s}.emoji-mart-skin-swatch.selected{position:relative;width:16px;padding:0 2px}.emoji-mart-skin-swatch.selected:after{content:"";position:absolute;top:50%;left:50%;width:4px;height:4px;margin:-2px 0 0 -2px;background-color:#fff;border-radius:100%;pointer-events:none;opacity:0;transition:opacity .2s ease-out}.emoji-mart-skin-swatch.custom{display:inline-block;width:0;height:38px;overflow:hidden;vertical-align:middle;transition-property:width,height;transition-duration:.125s;transition-timing-function:ease-out;cursor:default}.emoji-mart-skin-swatch.custom.selected{position:relative;width:36px;height:38px;padding:0 2px 0 0}.emoji-mart-skin-swatch.custom.selected:after{content:"";width:0;height:0}.emoji-mart-skin-swatches.custom .emoji-mart-skin-swatch.custom:hover{background-color:#f4f4f4;border-radius:10%}.emoji-mart-skin-swatches.custom.opened .emoji-mart-skin-swatch.custom{width:36px;height:38px;padding:0 2px 0 0}.emoji-mart-skin-swatches.custom.opened .emoji-mart-skin-swatch.custom.selected:after{opacity:.75}.emoji-mart-skin-text.opened{display:inline-block;vertical-align:middle;text-align:left;color:#888;font-size:11px;padding:5px 2px;width:95px;height:40px;border-radius:10%;background-color:#fff}.emoji-mart-skin{display:inline-block;width:100%;padding-top:100%;max-width:12px;border-radius:100%}.emoji-mart-skin-tone-1{background-color:#ffc93a}.emoji-mart-skin-tone-2{background-color:#fadcbc}.emoji-mart-skin-tone-3{background-color:#e0bb95}.emoji-mart-skin-tone-4{background-color:#bf8f68}.emoji-mart-skin-tone-5{background-color:#9b643d}.emoji-mart-skin-tone-6{background-color:#594539}.emoji-mart-sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.emoji-mart-dark{color:#fff;border-color:#555453;background-color:#222}.emoji-mart-dark .emoji-mart-bar{border-color:#555453}.emoji-mart-dark .emoji-mart-search input{color:#fff;border-color:#555453;background-color:#2f2f2f}.emoji-mart-dark .emoji-mart-search-icon svg{fill:#fff}.emoji-mart-dark .emoji-mart-category .emoji-mart-emoji:hover:before{background-color:#444}.emoji-mart-dark .emoji-mart-category-label span{background-color:#222;color:#fff}.emoji-mart-dark .emoji-mart-skin-swatches{border-color:#555453;background-color:#222}.emoji-mart-dark .emoji-mart-anchor:hover,.emoji-mart-dark .emoji-mart-anchor:focus,.emoji-mart-dark .emoji-mart-anchor-selected{color:#bfbfbf}input,select:focus,textarea{font-size:16px!important}:root{--button-in-msg-background-color: rgb(42, 106, 193);--button-in-msg-font-size: 15px}.chat-tooltip{font-family:Roboto,Google Sans,Helvetica,Arial,sans-serif;font-size:12px;font-style:normal;letter-spacing:normal;font-stretch:normal;font-variant:normal;font-weight:300}body{margin:0}:focus{outline:none!important}::-moz-focus-inner{border:0}.slide-in-right{animation:slide-in-right .5s cubic-bezier(.895,.03,.685,.22) 0s both}.slide-in-left{animation:slideIn .5s cubic-bezier(.895,.03,.685,.22) 0s}.scale-in-center{display:block;opacity:1;animation:scale-in-center .5s both}.jello-horizontal{animation:jello-horizontal .9s 3s both}.swirl-in-bck{animation:swirl-in-bck .65s ease-in .5s both}.rotate-scale-up{animation:rotate-scale-up .65s linear both}.rotate-center:hover{animation:rotate-center .6s ease-in-out both}.swing-in-bottom-fwd{animation:fade .5s both}.heartbeat:hover{animation:heartbeat 1.5s ease-in-out infinite both}.avatar-project{position:relative;padding:0;margin:0;height:70px;width:80px;line-height:52px}.avatar-project .avatar-placeholder{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;max-width:52px;text-align:center;font-size:20px;color:#fff;font-weight:500}.avatar-project .avatar-image{position:absolute;top:0;bottom:0;margin:0;left:0;width:100%;height:100%;max-height:100%;text-align:left;background-color:transparent;background-repeat:no-repeat;background-size:contain;background-attachment:initial;background-position:left;background-origin:content-box}textarea::placeholder{color:#aaa;font-weight:300}.msg_container .button-in-msg{color:#fff!important;background:var(--button-in-msg-background-color)!important;position:relative;max-width:300px;min-width:inherit;padding:8px 16px;cursor:auto;border:1px solid rgb(255,255,255);border-radius:20px!important;margin:3px;overflow:hidden;font-family:Muli,sans-serif;font-size:15px;text-overflow:ellipsis;white-space:normal;letter-spacing:-.24px;-webkit-font-smoothing:antialiased}.msg_container .button-in-msg p{font-size:var(--button-in-msg-font-size)!important;font-family:Muli,sans-serif!important;font-weight:400!important}chat-root{position:absolute;display:block;width:100%;height:100%}chat-root *:focus{outline:none}chat-root button{cursor:pointer}chat-root textarea,chat-root textarea:visited,chat-root textarea:focus,chat-root textarea:hover,chat-root textarea:active{line-height:20px!important;outline:none!important;box-shadow:none!important;border:0px solid rgba(0,0,0,.2)!important}chat-root .c21-button-clean{-webkit-appearance:initial;border:none;background-color:transparent;padding:0;margin:0}chat-root #tiledesk-container{position:absolute;width:100%;height:100%;font-family:Roboto,Google Sans,Helvetica,Arial,sans-serif;font-size:10px;text-align:left;background-color:transparent;display:none;overflow:hidden}chat-root #tiledesk-container.active{display:block}chat-root #tiledesk-container a:link{color:#fff}chat-root #tiledesk-container a:visited{color:#fff}chat-root #tiledesk-container a:hover{color:#fff}chat-root #tiledesk-container a:active{color:#fff}chat-root #tiledesk-container #c21-app-list-conversations a:link,chat-root #tiledesk-container #c21-app-list-all-conversations a:link,chat-root #tiledesk-container #chat21-star-rating-widget a:link,chat-root #tiledesk-container #chat21-prechat-form a:link{color:#3a3c4c}chat-root #tiledesk-container #c21-app-list-conversations a:visited,chat-root #tiledesk-container #c21-app-list-all-conversations a:visited,chat-root #tiledesk-container #chat21-star-rating-widget a:visited,chat-root #tiledesk-container #chat21-prechat-form a:visited{color:#3a3c4c}chat-root #tiledesk-container #c21-app-list-conversations a:hover,chat-root #tiledesk-container #c21-app-list-all-conversations a:hover,chat-root #tiledesk-container #chat21-star-rating-widget a:hover,chat-root #tiledesk-container #chat21-prechat-form a:hover{color:#3a3c4c}chat-root #tiledesk-container #c21-app-list-conversations a:active,chat-root #tiledesk-container #c21-app-list-all-conversations a:active,chat-root #tiledesk-container #chat21-star-rating-widget a:active,chat-root #tiledesk-container #chat21-prechat-form a:active{color:#3a3c4c}chat-root #tiledesk-container div.clear{all:unset;clear:both}chat-root #tiledesk-container .truncate{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}chat-root #tiledesk-container .truncate p{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin-block-start:0em;margin-block-end:0em}chat-root #tiledesk-container .v-align-center{display:inline-flex;align-items:center;height:100%;float:left}chat-root #tiledesk-container .c21-align-left{left:0}chat-root #tiledesk-container .c21-align-right{right:0}chat-root #tiledesk-container .time{display:none;font-size:1em;color:#aaa;text-align:left;margin:-2px 0 0;padding:0 40px;background-color:transparent}chat-root #tiledesk-container .time.sender{text-align:right;margin-right:24px;padding:0}chat-root #tiledesk-container .msg_receive a{color:#62a8ea}chat-root #tiledesk-container img{max-width:230px}chat-root #tiledesk-container button.c21-button-primary{width:auto;height:40px;line-height:40px;margin:25px 0;padding:0 24px;opacity:1;text-align:center;font-size:1em;border-radius:40px;background-color:#2a6ac1;color:#fff;border:0px;cursor:pointer}chat-root #tiledesk-container button.c21-button-primary .c21-label-button{margin-left:8px;font-weight:400;font-size:.9em}chat-root #tiledesk-container button.c21-button-primary:hover,chat-root #tiledesk-container button.c21-button-primary:focus,chat-root #tiledesk-container button.c21-button-primary:active{opacity:.8}chat-root #tiledesk-container button.c21-button-link{font-weight:400;font-size:14px;color:#2a6ac1;text-decoration:none;background-color:transparent;border:1px solid transparent;cursor:pointer}chat-root #tiledesk-container button.c21-button-link:hover,chat-root #tiledesk-container button.c21-button-link:focus,chat-root #tiledesk-container button.c21-button-link:active{text-decoration:underline;outline:none}chat-root #tiledesk-container .c21-divBudge{position:absolute;top:0;width:auto;height:12px;min-width:12px;font-size:1em;line-height:1.2em;border-radius:50%;background-color:red;color:#fff;text-align:center;margin-top:-10px;display:inline-block;box-sizing:initial;padding:5px;left:0}chat-root #tiledesk-container .c21-button{display:flex;cursor:pointer}chat-root #tiledesk-container .c21-close-button{position:absolute;width:35px;height:35px;top:0;right:0;margin:10px;z-index:10}chat-root #tiledesk-container .c21-close-button .c21-close-button-body{cursor:pointer;width:35px;height:35px;border-radius:8px;padding:0;margin:0;display:flex;align-items:center;-webkit-appearance:initial;border:none;background-color:#0000}chat-root #tiledesk-container .c21-close-button .c21-close-button-body:hover{background-color:#0006}chat-root #tiledesk-container .c21-close-button .c21-close-button-body svg{margin:0 auto;fill:#fff}chat-root #tiledesk-container #chat21-spinner{display:none;width:70px;min-height:20px;margin:20px auto 0;text-align:center}chat-root #tiledesk-container #chat21-spinner.active{display:block}chat-root #tiledesk-container #chat21-spinner>div{width:12px;height:12px;background-color:#2a6ac1;border-radius:100%;display:inline-block;animation:sk-bouncedelay 1.4s infinite ease-in-out both}chat-root #tiledesk-container #chat21-spinner .chat21-bounce1{animation-delay:-.32s}chat-root #tiledesk-container #chat21-spinner .chat21-bounce2{animation-delay:-.16s}chat-root #tiledesk-container #chat21-spinner span{display:block;margin:.5em 0 0;color:#1a1a1a;font-family:Roboto,sans-serif;animation:pulse 2s linear infinite;text-align:center}@keyframes sk-bouncedelay{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}chat-root #tiledesk-container #chat21-conversations{position:absolute;inset:1px;border-radius:16px;overflow:hidden;background-color:transparent;margin:0;padding:0}chat-root #tiledesk-container #chat21-conversations.full-screen-mode{width:100%;height:100%;inset:0;border-radius:0;max-height:none}chat-root #tiledesk-container #chat21-conversations.isMobile{border-radius:0}chat-root #tiledesk-container #chat21-conversations.shadow{transition:box-shadow .8s ease-in;box-shadow:#00000029 0 8px 36px}chat-root #tiledesk-container .chat21-fullscreen{width:100%;height:100%;right:0;left:0;bottom:0;border-radius:0;max-height:none}chat-root #tiledesk-container .modal-page{position:absolute;height:100%;width:100%;z-index:1;background-color:transparent;opacity:0;display:none}chat-root #tiledesk-container .modal-page.active{display:inline-block;opacity:1}chat-root #tiledesk-container .modal-page.modal-slide-in-right{position:absolute;left:0;opacity:1;display:inline-block;-webkit-animation-name:modal-active-in;-webkit-animation-duration:.3s;animation-name:modal-active-in;animation-duration:.3s}chat-root #tiledesk-container .modal-page.modal-slide-out-right{position:absolute;opacity:1;display:inline-block;animation:slide-out-right .3s cubic-bezier(.55,.085,.68,.53) both}chat-root .c21-header{overflow:hidden;width:100%;height:52px;position:relative;margin:0;padding:0;color:#fff;z-index:10}chat-root .c21-header button:hover{background:rgba(240,240,240,.4)!important;opacity:1!important;transition:all .45s ease-in-out 0s!important;-moz-transition:all .45s ease-in-out 0s!important;-webkit-transition:all .45s ease-in-out 0s!important;padding:0;margin:0;border-radius:10%}chat-root .c21-header .c21-header-container{position:relative;height:52px;width:100%;margin:0 auto}chat-root .c21-header .c21-header-container .c21-header-content{position:absolute;top:0;left:0;width:100%;height:100%}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button{display:block;align-items:center;justify-content:center;text-align:center;width:35px;height:35px;margin:9px;padding:0;border-radius:8px;cursor:pointer}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button.c21-right{float:right}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button.c21-left{float:left}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button.c21-close{display:none}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button svg{height:20px;width:20px}chat-root .c21-header .c21-header-container .c21-header-content .c21-title{position:absolute;left:0;display:flex;align-items:center;width:calc(100% - 200px);height:1.6em;line-height:1.6em;padding:0;margin:10px 100px;text-align:center;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}chat-root .c21-body::-webkit-scrollbar{display:none}chat-root .c21-body{position:absolute;inset:52px 0 0;padding:0;margin:0 auto;overflow:auto}chat-root .c21-body .c21-body-container{position:absolute;inset:0;height:auto;width:auto}chat-root .c21-body .c21-body-container .c21-body-header{position:absolute;top:0;left:30px;right:30px;padding:10px 0;margin:0 auto;width:auto;height:auto;z-index:2}chat-root .c21-body .c21-body-container .c21-body-content{position:absolute;inset:0;padding:0;margin:0 auto;height:auto}@media (max-width: 451px){chat-root #tiledesk-container .header-button.close{display:flex}}\n'],encapsulation:2});var So=be(6120),Po=be(4850);class vt{constructor(t,n,o){this.http=t,this.g=n,this.appConfigService=o,this.API_URL=o.getConfig().apiUrl}getCurrent(t){const n=this.API_URL+t+"/publicanalytics/waiting/current",o=new Ee.WM;return o.append("Content-Type","application/json"),this.http.get(n,{headers:o}).pipe((0,Po.U)(i=>i))}}vt.\u0275fac=function(t){return new(t||vt)(e.LFG(Ee.eN),e.LFG(Pe),e.LFG(ke))},vt.\u0275prov=e.Yz7({token:vt,factory:vt.\u0275fac});var Ke=be(2031);function ki(r,t){if(1&r&&e._UZ(0,"div",16,17),2&r){const n=e.oxw().$implicit;e.Udp("background-image","url("+n.image+")")}}function Ai(r,t){if(1&r&&(e.TgZ(0,"div",18),e.O4$(),e.TgZ(1,"svg",19),e._UZ(2,"path",20)(3,"path",21),e.qZA()()),2&r){const n=e.oxw().$implicit;e.ekj("not-read",null==n?null:n.is_new)}}function Ii(r,t){if(1&r&&(e.TgZ(0,"div",18),e.O4$(),e.TgZ(1,"svg",22),e._UZ(2,"path",23),e.qZA()()),2&r){const n=e.oxw().$implicit;e.ekj("not-read",n.is_new)}}const Ri=function(r){return{"background-color":r}};function Li(r,t){if(1&r&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("ngStyle",e.VKq(2,Ri,o.stylesMap.get("themeColor"))),e.xp6(1),e.Oqu(n.badge)}}function Ni(r,t){if(1&r&&(e.TgZ(0,"div",25)(1,"button",26),e.O4$(),e.TgZ(2,"svg",27),e._UZ(3,"path",28)(4,"path",29),e.TgZ(5,"title",30),e._uU(6),e.qZA()()()()),2&r){const n=e.oxw(2);e.xp6(6),e.Oqu(n.translationMap.get("CLOSED"))}}const Fi=function(r){return{background:r}};function Bi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div")(1,"button",2),e.NdJ("click",function(){const l=e.CHM(n).$implicit,E=e.oxw();return e.KtG(E.openConversationByID(l))}),e.TgZ(2,"div",3)(3,"div",4)(4,"div",5)(5,"span",6),e._uU(6),e.qZA(),e.YNc(7,ki,2,2,"div",7),e.qZA()(),e.TgZ(8,"div",8)(9,"div",9),e._uU(10),e.ALo(11,"amTimeAgo"),e.qZA(),e.TgZ(12,"div",10),e._uU(13),e.qZA(),e.YNc(14,Ai,4,2,"div",11),e.YNc(15,Ii,3,2,"div",11),e.TgZ(16,"div",12),e._uU(17),e.qZA()(),e.YNc(18,Li,2,4,"div",13),e.YNc(19,Ni,7,1,"div",14),e.qZA(),e._UZ(20,"div",15),e.qZA()()}if(2&r){const n=t.$implicit;e.xp6(4),e.Q6J("ngStyle",e.VKq(16,Fi,"linear-gradient(rgb(255,255,255) -125%, "+n.color+")")),e.xp6(2),e.Oqu(null==n?null:n.avatar),e.xp6(1),e.Q6J("ngIf",null==n?null:n.image),e.xp6(3),e.Oqu(e.lcZ(11,14,null==n?null:n.timestamp)),e.xp6(3),e.Oqu(null==n?null:n.sender_fullname),e.xp6(1),e.Q6J("ngIf","image"===(null==n?null:n.type)),e.xp6(1),e.Q6J("ngIf","image"!==n.type&&"text"!==n.type),e.xp6(1),e.ekj("not-read",n.is_new)("archived",n.archived),e.xp6(1),e.Oqu(n.last_message_text),e.xp6(1),e.Q6J("ngIf",n.is_new),e.xp6(1),e.Q6J("ngIf",n.archived)}}class Tt{constructor(t){this.iterableDiffers=t,this.onConversationSelected=new e.vpe,this.onImageLoaded=new e.vpe,this.onConversationLoaded=new e.vpe,this.convertMessage=Vn,this.setColorFromString=qn,this.avatarPlaceholder=Gn,this.logger=fe.getInstance(),this.empDifferMap=new Map,this.empMap=new Map,this.iterableDifferListConv=this.iterableDiffers.find([]).create(null)}ngOnInit(){this.logger.debug("[LISTCONVERSATIONS] ngOnInit",this.listConversations)}ngOnChanges(t){}openConversationByID(t){this.logger.debug("[LISTCONVERSATIONS] openConversationByID: ",t),t&&(this.uidConvSelected=t.uid,this.onConversationSelected.emit(t))}ngAfterViewInit(){this.logger.debug("[LISTCONVERSATIONS] ---ngAfterViewInit---: listConversations ",this.listConversations)}ngDoCheck(){this.iterableDifferListConv.diff(this.listConversations)}}function Ui(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.returnOpenAllConversation())}),e.TgZ(1,"div",11),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.returnOpenAllConversation())}),e._uU(2),e.qZA(),e.TgZ(3,"button",12),e.O4$(),e.TgZ(4,"svg",13),e._UZ(5,"path",14),e.qZA()()()}if(2&r){const n=e.oxw(2);e.xp6(2),e.hij("",n.g.SHOW_ALL_CONV," ")}}function Di(r,t){if(1&r&&(e.TgZ(0,"div")(1,"div",8),e._uU(2),e.qZA(),e.YNc(3,Ui,6,1,"div",9),e.qZA()),2&r){const n=e.oxw();e.xp6(2),e.Oqu(n.g.PREV_CONVERSATIONS),e.xp6(1),e.Q6J("ngIf",1==n.g.showAllConversations)}}function Hi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.returnOpenAllConversation())}),e.TgZ(1,"div",15),e._uU(2),e.qZA(),e.O4$(),e.TgZ(3,"svg",16),e._UZ(4,"path",17)(5,"path",18),e.qZA()()}if(2&r){const n=e.oxw(2);e.xp6(2),e.Oqu(n.g.SHOW_ALL_CONV)}}function Zi(r,t){if(1&r&&(e.TgZ(0,"div")(1,"div",8),e._uU(2),e.qZA(),e.YNc(3,Hi,6,1,"div",9),e.qZA()),2&r){const n=e.oxw();e.xp6(2),e.Oqu(n.g.NO_CONVERSATION),e.xp6(1),e.Q6J("ngIf",n.listConversations&&n.listConversations.length>0)}}function zi(r,t){if(1&r&&e._UZ(0,"div",25,26),2&r){const n=e.oxw().$implicit;e.Udp("background-image","url("+n.imageurl+")")}}Tt.\u0275fac=function(t){return new(t||Tt)(e.Y36(e.ZZ4))},Tt.\u0275cmp=e.Xpm({type:Tt,selectors:[["chat-list-conversations"]],inputs:{listConversations:"listConversations",limit:"limit",stylesMap:"stylesMap",translationMap:"translationMap"},outputs:{onConversationSelected:"onConversationSelected",onImageLoaded:"onImageLoaded",onConversationLoaded:"onConversationLoaded"},features:[e.TTD],decls:3,vars:5,consts:[["id","c21-app-list-conversations"],[4,"ngFor","ngForOf"],["tabindex","1103",1,"c21-item-conversation",3,"click"],[1,"c21-body-conv"],[1,"c21-left-conv"],[1,"c21-ball",3,"ngStyle"],[1,"c21-ball-label"],["class","c21-avatar-image",3,"background-image",4,"ngIf"],[1,"c21-right-conv"],[1,"c21-last-time"],[1,"truncate","c21-name"],["class","c21-msg","style","float: left; margin-right: 5px;",3,"not-read",4,"ngIf"],[1,"truncate","c21-msg"],["class","c21-divBudge",3,"ngStyle",4,"ngIf"],["class","c21-icon-archived-chat",4,"ngIf"],[1,"clear"],[1,"c21-avatar-image"],["avatarImage",""],[1,"c21-msg",2,"float","left","margin-right","5px"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","fill","#000000","width","20px","height","20px","viewBox","0 0 24 24"],["d","M0 0h24v24H0V0z","fill","none"],["d","M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","fill","#000000","width","20px","height","20px","viewBox","0 0 24 24","transform","rotate(45)"],["d","M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"],[1,"c21-divBudge",3,"ngStyle"],[1,"c21-icon-archived-chat"],["tabindex","-1",1,"c21-header-button","c21-right","c21-close","c21-button-clean"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","fill","#aaaaaa","width","24px","height","24px","viewBox","0 0 24 24"],["fill","none","d","M0 0h24v24H0z"],["d","M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"],["id","altIconTitle"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Bi,21,18,"div",1),e.ALo(2,"slice"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,1,n.listConversations,0,n.limit)))},dependencies:[de.sg,de.O5,de.PC,de.OU,Ke.eG],styles:["[_nghost-%COMP%]   .c21-msg[_ngcontent-%COMP%]    >a>img{max-width:24%!important;vertical-align:middle}#c21-app-list-conversations[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:auto;font-size:10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]{width:100%;min-width:325;height:auto;position:relative;margin:auto;padding:0;cursor:pointer;-webkit-appearance:initial;border:none;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]{border-bottom:1px solid #eee;width:auto;text-align:left;padding:0 15px;position:relative;display:flex;align-items:center;height:60px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]{width:auto;height:100%;float:left;display:flex;align-items:center}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]{width:calc(100% - 65px);margin-left:15px;height:auto;float:left;padding:17px 0;text-align:left}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-last-time[_ngcontent-%COMP%]{font-size:.8em;color:#aaa;float:right;display:block;padding:0;margin:0;width:auto;height:auto}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-name[_ngcontent-%COMP%]{font-weight:300;color:#8b8ea6;font-size:1.3em;line-height:1.7;min-height:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-msg[_ngcontent-%COMP%]{font-weight:400;color:#3a3c4c;font-size:1.3em;line-height:1.7;max-height:21px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .not-read.c21-msg[_ngcontent-%COMP%]{font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .archived.c21-msg[_ngcontent-%COMP%]{margin-right:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:hover, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:focus, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:active{background-color:#fafafa}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]{position:relative;width:40px;height:40px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:45px;left:inherit;right:10px;width:10px;height:10px;min-width:10px;font-size:1.2em;line-height:10px;border-radius:50%;background-color:#2a6ac1;color:#fff;font-weight:700;padding:0;text-align:center;margin-right:0;display:inline-block}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-icon-archived-chat[_ngcontent-%COMP%]{border-radius:4px;position:absolute;right:0;bottom:20px;margin-right:-5px;color:#858585;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{padding:6px 10px;display:flex;align-items:center;color:#777}"]});const ko=function(r){return{"background-color":r}};function ji(r,t){if(1&r&&(e.TgZ(0,"div",21)(1,"div",22)(2,"span",23),e._uU(3),e.qZA(),e.YNc(4,zi,2,2,"div",24),e.qZA()()),2&r){const n=t.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngStyle",e.VKq(3,ko,o.setColorFromString(n.firstname))),e.xp6(2),e.Oqu(o.avatarPlaceholder(n.firstname)),e.xp6(1),e.Q6J("ngIf",n.imageurl)}}function Vi(r,t){if(1&r&&(e.TgZ(0,"div",19),e.YNc(1,ji,5,5,"div",20),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.availableAgents)}}function Gi(r,t){if(1&r&&e._UZ(0,"div",25,26),2&r){const n=e.oxw().$implicit;e.Udp("background-image","url("+n.imageurl+")")}}function qi(r,t){if(1&r&&(e.TgZ(0,"div",35)(1,"div",22)(2,"span",23),e._uU(3),e.qZA(),e.YNc(4,Gi,2,2,"div",24),e.qZA()()),2&r){const n=t.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngStyle",e.VKq(3,ko,o.setColorFromString(n.firstname))),e.xp6(2),e.Oqu(o.avatarPlaceholder(n.firstname)),e.xp6(1),e.Q6J("ngIf",n.imageurl)}}const Ao=function(r,t,n){return{"background-color":r,"border-color":t,color:n}},Io=function(){return{fill:"yellow"}},Ro=function(r){return{fill:r}};function Wi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",27),e.YNc(1,qi,5,5,"div",28),e.TgZ(2,"button",29,30),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openNewConversation())}),e.TgZ(4,"span",31),e.O4$(),e.TgZ(5,"svg",32),e._UZ(6,"path",33),e.qZA()(),e.kcU(),e.TgZ(7,"span",34),e._uU(8),e.qZA(),e._UZ(9,"div",3),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.availableAgents),e.xp6(1),e.Q6J("ngStyle",e.kEZ(5,Ao,n.g.themeColor,n.g.themeColor,n.g.themeForegroundColor)),e.xp6(3),e.Q6J("ngStyle",e.DdM(9,Io)),e.xp6(1),e.Q6J("ngStyle",e.VKq(10,Ro,n.g.themeForegroundColor)),e.xp6(2),e.hij(" ",n.g.LABEL_START_NW_CONV," ")}}function Yi(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-list-conversations",38),e.NdJ("onConversationSelected",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onConversationSelectedFN(i))})("onImageLoaded",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onImageLoadedFN(i))})("onConversationLoaded",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onConversationLoadedFN(i))}),e.qZA()}if(2&r){const n=e.oxw(2);e.Q6J("listConversations",n.listConversations)("limit",3)("stylesMap",n.stylesMap)("translationMap",n.translationMapConversation)}}function Ji(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div"),e.YNc(1,Yi,1,4,"chat-list-conversations",36),e.TgZ(2,"div",37)(3,"button",29,30),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openNewConversation())}),e.TgZ(5,"span",31),e.O4$(),e.TgZ(6,"svg",32),e._UZ(7,"path",33),e.qZA()(),e.kcU(),e.TgZ(8,"span",34),e._uU(9),e.qZA(),e._UZ(10,"div",3),e.qZA()()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.listConversations&&n.listConversations.length>0),e.xp6(2),e.Q6J("ngStyle",e.kEZ(5,Ao,n.g.themeColor,n.g.themeColor,n.g.themeForegroundColor)),e.xp6(3),e.Q6J("ngStyle",e.DdM(9,Io)),e.xp6(1),e.Q6J("ngStyle",e.VKq(10,Ro,n.g.themeForegroundColor)),e.xp6(2),e.hij(" ",n.g.LABEL_START_NW_CONV," ")}}function Qi(r,t){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.WAITING_TIME_FOUND_WITH_REPLYTIME_PLACEHOLDER," ")}}function Ki(r,t){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.g.WAITING_TIME_NOT_FOUND," ")}}function $i(r,t){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.Oqu(n.g.WAITING_TIME_NOT_FOUND)}}function Xi(r,t){if(1&r&&(e.TgZ(0,"div",39)(1,"div",40),e.YNc(2,Qi,2,1,"div",2),e.YNc(3,Ki,2,1,"div",2),e.YNc(4,$i,2,1,"div",2),e.qZA()()),2&r){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.waitingTime>=0&&!0===n.g.dynamicWaitTimeReply),e.xp6(1),e.Q6J("ngIf",n.waitingTime>=0&&!1===n.g.dynamicWaitTimeReply),e.xp6(1),e.Q6J("ngIf",-1==n.waitingTime)}}class nn{constructor(t,n,o,i,l,E){this.g=t,this.imageRepoService=n,this.chatManager=o,this.waitingService=i,this.translatorService=l,this.customTranslateService=E,this.onNewConversation=new e.vpe,this.onConversationSelected=new e.vpe,this.onOpenAllConvesations=new e.vpe,this.onImageLoaded=new e.vpe,this.onConversationLoaded=new e.vpe,this.subscriptions=[],this.convertMessage=Vn,this.setColorFromString=qn,this.avatarPlaceholder=Gn,this.tenant="",this.themeColor="",this.themeForegroundColor="",this.availableAgents=[],this.langService=new So.b,this.logger=fe.getInstance(),this.humanizer=new So.f(this.langService),this.humanizer.setOptions({round:!0}),this.initialize()}ngOnInit(){this.logger.debug("[HOMECONVERSATIONS]---ngOnInit--- ",this.listConversations)}initTranslations(){this.translationMapConversation=this.customTranslateService.translateLanguage(["CLOSED"])}onConversationSelectedFN(t){t&&this.onConversationSelected.emit(t)}initialize(){this.logger.debug("initialize: ListConversationsComponent"),this.initTranslations(),this.tenant=this.g.tenant,this.LABEL_START_NW_CONV=this.g.LABEL_START_NW_CONV,this.listConversations=[],this.archivedConversations=[],this.waitingTime=-1,this.availableAgents=this.g.availableAgents.slice(0,5),this.availableAgents.forEach(t=>{t.imageurl=this.imageRepoService.getImagePhotoUrl(t.id)}),this.logger.debug("[HOMECONVERSATIONS] tenant: ",this.tenant,this.availableAgents),this.logger.debug("[HOMECONVERSATIONS] this.listConversations.length",this.listConversations.length),this.logger.debug("[HOMECONVERSATIONS] this.listConversations",this.listConversations),this.showWaitingTime()}showWaitingTime(){const t=this,n=this.g.projectid;n&&this.waitingService.getCurrent(n).subscribe(o=>{if(t.logger.debug("[HOMECONVERSATIONS] response waiting",o),o&&o.length>0&&o[0].waiting_time_avg){const i=o[0].waiting_time_avg;t.waitingTime=i,t.logger.debug("[HOMECONVERSATIONS] that.waitingTime",t.waitingTime);const l=t.translatorService.getLanguage();t.humanWaitingTime=this.humanizer.humanize(i,{language:l}),this.g.WAITING_TIME_FOUND.includes("$reply_time")&&(this.WAITING_TIME_FOUND_WITH_REPLYTIME_PLACEHOLDER=this.g.WAITING_TIME_FOUND.replace("$reply_time",t.humanWaitingTime))}})}checkShowAllConversation(){return!!(this.archivedConversations&&this.archivedConversations.length>0)||!!(this.listConversations&&this.listConversations.length>0)}openNewConversation(){this.onNewConversation.emit()}returnOpenAllConversation(){this.onOpenAllConvesations.emit()}onImageLoadedFN(t){this.onImageLoaded.emit(t)}onConversationLoadedFN(t){this.onConversationLoaded.emit(t)}openConversationByID(t){this.logger.debug("[HOMECONVERSATIONS] openConversationByID: ",t),t&&this.onConversationSelected.emit(t)}ngOnDestroy(){this.logger.debug("[HOMECONVERSATIONS] ngOnDestroy list conv subscriptions",this.subscriptions),this.unsubscribe()}unsubscribe(){this.subscriptions.forEach(function(t){t.unsubscribe()}),this.subscriptions=[],this.subListConversations=null,this.subArchivedConversations=null,this.logger.debug("[HOMECONVERSATIONS] this.subscriptions",this.subscriptions)}}function er(r,t){if(1&r&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.Oqu(n.g.userFullname)}}function tr(r,t){if(1&r&&(e.O4$(),e.TgZ(0,"svg",16),e._UZ(1,"path",17)(2,"path",18),e.TgZ(3,"title",19),e._uU(4),e.qZA()()),2&r){const n=e.oxw(2);e.xp6(4),e.Oqu(n.g.SOUND_OFF)}}function nr(r,t){if(1&r&&(e.O4$(),e.TgZ(0,"svg",16),e._UZ(1,"path",17)(2,"path",20),e.TgZ(3,"title",19),e._uU(4),e.qZA()()),2&r){const n=e.oxw(2);e.xp6(4),e.Oqu(n.g.SOUND_ON)}}function or(r,t){if(1&r&&(e.TgZ(0,"span",14),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.g.SOUND_OFF,"")}}function ir(r,t){if(1&r&&(e.TgZ(0,"span",14),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.g.SOUND_ON,"")}}function rr(r,t){if(1&r&&(e.O4$(),e.kcU(),e.TgZ(0,"span",14),e._uU(1),e.qZA()),2&r){const n=e.oxw(3);e.xp6(1),e.hij(" ",n.g.LOGOUT,"")}}function sr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.signOut())}),e.O4$(),e.TgZ(1,"svg",21),e._UZ(2,"path",17)(3,"path",22),e.TgZ(4,"title",19),e._uU(5),e.qZA()(),e.YNc(6,rr,2,1,"span",11),e.qZA()}if(2&r){const n=e.oxw(2);e.xp6(5),e.Oqu(n.g.LOGOUT),e.xp6(1),e.Q6J("ngIf",n.g.isLogged&&n.g.showLogoutOption)}}function ar(r,t){if(1&r){const n=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"div",6)(1,"div",7),e.YNc(2,er,2,1,"div",8),e.TgZ(3,"div",9),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.toggleSound())}),e.YNc(4,tr,5,1,"svg",10),e.YNc(5,nr,5,1,"svg",10),e.YNc(6,or,2,1,"span",11),e.YNc(7,ir,2,1,"span",11),e.qZA(),e.YNc(8,sr,7,2,"div",12),e.TgZ(9,"div",13)(10,"span",14),e._uU(11),e.qZA()()()()}if(2&r){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.g.signInWithCustomToken&&n.g.userFullname),e.xp6(2),e.Q6J("ngIf",!n.g.soundEnabled),e.xp6(1),e.Q6J("ngIf",n.g.soundEnabled),e.xp6(1),e.Q6J("ngIf",!n.g.soundEnabled),e.xp6(1),e.Q6J("ngIf",n.g.soundEnabled),e.xp6(1),e.Q6J("ngIf",n.g.isLogged&&n.g.showLogoutOption),e.xp6(3),e.hij(" ",n.g.BUILD_VERSION,"")}}nn.\u0275fac=function(t){return new(t||nn)(e.Y36(Pe),e.Y36(Ze),e.Y36(Xe),e.Y36(vt),e.Y36(st),e.Y36(He))},nn.\u0275cmp=e.Xpm({type:nn,selectors:[["chat-home-conversations"]],inputs:{listConversations:"listConversations",archivedConversations:"archivedConversations",hideNewConversationButton:"hideNewConversationButton",stylesMap:"stylesMap"},outputs:{onNewConversation:"onNewConversation",onConversationSelected:"onConversationSelected",onOpenAllConvesations:"onOpenAllConvesations",onImageLoaded:"onImageLoaded",onConversationLoaded:"onConversationLoaded"},decls:10,vars:6,consts:[["id","c21-app-list-conversations"],[1,"c21-header"],[4,"ngIf"],[1,"clear"],[1,"c21-body"],["style","margin: 20px 30px;",4,"ngIf"],["class","flex-container",4,"ngIf"],["class","c21-footer",4,"ngIf"],[1,"c21-title"],["class","c21-button",3,"click",4,"ngIf"],[1,"c21-button",3,"click"],[2,"display","inline-block","line-height","40px","margin-right","10px",3,"click"],["tabindex","1101","aria-label"," tutte le conversazioni",1,"c21-button-clean"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","20","height","20","viewBox","0 0 20 20",0,"xml","space","preserve",2,"enable-background","new 0 0 20 20"],["d","M1.9,15.4h16.2v-1.8H1.9V15.4z M1.9,10.9h16.2V9.1H1.9V10.9z M1.9,4.6v1.8h16.2V4.6H1.9z"],[2,"display","inline-block","line-height","40px","margin-right","10px"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24"],["fill","none","d","M0 0h24v24H0V0z"],["d","M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7zm-4 6h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"],[2,"margin","20px 30px"],["class","c21-pallozzo",4,"ngFor","ngForOf"],[1,"c21-pallozzo"],[1,"c21-ball",3,"ngStyle"],[1,"c21-ball-label"],["class","c21-avatar-image",3,"background-image",4,"ngIf"],[1,"c21-avatar-image"],["avatarImage",""],[1,"flex-container"],["class","c21-pallozzo flex-inline-agent ",4,"ngFor","ngForOf"],["tabindex","1040","aflistconv","",1,"c21-button-primary",3,"ngStyle","click"],["aflistconv",""],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",3,"ngStyle"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",3,"ngStyle"],[1,"v-align-center","c21-label-button"],[1,"c21-pallozzo","flex-inline-agent"],[3,"listConversations","limit","stylesMap","translationMap","onConversationSelected","onImageLoaded","onConversationLoaded",4,"ngIf"],[1,"c21-new-conversation"],[3,"listConversations","limit","stylesMap","translationMap","onConversationSelected","onImageLoaded","onConversationLoaded"],[1,"c21-footer"],[1,"c21-waiting-time"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Di,4,2,"div",2),e.YNc(3,Zi,4,2,"div",2),e.qZA(),e._UZ(4,"div",3),e.TgZ(5,"div",4),e.YNc(6,Vi,2,1,"div",5),e.YNc(7,Wi,10,12,"div",6),e.YNc(8,Ji,11,12,"div",2),e.qZA(),e.YNc(9,Xi,5,3,"div",7),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",n.checkShowAllConversation()),e.xp6(1),e.Q6J("ngIf",!n.checkShowAllConversation()),e.xp6(3),e.Q6J("ngIf",(!n.listConversations||0==n.listConversations.length)&&!0===n.g.showAvailableAgents&&n.availableAgents&&n.availableAgents.length>1),e.xp6(1),e.Q6J("ngIf",(!n.listConversations||0==n.listConversations.length)&&n.availableAgents&&1===n.availableAgents.length&&!0===n.g.showAvailableAgents),e.xp6(1),e.Q6J("ngIf",n.availableAgents&&n.availableAgents.length>1||n.listConversations&&n.listConversations.length>0||n.availableAgents&&0===n.availableAgents.length),e.xp6(1),e.Q6J("ngIf",!0===n.g.showWaitTime))},dependencies:[de.sg,de.O5,de.PC,Tt],styles:["#c21-app-list-conversations[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:auto;font-size:10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{color:#5f6368;height:auto;position:relative;min-height:40px;display:block;font-weight:300;border-bottom:1px solid rgb(241,241,241);border-radius:0}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{font-size:1.4em;max-width:230px;line-height:normal;padding:14px 0 10px 24px;float:left}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]{font-size:1.4em;margin:0;line-height:normal;padding:0 5px;float:right;fill:#2a6ac1}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:40px;height:40px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#5f6368}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:rgba(220,220,220,.4)!important}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%;height:auto;top:0;font-size:1em;box-shadow:none;overflow:hidden;margin:0}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .flex-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-content:center;margin:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]{width:100%;min-width:344px;height:auto;position:relative;margin:auto;padding:0;cursor:pointer;-webkit-appearance:initial;border:none;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]{border-top:1px solid #eee;width:auto;text-align:left;margin:0 20px;position:relative;display:flex;align-items:center;height:80px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]{width:auto;height:100%;float:left;display:flex;align-items:center}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]{width:calc(100% - 65px);margin-left:15px;height:auto;float:left;padding:17px 0;text-align:left}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-last-time[_ngcontent-%COMP%]{font-size:.8em;color:#aaa;float:right;display:block;padding:0;margin:0;width:auto;height:auto}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-name[_ngcontent-%COMP%]{font-weight:700;color:#3a3c4c;font-size:1.3em;line-height:1.7;min-height:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-msg[_ngcontent-%COMP%]{font-weight:200;color:#3a3c4c;font-size:1.3em;line-height:1.7;max-height:21px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .not-read.c21-msg[_ngcontent-%COMP%]{font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:hover, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:focus, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:active{background-color:#fafafa}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-pallozzo[_ngcontent-%COMP%]{display:inline}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-pallozzo.flex-inline-agent[_ngcontent-%COMP%]{margin:auto 15px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]{position:relative;width:52px;height:52px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-new-conversation[_ngcontent-%COMP%]{width:auto;height:auto;position:relative;border-top:0px solid #eeeeee;display:flex;align-items:center;justify-content:center;box-shadow:none;vertical-align:top}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-footer[_ngcontent-%COMP%]{width:auto;height:auto;position:relative;display:flex;align-items:center}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-footer[_ngcontent-%COMP%]   .c21-waiting-time[_ngcontent-%COMP%]{font-size:1.3em;font-weight:200;padding:0 24px 10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:40px;left:inherit;right:10px;width:10px;height:10px;min-width:10px;font-size:1.2em;line-height:10px;border-radius:50%;background-color:#2a6ac1;color:#fff;font-weight:700;padding:0;text-align:center;margin-right:0;display:inline-block}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-label-button[_ngcontent-%COMP%]{margin-left:8px;font-weight:400;font-size:1.2em}"]});const lr=function(r){return{display:r}};class on{constructor(t){this.g=t,this.isHover=!1,this.onSignOut=new e.vpe}ngOnInit(){this.themeColor50=Ae(this.g.themeColor,50)}f21_toggle_options(){this.g.setParameter("isOpenMenuOptions",!this.g.isOpenMenuOptions,!0)}toggleSound(){this.g.setParameter("soundEnabled",!this.g.soundEnabled,!0),this.g.setParameter("isOpenMenuOptions",!1,!0)}signOut(){this.g.setParameter("isOpenMenuOptions",!1,!0),this.onSignOut.emit()}}on.\u0275fac=function(t){return new(t||on)(e.Y36(Pe))},on.\u0275cmp=e.Xpm({type:on,selectors:[["chat-menu-options"]],inputs:{isHover:"isHover"},outputs:{onSignOut:"onSignOut"},decls:7,vars:4,consts:[["id","c21-menu-options"],[1,"button-menu-options",3,"click","mouseover","mouseleave"],["xmlns","http://www.w3.org/2000/svg","enable-background","new 0 0 24 24","height","24px","width","24px","viewBox","0 0 24 24",3,"ngStyle"],["d","M0,0h24v24H0V0z","fill","none"],["d","M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"],["class","modal-menu-options",4,"ngIf"],[1,"modal-menu-options"],[1,""],["class","label-menu-welcome",4,"ngIf"],[1,"c21-button",3,"click"],["aria-labelledby","altIconTitle","class","icon-menu","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",4,"ngIf"],["class","label-menu-item",4,"ngIf"],["class","c21-button",3,"click",4,"ngIf"],[1,"c21-button","build_version_menu"],[1,"label-menu-item"],[1,"label-menu-welcome"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",1,"icon-menu"],["fill","none","d","M0 0h24v24H0V0z"],["d","M4.34 2.93L2.93 4.34 7.29 8.7 7 9H3v6h4l5 5v-6.59l4.18 4.18c-.65.49-1.38.88-2.18 1.11v2.06c1.34-.3 2.57-.92 3.61-1.75l2.05 2.05 1.41-1.41L4.34 2.93zM10 15.17L7.83 13H5v-2h2.83l.88-.88L10 11.41v3.76zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zm-7-8l-1.88 1.88L12 7.76zm4.5 8c0-1.77-1.02-3.29-2.5-4.03v1.79l2.48 2.48c.01-.08.02-.16.02-.24z"],["id","altIconTitle"],["d","M3 9v6h4l5 5V4L7 9H3zm7-.17v6.34L7.83 13H5v-2h2.83L10 8.83zM16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77 0-4.28-2.99-7.86-7-8.77z"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","aria-labelledby","altIconTitle",1,"icon-menu"],["d","M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return n.f21_toggle_options()})("mouseover",function(){return n.isHover=!0})("mouseleave",function(){return n.isHover=!1}),e.O4$(),e.TgZ(2,"svg",2)(3,"g"),e._UZ(4,"path",3)(5,"path",4),e.qZA()()(),e.YNc(6,ar,12,7,"div",5),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngStyle",e.VKq(2,lr,n.isHover||n.g.isOpenMenuOptions?"block":"none")),e.xp6(4),e.Q6J("ngIf",n.g.isOpenMenuOptions))},dependencies:[de.O5,de.PC],styles:["#c21-menu-options[_ngcontent-%COMP%]   .modal-menu-options[_ngcontent-%COMP%]{width:auto;height:auto;min-height:40px;min-width:100px;max-width:80%;position:absolute;bottom:40px;right:10px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;background-color:#fff;z-index:25;box-shadow:0 4px 15px #0003,0 1px 2px #0003}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]{position:absolute;width:auto;line-height:12px;font-size:1em;font-weight:700;color:#777;display:inline-block;align-items:center;margin:4px 20px;padding:0;cursor:pointer;width:22px;height:22px;right:0}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#5f6368;display:none}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]:hover{border-radius:50%}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{display:block}.c21-button[_ngcontent-%COMP%]{cursor:pointer;margin:5px;padding:5px 10px;color:#777;display:flex}.c21-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;border-radius:6px;cursor:pointer}.build_version_menu[_ngcontent-%COMP%]{color:#aaa;justify-content:center;font-size:1em}.build_version_menu[_ngcontent-%COMP%]:hover{cursor:default;background-color:unset}.label-menu-welcome[_ngcontent-%COMP%]{cursor:default;font-weight:500;margin:10px 0;padding:0 10px}#c21-options-menu[_ngcontent-%COMP%]{width:auto;height:auto;min-height:40px;min-width:100px;max-width:80%;position:absolute;z-index:10;top:40px;right:15px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;border:1px solid #d7d7d7;background-color:#fff;padding:10px 0}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{padding:6px 10px;display:flex;align-items:center}.label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}.icon-menu[_ngcontent-%COMP%]{fill:#5f6368}#c21-options-menu[_ngcontent-%COMP%]   .label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}"]});const cr=["homeComponent"],hr=["aflistconv"];function dr(r,t){if(1&r&&(e.TgZ(0,"div",27),e._UZ(1,"div",28,29),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Udp("background-image","url("+n.g.project.logoChat+")")}}function ur(r,t){if(1&r&&(e.TgZ(0,"div",30),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Oqu(n.g.welcomeMsg)}}function gr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",36)(1,"button",37,38),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.openConversationOnPlatform("whatsapp"))}),e.TgZ(3,"span",39),e.O4$(),e.TgZ(4,"svg",40),e._UZ(5,"path",41),e.TgZ(6,"linearGradient",42),e._UZ(7,"stop",43)(8,"stop",44),e.qZA(),e._UZ(9,"path",45)(10,"image",46)(11,"path",47)(12,"path",48),e.TgZ(13,"title",10),e._uU(14,"Whatsapp"),e.qZA()()(),e.kcU(),e._UZ(15,"div",49),e.qZA()()}}function pr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",50)(1,"button",37,38),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.openConversationOnPlatform("telegram"))}),e.TgZ(3,"span",39),e.O4$(),e.TgZ(4,"svg",51)(5,"g",52)(6,"linearGradient",53),e._UZ(7,"stop",54)(8,"stop",55),e.qZA(),e._UZ(9,"circle",56)(10,"path",57)(11,"path",58),e.TgZ(12,"linearGradient",59),e._UZ(13,"stop",60)(14,"stop",61),e.qZA(),e._UZ(15,"path",62),e.qZA(),e.TgZ(16,"title",10),e._uU(17,"Telegram"),e.qZA()()(),e.kcU(),e._UZ(18,"div",49),e.qZA()()}}function fr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",63)(1,"button",37,38),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.openConversationOnPlatform("messanger"))}),e.TgZ(3,"span",39),e.O4$(),e.TgZ(4,"svg",64)(5,"radialGradient",65),e._UZ(6,"stop",66)(7,"stop",67)(8,"stop",68)(9,"stop",69),e.qZA(),e._UZ(10,"path",70)(11,"path",71),e.TgZ(12,"title",10),e._uU(13,"Facebook Messanger"),e.qZA()()(),e.kcU(),e._UZ(14,"div",49),e.qZA()()}}function mr(r,t){if(1&r&&(e.TgZ(0,"div",31)(1,"div",32),e._uU(2),e.qZA(),e.YNc(3,gr,16,0,"div",33),e.YNc(4,pr,19,0,"div",34),e.YNc(5,fr,15,0,"div",35),e.qZA()),2&r){const n=e.oxw();e.xp6(2),e.Oqu(null==n.translationMapFooter?null:n.translationMapFooter.get("SWITCH_TO")),e.xp6(1),e.Q6J("ngIf",(null==n.g?null:n.g.whatsappNumber)&&""!==(null==n.g?null:n.g.whatsappNumber.trim())),e.xp6(1),e.Q6J("ngIf",(null==n.g?null:n.g.telegramUsername)&&""!==(null==n.g?null:n.g.telegramUsername.trim())),e.xp6(1),e.Q6J("ngIf",(null==n.g?null:n.g.messangerPageTitle)&&""!==(null==n.g?null:n.g.messangerPageTitle.trim()))}}function _r(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-menu-options",72),e.NdJ("onSignOut",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onSignOutFN())}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("isHover",n.hover)}}const vr=function(r,t){return{color:r,"background-image":t}},br=function(r){return{display:r}},Cr=function(r){return{fill:r}};class rn{constructor(t,n){this.g=t,this.customTranslateService=n,this.onNewConversation=new e.vpe,this.onConversationSelected=new e.vpe,this.onOpenAllConvesations=new e.vpe,this.onCloseWidget=new e.vpe,this.onSignOut=new e.vpe,this.onImageLoaded=new e.vpe,this.onConversationLoaded=new e.vpe,this.hover=!1,this.convertColorToRGBA=Ae,this.logger=fe.getInstance()}ngOnInit(){this.logger.debug("[HOME-COMP] ngOnInit"),this.initiTranslations()}initiTranslations(){this.translationMapFooter=this.customTranslateService.translateLanguage(["SWITCH_TO"]),this.translationMapHeader=this.customTranslateService.translateLanguage(["BUTTON_CLOSE_TO_ICON"])}ngAfterViewInit(){this.logger.debug("[HOME-COMP]---ngAfterViewInit--- "),!0===this.g.firstOpen&&(this.addAnimation(),this.g.firstOpen=!1),setTimeout(()=>{this.aflistconv&&this.aflistconv.nativeElement.focus()},1e3)}onNewConversationFN(){this.removeAnimation(),this.onNewConversation.emit()}onOpenAllConversation(){this.removeAnimation(),this.onOpenAllConvesations.emit()}openConversationOnPlatform(t){"telegram"===t?window.open("https://telegram.me/"+this.g.telegramUsername,"_blank"):"whatsapp"===t?window.open("https://wa.me/"+this.g.whatsappNumber+"?text=/start","_blank"):"messanger"===t&&window.open("https://m.me/"+this.g.messangerPageTitle,"_blank")}onConversationSelectedFN(t){t&&(this.removeAnimation(),this.onConversationSelected.emit(t))}onImageLoadedFN(t){this.onImageLoaded.emit(t)}onConversationLoadedFN(t){this.onConversationLoaded.emit(t)}f21_close(){this.addAnimation(),this.onCloseWidget.emit()}hideMenuOptions(){this.logger.debug("[HOME-COMP] hideMenuOptions"),this.g.setParameter("isOpenMenuOptions",!1,!0)}onSignOutFN(){this.onSignOut.emit()}addAnimation(){try{const t=this.element.nativeElement;t&&t.classList.add("start-animation")}catch(t){this.logger.error("[HOME-COMP] addAnimation > Error :"+t)}}removeAnimation(){try{const t=this.element.nativeElement;t&&t.classList.remove("start-animation")}catch(t){this.logger.error("[HOME-COMP] removeAnimation > Error :"+t)}}}rn.\u0275fac=function(t){return new(t||rn)(e.Y36(Pe),e.Y36(He))},rn.\u0275cmp=e.Xpm({type:rn,selectors:[["chat-home"]],viewQuery:function(t,n){if(1&t&&(e.Gf(cr,5),e.Gf(hr,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.element=o.first),e.iGM(o=e.CRH())&&(n.aflistconv=o.first)}},inputs:{listConversations:"listConversations",archivedConversations:"archivedConversations",hideSettings:"hideSettings",hideNewConversationButton:"hideNewConversationButton",stylesMap:"stylesMap"},outputs:{onNewConversation:"onNewConversation",onConversationSelected:"onConversationSelected",onOpenAllConvesations:"onOpenAllConvesations",onCloseWidget:"onCloseWidget",onSignOut:"onSignOut",onImageLoaded:"onImageLoaded",onConversationLoaded:"onConversationLoaded"},decls:29,vars:23,consts:[["id","chat21-home-component","tabindex","2002","onFocus","document.querySelector('[aflistconv]').focus()"],["homeComponent",""],[1,"c21-header",3,"ngStyle","click"],[1,"c21-header-container"],[1,"c21-header-button",3,"ngStyle"],[1,"c21-close-button"],["tabindex","2001","aria-label","    chiudi chat",1,"c21-close-button-body",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],[1,"c21-header-content"],["class","avatar-project","item-start","",4,"ngIf"],[1,"c21-text","fade-in-bottom"],[1,"c21-text-welcome"],["class","c21-text-intro",4,"ngIf"],[1,"c21-body",3,"click"],[1,"c21-body-content"],[1,"c21-cards"],[1,"c21-card-blank","fade-in-top"],[1,"c21-card","fade-in-top"],[3,"listConversations","archivedConversations","hideNewConversationButton","stylesMap","onNewConversation","onConversationSelected","onOpenAllConvesations","onImageLoaded","onConversationLoaded"],["class","c21-footer-content fade-in-bottom-footer",4,"ngIf"],[1,"c21-footer","fade-in-bottom-footer"],["id","c21-powered-by",3,"mouseover","mouseleave"],["tabindex","-1",1,"c21-powered-by",3,"innerHTML"],[3,"isHover","onSignOut",4,"ngIf"],["item-start","",1,"avatar-project"],[1,"avatar-image"],["avatarImage",""],[1,"c21-text-intro"],[1,"c21-footer-content","fade-in-bottom-footer"],[1,"label-item"],["id","c21-whatsapp",4,"ngIf"],["id","c21-telegram",4,"ngIf"],["id","c21-messanger",4,"ngIf"],["id","c21-whatsapp"],["tabindex","1040","aflistconv","",1,"c21-button-primary",3,"click"],["aflistconv",""],[1,"v-align-center"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","28","height","28","viewBox","0 0 1219.547 1225.016"],["fill","#E0E0E0","d","M1041.858 178.02C927.206 63.289 774.753.07 612.325 0 277.617 0 5.232 272.298 5.098 606.991c-.039 106.986 27.915 211.42 81.048 303.476L0 1225.016l321.898-84.406c88.689 48.368 188.547 73.855 290.166 73.896h.258.003c334.654 0 607.08-272.346 607.222-607.023.056-162.208-63.052-314.724-177.689-429.463zm-429.533 933.963h-.197c-90.578-.048-179.402-24.366-256.878-70.339l-18.438-10.93-191.021 50.083 51-186.176-12.013-19.087c-50.525-80.336-77.198-173.175-77.16-268.504.111-278.186 226.507-504.503 504.898-504.503 134.812.056 261.519 52.604 356.814 147.965 95.289 95.36 147.728 222.128 147.688 356.948-.118 278.195-226.522 504.543-504.693 504.543z"],["id","a","gradientUnits","userSpaceOnUse","x1","609.77","y1","1190.114","x2","609.77","y2","21.084"],["offset","0","stop-color","#20b038"],["offset","1","stop-color","#60d66a"],["fill","url(#a)","d","M27.875 1190.114l82.211-300.18c-50.719-87.852-77.391-187.523-77.359-289.602.133-319.398 260.078-579.25 579.469-579.25 155.016.07 300.508 60.398 409.898 169.891 109.414 109.492 169.633 255.031 169.57 409.812-.133 319.406-260.094 579.281-579.445 579.281-.023 0 .016 0 0 0h-.258c-96.977-.031-192.266-24.375-276.898-70.5l-307.188 80.548z"],["overflow","visible","opacity",".08","width","20","height","20",0,"xlink","href","FCC0802E2AF8A915.png","transform","translate(270.984 291.372)"],["fill-rule","evenodd","clip-rule","evenodd","fill","#FFF","d","M462.273 349.294c-11.234-24.977-23.062-25.477-33.75-25.914-8.742-.375-18.75-.352-28.742-.352-10 0-26.25 3.758-39.992 18.766-13.75 15.008-52.5 51.289-52.5 125.078 0 73.797 53.75 145.102 61.242 155.117 7.5 10 103.758 166.266 256.203 226.383 126.695 49.961 152.477 40.023 179.977 37.523s88.734-36.273 101.234-71.297c12.5-35.016 12.5-65.031 8.75-71.305-3.75-6.25-13.75-10-28.75-17.5s-88.734-43.789-102.484-48.789-23.75-7.5-33.75 7.516c-10 15-38.727 48.773-47.477 58.773-8.75 10.023-17.5 11.273-32.5 3.773-15-7.523-63.305-23.344-120.609-74.438-44.586-39.75-74.688-88.844-83.438-103.859-8.75-15-.938-23.125 6.586-30.602 6.734-6.719 15-17.508 22.5-26.266 7.484-8.758 9.984-15.008 14.984-25.008 5-10.016 2.5-18.773-1.25-26.273s-32.898-81.67-46.234-111.326z"],["fill","#FFF","d","M1036.898 176.091C923.562 62.677 772.859.185 612.297.114 281.43.114 12.172 269.286 12.039 600.137 12 705.896 39.633 809.13 92.156 900.13L7 1211.067l318.203-83.438c87.672 47.812 186.383 73.008 286.836 73.047h.255.003c330.812 0 600.109-269.219 600.25-600.055.055-160.343-62.328-311.108-175.649-424.53zm-424.601 923.242h-.195c-89.539-.047-177.344-24.086-253.93-69.531l-18.227-10.805-188.828 49.508 50.414-184.039-11.875-18.867c-49.945-79.414-76.312-171.188-76.273-265.422.109-274.992 223.906-498.711 499.102-498.711 133.266.055 258.516 52 352.719 146.266 94.195 94.266 146.031 219.578 145.992 352.852-.118 274.999-223.923 498.749-498.899 498.749z"],[1,"clear"],["id","c21-telegram"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","26","height","26","viewBox","0 0 368 368",0,"xml","space","preserve",2,"enable-background","new 0 0 368 368"],["id","XMLID_1_"],["id","XMLID_7_","gradientUnits","userSpaceOnUse","x1","-66.831","y1","-68.1757","x2","-65.3102","y2","-68.1757","gradientTransform","matrix(-60 139.992 -139.992 -60 -13316.416 5324.4634)"],["offset","0",2,"stop-color","#37AEE2"],["offset","1",2,"stop-color","#1E96C8"],["id","XMLID_3_","fill","url(#XMLID_7_)","cx","184","cy","184","r","182.5"],["id","XMLID_4_","fill","#C8DAEA","d","M150.5,267.6c-5.9,0-4.9-2.2-6.9-7.9l-17.4-57.2L260,123.2"],["id","XMLID_5_","fill","#A9C9DD","d","M150.5,267.6c4.6,0,6.6-2.1,9.1-4.6l24.3-23.7l-30.4-18.3"],["id","XMLID_8_","gradientUnits","userSpaceOnUse","x1","-61.9167","y1","-70.9915","x2","-60.3959","y2","-70.9915","gradientTransform","matrix(24.9894 40.0038 -47.6951 20.9596 -1641.849 4153.2417)"],["offset","0",2,"stop-color","#EFF7FC"],["offset","1",2,"stop-color","#FFFFFF"],["id","XMLID_6_","fill","url(#XMLID_8_)","d","M153.6,221.1l73.5,54.3c8.4,4.6,14.4,2.2,16.5-7.8l29.9-141.1c3.1-12.3-4.7-17.9-12.7-14.2   L85.2,180.2c-12,4.8-11.9,11.5-2.2,14.5l45.1,14.1l104.4-65.9c4.9-3,9.5-1.4,5.7,1.9"],["id","c21-messanger"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","26","height","26",0,"xmlns","xlink","http://www.w3.org/1999/xlink","version","1.1","viewBox","0 0 800 800"],["id","Gradient","cx","101.925","cy","809.0079","r","1.0896","gradientTransform","matrix(800 0 0 -799.9985 -81386 648000.75)","gradientUnits","userSpaceOnUse"],["offset","0",2,"stop-color","#0099FF"],["offset","0.6098",2,"stop-color","#A033FF"],["offset","0.9348",2,"stop-color","#FF5280"],["offset","1",2,"stop-color","#FF7061"],["fill","url(#Gradient)","d","M400,0C174.7,0,0,165.1,0,388c0,116.6,47.8,217.4,125.6,287c6.5,5.8,10.5,14,10.7,22.8l2.2,71.2  c0.7,22.7,24.1,37.5,44.9,28.3l79.4-35c6.7-3,14.3-3.5,21.4-1.6c36.5,10,75.3,15.4,115.8,15.4c225.3,0,400-165.1,400-388  S625.3,0,400,0z"],["fill","#FFFFFF","d","M159.8,501.5l117.5-186.4c18.7-29.7,58.7-37,86.8-16l93.5,70.1c8.6,6.4,20.4,6.4,28.9-0.1    l126.2-95.8c16.8-12.8,38.8,7.4,27.6,25.3L522.7,484.9c-18.7,29.7-58.7,37-86.8,16l-93.5-70.1c-8.6-6.4-20.4-6.4-28.9,0.1    l-126.2,95.8C170.5,539.5,148.5,519.4,159.8,501.5z"],[3,"isHover","onSignOut"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0,1)(2,"div",2),e.NdJ("click",function(){return n.hideMenuOptions()}),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),e.NdJ("click",function(){return n.f21_close()}),e.O4$(),e.TgZ(7,"svg",7),e._UZ(8,"path",8)(9,"path",9),e.TgZ(10,"title",10),e._uU(11),e.qZA()()()()(),e.kcU(),e.TgZ(12,"div",11),e.YNc(13,dr,3,2,"div",12),e.TgZ(14,"div",13)(15,"div",14),e._uU(16),e.qZA(),e.YNc(17,ur,2,1,"div",15),e.qZA()()()(),e.TgZ(18,"div",16),e.NdJ("click",function(){return n.hideMenuOptions()}),e.TgZ(19,"div",17)(20,"div",18),e._UZ(21,"div",19),e.TgZ(22,"div",20)(23,"chat-home-conversations",21),e.NdJ("onNewConversation",function(){return n.onNewConversationFN()})("onConversationSelected",function(i){return n.onConversationSelectedFN(i)})("onOpenAllConvesations",function(){return n.onOpenAllConversation()})("onImageLoaded",function(i){return n.onImageLoadedFN(i)})("onConversationLoaded",function(i){return n.onConversationLoadedFN(i)}),e.qZA()()()()(),e.YNc(24,mr,6,4,"div",22),e.TgZ(25,"div",23)(26,"div",24),e.NdJ("mouseover",function(){return n.hover=!0})("mouseleave",function(){return n.hover=!1}),e._UZ(27,"div",25),e.qZA(),e.YNc(28,_r,1,1,"chat-menu-options",26),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngStyle",e.WLB(16,vr,n.g.themeForegroundColor,n.g.colorGradient)),e.xp6(2),e.Q6J("ngStyle",e.VKq(19,br,n.g.hideHeaderCloseButton?"none":"block")),e.xp6(3),e.Q6J("ngStyle",e.VKq(21,Cr,n.g.themeForegroundColor)),e.xp6(4),e.Oqu(null==n.translationMapHeader?null:n.translationMapHeader.get("BUTTON_CLOSE_TO_ICON")),e.xp6(2),e.Q6J("ngIf","nologo"!==n.g.project.logoChat),e.xp6(3),e.Oqu(null==n.g?null:n.g.welcomeTitle),e.xp6(1),e.Q6J("ngIf",n.g.welcomeMsg),e.xp6(2),e.ekj("nologo","nologo"===n.g.project.logoChat),e.xp6(4),e.Q6J("listConversations",n.listConversations)("archivedConversations",n.archivedConversations)("hideNewConversationButton",n.hideNewConversationButton)("stylesMap",n.stylesMap),e.xp6(1),e.Q6J("ngIf",(null==n.g?null:n.g.whatsappNumber)||(null==n.g?null:n.g.telegramUsername)||(null==n.g?null:n.g.messangerPageTitle)),e.xp6(3),e.Q6J("innerHTML",n.g.poweredBy,e.oJD),e.xp6(1),e.Q6J("ngIf",!n.hideSettings))},dependencies:[de.O5,de.PC,nn,on],styles:["#chat21-home-component{position:absolute;width:100%;height:100%}#chat21-home-component.start-animation .fade-in-top{animation:fade-in-top .5s cubic-bezier(.39,.575,.565,1) .3s both}#chat21-home-component.start-animation .fade-in-bottom{animation:fade-in-bottom .5s cubic-bezier(.6,-.28,.735,.045) 0s}#chat21-home-component .c21-header{position:absolute;width:100%;height:500px;border-radius:0 0 16px 16px;overflow:hidden;margin:0;padding:0}#chat21-home-component .c21-header .c21-header-container{padding:0;margin:0;width:100%;height:100%;position:absolute}#chat21-home-component .c21-header .c21-header-container .c21-header-button{display:block;width:100%;height:70px;position:absolute;margin:0}#chat21-home-component .c21-header .c21-header-container .flex-container{display:flex;align-items:stretch;margin:30px 40px 0;width:auto;height:auto}#chat21-home-component .c21-header .c21-header-container .flex-container .avatar-project{width:22%}#chat21-home-component .c21-header .c21-header-container .flex-container .c21-text{font-family:Google Sans}#chat21-home-component .c21-header .c21-header-container .flex-container .c21-text .c21-text-welcome{overflow:hidden;line-height:1.2em;max-height:2.4em;font-weight:400;font-size:3em;margin-bottom:10px}#chat21-home-component .c21-header .c21-header-container .flex-container .c21-text .c21-text-intro{display:inline-block;font-size:1.4em;font-weight:300;line-height:1.2em;max-height:2.4em}#chat21-home-component .c21-header .c21-header-container .c21-header-content{margin:55px 40px 0;width:auto;height:auto;display:flex;align-items:stretch}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-logo{position:relative;width:auto;height:70px;margin-bottom:20px}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-logo img{max-width:100%;max-height:100%;margin:auto 0;display:block}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-text{font-family:Roboto;margin:0 0 0 15px}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-text .c21-text-welcome{overflow:hidden;line-height:1.4em;max-height:3em;font-weight:200;font-size:2.5em;margin-bottom:15px}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-text .c21-text-intro{display:inline-block;font-size:1.7em;font-weight:600;line-height:1.2em;max-height:2.4em}#chat21-home-component .c21-body{position:absolute;width:100%;height:calc(100% - 30px);padding:0;margin:0;overflow:auto;background-color:#fff;top:0;box-shadow:none}#chat21-home-component .c21-body .c21-body-content{position:relative;padding:180px 25px 20px;margin:0}#chat21-home-component .c21-body .c21-body-content.nologo{padding:180px 10px 20px}#chat21-home-component .c21-body .c21-body-content .c21-cards .c21-card-blank{width:0;height:0;position:absolute;margin:-8px 16px;border-radius:0;z-index:40;border-style:solid;border-width:0px 15px 15px 15px;border-color:transparent transparent #ffffff transparent}#chat21-home-component .c21-body .c21-body-content .c21-cards .c21-card{position:relative;margin-bottom:20px;background-color:#fff;border-radius:16px;font-size:1.4em;line-height:1.4;color:#1a1a1a;overflow:hidden;-webkit-box-shadow:0 4px 15px 0 rgba(0,0,0,.2),0 1px 2px 0 rgba(0,0,0,.2);z-index:20;text-align:left}#chat21-home-component .c21-footer-content{position:absolute;width:100%;height:40px;bottom:40px;display:flex;align-items:center;justify-content:center;background-color:#fff;z-index:20;gap:10px}#chat21-home-component .c21-footer-content .label-item{line-height:20px;position:relative;margin:0 10px;color:#777;font-size:1.2em}#chat21-home-component .c21-footer-content #c21-whatsapp .c21-button-primary,#chat21-home-component .c21-footer-content #c21-telegram .c21-button-primary,#chat21-home-component .c21-footer-content #c21-messanger .c21-button-primary{background-color:transparent;color:#fff;margin:0;padding:5px;height:35px;width:35px;display:flex;justify-content:center}#chat21-home-component .c21-footer-content #c21-whatsapp:hover svg,#chat21-home-component .c21-footer-content #c21-telegram:hover svg,#chat21-home-component .c21-footer-content #c21-messanger:hover svg{transform:scale(1.2)}#chat21-home-component .c21-footer{position:absolute;width:100%;height:40px;bottom:0;display:flex;background-color:#fff;z-index:20}#chat21-home-component .c21-footer#c21-powered-by{display:block!important}#chat21-home-component .c21-footer .c21-powered-by{height:40px;text-align:center;padding:0;position:absolute;color:#aaa;top:0;left:20px;display:flex;align-items:center}#chat21-home-component .c21-footer .c21-powered-by a{text-decoration:none;cursor:pointer;display:inline-block;color:#aaa;font-size:1.1em;font-weight:500;line-height:22px;font-family:Mulish,sans-serif;letter-spacing:-.24px;-webkit-font-smoothing:antialiased}#chat21-home-component .c21-footer .c21-powered-by a span{display:inline-block;position:relative;top:2px}#chat21-home-component .c21-footer .c21-powered-by a img{width:80px;height:auto;max-height:40px;position:relative;vertical-align:middle;object-fit:contain}#chat21-home-component .c21-footer .c21-powered-by b{font-weight:bolder}#chat21-home-component .c21-footer .build_version{display:none;font-size:1em;color:#aaa;position:absolute;bottom:0;right:40px;line-height:30px}#chat21-home-component .c21-footer #c21-powered-by{width:calc(100% - 40px)}#chat21-home-component .c21-footer #c21-powered-by:hover div.build_version{display:block}@media (max-width: 451px){#tiledesk-container .c21-header-button.close{display:flex}}\n"],encapsulation:2});const wr=["afallconv"],yr=function(r,t){return{color:r,"background-image":t}},Lo=function(r){return{fill:r}},Or=function(r){return{color:r}};class sn{constructor(t,n,o){this.g=t,this.iterableDiffers=n,this.customTranslateService=o,this.onConversationSelected=new e.vpe,this.onCloseWidget=new e.vpe,this.convertMessage=Vn,this.subscriptions=[],this.logger=fe.getInstance(),this.iterableDifferListConv=this.iterableDiffers.find([]).create(null),this.iterableDifferListArchivedConv=this.iterableDiffers.find([]).create(null)}ngOnInit(){this.initialize()}ngAfterViewInit(){setTimeout(()=>{this.afallconv&&this.afallconv.nativeElement.focus()},1e3)}ngDoCheck(){let t=this.iterableDifferListConv.diff(this.listConversations),n=this.iterableDifferListArchivedConv.diff(this.archivedConversations);(t||n)&&this.concatAndOrderArray()}initTranslations(){this.translationMapConversation=this.customTranslateService.translateLanguage(["CLOSED"])}initialize(){this.logger.debug("[LISTALLCONVERSATIONS] initialize"),this.initTranslations(),this.LABEL_START_NW_CONV=this.g.LABEL_START_NW_CONV,this.allConversations=[],this.logger.debug("[LISTALLCONVERSATIONS] listconversations",this.listConversations,this.archivedConversations),this.concatAndOrderArray()}concatAndOrderArray(){let t;if(this.listConversations&&this.listConversations.length>0?t=this.archivedConversations&&this.archivedConversations.length>0?this.listConversations.concat(this.archivedConversations):this.listConversations:this.archivedConversations&&this.archivedConversations.length>0&&(t=this.archivedConversations),!t)return;const n=[],o=new Map;for(const i of t)o.has(i.uid)||(o.set(i.uid,!0),n.push(i));this.allConversations=n,this.allConversations.sort(function Qo(r,t="asc"){return function(n,o){if(!n.hasOwnProperty(r)||!o.hasOwnProperty(r))return 0;const i="string"==typeof n[r]?n[r].toUpperCase():n[r],l="string"==typeof o[r]?o[r].toUpperCase():o[r];let E=0;return i>l?E=1:i<l&&(E=-1),"desc"===t?-1*E:E}}("timestamp","desc")),this.logger.debug("[LISTALLCONVERSATIONS] concatAndOrderArray ",this.allConversations)}returnClosePage(){this.onCloseWidget.emit()}onConversationSelectedFN(t){this.logger.debug("[LISTALLCONVERSATIONS] openConversationByID: ",t),t&&this.onConversationSelected.emit(t)}onImageLoadedFN(t){this.logger.debug("[LISTALLCONVERSATIONS] onImageLoadedFN",t)}onConversationLoadedFN(t){this.logger.debug("[LISTALLCONVERSATIONS] onImageLoadedFN",t)}ngOnDestroy(){this.logger.debug("[LISTALLCONVERSATIONS] ngOnDestroy ->list conv subscriptions",this.subscriptions)}unsubscribe(){this.subscriptions.forEach(function(t){t.unsubscribe()}),this.subscriptions=[],this.allConversations=[],this.listConversations=[],this.archivedConversations=[]}}sn.\u0275fac=function(t){return new(t||sn)(e.Y36(Pe),e.Y36(e.ZZ4),e.Y36(He))},sn.\u0275cmp=e.Xpm({type:sn,selectors:[["chat-list-all-conversations"]],viewQuery:function(t,n){if(1&t&&e.Gf(wr,5),2&t){let o;e.iGM(o=e.CRH())&&(n.afallconv=o.first)}},inputs:{listConversations:"listConversations",archivedConversations:"archivedConversations",stylesMap:"stylesMap"},outputs:{onConversationSelected:"onConversationSelected",onCloseWidget:"onCloseWidget"},decls:21,vars:19,consts:[["id","c21-app-list-all-conversations"],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-content"],[1,"c21-header-button","c21-right","c21-close"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],["tabindex","1310","aria-label","indietro",1,"c21-header-button","c21-left","c21-button-clean",3,"click"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],[1,"c21-title",3,"ngStyle"],[1,"titleText"],["tabindex","1311","onFocus","document.querySelector('[start-focus]').focus()",1,"c21-body"],[3,"listConversations","stylesMap","translationMap","onConversationSelected","onImageLoaded","onConversationLoaded"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.O4$(),e.TgZ(5,"svg",5),e._UZ(6,"path",6)(7,"path",7),e.TgZ(8,"title",8),e._uU(9),e.qZA()()(),e.kcU(),e.TgZ(10,"button",9),e.NdJ("click",function(){return n.returnClosePage()}),e.O4$(),e.TgZ(11,"svg",5),e._UZ(12,"path",6)(13,"path",10),e.TgZ(14,"title",8),e._uU(15),e.qZA()()(),e.kcU(),e.TgZ(16,"div",11)(17,"div",12),e._uU(18),e.qZA()()()()(),e.TgZ(19,"div",13)(20,"chat-list-conversations",14),e.NdJ("onConversationSelected",function(i){return n.onConversationSelectedFN(i)})("onImageLoaded",function(i){return n.onImageLoadedFN(i)})("onConversationLoaded",function(i){return n.onConversationLoadedFN(i)}),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("ngStyle",e.WLB(10,yr,n.g.themeForegroundColor,n.g.colorGradient180)),e.xp6(4),e.Q6J("ngStyle",e.VKq(13,Lo,n.g.themeForegroundColor)),e.xp6(4),e.Oqu(n.g.BUTTON_CLOSE_TO_ICON),e.xp6(2),e.Q6J("ngStyle",e.VKq(15,Lo,n.g.themeForegroundColor)),e.xp6(4),e.Oqu(n.g.PREV_CONVERSATIONS),e.xp6(1),e.Q6J("ngStyle",e.VKq(17,Or,n.g.themeForegroundColor)),e.xp6(2),e.Oqu(n.g.project.widgetTitle),e.xp6(2),e.Q6J("listConversations",n.allConversations)("stylesMap",n.stylesMap)("translationMap",n.translationMapConversation))},dependencies:[de.PC,Tt],styles:["#c21-app-list-all-conversations[_ngcontent-%COMP%]{display:block;height:auto;font-size:10px;background-color:#fff;width:100%;height:100%;position:relative;margin:0;padding:0}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{overflow:hidden;width:100%;height:52px;position:relative;margin:0;padding:0}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;font-size:1em;line-height:40px;text-align:left}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .avatar-project[_ngcontent-%COMP%]{position:relative;padding:0;margin:0 10px 0 0;float:left;height:42px;width:42px;line-height:42px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{font-size:16px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{max-width:30px;max-height:30px;margin:6px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{position:relative;height:52px;width:100%;margin:0 auto}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-writing[_ngcontent-%COMP%]{position:absolute;bottom:3px;width:100%;text-align:center;margin:0;padding:0;font-size:1.1em;color:#fff}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-pallozzo[_ngcontent-%COMP%]{display:inline}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]{position:relative;width:52px;height:52px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:calc(100% - 52px);top:0;font-size:1em;box-shadow:none;overflow:auto}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]{width:100%;height:auto;position:relative;margin:auto;padding:0;cursor:pointer;-webkit-appearance:initial;border:none;border-bottom:1px solid #eeeeee;background-color:#fff;text-align:left}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]{width:auto;margin:0 24px;position:relative;display:flex;align-items:center;height:80px;text-align:left}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]{width:auto;height:100%;float:left;display:flex;align-items:center}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:14px;color:#fff;font-weight:500}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:2px 0 0;background-repeat:no-repeat;background-position:center;background-size:cover}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]{width:calc(100% - 65px);margin-left:15px;height:auto;float:left;padding:17px 0}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-last-time[_ngcontent-%COMP%]{font-size:.8em;color:#aaa;float:right;display:block;padding:0;margin:0;width:auto;height:auto}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-name[_ngcontent-%COMP%]{font-weight:700;color:#3a3c4c;font-size:1.3em;line-height:1.7;min-height:20px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-msg[_ngcontent-%COMP%]{font-weight:200;color:#3a3c4c;font-size:1.3em;line-height:1.7;max-height:21px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .not-read.c21-msg[_ngcontent-%COMP%]{font-weight:500}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:hover, #c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:focus, #c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:active{background-color:#fafafa}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:40px;left:inherit;right:10px;width:10px;height:10px;min-width:10px;font-size:1.2em;line-height:10px;border-radius:50%;background-color:red;color:#fff;font-weight:700;padding:0;text-align:center;margin-right:0;display:inline-block}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-lablel-close[_ngcontent-%COMP%]{border:1px solid #e2e2e2;background-color:#ececec;padding:4px;border-radius:4px;position:absolute;right:0;bottom:2px;margin-right:-10px;color:#858585;font-weight:500}"]});class xr{constructor(t){this.createdAt=new Date,this.file=t}}var Ce=be(4006),No=be(5183);const Mr=["chat21_file"],Fo=function(r,t,n){return{"background-color":r,"border-color":t,color:n}};function Er(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.onContinueConversation())}),e.TgZ(1,"span",11),e._uU(2),e.qZA(),e._UZ(3,"div",12),e.qZA()}if(2&r){const n=e.oxw(2);e.Q6J("ngStyle",e.kEZ(2,Fo,n.stylesMap.get("themeColor"),n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.hij(" ",null==n.translationMap?null:n.translationMap.get("CONTINUE")," ")}}const Tr=function(){return{fill:"yellow"}},Sr=function(r){return{fill:r}};function Pr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",5)(1,"button",6,7),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openNewConversation())}),e.TgZ(3,"span",8),e.O4$(),e.TgZ(4,"svg",9),e._UZ(5,"path",10),e.qZA()(),e.kcU(),e.TgZ(6,"span",11),e._uU(7),e.qZA(),e._UZ(8,"div",12),e.qZA(),e.YNc(9,Er,4,6,"button",13),e.qZA()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.kEZ(5,Fo,n.stylesMap.get("themeColor"),n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(3),e.Q6J("ngStyle",e.DdM(9,Tr)),e.xp6(1),e.Q6J("ngStyle",e.VKq(10,Sr,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.hij(" ",null==n.translationMap?null:n.translationMap.get("LABEL_START_NW_CONV")," "),e.xp6(2),e.Q6J("ngIf",n.showContinueConversationButton)}}function kr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",15)(1,"textarea",16,17),e.NdJ("ngModelChange",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.textInputTextArea=i)})("ngModelChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onTextAreaChange())})("keypress",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onkeypress(i))})("keydown",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onkeydown(i))})("paste",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onPaste(i))}),e._uU(3),e.qZA()()}if(2&r){const n=e.oxw();e.ekj("disabled",!(!n.isConversationArchived&&!n.hideTextReply)||null),e.xp6(1),e.Q6J("ngModel",n.textInputTextArea),e.uIk("disabled",!!n.hideTextReply||null)("placeholder",n.footerMessagePlaceholder?n.footerMessagePlaceholder:null==n.translationMap?null:n.translationMap.get("LABEL_PLACEHOLDER")),e.xp6(2),e.hij('    \x3c!-- placeholder="',null==n.translationMap?null:n.translationMap.get("LABEL_PLACEHOLDER"),'"> --\x3e\n  ')}}const Ar=function(){return{display:"block",height:"1px",width:"1px",overflow:"hidden"}};function Ir(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"label",29)(1,"span",8),e.O4$(),e.TgZ(2,"svg",30),e._UZ(3,"path",31),e.qZA()(),e.kcU(),e.TgZ(4,"input",32,33),e.NdJ("change",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.detectFiles(i))}),e.qZA()()}if(2&r){const n=e.oxw(2);e.ekj("active",!n.isFilePendingToUpload&&!n.hideTextReply),e.xp6(4),e.Q6J("accept",n.fileUploadAccept)("ngStyle",e.DdM(5,Ar)),e.uIk("disabled",!!(n.isFilePendingToUpload||n.isConversationArchived||n.hideTextReply)||null)}}function Rr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",null,18),e.YNc(2,Ir,6,6,"label",19),e.TgZ(3,"div",20),e.NdJ("click",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onSendPressed(i))}),e.TgZ(4,"span",8),e.O4$(),e.TgZ(5,"svg",21),e._UZ(6,"path",22),e.qZA()()(),e.kcU(),e.TgZ(7,"label",23),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onEmojiiPickerClicked())}),e.TgZ(8,"span",8),e.O4$(),e.TgZ(9,"svg",24),e._UZ(10,"path",25)(11,"circle",26)(12,"circle",27)(13,"path",28),e.qZA()()()()}if(2&r){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",1==n.showAttachmentButton),e.xp6(1),e.ekj("active",n.textInputTextArea&&!n.hideTextReply),e.xp6(4),e.ekj("active",!n.isFilePendingToUpload&&!n.hideTextReply)}}function Lr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"emoji-mart",34),e.NdJ("emojiSelect",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.addEmoji(i))}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("showPreview",n.emojiiOptions.showPreview)("color",null==n.stylesMap?null:n.stylesMap.get("themeColor"))("perLine",n.emojiiOptions.emojiPerLine)("totalFrequentLines",n.emojiiOptions.totalFrequentLines)("enableSearch",n.emojiiOptions.enableSearch)("darkMode",n.emojiiOptions.darkMode)("include",n.emojiiOptions.include)}}class St{constructor(t,n,o,i){this.g=t,this.chatManager=n,this.typingService=o,this.uploadService=i,this.onEmojiiPickerShow=new e.vpe,this.onBeforeMessageSent=new e.vpe,this.onAfterSendMessage=new e.vpe,this.onChangeTextArea=new e.vpe,this.onAttachmentFileButtonClicked=new e.vpe,this.onNewConversationButtonClicked=new e.vpe,this.onBackButton=new e.vpe,this.isFilePendingToUpload=!1,this.arrayFilesLoad=[],this.isFileSelected=!1,this.HEIGHT_DEFAULT="20px",this.showEmojiPicker=!1,this.emojiiOptions={emojiPerLine:9,totalFrequentLines:1,showPreview:!1,darkMode:!1,enableSearch:!1,include:["recent","people","nature","activity"]},this.convertColorToRGBA=Ae,this.logger=fe.getInstance()}ngOnInit(){}ngOnChanges(t){t.conversationWith&&void 0!==t.conversationWith.currentValue&&(this.conversationHandlerService=this.chatManager.getConversationHandlerByConversationId(this.conversationWith)),t.hideTextReply&&void 0!==t.hideTextReply.currentValue&&this.restoreTextArea(),t.dropEvent&&void 0!==t.dropEvent.currentValue&&this.onDrop(this.dropEvent)}ngAfterViewInit(){this.logger.debug("[CONV-FOOTER] --------ngAfterViewInit: conversation-footer-------- "),this.showEmojiPicker=!0}detectFiles(t){if(this.logger.debug("[CONV-FOOTER] detectFiles: ",t),t){this.selectedFiles=t.target.files,this.logger.debug("[CONV-FOOTER] AppComponent:detectFiles::selectedFiles",this.selectedFiles),this.isFilePendingToUpload=null!=this.selectedFiles,this.logger.debug("[CONV-FOOTER] AppComponent:detectFiles::selectedFiles::isFilePendingToUpload",this.isFilePendingToUpload),this.logger.debug("[CONV-FOOTER] fileChange: ",t.target.files),this.isFilePendingToUpload=!(t.target.files.length<=0);const n=this;if(t.target.files&&t.target.files[0]){const o=t.target.files[0].name,i=t.target.files[0].type,l=new FileReader;n.logger.debug("[CONV-FOOTER] OK preload: ",o,i,l),l.addEventListener("load",function(){if(n.logger.debug("[CONV-FOOTER] addEventListener load",l.result),n.isFileSelected=!0,i.startsWith("image")&&!i.includes("svg")){const E=new Image;n.logger.debug("[CONV-FOOTER] onload ",E),E.src=l.result.toString(),E.title=o,E.onload=function(){n.logger.debug("[CONV-FOOTER] onload image");const V=(new Date).getTime().toString(36);n.arrayFilesLoad[0]={uid:V,file:E,type:i},n.logger.debug("[CONV-FOOTER] OK: ",n.arrayFilesLoad[0]),n.loadFile()}}else{n.logger.debug("[CONV-FOOTER] onload file");const E={src:l.result.toString(),title:o},V=(new Date).getTime().toString(36);n.arrayFilesLoad[0]={uid:V,file:E,type:i},n.logger.debug("[CONV-FOOTER] OK: ",n.arrayFilesLoad[0]),n.loadFile()}},!1),t.target.files[0]&&(l.readAsDataURL(t.target.files[0]),n.logger.debug("[CONV-FOOTER] reader-result: ",t.target.files[0]))}}}loadFile(){if(this.logger.debug("[CONV-FOOTER] that.fileXLoad: ",this.arrayFilesLoad),this.arrayFilesLoad[0]&&this.arrayFilesLoad[0].file){const t=this.arrayFilesLoad[0].file,n=this.arrayFilesLoad[0].uid,o=this.arrayFilesLoad[0].type;let i;this.logger.debug("[CONV-FOOTER] that.fileXLoad: ",o),i=o.startsWith("image")&&!o.includes("svg")?{name:t.title,src:t.src,width:t.width,height:t.height,type:o,uid:n}:{name:t.title,src:t.src,type:o,uid:n},this.logger.debug("[CONV-FOOTER] metadata -------\x3e ",i);const l=this.selectedFiles.item(0);this.onAttachmentFileButtonClicked.emit({attachments:[{metadata:i,file:l}],message:this.textInputTextArea}),this.restoreTextArea(),this.chat21_file.nativeElement.value=""}}uploadSingle(t,n,o){const i=this;document.getElementById("chat21-start-upload-doc").disabled=!0,i.logger.debug("[CONV-FOOTER] AppComponent::uploadSingle::",t,n);const E=new xr(n);this.uploadService.upload(this.senderId,E).then(V=>{i.logger.debug("[CONV-FOOTER] AppComponent::uploadSingle:: downloadURL",V),i.logger.debug(`[CONV-FOOTER] Successfully uploaded file and got download link - ${V}`),t.src=V;let Q=N,se=`[${t.name}](${t.src})`;t.type.startsWith("image")&&!t.type.includes("svg")?(Q=W,se=o):t.type.startsWith("image")&&t.type.includes("svg")||!t.type.startsWith("image")?(Q=M,se=se+"\n"+o):t.type.startsWith("image")||(Q=M,se=se+"\n"+o),i.sendMessage(se,Q,t),i.chat21_file.nativeElement.value="",i.isFilePendingToUpload=!1}).catch(V=>{i.logger.error(`[CONV-FOOTER] uploadSingle:: Failed to upload file and get link - ${V}`),i.isFilePendingToUpload=!1}),i.logger.debug("[CONV-FOOTER] reader-result: ",n)}sendMessage(t,n,o,i){if(o||(o=""),this.onEmojiiPickerShow.emit(!1),this.logger.debug("[CONV-FOOTER] SEND MESSAGE: ",t,n,o,i),t&&""!==t.trim()||n===W||n===M){let l=this.translationMap.get("GUEST_LABEL");const E=this.attributes,V={};if(E)for(const[Me,Ne]of Object.entries(E))V[Me]=Ne;if(i)for(const[Me,Ne]of Object.entries(i))V[Me]=Ne;const Q=this.senderId,se=this.projectid,ge=this.channelType,ce=this.userEmail,ve=this.conversationWith;l=this.userFullname||ce||(V&&V.userFullname?V.userFullname:this.translationMap.get("GUEST_LABEL")),this.onBeforeMessageSent.emit({senderFullname:l,text:t,type:n,metadata:o,conversationWith:ve,recipientFullname:l,attributes:V,projectid:se,channelType:ge});const we=this.conversationHandlerService.sendMessage(t,n,o,ve,l,Q,l,ge,V);this.onAfterSendMessage.emit(we);try{const Me=document.getElementById("chat21-main-message-context");Me.value="",Me.style.height=this.HEIGHT_DEFAULT}catch(Me){this.logger.error("[CONV-FOOTER] > Error :"+Me)}this.restoreTextArea()}}restoreTextArea(){this.resizeInputField();const t=document.getElementById("chat21-main-message-context");this.textInputTextArea="",t&&(t.value="",t.placeholder=this.translationMap.get("LABEL_PLACEHOLDER"),t.style.height>this.HEIGHT_DEFAULT&&document.getElementById("chat21-button-send").style.removeProperty("right"),this.logger.debug("[CONV-FOOTER] AppComponent:restoreTextArea::restoreTextArea::textArea:","restored")),this.setFocusOnId("chat21-main-message-context")}resizeInputField(){try{const t=document.getElementById("chat21-main-message-context");t&&(t.style.height="100%"),t&&"\n"===t.value?(t.value="",t.style.height=this.HEIGHT_DEFAULT):t&&t.scrollHeight>t.offsetHeight?(t.style.height=t.scrollHeight+2+"px",t.style.minHeight=this.HEIGHT_DEFAULT):t&&(t.style.height=this.HEIGHT_DEFAULT),this.onChangeTextArea.emit({textAreaEl:t,minHeightDefault:this.HEIGHT_DEFAULT})}catch(t){this.logger.error("[CONV-FOOTER] > Error :"+t)}}onTextAreaChange(){this.resizeInputField(),this.setWritingMessages(this.textInputTextArea)}onSendPressed(t){this.logger.debug("[CONV-FOOTER] onSendPressed:event",t),t.preventDefault(),this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed::isFilePendingToUpload:",this.isFilePendingToUpload),this.isFilePendingToUpload?(this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed","is a file"),this.loadFile(),this.isFilePendingToUpload=!1,this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed::isFilePendingToUpload:",this.isFilePendingToUpload)):this.textInputTextArea&&this.textInputTextArea.length>0&&(this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed","is a message"),""!==this.textInputTextArea.trim()&&this.sendMessage(this.textInputTextArea,N))}onEmojiiPickerClicked(){this.onEmojiiPickerShow.emit(!this.isEmojiiPickerShow)}addEmoji(t){this.onEmojiiPickerShow.emit(!1),this.textInputTextArea=this.textInputTextArea.trimStart()+t.emoji.native+" ",this.setFocusOnId("chat21-main-message-context")}openNewConversation(){this.onNewConversationButtonClicked.emit()}onContinueConversation(){this.hideTextAreaContent=!1,this.onBackButton.emit(!1),this.restoreTextArea()}onBackButtonFN(){this.onBackButton.emit(!1)}setFocusOnId(t){this.isMobile||setTimeout(function(){const n=document.getElementById(t);n&&(n.setAttribute("value"," "),n.focus())},500)}removeFocusOnId(t){const n=document.getElementById(t);n&&n.blur()}setWritingMessages(t){this.typingService.setTyping(this.conversationWith,t,this.senderId,this.userFullname)}onkeypress(t){const n=t.which||t.keyCode;this.textInputTextArea=document.getElementById("chat21-main-message-context").value,13===n?this.textInputTextArea&&""!==this.textInputTextArea.trim()&&this.sendMessage(this.textInputTextArea,N):9===n&&t.preventDefault()}onkeydown(t){(t.metaKey||t.shiftKey||t.altKey||t.ctrlKey)&&13===(t.which||t.keyCode)&&(t.preventDefault(),this.textInputTextArea+="\r\n",this.resizeInputField())}onPaste(t){this.resizeInputField();const n=(t.clipboardData||t.originalEvent.clipboardData).items;let o=null;this.logger.debug("[CONV-FOOTER] onPaste items ",n);for(const i of n)if(this.logger.debug("[CONV-FOOTER] onPaste item ",i),this.logger.debug("[CONV-FOOTER] onPaste item.type ",i.type),i.type.startsWith("image")){try{this.restoreTextArea()}catch(E){this.logger.error("[CONV-FOOTER] onPaste - error while restoring textArea:",E)}this.logger.debug("[CONV-FOOTER] onPaste item.type",i.type),o=i.getAsFile();const l={target:new ClipboardEvent("").clipboardData||new DataTransfer};l.target.items.add(new File([o],o.name,{type:o.type})),this.logger.debug("[CONV-FOOTER] onPaste data",l),this.logger.debug("[CONV-FOOTER] onPaste file ",o),this.detectFiles(l)}}onDrop(t){const n=t.dataTransfer.files;this.logger.debug("[CONV-FOOTER] onDrop items ",n);for(const i of n){this.logger.debug("[CONV-FOOTER] onDrop item ",i),this.logger.debug("[CONV-FOOTER] onDrop item.type ",i.type);const l={target:{files:new DataTransfer}};l.target.files=n,this.logger.debug("[CONV-FOOTER] onDrop data",l),this.logger.debug("[CONV-FOOTER] onDrop file ",null),this.detectFiles(l)}}}St.\u0275fac=function(t){return new(t||St)(e.Y36(Pe),e.Y36(Xe),e.Y36(je),e.Y36(Ve))},St.\u0275cmp=e.Xpm({type:St,selectors:[["chat-conversation-footer"]],viewQuery:function(t,n){if(1&t&&e.Gf(Mr,5),2&t){let o;e.iGM(o=e.CRH())&&(n.chat21_file=o.first)}},inputs:{conversationWith:"conversationWith",attributes:"attributes",senderId:"senderId",tenant:"tenant",projectid:"projectid",channelType:"channelType",userFullname:"userFullname",userEmail:"userEmail",showAttachmentButton:"showAttachmentButton",showContinueConversationButton:"showContinueConversationButton",isConversationArchived:"isConversationArchived",hideTextAreaContent:"hideTextAreaContent",hideTextReply:"hideTextReply",isMobile:"isMobile",isEmojiiPickerShow:"isEmojiiPickerShow",footerMessagePlaceholder:"footerMessagePlaceholder",fileUploadAccept:"fileUploadAccept",stylesMap:"stylesMap",translationMap:"translationMap",dropEvent:"dropEvent"},outputs:{onEmojiiPickerShow:"onEmojiiPickerShow",onBeforeMessageSent:"onBeforeMessageSent",onAfterSendMessage:"onAfterSendMessage",onChangeTextArea:"onChangeTextArea",onAttachmentFileButtonClicked:"onAttachmentFileButtonClicked",onNewConversationButtonClicked:"onNewConversationButtonClicked",onBackButton:"onBackButton"},features:[e.TTD],decls:5,vars:6,consts:[["id","floating-container","class","fade-in-bottom","start-focus-chat21-conversation-component","",4,"ngIf"],["class","visible-text-area",3,"disabled",4,"ngIf"],[4,"ngIf"],[1,"emoji-container"],["id","emoji-mart","class","emoji-mart",3,"showPreview","color","perLine","totalFrequentLines","enableSearch","darkMode","include","emojiSelect",4,"ngIf"],["id","floating-container","start-focus-chat21-conversation-component","",1,"fade-in-bottom"],["tabindex","1040","aflistconv","",1,"c21-button-primary",3,"ngStyle","click"],["aflistconv",""],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",3,"ngStyle"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",3,"ngStyle"],[1,"v-align-center","c21-label-button"],[1,"clear"],["tabindex","1040","class","c21-button-primary",3,"ngStyle","click",4,"ngIf"],["tabindex","1040",1,"c21-button-primary",3,"ngStyle","click"],[1,"visible-text-area"],["start-focus-chat21-conversation-component","","inputTextArea","","tabindex","1501","aria-labelledby","altTextArea","rows","1","id","chat21-main-message-context",1,"f21textarea","c21-button-clean",3,"ngModel","ngModelChange","keypress","keydown","paste"],["textbox",""],["div_attached",""],["tabindex","1502","aria-label","allegati","for","chat21-file","class","chat21-textarea-button","id","chat21-start-upload-doc",3,"active",4,"ngIf"],["tabindex","-1","id","chat21-button-send",1,"chat21-textarea-button",3,"click"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","height","24","width","24","viewBox","0 0 24 24",0,"xml","space","preserve",2,"enable-background","new 0 0 24 24"],["d","M1.8,18.9V1.7L22,10.3L1.8,18.9z M3.9,15.6l12.6-5.4L3.9,4.9v3.7l6.4,1.6l-6.4,1.6V15.6z M3.9,15.6V4.9v7V15.6z"],["tabindex","1504","aria-label","emojii","for","chat21-emojii","id","chat21-emoticon-picker",1,"chat21-textarea-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 28 28"],["d","M0 0h24v24H0V0z","fill","none"],["cx","15.5","cy","9.5","r","1.5"],["cx","8.5","cy","9.5","r","1.5"],["d","M12 16c-1.48 0-2.75-.81-3.45-2H6.88c.8 2.05 2.79 3.5 5.12 3.5s4.32-1.45 5.12-3.5h-1.67c-.7 1.19-1.97 2-3.45 2zm-.01-14C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"],["tabindex","1502","aria-label","allegati","for","chat21-file","id","chat21-start-upload-doc",1,"chat21-textarea-button"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 28 28","transform","rotate(45)"],["d","M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"],["tabindex","1503","type","file","aria-label","seleziona allegato","name","chat21-file","id","chat21-file",1,"inputfile",3,"accept","ngStyle","change"],["chat21_file",""],["id","emoji-mart",1,"emoji-mart",3,"showPreview","color","perLine","totalFrequentLines","enableSearch","darkMode","include","emojiSelect"]],template:function(t,n){1&t&&(e.YNc(0,Pr,10,12,"div",0),e.YNc(1,kr,4,6,"div",1),e.YNc(2,Rr,14,5,"div",2),e.TgZ(3,"div",3),e.YNc(4,Lr,1,7,"emoji-mart",4),e.qZA()),2&t&&(e.Q6J("ngIf",n.hideTextAreaContent),e.xp6(1),e.Q6J("ngIf",!n.hideTextAreaContent),e.xp6(1),e.Q6J("ngIf",!n.hideTextAreaContent),e.xp6(1),e.Udp("visibility",n.isEmojiiPickerShow?"visible":"hidden"),e.xp6(1),e.Q6J("ngIf",n.showEmojiPicker))},dependencies:[de.O5,de.PC,Ce.Fj,Ce.JJ,Ce.On,No.qP],styles:[".visible-text-area[_ngcontent-%COMP%]{pointer-events:auto;border-radius:16px;background-color:#f6f7fb}.visible-text-area.disabled[_ngcontent-%COMP%]{background-color:#e8e9ed}.chat21-textarea-button[_ngcontent-%COMP%]{fill:#5f6368;pointer-events:auto}textarea[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]:visited, textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:active{all:unset}#button[_ngcontent-%COMP%]{position:absolute;bottom:12px;display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:1}#button.chat-open[_ngcontent-%COMP%]:not(.sidebar){right:5px;left:auto;background-color:#fff}#button[_ngcontent-%COMP%]:not(.sidebar)   .buttonWave[_ngcontent-%COMP%]{position:absolute;z-index:-1;width:60px;height:60px}#button-body[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:28px;border-color:transparent;display:inherit;align-items:center;justify-content:center;pointer-events:initial;transition:all .2s ease-in-out 0s;position:relative;box-shadow:#03060c80 0 4px 10px}#chat21-buttonToBottom[_ngcontent-%COMP%]{display:flex;position:relative;margin-right:-25px;margin-top:-40px;float:right;width:30px;height:30px;border-radius:50%;z-index:1;cursor:pointer;background-color:#fff;border:1px solid rgba(191,191,191,.2);text-align:center}#chat21-buttonToBottom[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:auto;fill:#aaa}#chat21-buttonToBottom[_ngcontent-%COMP%]:hover{background-color:#2a6ac1;opacity:1!important;transition:all .45s ease-in-out!important;-moz-transition:all .45s ease-in-out!important;-webkit-transition:all .45s ease-in-out!important;border:1px solid #ffffff}#chat21-buttonToBottom[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:#fff}textarea[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]:visited, textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:active{all:unset}#chat21-main-message-context[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word;resize:horizontal;overflow-y:auto;box-sizing:border-box;color:#1a1a1a;min-width:100%;outline:0;resize:none;font-size:1.4em;line-height:1.4em;font-weight:300;max-height:110px;min-height:auto;height:20px;padding:0 12px;margin:10px 0;border:none}#chat21-main-message-context[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}#chat21-main-message-context[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}#chat21-main-message-context[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}.chat21-textarea-button[_ngcontent-%COMP%]{position:absolute;display:block;height:56px;bottom:22px;opacity:.3;cursor:initial}.chat21-textarea-button.active[_ngcontent-%COMP%]{opacity:1;cursor:pointer}.chat21-textarea-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover{background:rgba(240,240,240,.4)!important;opacity:1!important;transition:all .45s ease-in-out 0s!important;-moz-transition:all .45s ease-in-out 0s!important;-webkit-transition:all .45s ease-in-out 0s!important;padding:0;margin:0;border-radius:50%}.chat21-back-button[_ngcontent-%COMP%]{position:absolute;display:block;height:56px;cursor:pointer}.chat21-back-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover{background:rgba(240,240,240,.4)!important;opacity:1!important;transition:all .45s ease-in-out 0s!important;-moz-transition:all .45s ease-in-out 0s!important;-webkit-transition:all .45s ease-in-out 0s!important;padding:0;margin:0;border-radius:50%}#chat21-button-send[_ngcontent-%COMP%]{right:8px;bottom:0}#chat21-file[_ngcontent-%COMP%]{left:8px;bottom:0}#chat21-emoticon-picker[_ngcontent-%COMP%]{left:36px;bottom:0}#chat21-start-upload-doc[_ngcontent-%COMP%], #chat21-start-mic[_ngcontent-%COMP%], #chat21-back-button[_ngcontent-%COMP%]{left:8px;bottom:0}#floating-container[_ngcontent-%COMP%]{width:100%;border-top:0px solid #eeeeee;display:inline-flex;align-items:center;justify-content:center;box-shadow:none;vertical-align:top;text-align:center}#floating-container[_ngcontent-%COMP%]   .c21-label-button[_ngcontent-%COMP%]{margin-left:8px;font-weight:400;font-size:1.2em}#floating-container[_ngcontent-%COMP%]   .c21-button-primary[_ngcontent-%COMP%]{height:36px;margin:5px 3px}#floating-container[_ngcontent-%COMP%]   .c21-waiting-time[_ngcontent-%COMP%]{font-size:1.3em;font-weight:200;padding:0 24px 5px}.fade-in-bottom[_ngcontent-%COMP%]{animation:fade-in-bottom .5s cubic-bezier(.6,-.28,.735,.045) 0s}.emoji-container[_ngcontent-%COMP%]{height:312px;position:absolute;overflow:hidden;width:93%;bottom:100%;z-index:10;left:10px;box-shadow:0 -15px 20px -13px #00000061;-webkit-box-shadow:0px -15px 20px -13px rgba(0,0,0,.38)}.emoji-mart[_ngcontent-%COMP%]{position:absolute;border:none;margin:-2px -2px 0}"]});const Nr=function(r){return{disabled:r}};class an{constructor(t){this.elementRef=t,this.isConversationArchived=!0,this.onButtonClicked=new e.vpe,this.type="action"}ngOnInit(){}ngOnChanges(t){this.fontSize&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--buttonFontSize",this.fontSize),this.backgroundColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--backgroundColor",this.backgroundColor),this.textColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--textColor",this.textColor),this.hoverBackgroundColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--hoverBackgroundColor",this.hoverBackgroundColor),this.hoverTextColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--hoverTextColor",this.hoverTextColor)}onMouseOver(t){}onMouseOut(t){}actionButtonAction(){if(this.button&&this.button.action&&""!==this.button.action){const t=this.elementRef.nativeElement.querySelector(".action");t&&(t.classList.contains("active")||t.classList.add("active"),setTimeout(function(){t.classList.contains("active")&&t.classList.remove("active")},400)),this.onButtonClicked.emit({target:this,currentTarget:this})}}}function Fr(r,t){1&r&&(e.TgZ(0,"span",4),e.O4$(),e.TgZ(1,"svg",5),e._UZ(2,"path",6)(3,"path",7),e.qZA()())}function Br(r,t){1&r&&(e.TgZ(0,"span",8),e.O4$(),e.TgZ(1,"svg",9),e._UZ(2,"path",6)(3,"path",7),e.qZA()())}an.\u0275fac=function(t){return new(t||an)(e.Y36(e.SBq))},an.\u0275cmp=e.Xpm({type:an,selectors:[["chat-action-button-attachment"]],inputs:{button:"button",isConversationArchived:"isConversationArchived",fontSize:"fontSize",backgroundColor:"backgroundColor",textColor:"textColor",hoverBackgroundColor:"hoverBackgroundColor",hoverTextColor:"hoverTextColor"},outputs:{onButtonClicked:"onButtonClicked"},features:[e.TTD],decls:3,vars:5,consts:[["id","actionButton",1,"button-in-msg","action",3,"ngClass","title","click","mouseover","mouseout"],["actionButton",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0,1),e.NdJ("click",function(){return n.actionButtonAction()})("mouseover",function(i){return n.onMouseOver(i)})("mouseout",function(i){return n.onMouseOut(i)}),e._uU(2),e.qZA()),2&t&&(e.s9C("title",null==n.button?null:n.button.value),e.Q6J("ngClass",e.VKq(3,Nr,n.isConversationArchived)),e.xp6(2),e.hij(" ",null==n.button?null:n.button.value,"\n"))},dependencies:[de.mk],styles:['[_nghost-%COMP%]{--backgroundColor: rgb(42, 106, 193);--textColor: rgb(98, 168, 234);--hoverBackgroundColor: rgb(98, 168, 234);--hoverTextColor: rgb(42, 106, 193);--buttonFontSize: 15px;--max-width: 280px}.button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important;position:relative;max-width:var(--max-width);min-width:inherit;cursor:pointer;border:1px solid var(--textColor);border-radius:20px;margin:3px;background:var(--backgroundColor);overflow:hidden;font-family:Muli,sans-serif;font-size:var(--buttonFontSize);text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--textColor);line-height:16px}.action[_ngcontent-%COMP%]{background:var(--backgroundColor);transition:background-color .6s ease}.action[_ngcontent-%COMP%]:focus, .action[_ngcontent-%COMP%]:hover{color:var(--hoverTextColor);background:var(--hoverBackgroundColor);transform:scale(1.05)}.action[_ngcontent-%COMP%]:focus   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]:hover   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--hoverTextColor)}.action[_ngcontent-%COMP%]:after{content:"";position:absolute;width:0;height:0;top:50%;left:50%;transform-style:flat;transform:translate3d(-50%,-50%,0);background:rgba(255,255,255,.2);border-radius:100%;transition:width .5s ease,height .5s ease}.action.active[_ngcontent-%COMP%]:after{width:200px;height:200px}.disabled[_ngcontent-%COMP%]{pointer-events:none}']});class ln{constructor(t){this.elementRef=t,this.onButtonClicked=new e.vpe,this.type="url"}ngOnInit(){}ngOnChanges(t){this.fontSize&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--buttonFontSize",this.fontSize),this.backgroundColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--backgroundColor",this.backgroundColor),this.textColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--textColor",this.textColor),this.hoverBackgroundColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--hoverBackgroundColor",this.hoverBackgroundColor),this.hoverTextColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--hoverTextColor",this.hoverTextColor)}onMouseOver(t){}onMouseOut(t){}actionButtonUrl(){this.button&&this.button.link&&""!==this.button.link&&this.onButtonClicked.emit({target:this,currentTarget:this})}}ln.\u0275fac=function(t){return new(t||ln)(e.Y36(e.SBq))},ln.\u0275cmp=e.Xpm({type:ln,selectors:[["chat-link-button-attachment"]],inputs:{button:"button",fontSize:"fontSize",backgroundColor:"backgroundColor",textColor:"textColor",hoverBackgroundColor:"hoverBackgroundColor",hoverTextColor:"hoverTextColor"},outputs:{onButtonClicked:"onButtonClicked"},features:[e.TTD],decls:5,vars:4,consts:[[1,"button-in-msg","url",3,"title","click","mouseover","mouseout"],["class","icon-button-action",4,"ngIf"],["class","icon-button-action-self",4,"ngIf"],[1,"clear"],[1,"icon-button-action"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","black","width","18px","height","18px",2,"transform","rotateZ(45deg)"],["d","M0 0h24v24H0z","fill","none"],["d","M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"],[1,"icon-button-action-self"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","black","width","18px","height","18px",2,"transform","rotateZ(90deg)"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return n.actionButtonUrl()})("mouseover",function(i){return n.onMouseOver(i)})("mouseout",function(i){return n.onMouseOut(i)}),e.YNc(1,Fr,4,0,"span",1),e.YNc(2,Br,4,0,"span",2),e._uU(3),e._UZ(4,"div",3),e.qZA()),2&t&&(e.s9C("title",null==n.button?null:n.button.value),e.xp6(1),e.Q6J("ngIf","self"!==(null==n.button?null:n.button.target)),e.xp6(1),e.Q6J("ngIf","self"===(null==n.button?null:n.button.target)),e.xp6(1),e.hij(" ",null==n.button?null:n.button.value," "))},dependencies:[de.O5],styles:["[_nghost-%COMP%]{--backgroundColor: rgb(42, 106, 193);--textColor: rgb(98, 168, 234);--hoverBackgroundColor: rgb(98, 168, 234);--hoverTextColor: rgb(42, 106, 193);--buttonFontSize: 15px;--max-width: 280px}.button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important;position:relative;max-width:var(--max-width);min-width:inherit;cursor:pointer;border:1px solid var(--textColor);border-radius:20px;margin:3px;background:var(--backgroundColor);overflow:hidden;font-family:Muli,sans-serif;font-size:var(--buttonFontSize);text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--textColor);line-height:16px}.url[_ngcontent-%COMP%]{transition:background-color .6s ease}.url[_ngcontent-%COMP%]   .icon-button-action[_ngcontent-%COMP%]{position:absolute;top:-1px;right:1px}.url[_ngcontent-%COMP%]   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--textColor)}.url[_ngcontent-%COMP%]   .icon-button-action-self[_ngcontent-%COMP%]{position:absolute;right:1px}.url[_ngcontent-%COMP%]   .icon-button-action-self[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--textColor)}.url[_ngcontent-%COMP%]:focus, .url[_ngcontent-%COMP%]:hover{color:var(--hoverTextColor);background:var(--hoverBackgroundColor);transform:scale(1.05)}.url[_ngcontent-%COMP%]:focus   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .url[_ngcontent-%COMP%]:focus   .icon-button-action-self[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .url[_ngcontent-%COMP%]:hover   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .url[_ngcontent-%COMP%]:hover   .icon-button-action-self[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--hoverTextColor)}"]});const Ur=function(r){return{disabled:r}};class cn{constructor(t){this.elementRef=t,this.onButtonClicked=new e.vpe,this.type="text"}ngOnInit(){}ngOnChanges(t){this.fontSize&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--buttonFontSize",this.fontSize),this.backgroundColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--backgroundColor",this.backgroundColor),this.textColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--textColor",this.textColor),this.hoverBackgroundColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--hoverBackgroundColor",this.hoverBackgroundColor),this.hoverTextColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--hoverTextColor",this.hoverTextColor)}onMouseOver(t){}onMouseOut(t){}actionButtonText(){this.onButtonClicked.emit({target:this,currentTarget:this})}}function Dr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-text-button-attachment",6),e.NdJ("onButtonClicked",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.returnOnAttachmentButtonClicked(i))}),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("button",n)("isConversationArchived",o.isConversationArchived)("fontSize",o.stylesMap.get("buttonFontSize"))("backgroundColor",o.stylesMap.get("buttonBackgroundColor"))("textColor",o.stylesMap.get("buttonTextColor"))("hoverBackgroundColor",o.stylesMap.get("buttonHoverBackgroundColor"))("hoverTextColor",o.stylesMap.get("buttonHoverTextColor"))}}function Hr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-link-button-attachment",7),e.NdJ("onButtonClicked",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.returnOnAttachmentButtonClicked(i))}),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("button",n)("fontSize",o.stylesMap.get("buttonFontSize"))("backgroundColor",o.stylesMap.get("buttonBackgroundColor"))("textColor",o.stylesMap.get("buttonTextColor"))("hoverBackgroundColor",o.stylesMap.get("buttonHoverBackgroundColor"))("hoverTextColor",o.stylesMap.get("buttonHoverTextColor"))}}function Zr(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-action-button-attachment",6),e.NdJ("onButtonClicked",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.returnOnAttachmentButtonClicked(i))}),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("button",n)("isConversationArchived",o.isConversationArchived)("fontSize",o.stylesMap.get("buttonFontSize"))("backgroundColor",o.stylesMap.get("buttonBackgroundColor"))("textColor",o.stylesMap.get("buttonTextColor"))("hoverBackgroundColor",o.stylesMap.get("buttonHoverBackgroundColor"))("hoverTextColor",o.stylesMap.get("buttonHoverTextColor"))}}function zr(r,t){if(1&r&&(e.TgZ(0,"span",3),e.YNc(1,Dr,1,7,"chat-text-button-attachment",4),e.YNc(2,Hr,1,6,"chat-link-button-attachment",5),e.YNc(3,Zr,1,7,"chat-action-button-attachment",4),e.qZA()),2&r){const n=t.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf","text"===n.type&&!0===o.isLastMessage),e.xp6(1),e.Q6J("ngIf","url"===n.type),e.xp6(1),e.Q6J("ngIf","action"===n.type&&!0===o.isLastMessage)}}cn.\u0275fac=function(t){return new(t||cn)(e.Y36(e.SBq))},cn.\u0275cmp=e.Xpm({type:cn,selectors:[["chat-text-button-attachment"]],inputs:{button:"button",isConversationArchived:"isConversationArchived",fontSize:"fontSize",backgroundColor:"backgroundColor",textColor:"textColor",hoverBackgroundColor:"hoverBackgroundColor",hoverTextColor:"hoverTextColor"},outputs:{onButtonClicked:"onButtonClicked"},features:[e.TTD],decls:2,vars:5,consts:[[1,"button-in-msg","text",3,"ngClass","title","click","mouseover","mouseout"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return n.actionButtonText()})("mouseover",function(i){return n.onMouseOver(i)})("mouseout",function(i){return n.onMouseOut(i)}),e._uU(1),e.qZA()),2&t&&(e.s9C("title",null==n.button?null:n.button.value),e.Q6J("ngClass",e.VKq(3,Ur,n.isConversationArchived)),e.xp6(1),e.hij(" ",null==n.button?null:n.button.value,"\n"))},dependencies:[de.mk],styles:["[_nghost-%COMP%]{--backgroundColor: rgb(42, 106, 193);--textColor: rgb(98, 168, 234);--hoverBackgroundColor: rgb(98, 168, 234);--hoverTextColor: rgb(42, 106, 193);--buttonFontSize: 15px;--max-width: 280px}.button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important;position:relative;max-width:var(--max-width);min-width:inherit;cursor:pointer;border:1px solid var(--textColor);border-radius:20px;margin:3px;background:var(--backgroundColor);overflow:hidden;font-family:Muli,sans-serif;font-size:var(--buttonFontSize);text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--textColor);line-height:16px}.text[_ngcontent-%COMP%]{transition:background-color .6s ease}.text[_ngcontent-%COMP%]:focus, .text[_ngcontent-%COMP%]:hover{color:var(--hoverTextColor);background:var(--hoverBackgroundColor);transform:scale(1.05)}.text[_ngcontent-%COMP%]:focus   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .text[_ngcontent-%COMP%]:hover   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#1a1a1a}.disabled[_ngcontent-%COMP%]{pointer-events:none}"]});class hn{constructor(){this.onAttachmentButtonClicked=new e.vpe,this.onElementRendered=new e.vpe}ngOnInit(){this.getAttachmentButton()}getAttachmentButton(){if(this.message&&this.message.attributes&&this.message.attributes.attachment){try{this.type=this.message.attributes.attachment.type}catch{return}try{this.buttons=this.message.attributes.attachment.buttons}catch{return}}}ngAfterViewInit(){this.onElementRendered.emit({element:"attachment",status:!0})}returnOnAttachmentButtonClicked(t){t&&t.target&&this.onAttachmentButtonClicked.emit({target:t.target,message:this.message,currentTarget:this})}}hn.\u0275fac=function(t){return new(t||hn)},hn.\u0275cmp=e.Xpm({type:hn,selectors:[["chat-message-attachment"]],inputs:{message:"message",isConversationArchived:"isConversationArchived",isLastMessage:"isLastMessage",stylesMap:"stylesMap"},outputs:{onAttachmentButtonClicked:"onAttachmentButtonClicked",onElementRendered:"onElementRendered"},decls:3,vars:1,consts:[["id","buttons-in-message"],[1,"buttons-wrapper"],["class","div-button",4,"ngFor","ngForOf"],[1,"div-button"],["class","div-button",3,"button","isConversationArchived","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked",4,"ngIf"],["class","div-button",3,"button","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked",4,"ngIf"],[1,"div-button",3,"button","isConversationArchived","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked"],[1,"div-button",3,"button","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,zr,4,3,"span",2),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngForOf",n.buttons))},dependencies:[de.sg,de.O5,an,ln,cn],styles:["#buttons-in-message[_ngcontent-%COMP%]{text-align:right;display:block;margin-right:16px;height:auto;width:85%;float:right}#buttons-in-message[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]{margin-top:0;display:flex;flex-wrap:wrap;justify-content:flex-end;width:100%;border:none}#buttons-in-message[_ngcontent-%COMP%]   .div-button[_ngcontent-%COMP%]{display:inline-block}#buttons-in-message[_ngcontent-%COMP%]   .div-button[_ngcontent-%COMP%]   .button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important}#buttons-in-message.align-left[_ngcontent-%COMP%]{text-align:left;margin:4px 50px}"]});var to=be(158);const jr=function(r,t){return{width:r,height:t}};function Vr(r,t){if(1&r&&e._UZ(0,"div",3),2&r){const n=e.oxw();e.Q6J("ngStyle",e.WLB(1,jr,n.width,n.height))}}const Gr=function(r,t){return{"max-width":"100%",width:r,height:t}},qr=function(r){return{isLoadingImage:r}};class dn{constructor(t){this.sanitizer=t,this.onElementRendered=new e.vpe,this.url=null,this.loading=!0}ngOnInit(){this.metadata&&this.metadata.src&&(this.url=this.sanitizer.bypassSecurityTrustResourceUrl(this.metadata.src))}ngOnDestroy(){this.url=null}onLoaded(t){this.loading=!1,this.onElementRendered.emit({element:"frame",status:!0})}}dn.\u0275fac=function(t){return new(t||dn)(e.Y36(S.H7))},dn.\u0275cmp=e.Xpm({type:dn,selectors:[["chat-frame"]],inputs:{metadata:"metadata",width:"width",height:"height"},outputs:{onElementRendered:"onElementRendered"},decls:3,vars:9,consts:[[3,"ngStyle"],["class","loader",3,"ngStyle",4,"ngIf"],["allowfullscreen","","width","100%","height","100%",3,"ngClass","src","load"],[1,"loader",3,"ngStyle"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Vr,1,4,"div",1),e.TgZ(2,"iframe",2),e.NdJ("load",function(i){return n.onLoaded(i)}),e.qZA()()),2&t&&(e.Q6J("ngStyle",e.WLB(4,Gr,n.width,n.height)),e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngClass",e.VKq(7,qr,n.loading))("src",n.url,e.uOi))},dependencies:[de.mk,de.O5,de.PC],styles:["[_nghost-%COMP%]{--borderRadius: 8px}.loader[_ngcontent-%COMP%]{float:left;z-index:1000;border-radius:var(--borderRadius);background-image:linear-gradient(90deg,transparent 0px,#e8e8e8 40px,transparent 80px);background-size:600px;animation:_ngcontent-%COMP%_shine-loader 1.6s infinite linear}.isLoadingImage[_ngcontent-%COMP%]{display:none}iframe[_ngcontent-%COMP%]{border:none;border-radius:var(--borderRadius)}@keyframes _ngcontent-%COMP%_shine-loader{0%{background-position:-32px}40%,to{background-position:208px}}"]});class un{constructor(t){this.sanitizer=t}transform(t,n){return this.sanitizer.bypassSecurityTrustHtml(t)}}un.\u0275fac=function(t){return new(t||un)(e.Y36(S.H7,16))},un.\u0275pipe=e.Yjl({name:"safeHtml",type:un,pure:!0});const Wr=["htmlCode"];class gn{constructor(t){this.elementRef=t}ngOnInit(){}ngOnChanges(t){this.fontSize&&this.elementRef.nativeElement.style.setProperty("--buttonFontSize",this.fontSize),this.themeColor&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.themeColor),this.foregroundColor&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.foregroundColor)}}gn.\u0275fac=function(t){return new(t||gn)(e.Y36(e.SBq))},gn.\u0275cmp=e.Xpm({type:gn,selectors:[["chat-html"]],viewQuery:function(t,n){if(1&t&&e.Gf(Wr,5),2&t){let o;e.iGM(o=e.CRH())&&(n.container=o.first)}},inputs:{htmlText:"htmlText",fontSize:"fontSize",themeColor:"themeColor",foregroundColor:"foregroundColor"},features:[e.TTD],decls:3,vars:3,consts:[["id","htmlCode",3,"innerHTML"],["htmlCode",""]],template:function(t,n){1&t&&(e._UZ(0,"div",0,1),e.ALo(2,"safeHtml")),2&t&&e.Q6J("innerHTML",e.lcZ(2,1,n.htmlText),e.oJD)},dependencies:[un],styles:["[_ngcontent-%COMP%]:root{--themeColor: rgb(42, 106, 193);--foregroundColor: #ffffff;--buttonFontSize: 15px}  .button-html{padding:8px 16px!important;position:relative;max-width:300px;min-width:inherit;cursor:pointer!important;border:1px solid var(--themeColor);border-radius:20px;margin:3px;background:transparent;overflow:hidden;font-family:Muli,sans-serif!important;font-size:var(--buttonFontSize)!important;text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--themeColor);line-height:16px}  .url{transition:background-color .6s ease}  .url .icon-button-action{position:absolute;top:-1px;right:1px}  .url .icon-button-action svg{fill:var(--themeColor)}  .url .icon-button-action-self{position:absolute;right:1px}  .url .icon-button-action-self svg{fill:var(--themeColor)}  .url:focus,   .url:hover{color:#fff;background:var(--themeColor)}  .url:focus .icon-button-action svg,   .url:focus .icon-button-action-self svg,   .url:hover .icon-button-action svg,   .url:hover .icon-button-action-self svg{fill:#fff}  .url:active{font-size:20px}  .text-html{font-size:1.4em;margin:0;padding:8px;font-style:normal;letter-spacing:normal;font-stretch:normal;font-variant:normal;font-weight:300;overflow:hidden}"]});var Yr=be(4327);const Bo=function(r,t){return{width:r,height:t}};function Jr(r,t){if(1&r&&e._UZ(0,"div",4),2&r){const n=e.oxw();e.Q6J("ngStyle",e.WLB(1,Bo,n.width,n.height))}}function Qr(r,t){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Oqu(n.tooltipMessage)}}const Kr=function(r){return{isLoadingImage:r}};class Pt{constructor(){this.onElementRendered=new e.vpe,this.loading=!0,this.tooltipOptions={"show-delay":0,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},this.popupUrl=Jn}ngOnInit(){}onLoaded(t){this.loading=!1,this.onElementRendered.emit({element:"image",status:!0})}downloadImage(t,n){console.log("Image COMP - IMAGE URL ",t),console.log("Image COMP - IMAGE FILENAME ",n),n||(n=decodeURIComponent(decodeURIComponent(t).split("/").pop())),(0,Yr.saveAs)(t,n)}onClickImage(){}}Pt.\u0275fac=function(t){return new(t||Pt)},Pt.\u0275cmp=e.Xpm({type:Pt,selectors:[["chat-image"]],inputs:{metadata:"metadata",width:"width",height:"height"},outputs:{onElementRendered:"onElementRendered"},decls:5,vars:9,consts:[[1,"c21-img-container"],["class","loader",3,"ngStyle",4,"ngIf"],[1,"message-contentX","message-content-imageX",3,"ngClass","ngStyle","src","load","click"],["timeTooltipRight",""],[1,"loader",3,"ngStyle"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Jr,1,4,"div",1),e.TgZ(2,"img",2),e.NdJ("load",function(i){return n.onLoaded(i)})("click",function(){return n.downloadImage(n.metadata.src,n.metadata.name)}),e.qZA(),e.YNc(3,Qr,2,1,"ng-template",null,3,e.W1O),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngClass",e.VKq(4,Kr,n.loading))("ngStyle",e.WLB(6,Bo,n.width,n.height))("src",n.metadata.src,e.LSH))},dependencies:[de.mk,de.O5,de.PC],styles:["[_nghost-%COMP%]{--borderRadius: 8px}img[_ngcontent-%COMP%]{border-radius:var(--borderRadius);margin-bottom:0;max-width:calc(100% - 6px);width:auto;height:auto;object-fit:cover;transition:transform .3s ease-in-out 0s}.c21-img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{cursor:pointer;transform:scale(1.05)}.c21-img-container[_ngcontent-%COMP%]{text-align:center;width:100%;overflow:hidden;border-radius:var(--borderRadius)}.demo-content[_ngcontent-%COMP%]{position:relative}.isLoadingImage[_ngcontent-%COMP%]{display:none}.loader[_ngcontent-%COMP%]{float:left;z-index:1000;border-radius:var(--borderRadius);background-image:linear-gradient(90deg,transparent 0px,#e8e8e8 40px,transparent 80px);background-size:600px;animation:_ngcontent-%COMP%_shine-loader 1.6s infinite linear}@keyframes _ngcontent-%COMP%_shine-loader{0%{background-position:-32px}40%,to{background-position:208px}}"]});class kt{transform(t,n){return(t=function ti(r){return r.replace(/[\n\r]/g,"<br>")}(t=function ei(r){return String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}(t))).trim()}}kt.\u0275fac=function(t){return new(t||kt)},kt.\u0275pipe=e.Yjl({name:"htmlEntitiesEncode",type:kt,pure:!0});var Hn=be(8645);class bt{transform(t){const n=new Hn.TU.Renderer;return n.link=function(o,i,l){return Hn.TU.Renderer.prototype.link.call(this,o,i,l).replace("<a",'<a target="_blank" ')},Hn.TU.setOptions({renderer:n}),t&&t.length>0?(0,Hn.TU)(t):t}}bt.\u0275fac=function(t){return new(t||bt)},bt.\u0275pipe=e.Yjl({name:"marked",type:bt,pure:!0});class pn{constructor(){this.htmlEnabled=!1,this.onBeforeMessageRender=new e.vpe,this.onAfterMessageRender=new e.vpe}ngOnInit(){}printMessage(t,n,o){const i={messageEl:n,component:o};this.onBeforeMessageRender.emit(i);const l=t;return this.onAfterMessageRender.emit(i),l}}pn.\u0275fac=function(t){return new(t||pn)},pn.\u0275cmp=e.Xpm({type:pn,selectors:[["chat-text"]],inputs:{text:"text",htmlEnabled:"htmlEnabled",color:"color",fontSize:"fontSize",fontFamily:"fontFamily"},outputs:{onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender"},decls:4,vars:9,consts:[[1,"message_innerhtml","marked",3,"innerHTML"],["messageEl",""]],template:function(t,n){if(1&t&&(e._UZ(0,"p",0,1),e.ALo(2,"marked"),e.ALo(3,"htmlEntitiesEncode")),2&t){const o=e.MAs(1);e.Udp("color",n.color)("font-size",n.fontSize),e.Q6J("innerHTML",e.lcZ(2,5,e.lcZ(3,7,n.printMessage(n.text,o,n))),e.oJD)}},dependencies:[kt,bt],styles:[".message_innerhtml[_ngcontent-%COMP%]{margin:0}.message_innerhtml.marked[_ngcontent-%COMP%]{padding:8px;margin-block-start:-1em!important;margin-block-end:-1em!important}.message_innerhtml[_ngcontent-%COMP%]   .text-message[_ngcontent-%COMP%]{padding-top:14px}p[_ngcontent-%COMP%]{font-size:1.4em;margin:0;padding:14px;line-height:1.4em;font-style:normal;letter-spacing:normal;font-stretch:normal;font-variant:normal;font-weight:300;overflow:hidden}"]});const $r=function(r){return{margin:r}};function Xr(r,t){if(1&r&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.Udp("color",n.convertColorToRGBA(n.fontColor,65)),e.Q6J("ngStyle",e.VKq(4,$r,n.isImage(n.message)||n.isFrame(n.message)?"10px 16px 8px 16px":"10px 8px 0px 8px")),e.xp6(1),e.hij(" ",null==n.message?null:n.message.sender_fullname," ")}}function es(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-image",5),e.NdJ("onElementRendered",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onElementRenderedFN(i))}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("metadata",n.message.metadata)("width",null==n.sizeImage?null:n.sizeImage.width)("height",null==n.sizeImage?null:n.sizeImage.height)}}function ts(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-frame",5),e.NdJ("onElementRendered",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onElementRenderedFN(i))}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("metadata",n.message.metadata)("width",null==n.sizeImage?null:n.sizeImage.width)("height",null==n.sizeImage?null:n.sizeImage.height)}}function ns(r,t){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"amTimeAgo"),e.ALo(3,"amDateFormat"),e.ALo(4,"amLocal"),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.AsE("",e.lcZ(2,2,n.message.timestamp)," (",e.xi3(3,4,e.lcZ(4,7,n.message.timestamp),"L HH:mm:ss"),")")}}function os(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-text",10),e.NdJ("onBeforeMessageRender",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onBeforeMessageRenderFN(i))})("onAfterMessageRender",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onAfterMessageRenderFN(i))}),e.qZA()}if(2&r){const n=e.oxw(2);e.Q6J("text",null==n.message?null:n.message.text)("color",n.fontColor)("fontSize",n.fontSize)("fontFamily",n.fontFamily)}}function is(r,t){if(1&r&&e._UZ(0,"chat-html",11),2&r){const n=e.oxw(2);e.Q6J("htmlText",null==n.message?null:n.message.text)("fontSize",n.stylesMap.get("buttonFontSize"))("themeColor",n.stylesMap.get("themeColor"))("foregroundColor",n.stylesMap.get("foregroundColor"))}}function rs(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",6),e.NdJ("click",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.handleTooltipEvents(i))}),e.YNc(1,ns,5,9,"ng-template",null,7,e.W1O),e.YNc(3,os,1,4,"chat-text",8),e.YNc(4,is,1,4,"chat-html",9),e.qZA()}if(2&r){const n=e.MAs(2),o=e.oxw();e.Q6J("tooltip",n),e.xp6(3),e.Q6J("ngIf","html"!==(null==o.message?null:o.message.type)),e.xp6(1),e.Q6J("ngIf","html"===(null==o.message?null:o.message.type))}}const ss=function(r){return{padding:r}};class fn{constructor(t){this.sanitizer=t,this.onBeforeMessageRender=new e.vpe,this.onAfterMessageRender=new e.vpe,this.onElementRendered=new e.vpe,this.isImage=$n,this.isFile=gi,this.isFrame=Oo,this.convertColorToRGBA=Ae,this.messageType=We,this.MESSAGE_TYPE_MINE=$,this.MESSAGE_TYPE_OTHERS=te,this.logger=fe.getInstance()}ngOnInit(){}ngOnChanges(){this.message&&this.message.metadata&&"object"==typeof this.message.metadata&&(this.sizeImage=this.getMetadataSize(this.message.metadata))}getMetadataSize(t){const n={width:t.width,height:t.height};if(t.width&&t.width<q)if(t.width<=55){const o=t.width/t.height;n.width=130,n.height=130/o}else t.width>55&&(n.width=t.width,n.height=t.height);else if(t.width&&t.width>q){const o=t.width/t.height;n.width=q,n.height=q/o}return n}handleTooltipEvents(t){const n=this;setTimeout(function(){try{const i=document.getElementsByClassName("chat-tooltip");if(i){const l=i[0];l.classList.contains("tooltip-show")||l.classList.add("tooltip-show"),setTimeout(function(){l.classList.contains("tooltip-show")&&l.classList.remove("tooltip-show")},Te.hideDelayAfterClick)}}catch(i){n.logger.error("[BUBBLE-MESSAGE] handleTooltipEvents >>>> Error :"+i)}},Te.showDelay)}onBeforeMessageRenderFN(t){this.onBeforeMessageRender.emit({message:this.message,sanitizer:this.sanitizer,messageEl:t.messageEl,component:t.component})}onAfterMessageRenderFN(t){this.onAfterMessageRender.emit({message:this.message,sanitizer:this.sanitizer,messageEl:t.messageEl,component:t.component})}onElementRenderedFN(t){this.onElementRendered.emit({element:t.element,status:t.status})}}function as(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"img",3),e.NdJ("error",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onBotImgError(i))})("load",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onLoadedBot(i))}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("src",n.url,e.LSH)}}function ls(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"img",3),e.NdJ("error",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onHumanImgError(i))})("load",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onLoadedHuman(i))}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("src",n.url,e.LSH)}}fn.\u0275fac=function(t){return new(t||fn)(e.Y36(S.H7))},fn.\u0275cmp=e.Xpm({type:fn,selectors:[["chat-bubble-message"]],inputs:{message:"message",isSameSender:"isSameSender",fontColor:"fontColor",fontSize:"fontSize",fontFamily:"fontFamily",stylesMap:"stylesMap"},outputs:{onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender",onElementRendered:"onElementRendered"},features:[e.TTD],decls:6,vars:7,consts:[["id","bubble-message",1,"messages","primary-color",3,"ngStyle"],["class","message_sender_fullname",3,"color","ngStyle",4,"ngIf"],[3,"metadata","width","height","onElementRendered",4,"ngIf"],["placement","left","contentType","template",3,"tooltip","click",4,"ngIf"],[1,"message_sender_fullname",3,"ngStyle"],[3,"metadata","width","height","onElementRendered"],["placement","left","contentType","template",3,"tooltip","click"],["timeTooltipLeft",""],[3,"text","color","fontSize","fontFamily","onBeforeMessageRender","onAfterMessageRender",4,"ngIf"],[3,"htmlText","fontSize","themeColor","foregroundColor",4,"ngIf"],[3,"text","color","fontSize","fontFamily","onBeforeMessageRender","onAfterMessageRender"],[3,"htmlText","fontSize","themeColor","foregroundColor"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div"),e.YNc(2,Xr,2,6,"div",1),e.YNc(3,es,1,3,"chat-image",2),e.YNc(4,ts,1,3,"chat-frame",2),e.YNc(5,rs,5,3,"div",3),e.qZA()()),2&t&&(e.Q6J("ngStyle",e.VKq(5,ss,n.isImage(n.message)||n.isFrame(n.message)?"0 0px":"0 8px")),e.xp6(2),e.Q6J("ngIf",n.messageType(n.MESSAGE_TYPE_OTHERS,n.message)&&!n.isSameSender),e.xp6(1),e.Q6J("ngIf",n.isImage(n.message)),e.xp6(1),e.Q6J("ngIf",n.isFrame(n.message)),e.xp6(1),e.Q6J("ngIf",null==n.message?null:n.message.text))},dependencies:[de.O5,de.PC,to.i9,dn,gn,Pt,pn,Ke.Ek,Ke.eG,Ke.Bs],styles:[".messages[_ngcontent-%COMP%]{border-radius:20px;padding:0;word-wrap:break-word}.messages[_ngcontent-%COMP%]   .message_sender_fullname[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.messages[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:20px;padding:3px;margin-bottom:0;max-width:calc(100% - 6px);width:auto;height:auto;object-fit:cover}.messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{margin:0}.messages[_ngcontent-%COMP%]   .message_innerhtml.marked[_ngcontent-%COMP%]{padding:8px;margin-block-start:-1em!important;margin-block-end:-1em!important}.messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]   .text-message[_ngcontent-%COMP%]{padding-top:14px}"]});class At{constructor(t){this.imageRepoService=t}ngOnInit(){if(this.senderID){-1!==this.senderID.indexOf("bot_")||this.senderFullname.toLowerCase().includes("bot")?this.url=this.baseLocation+"/assets/images/tommy_bot_tiledesk.svg":-1==this.senderID.indexOf("bot_")&&(this.url=this.baseLocation+"/assets/images/chat_human_avatar.svg");let t=this.imageRepoService.getImagePhotoUrl(this.senderID);this.checkImageExists(t,n=>{n&&(this.url=t)})}}onBotImgError(t){t.target.src=this.baseLocation+"/assets/images/tommy_bot_tiledesk.svg"}onHumanImgError(t){t.target.src=this.baseLocation+"/assets/images/chat_human_avatar.svg"}onLoadedBot(t){}onLoadedHuman(t){}checkImageExists(t,n){var o=new Image;o.onload=function(){n(!0)},o.onerror=function(){n(!1)},o.src=t}}function cs(r,t){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"amTimeAgo"),e.ALo(3,"amDateFormat"),e.ALo(4,"amLocal"),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,2,n.message.timestamp)," (",e.xi3(3,4,e.lcZ(4,7,n.message.timestamp),"L HH:mm:ss"),")")}}At.\u0275fac=function(t){return new(t||At)(e.Y36(Ze))},At.\u0275cmp=e.Xpm({type:At,selectors:[["chat-avatar-image"]],inputs:{senderID:"senderID",senderFullname:"senderFullname",baseLocation:"baseLocation"},decls:4,vars:2,consts:[[1,"c21-icon-avatar"],[1,"c21-avatar-image","profile_image"],[3,"src","error","load",4,"ngIf"],[3,"src","error","load"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,as,1,1,"img",2),e.YNc(3,ls,1,1,"img",2),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",-1!==(null==n.senderID?null:n.senderID.indexOf("bot_"))||n.senderFullname.toLowerCase().includes("bot")),e.xp6(1),e.Q6J("ngIf",-1===(null==n.senderID?null:n.senderID.indexOf("bot_"))&&!n.senderFullname.toLowerCase().includes("bot")))},dependencies:[de.O5],styles:[".c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%;display:flex;align-items:center;justify-content:center}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}.c21-pallozzo[_ngcontent-%COMP%]{display:inline}.c21-ball[_ngcontent-%COMP%]{position:relative;width:52px;height:52px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}.c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}.c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}"]});class mn{constructor(){this.logger=fe.getInstance()}ngOnInit(){this.logger.debug("[INFO-COMP] message ",this.message),this.message&&this.message.text&&(this.message.text=this.message.text.replace(/<br\s*[\/]?>/gi,"\n"),this.logger.debug("[INFO-COMP] message .text  ",this.message.text))}}function hs(r,t){1&r&&(e.TgZ(0,"div",2),e.O4$(),e.TgZ(1,"svg",3)(2,"defs")(3,"style"),e._uU(4,".cls-1{fill:none;}"),e.qZA()(),e.TgZ(5,"g",4)(6,"g",5),e._UZ(7,"path",6)(8,"path",7)(9,"path",8),e.qZA()()()())}function ds(r,t){1&r&&(e.TgZ(0,"div",2),e.O4$(),e.TgZ(1,"svg",3)(2,"defs")(3,"style"),e._uU(4,".cls-1{fill:none;}"),e.qZA()(),e.TgZ(5,"g",4)(6,"g",5),e._UZ(7,"path",7)(8,"path",9),e.qZA()()()())}function us(r,t){1&r&&(e.TgZ(0,"div",2),e.O4$(),e.TgZ(1,"svg",3)(2,"defs")(3,"style"),e._uU(4,".cls-1{fill:none;}"),e.qZA()(),e.TgZ(5,"g",4)(6,"g",5),e._UZ(7,"path",7)(8,"path",9),e.qZA()()()())}function gs(r,t){1&r&&(e.TgZ(0,"div",2),e.O4$(),e.TgZ(1,"svg",3)(2,"defs")(3,"style"),e._uU(4,".cls-1{fill:none;}"),e.qZA()(),e.TgZ(5,"g",4)(6,"g",5),e._UZ(7,"path",7)(8,"path",10),e.qZA()()()())}mn.\u0275fac=function(t){return new(t||mn)},mn.\u0275cmp=e.Xpm({type:mn,selectors:[["chat-info-message"]],inputs:{message:"message"},decls:14,vars:4,consts:[[1,"info-container"],[1,"spinner"],[1,"bounce3"],[1,"bounce2"],[1,"bounce1"],[2,"max-width","70%"],["placement","left","contentType","template",1,"base_info",3,"innerHTML","tooltip"],["timeTooltipLeft",""]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2)(3,"div",3)(4,"div",4),e.qZA(),e.TgZ(5,"div",5),e._UZ(6,"span",6),e.ALo(7,"marked"),e.YNc(8,cs,5,9,"ng-template",null,7,e.W1O),e.qZA(),e.TgZ(10,"div",1),e._UZ(11,"div",4)(12,"div",3)(13,"div",2),e.qZA()()),2&t){const o=e.MAs(9);e.xp6(6),e.Q6J("innerHTML",e.lcZ(7,2,null==n.message?null:n.message.text),e.oJD)("tooltip",o)}},dependencies:[to.i9,Ke.Ek,Ke.eG,Ke.Bs,bt],styles:[".info-container[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:center;padding:4px 0 2px;width:100%}.base_info[_ngcontent-%COMP%]{border-radius:14px;padding:6px 10px;display:inline-block;background:rgba(24,119,242,.1);font-size:10px;color:#666;margin-left:5px;margin-right:5px}.base_info[_ngcontent-%COMP%]    >p{margin-top:0!important;margin-bottom:0!important}.base_info[_ngcontent-%COMP%]    >p a{word-break:break-all;color:#3880ff!important}.spinner[_ngcontent-%COMP%]{width:45px;min-height:100%;margin:auto 0}.spinner[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;background-color:#333;border-radius:100%;display:inline-block;margin:0 2px}.spinner[_ngcontent-%COMP%]   .bounce1[_ngcontent-%COMP%]{background-color:#1877f21a}.spinner[_ngcontent-%COMP%]   .bounce2[_ngcontent-%COMP%]{background-color:#1877f21a;opacity:.6}.spinner[_ngcontent-%COMP%]   .bounce3[_ngcontent-%COMP%]{background-color:#1877f21a;opacity:.4}"]});class _n{constructor(){this.MSG_STATUS_SENT=100,this.MSG_STATUS_SENT_SERVER=150,this.MSG_STATUS_RETURN_RECEIPT=250}ngOnInit(){}}function ps(r,t){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij("",n.nameUserTypingNow," ")}}function fs(r,t){if(1&r&&(e.TgZ(0,"div",2),e.YNc(1,ps,2,1,"span",3),e._uU(2),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.nameUserTypingNow),e.xp6(1),e.hij(" ",null==n.translationMap?null:n.translationMap.get("LABEL_WRITING"),"\n")}}function ms(r,t){1&r&&(e.TgZ(0,"div",4),e._UZ(1,"div",5)(2,"div",6)(3,"div",7),e.qZA())}_n.\u0275fac=function(t){return new(t||_n)},_n.\u0275cmp=e.Xpm({type:_n,selectors:[["chat-return-receipt"]],inputs:{status:"status"},decls:5,vars:4,consts:[[1,"status-message"],["class","icon",4,"ngIf"],[1,"icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 18 18"],["id","Livello_2","data-name","Livello 2"],["id","Livello_1-2","data-name","Livello 1"],["d","M9,1.5A7.5,7.5,0,1,0,16.5,9,7.5,7.5,0,0,0,9,1.5ZM9,15a6,6,0,1,1,6-6A6,6,0,0,1,9,15Z"],["d","M0,0H18V18H0Z",1,"cls-1"],["d","M9.38,5.25H8.25v4.5l3.94,2.36.56-.92-3.37-2Z"],["d","M6.75,12.15,3.6,9,2.55,10l4.2,4.2,9-9-1-1.05Z"],["d","M13.5,5.25,12.44,4.19,7.69,8.95,8.74,10Zm3.18-1.06L8.74,12.13,5.61,9,4.55,10.06l4.19,4.19,9-9ZM.31,10.06,4.5,14.25l1.06-1.06L1.37,9Z"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,hs,10,0,"div",1),e.YNc(2,ds,9,0,"div",1),e.YNc(3,us,9,0,"div",1),e.YNc(4,gs,9,0,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.status),e.xp6(1),e.Q6J("ngIf",n.status==n.MSG_STATUS_SENT),e.xp6(1),e.Q6J("ngIf",n.status==n.MSG_STATUS_SENT_SERVER),e.xp6(1),e.Q6J("ngIf",n.status==n.MSG_STATUS_RETURN_RECEIPT))},dependencies:[de.O5],styles:[".status-message[_ngcontent-%COMP%]{width:16px;height:16px;margin-left:4px}.status-message[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:13px;height:13px;background-repeat:no-repeat;background-position:center;background-size:cover;overflow-x:hidden;overflow-y:hidden}.status-message[_ngcontent-%COMP%]   .c21-ico-schedule[_ngcontent-%COMP%]{background-image:url(f21ico-schedule.svg)}.status-message[_ngcontent-%COMP%]   .c21-ico-done[_ngcontent-%COMP%]{background-image:url(f21ico-done.svg)}.status-message[_ngcontent-%COMP%]   .c21-ico-done_all[_ngcontent-%COMP%]{background-image:url(f21ico-done_all.svg)}"]});class It{constructor(t){this.elementRef=t,this.typingLocation="content"}ngOnInit(){this.elementRef.nativeElement.style.setProperty("--bubbleReceivedBackgroundColor",this.color)}ngOnDestroy(){}}It.\u0275fac=function(t){return new(t||It)(e.Y36(e.SBq))},It.\u0275cmp=e.Xpm({type:It,selectors:[["user-typing"]],inputs:{typingLocation:"typingLocation",translationMap:"translationMap",color:"color",idUserTypingNow:"idUserTypingNow",nameUserTypingNow:"nameUserTypingNow"},decls:2,vars:2,consts:[["class","tile-typing-now",4,"ngIf"],["class","spinner",4,"ngIf"],[1,"tile-typing-now"],[4,"ngIf"],[1,"spinner"],[1,"bounce1"],[1,"bounce2"],[1,"bounce3"]],template:function(t,n){1&t&&(e.YNc(0,fs,3,2,"div",0),e.YNc(1,ms,4,0,"div",1)),2&t&&(e.Q6J("ngIf","header"===n.typingLocation),e.xp6(1),e.Q6J("ngIf","content"===n.typingLocation))},dependencies:[de.O5],styles:["[_ngcontent-%COMP%]:root{--bubbleReceivedBackgroundColor: $blue;--foregroundColor: $bck-msg-sent}.tile-typing-now[_ngcontent-%COMP%]{position:absolute;left:40px;right:40px;bottom:3px;width:auto;text-align:center;margin:0;padding:0;font-size:1.1em;color:var(--foregroundColor)}#tile-spinner[_ngcontent-%COMP%]{position:relative;left:0;top:0;margin:0}#tile-spinner[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;background-color:var(--basic-blue)}.spinner[_ngcontent-%COMP%]{margin:15px 10px;width:70px;min-height:20px;display:block}.spinner[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:9px;height:9px;border-radius:100%;display:inline-block;animation:_ngcontent-%COMP%_sk-bouncedelay 1.4s infinite ease-in-out both}.spinner[_ngcontent-%COMP%]   .bounce1[_ngcontent-%COMP%]{animation-delay:-.32s;background-color:var(--bubbleReceivedBackgroundColor)}.spinner[_ngcontent-%COMP%]   .bounce2[_ngcontent-%COMP%]{animation-delay:-.16s;background-color:var(--bubbleReceivedBackgroundColor);opacity:.4}.spinner[_ngcontent-%COMP%]   .bounce3[_ngcontent-%COMP%]{background-color:var(--bubbleReceivedBackgroundColor);opacity:.6}@keyframes _ngcontent-%COMP%_sk-bouncedelay{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}"]});const _s=["scrollMe"];function vs(r,t){if(1&r&&(e.TgZ(0,"span"),e._UZ(1,"user-typing",12),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("color",null==n.stylesMap?null:n.stylesMap.get("iconColor"))("translationMap",n.translationMap)("idUserTypingNow",n.idUserTypingNow)("nameUserTypingNow",n.nameUserTypingNow)}}const Uo=function(r,t){return{background:r,color:t}},bs=function(r){return{"button-in-msg":r}};function Cs(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",19)(1,"chat-bubble-message",20),e.NdJ("onBeforeMessageRender",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onBeforeMessageRenderFN(i))})("onAfterMessageRender",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onAfterMessageRenderFN(i))})("onElementRendered",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onElementRenderedFN(i))}),e.qZA(),e._UZ(2,"chat-return-receipt",21),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.ekj("no-background",(o.isImage(n)||o.isFrame(n))&&""===(null==n?null:n.text.trim()))("emoticon",o.isEmojii(null==n?null:n.text)),e.Q6J("ngStyle",e.WLB(12,Uo,o.stylesMap.get("bubbleSentBackground"),o.stylesMap.get("bubbleSentTextColor")))("ngClass",e.VKq(15,bs,(null==n?null:n.metadata)&&(null==n||null==n.metadata?null:n.metadata.button)))("message",n)("fontColor",o.stylesMap.get("bubbleSentTextColor"))("fontSize",o.stylesMap.get("fontSize"))("fontFamily",o.stylesMap.get("fontFamily"))("stylesMap",o.stylesMap),e.xp6(1),e.Q6J("status",null==n?null:n.status)}}const no=function(){return{"slide-in-left":!1}};function ws(r,t){if(1&r&&e._UZ(0,"chat-avatar-image",25),2&r){const n=e.oxw(2).$implicit,o=e.oxw();e.Q6J("ngClass",e.DdM(4,no))("senderID",null==n?null:n.sender)("senderFullname",null==n?null:n.sender_fullname)("baseLocation",o.baseLocation)}}function ys(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",22),e.YNc(1,ws,1,5,"chat-avatar-image",23),e.TgZ(2,"chat-bubble-message",24),e.NdJ("onBeforeMessageRender",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onBeforeMessageRenderFN(i))})("onAfterMessageRender",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onAfterMessageRenderFN(i))})("onElementRendered",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onElementRenderedFN(i))}),e.qZA()()}if(2&r){const n=e.oxw(),o=n.$implicit,i=n.index,l=e.oxw();e.xp6(1),e.Q6J("ngIf",!l.isSameSender(null==o?null:o.sender,i)),e.xp6(1),e.Udp("margin-left",l.isSameSender(null==o?null:o.sender,i)?"50px":null),e.ekj("no-background",(l.isImage(o)||l.isFrame(o))&&""===(null==o?null:o.text.trim()))("emoticon",l.isEmojii(null==o?null:o.text)),e.Q6J("ngClass",e.DdM(15,no))("ngStyle",e.WLB(16,Uo,l.stylesMap.get("bubbleReceivedBackground"),l.stylesMap.get("bubbleReceivedTextColor")))("isSameSender",l.isSameSender(null==o?null:o.sender,i))("message",o)("fontColor",l.stylesMap.get("bubbleReceivedTextColor"))("fontSize",l.stylesMap.get("fontSize"))("fontFamily",l.stylesMap.get("fontFamily"))("stylesMap",l.stylesMap)}}function Os(r,t){if(1&r&&(e.TgZ(0,"div",26),e._UZ(1,"chat-info-message",27),e.qZA()),2&r){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("message",n)}}function xs(r,t){if(1&r&&(e.TgZ(0,"time",null,28),e._uU(2),e.ALo(3,"amTimeAgo"),e.qZA()),2&r){const n=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,1,null==n?null:n.timestamp)," ")}}function Ms(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",29)(1,"chat-message-attachment",30),e.NdJ("onElementRendered",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onElementRenderedFN(i))})("onAttachmentButtonClicked",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onAttachmentButtonClickedFN(i))}),e.qZA()()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("ngClass",e.DdM(5,no)),e.xp6(1),e.Q6J("message",n)("isConversationArchived",o.isConversationArchived)("isLastMessage",o.isLastMessage(null==n?null:n.uid))("stylesMap",o.stylesMap)}}const Es=function(r){return{sender:r}};function Ts(r,t){if(1&r&&(e.TgZ(0,"div",13),e.YNc(1,Cs,3,17,"div",14),e.YNc(2,ys,3,19,"div",15),e.YNc(3,Os,2,1,"div",16),e.TgZ(4,"div",17),e.YNc(5,xs,4,3,"time",3),e.qZA(),e.YNc(6,Ms,2,6,"div",18),e.qZA()),2&r){const n=t.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.messageType(o.MESSAGE_TYPE_MINE,n)),e.xp6(1),e.Q6J("ngIf",o.messageType(o.MESSAGE_TYPE_OTHERS,n)),e.xp6(1),e.Q6J("ngIf",o.messageType(o.MESSAGE_TYPE_INFO,n)),e.xp6(1),e.Q6J("ngClass",e.VKq(6,Es,(null==n?null:n.sender)==o.senderId)),e.xp6(1),e.Q6J("ngIf",""!==(null==n?null:n.sender)&&"{.sv: timestamp}"!==(null==n?null:n.timestamp)),e.xp6(1),e.Q6J("ngIf",(null==n?null:n.attributes)&&(null==n||null==n.attributes?null:n.attributes.attachment))}}const Ss=function(r){return{"background-color":r}},Ps=function(r){return{"background-color":r,opacity:.4}},ks=function(r){return{"background-color":r,opacity:.6}};function As(r,t){if(1&r&&(e.TgZ(0,"div",31)(1,"div",32),e._UZ(2,"div",33)(3,"div",34)(4,"div",35),e.qZA()()),2&r){const n=e.oxw();e.xp6(2),e.Q6J("ngStyle",e.VKq(3,Ss,n.stylesMap.get("iconColor"))),e.xp6(1),e.Q6J("ngStyle",e.VKq(5,Ps,n.stylesMap.get("iconColor"))),e.xp6(1),e.Q6J("ngStyle",e.VKq(7,ks,n.stylesMap.get("iconColor")))}}function Is(r,t){if(1&r&&e._UZ(0,"chat-avatar-image",39),2&r){const n=e.oxw(2);e.Q6J("senderID",n.idUserTypingNow)("senderFullname",n.nameUserTypingNow)("baseLocation",n.baseLocation)}}const Rs=function(r){return{userTypingNowExist:r}};function Ls(r,t){if(1&r&&(e.TgZ(0,"div",36),e.YNc(1,Is,1,3,"chat-avatar-image",37),e._UZ(2,"user-typing",38),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.idUserTypingNow),e.xp6(1),e.Q6J("ngClass",e.VKq(6,Rs,!n.idUserTypingNow))("color",null==n.stylesMap?null:n.stylesMap.get("iconColor"))("translationMap",n.translationMap)("idUserTypingNow",n.idUserTypingNow)("nameUserTypingNow",n.nameUserTypingNow)}}class Rt{constructor(t,n,o){this.cdref=t,this.elementRef=n,this.uploadService=o,this.onBeforeMessageRender=new e.vpe,this.onAfterMessageRender=new e.vpe,this.onMenuOptionShow=new e.vpe,this.onEmojiiPickerShow=new e.vpe,this.onAttachmentButtonClicked=new e.vpe,this.onScrollContent=new e.vpe,this.startScroll=!0,this.idDivScroll="c21-contentScroll",this.isScrolling=!1,this.isIE=/msie\s|trident\//i.test(window.navigator.userAgent),this.firstScroll=!0,this.isPopupUrl=$o,this.popupUrl=Jn,this.MSG_STATUS_SENT=100,this.MSG_STATUS_SENT_SERVER=150,this.MSG_STATUS_RETURN_RECEIPT=250,this.isMine=Xn,this.isInfo=Un,this.messageType=We,this.isEmojii=pi,this.isImage=$n,this.isFrame=Oo,this.MESSAGE_TYPE_INFO=U,this.MESSAGE_TYPE_MINE=$,this.MESSAGE_TYPE_OTHERS=te,this.tooltipOptions={"show-delay":1500,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},this.urlBOTImage="https://s3.eu-west-1.amazonaws.com/tiledesk-widget/dev/2.0.4-beta.7/assets/images/avatar_bot_tiledesk.svg",this.showUploadProgress=!1,this.logger=fe.getInstance()}ngOnInit(){this.listenToUploadFileProgress()}ngAfterContentChecked(){this.cdref.detectChanges()}ngOnChanges(t){this.stylesMap&&this.stylesMap.get("bubbleSentTextColor")&&this.elementRef.nativeElement.querySelector(".c21-body").style.setProperty("--textColorSent",this.stylesMap.get("bubbleSentTextColor")),this.stylesMap&&this.stylesMap.get("bubbleReceivedTextColor")&&this.elementRef.nativeElement.querySelector(".c21-body").style.setProperty("--textColorReceive",this.stylesMap.get("bubbleReceivedTextColor"))}getMetadataSize(t){void 0===t.width&&(t.width="100%"),void 0===t.height&&(t.height=$e);const n={width:t.width,height:t.height};if(t.width&&t.width>$e){const o=t.width/t.height;n.width=$e,n.height=$e/o}return n}listenToUploadFileProgress(){this.uploadService.BSStateUpload.subscribe(t=>{this.logger.debug("[CONV-CONTENT] BSStateUpload",t),t&&(this.showUploadProgress=100!==t.upload&&!isNaN(t.upload),this.uploadProgress=t.upload,this.fileType="file",this.scrollToBottom())})}onScroll(t){this.startScroll=!1,this.scrollMe&&(this.checkContentScrollPosition(this.scrollMe.nativeElement)?this.onScrollContent.emit(!0):this.onScrollContent.emit(!1))}checkContentScrollPosition(t){return t||(t=this.scrollMe.nativeElement),t.scrollHeight-t.scrollTop<=t.clientHeight+40?(this.logger.debug("[CONV-CONTENT] - SONO ALLA FINE"),!0):(this.logger.debug("[CONV-CONTENT] - NON SONO ALLA FINE"),!1)}scrollToBottom(t){const n=this;try{n.isScrolling=!0;const o=document.getElementById(n.idDivScroll);setTimeout(function(){!0===n.isIE||!0===t||!0===n.firstScroll?o.parentElement.classList.add("withoutAnimation"):o.parentElement.classList.remove("withoutAnimation"),o.parentElement.scrollTop=o.scrollHeight,o.style.opacity="1",n.firstScroll=!1},0)}catch(o){this.logger.error("[CONV-CONTENT] scrollToBottom > Error :"+o)}n.isScrolling=!1}isLastMessage(t){return t===this.messages[this.messages.length-1].uid}isSameSender(t,n){return!(!t||!this.messages[n-1]||t!==this.messages[n-1].sender)}isFirstMessage(t,n){return!(!t||0!=n||!this.messages[n]||this.messages[n]===t)}hideOutsideElements(){this.onMenuOptionShow.emit(!1),this.onEmojiiPickerShow.emit(!1)}onAttachmentButtonClickedFN(t){this.onAttachmentButtonClicked.emit(t)}onBeforeMessageRenderFN(t){this.onBeforeMessageRender.emit(t)}onAfterMessageRenderFN(t){this.onAfterMessageRender.emit(t)}onElementRenderedFN(t){t.status&&this.scrollMe&&(this.checkContentScrollPosition(this.scrollMe.nativeElement),this.scrollToBottom())}}Rt.\u0275fac=function(t){return new(t||Rt)(e.Y36(e.sBO),e.Y36(e.SBq),e.Y36(Ve))},Rt.\u0275cmp=e.Xpm({type:Rt,selectors:[["chat-conversation-content"]],viewQuery:function(t,n){if(1&t&&e.Gf(_s,5),2&t){let o;e.iGM(o=e.CRH())&&(n.scrollMe=o.first)}},inputs:{messages:"messages",senderId:"senderId",baseLocation:"baseLocation",isConversationArchived:"isConversationArchived",isTypings:"isTypings",idUserTypingNow:"idUserTypingNow",nameUserTypingNow:"nameUserTypingNow",typingLocation:"typingLocation",fullscreenMode:"fullscreenMode",translationMap:"translationMap",stylesMap:"stylesMap"},outputs:{onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender",onMenuOptionShow:"onMenuOptionShow",onEmojiiPickerShow:"onEmojiiPickerShow",onAttachmentButtonClicked:"onAttachmentButtonClicked",onScrollContent:"onScrollContent"},features:[e.TTD],decls:12,vars:5,consts:[[1,"c21-body",3,"click"],[1,"c21-body-container"],["tabindex","1520","aria-label"," messaggi della conversazione: ",1,"c21-body-content"],[4,"ngIf"],["id","chat21-sheet-content",1,"chat21-sheet-content"],[1,"chat21-conversation-parts-container"],["id","scroll-me",3,"scroll"],["scrollMe",""],[1,"c21-contentScroll",3,"id"],["tabindex","1521","class","rowMsg",4,"ngFor","ngForOf"],["class","msg_container base_sent",4,"ngIf"],["class","msg_container base_receive",4,"ngIf"],[1,"loading",3,"color","translationMap","idUserTypingNow","nameUserTypingNow"],["tabindex","1521",1,"rowMsg"],["role","messaggio","class","msg_container base_sent",4,"ngIf"],["role","messaggio","class","msg_container base_receive",4,"ngIf"],["class","msg_info_container",4,"ngIf"],[1,"time","slide-in-left",3,"ngClass"],["class","attachment_container",3,"ngClass",4,"ngIf"],["role","messaggio",1,"msg_container","base_sent"],[1,"messages","msg_sent",3,"ngStyle","ngClass","message","fontColor","fontSize","fontFamily","stylesMap","onBeforeMessageRender","onAfterMessageRender","onElementRendered"],[3,"status"],["role","messaggio",1,"msg_container","base_receive"],[3,"ngClass","senderID","senderFullname","baseLocation",4,"ngIf"],[1,"messages","msg_receive",3,"ngClass","ngStyle","isSameSender","message","fontColor","fontSize","fontFamily","stylesMap","onBeforeMessageRender","onAfterMessageRender","onElementRendered"],[3,"ngClass","senderID","senderFullname","baseLocation"],[1,"msg_info_container"],[1,"messages",3,"message"],["timeTooltip",""],[1,"attachment_container",3,"ngClass"],[2,"height","100%","display","block",3,"message","isConversationArchived","isLastMessage","stylesMap","onElementRendered","onAttachmentButtonClicked"],[1,"msg_container","base_sent"],["id","chat21-spinner",1,"chat21-spinner","active",2,"margin","0px 6px 0px"],[1,"chat21-bounce1",3,"ngStyle"],[1,"chat21-bounce2",3,"ngStyle"],[1,"chat21-bounce3",3,"ngStyle"],[1,"msg_container","base_receive"],["class","slide-in-left",3,"senderID","senderFullname","baseLocation",4,"ngIf"],[3,"ngClass","color","translationMap","idUserTypingNow","nameUserTypingNow"],[1,"slide-in-left",3,"senderID","senderFullname","baseLocation"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return n.hideOutsideElements()}),e.TgZ(1,"div",1)(2,"div",2),e.YNc(3,vs,2,4,"span",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6,7),e.NdJ("scroll",function(i){return n.onScroll(i)}),e.TgZ(8,"div",8),e.YNc(9,Ts,7,8,"div",9),e.YNc(10,As,5,9,"div",10),e.YNc(11,Ls,3,8,"div",11),e.qZA()()()()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",n.messages&&0===n.messages.length),e.xp6(5),e.s9C("id",n.idDivScroll),e.xp6(1),e.Q6J("ngForOf",n.messages),e.xp6(1),e.Q6J("ngIf",n.showUploadProgress),e.xp6(1),e.Q6J("ngIf",n.isTypings&&"content"===n.typingLocation))},dependencies:[de.mk,de.sg,de.O5,de.PC,hn,fn,At,mn,_n,It,Ke.eG],styles:["#scroll-me[_ngcontent-%COMP%]{scroll-behavior:smooth}#scroll-me.withoutAnimation[_ngcontent-%COMP%]{scroll-behavior:unset}[_nghost-%COMP%]{--textColorSent: #ffffff;--textColorReceive: #1a1a1a}[_nghost-%COMP%]   .base_receive[_ngcontent-%COMP%]   .msg_receive[_ngcontent-%COMP%]    >div>div>div>chat-text a{color:var(--textColorReceive)!important}[_nghost-%COMP%]   .base_sent[_ngcontent-%COMP%]   .msg_sent[_ngcontent-%COMP%]    >div>div>div>chat-text a{color:var(--textColorSent)!important}[_nghost-%COMP%]   .userTypingNowExist[_ngcontent-%COMP%]    >div.spinner{margin:15px 50px}[_nghost-%COMP%]   .loading[_ngcontent-%COMP%]    >div.spinner{margin:25px 50px}.c21-body[_ngcontent-%COMP%]{position:fixed}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .chat21-header-modal-select[_ngcontent-%COMP%]{font-family:Google Sans,sans-serif!important;padding:0;background-color:#b9b9b921;margin:8px;line-height:1.2em;color:#616161;font-size:15px;text-align:center;word-wrap:break-word;border-radius:8px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .chat21-header-modal-select-more-of-one-dept[_ngcontent-%COMP%]{position:relative;height:auto;padding:10px;margin:30px 0 0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]{position:absolute;inset:0 0 56px;overflow:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{margin-bottom:20px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]{height:100%;overflow-y:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #c21-contentScroll[_ngcontent-%COMP%]{position:absolute;left:0;right:0;padding:10px;opacity:0;transition:opacity .5s;transition-timing-function:ease-in}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;background-color:#0000!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.1);background-color:#0000!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:6px!important;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,0);background-color:#00000040!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden;position:absolute;top:0;right:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#d3d6dc}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .msg_container[_ngcontent-%COMP%]{overflow:hidden;display:flex;width:100%}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .attachment_container[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:flex-end}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .msg_info_container[_ngcontent-%COMP%]{text-align:center;padding:0 0 6px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]{border-radius:20px;padding:0;word-wrap:break-word}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.4em;margin:0;padding:14px;font-style:normal;letter-spacing:normal;font-stretch:normal;font-variant:normal;font-weight:300;overflow:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:8px;padding:3px;margin-bottom:0;max-width:calc(100% - 6px);width:auto;height:auto;object-fit:cover}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{margin:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message_innerhtml.marked[_ngcontent-%COMP%]{padding:8px;margin-block-start:-1em!important;margin-block-end:-1em!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]   .text-message[_ngcontent-%COMP%]{padding-top:14px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_info[_ngcontent-%COMP%]{border-radius:8px;border:1px solid #C9E4F6;padding-left:4px;padding-right:4px;display:inline-block;background:#C9E4F6;font-size:.85em}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]{align-items:flex-end;justify-content:flex-end;padding:2px 0 4px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .msg_sent[_ngcontent-%COMP%]{background-color:#62a8ea;color:#fff;margin-right:0;margin-left:4px;max-width:calc(100% - 30px);min-width:14px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:8px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .no-background[_ngcontent-%COMP%]{background:transparent!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]{background:transparent!important;font-size:4em;margin:-15px 0 0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:0;margin:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]{width:16px;height:16px;margin-left:4px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:13px;height:13px;background-repeat:no-repeat;background-position:center;background-size:cover;overflow-x:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .c21-ico-schedule[_ngcontent-%COMP%]{background-image:url(f21ico-schedule.svg)}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .c21-ico-done[_ngcontent-%COMP%]{background-image:url(f21ico-done.svg)}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .c21-ico-done_all[_ngcontent-%COMP%]{background-image:url(f21ico-done_all.svg)}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]{padding:2px 0 4px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .content-avatar[_ngcontent-%COMP%]{position:relative;border-radius:50%;width:28px;height:28px;margin-right:6px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .content-avatar[_ngcontent-%COMP%]   .profile_image[_ngcontent-%COMP%]{position:relative;width:25px;height:25px;border-radius:50%;overflow:hidden;background-color:#fff;border:1px solid #e2e2e2}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .content-avatar[_ngcontent-%COMP%]   .profile_image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .msg_receive[_ngcontent-%COMP%]{background-color:#f7f7f7;color:#1a1a1a;max-width:calc(100% - 70px);min-width:14px;margin:auto 20px auto 10px;height:-moz-fit-content;height:fit-content;width:auto}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:14px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .no-background[_ngcontent-%COMP%]{background:transparent!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]{background-color:transparent!important;font-size:4em;margin:-15px 20px -10px 10px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:0;margin:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .message_sender_fullname[_ngcontent-%COMP%]{font-size:12px;color:#5f6368;margin:0 auto 4px}.c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}@keyframes _ngcontent-%COMP%_sk-bouncedelay{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}"]});class Ns{constructor(t,n,o,i,l,E,V,Q,se,ge,me,ce,ve,we,Me,Ne,ht,ot,it,rt,Rn){this.uid=t,this.attributes=n,this.channel_type=o,this.conversation_with_fullname=i,this.conversation_with=l,this.recipient=E,this.recipient_fullname=V,this.image=Q,this.is_new=se,this.last_message_text=ge,this.text=me,this.sender=ce,this.senderAuthInfo=ve,this.sender_fullname=we,this.status=Me,this.timestamp=Ne,this.selected=ht,this.color=ot,this.avatar=it,this.archived=rt,this.type=Rn}}var Ct=be(7625),Fs=be(8929);class lt{constructor(t,n,o){if(this.http=t,this.g=n,this.appConfigService=o,this.logger=fe.getInstance(),this.API_URL=this.appConfigService.getConfig().apiUrl,!this.API_URL)throw new Error("apiUrl is not defined");this.obsCloseConversation=new _e.X(null)}httpSendRate(t,n){const o=this.g.tiledeskToken,i=this.g.projectid,l=this.g.recipientId;if(t&&o&&i&&l){const E=new Ee.WM({Accept:"application/json","Content-Type":"application/json",Authorization:o}),V=this.API_URL+i+"/requests/"+l+"/rating";this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e url: ",V);const Q={rating:t,rating_message:n};return this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e options: ",E),this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e body: ",JSON.stringify(Q)),this.http.patch(V,JSON.stringify(Q),{headers:E}).pipe((0,Po.U)(se=>se.json()))}}setOsservable(t){this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e setOsservable: ",t),this.obsCloseConversation.next(t)}_dowloadTranscript(t){this.g.windowContext.open(this.API_URL+"public/requests/"+t+"/messages-user.html","_blank")}}function Bs(r,t){if(1&r&&e._UZ(0,"user-typing",17),2&r){const n=e.oxw();e.Q6J("color",null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))("translationMap",n.translationMap)("nameUserTypingNow",n.nameUserTypingNow)("typingLocation",n.typingLocation)}}function Us(r,t){if(1&r&&(e.O4$(),e.TgZ(0,"svg",24),e._UZ(1,"path",5)(2,"path",25),e.TgZ(3,"title",7),e._uU(4),e.qZA()()),2&r){const n=e.oxw(2);e.xp6(4),e.Oqu(null==n.translationMap?null:n.translationMap.get("SOUND_OFF"))}}function Ds(r,t){if(1&r&&(e.O4$(),e.TgZ(0,"svg",24),e._UZ(1,"path",5)(2,"path",26),e.TgZ(3,"title",7),e._uU(4),e.qZA()()),2&r){const n=e.oxw(2);e.xp6(4),e.Oqu(null==n.translationMap?null:n.translationMap.get("SOUND_ON"))}}function Hs(r,t){if(1&r&&(e.TgZ(0,"span",27),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",null==n.translationMap?null:n.translationMap.get("SOUND_OFF"),"")}}function Zs(r,t){if(1&r&&(e.TgZ(0,"span",27),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",null==n.translationMap?null:n.translationMap.get("SOUND_ON"),"")}}function zs(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.dowloadTranscript())}),e.O4$(),e.TgZ(1,"svg",28),e._UZ(2,"path",5)(3,"path",29),e.TgZ(4,"title",7),e._uU(5),e.qZA()(),e.kcU(),e.TgZ(6,"span",27),e._uU(7),e.qZA()()}if(2&r){const n=e.oxw(2);e.xp6(5),e.Oqu(null==n.translationMap?null:n.translationMap.get("DOWNLOAD_TRANSCRIPT")),e.xp6(2),e.Oqu(null==n.translationMap?null:n.translationMap.get("DOWNLOAD_TRANSCRIPT"))}}function js(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.closeChat())}),e.O4$(),e.TgZ(1,"svg",30),e._UZ(2,"path",31)(3,"rect",32)(4,"path",33),e.TgZ(5,"title",7),e._uU(6),e.qZA()(),e.kcU(),e.TgZ(7,"span",27),e._uU(8),e.qZA()()}if(2&r){const n=e.oxw(2);e.xp6(6),e.Oqu(null==n.translationMap?null:n.translationMap.get("CLOSE_CHAT")),e.xp6(2),e.Oqu(null==n.translationMap?null:n.translationMap.get("CLOSE_CHAT"))}}function Vs(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.restartChat())}),e.O4$(),e.TgZ(1,"svg",34),e._UZ(2,"path",35)(3,"path",36),e.TgZ(4,"title",7),e._uU(5),e.qZA()(),e.kcU(),e.TgZ(6,"span",27),e._uU(7),e.qZA()()}if(2&r){const n=e.oxw(2);e.xp6(5),e.Oqu(null==n.translationMap?null:n.translationMap.get("RESTART")),e.xp6(2),e.Oqu(null==n.translationMap?null:n.translationMap.get("RESTART"))}}function Gs(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.signOut())}),e.O4$(),e.TgZ(1,"svg",37),e._UZ(2,"path",5)(3,"path",38),e.TgZ(4,"title",7),e._uU(5),e.qZA()(),e.kcU(),e.TgZ(6,"span",27),e._uU(7),e.qZA()()}if(2&r){const n=e.oxw(2);e.xp6(5),e.Oqu(null==n.translationMap?null:n.translationMap.get("LOGOUT")),e.xp6(2),e.Oqu(null==n.translationMap?null:n.translationMap.get("LOGOUT"))}}function qs(r,t){if(1&r&&(e.TgZ(0,"div",39)(1,"span",27),e._uU(2),e.qZA()()),2&r){const n=e.oxw(2);e.xp6(2),e.Oqu(n.build_version)}}function Ws(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",18)(1,"div",19),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.toggleSound())}),e.YNc(2,Us,5,1,"svg",20),e.YNc(3,Ds,5,1,"svg",20),e.YNc(4,Hs,2,1,"span",21),e.YNc(5,Zs,2,1,"span",21),e.qZA(),e.YNc(6,zs,8,2,"div",22),e.YNc(7,js,9,2,"div",22),e.YNc(8,Vs,8,2,"div",22),e.YNc(9,Gs,8,2,"div",22),e.YNc(10,qs,3,1,"div",23),e.qZA()}if(2&r){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",!n.soundEnabled),e.xp6(1),e.Q6J("ngIf",n.soundEnabled),e.xp6(1),e.Q6J("ngIf",!n.soundEnabled),e.xp6(1),e.Q6J("ngIf",n.soundEnabled),e.xp6(1),e.Q6J("ngIf",n.isTrascriptDownloadEnabled),e.xp6(1),e.Q6J("ngIf",!n.hideCloseConversationOptionMenu),e.xp6(1),e.Q6J("ngIf",!n.hideRestartConversationOptionsMenu),e.xp6(1),e.Q6J("ngIf",!n.hideSignOutOptionMenu),e.xp6(1),e.Q6J("ngIf",n.build_version)}}lt.\u0275fac=function(t){return new(t||lt)(e.LFG(Ee.eN),e.LFG(Pe),e.LFG(ke))},lt.\u0275prov=e.Yz7({token:lt,factory:lt.\u0275fac});const Ys=function(r){return{"background-image":r}},oo=function(r){return{display:r}},io=function(r){return{fill:r}},Js=function(r){return{color:r}};class vn{constructor(t,n){this.g=t,this.appConfigService=n,this.onBack=new e.vpe,this.onCloseWidget=new e.vpe,this.onSoundChange=new e.vpe,this.onCloseChat=new e.vpe,this.onRestartChat=new e.vpe,this.onWidgetHeightChange=new e.vpe,this.onSignOut=new e.vpe,this.onMenuOptionShow=new e.vpe,this.convertColorToRGBA=Ae,this.isButtonsDisabled=!0,this.isDirect=!1,this.subscriptions=[],this.membersConversation=["SYSTEM"],this.heightStatus="min",this.logger=fe.getInstance(),this.API_URL=this.appConfigService.getConfig().apiUrl}ngOnInit(){this.logger.debug("[CONV-HEADER] ngOnInit: conversation-header COMPONENT ",this.translationMap),this.membersConversation.push(this.senderId)}ngOnChanges(t){t.idConversation&&void 0!==t.idConversation.currentValue&&this.logger.debug("[CONV-HEADER] onChanges -- Conversation-header.component-> start initializeTyping()",this.idConversation)}ngAfterViewInit(){this.logger.debug("[CONV-HEADER] --------ngAfterViewInit: conversation-header-------- "),this.isButtonsDisabled=!1,this.setSubscriptions()}setSubscriptions(){}returnHome(){this.onBack.emit()}closeChat(){this.onCloseChat.emit()}restartChat(){this.onRestartChat.emit(),this.onMenuOptionShow.emit(!1)}closeWidget(){this.onCloseWidget.emit()}dowloadTranscript(){this.windowContext.open(this.API_URL+"public/requests/"+this.idConversation+"/messages-user.html","_blank"),this.onMenuOptionShow.emit(!1)}toggleSound(){this.onMenuOptionShow.emit(!1),this.onSoundChange.emit(!this.soundEnabled)}signOut(){this.onSignOut.emit(!0)}toggleMenu(){this.onMenuOptionShow.emit(!this.isMenuShow)}maximizeMinimize(t){this.heightStatus=t,this.onWidgetHeightChange.emit(t)}ngOnDestroy(){this.logger.debug("[CONV-HEADER] ngOnDestroy ------------------\x3e this.subscriptions",this.subscriptions),this.unsubescribeAll()}unsubescribeAll(){this.logger.debug("[CONV-HEADER] unsubescribeAll: ",this.subscriptions),this.subscriptions.forEach(t=>{this.logger.debug("[CONV-HEADER] unsubescribe: ",t),t.value.unsubscribe()}),this.subscriptions.length=0,this.subscriptions=[]}}vn.\u0275fac=function(t){return new(t||vn)(e.Y36(Pe),e.Y36(ke))},vn.\u0275cmp=e.Xpm({type:vn,selectors:[["chat-conversation-header"]],inputs:{idConversation:"idConversation",senderId:"senderId",soundEnabled:"soundEnabled",isMenuShow:"isMenuShow",isTypings:"isTypings",nameUserTypingNow:"nameUserTypingNow",typingLocation:"typingLocation",isTrascriptDownloadEnabled:"isTrascriptDownloadEnabled",hideCloseConversationOptionMenu:"hideCloseConversationOptionMenu",hideRestartConversationOptionsMenu:"hideRestartConversationOptionsMenu",hideHeaderCloseButton:"hideHeaderCloseButton",hideHeaderBackButton:"hideHeaderBackButton",hideHeaderConversationOptionsMenu:"hideHeaderConversationOptionsMenu",hideSignOutOptionMenu:"hideSignOutOptionMenu",windowContext:"windowContext",stylesMap:"stylesMap",translationMap:"translationMap",widgetTitle:"widgetTitle",build_version:"build_version"},outputs:{onBack:"onBack",onCloseWidget:"onCloseWidget",onSoundChange:"onSoundChange",onCloseChat:"onCloseChat",onRestartChat:"onRestartChat",onWidgetHeightChange:"onWidgetHeightChange",onSignOut:"onSignOut",onMenuOptionShow:"onMenuOptionShow"},features:[e.TTD],decls:26,vars:33,consts:[[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-content"],["tabindex","-1",1,"c21-header-button","c21-right","c21-close","c21-button-clean",3,"ngStyle","click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],["tabindex","-1",1,"c21-header-button","c21-right","c21-button-clean",3,"ngStyle","click"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",3,"ngStyle"],["d","M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"],["tabindex","1530","aria-label"," indietro ",1,"c21-header-button","c21-left","c21-button-clean",3,"ngStyle","click"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],[1,"c21-title",3,"ngStyle"],[1,"titleText"],[3,"color","translationMap","nameUserTypingNow","typingLocation",4,"ngIf"],["id","c21-options-menu",4,"ngIf"],[3,"color","translationMap","nameUserTypingNow","typingLocation"],["id","c21-options-menu"],[1,"c21-header-button","c21-right",3,"click"],["aria-labelledby","altIconTitle","class","icon-menu","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",4,"ngIf"],["class","label-menu-item",4,"ngIf"],["class","c21-header-button c21-right",3,"click",4,"ngIf"],["class","c21-button build_version_menu",4,"ngIf"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",1,"icon-menu"],["d","M4.34 2.93L2.93 4.34 7.29 8.7 7 9H3v6h4l5 5v-6.59l4.18 4.18c-.65.49-1.38.88-2.18 1.11v2.06c1.34-.3 2.57-.92 3.61-1.75l2.05 2.05 1.41-1.41L4.34 2.93zM10 15.17L7.83 13H5v-2h2.83l.88-.88L10 11.41v3.76zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zm-7-8l-1.88 1.88L12 7.76zm4.5 8c0-1.77-1.02-3.29-2.5-4.03v1.79l2.48 2.48c.01-.08.02-.16.02-.24z"],["d","M3 9v6h4l5 5V4L7 9H3zm7-.17v6.34L7.83 13H5v-2h2.83L10 8.83zM16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77 0-4.28-2.99-7.86-7-8.77z"],[1,"label-menu-item"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24",1,"icon-menu"],["d","M16 13h-3V3h-2v10H8l4 4 4-4zM4 19v2h16v-2H4z"],["role","img","id","archive","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 512 512",1,"icon-menu"],["d","M80 152v256a40.12 40.12 0 0040 40h272a40.12 40.12 0 0040-40V152","stroke-linecap","round","stroke-linejoin","round","stroke-width","50px","fill","none"],["x","48","y","64","width","416","height","80","rx","28","ry","28","stroke-linejoin","round","stroke-width","50px","fill","none"],["stroke-linecap","round","stroke-linejoin","round","d","M320 304l-64 64-64-64M256 345.89V224","stroke-width","50px","fill","none"],["role","img","id","refresh","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 20 20",1,"icon-menu"],["d","M9.6,18.2c0.6,0,1-0.7,1-1.5s-0.5-1.5-1-1.5H6c-0.6,0-1-0.7-1-1.5V7.8h1c0.4,0,0.8-0.4,1-0.9c0.2-0.6,0.1-1.2-0.2-1.6  l-2.1-3c-0.4-0.6-1.1-0.6-1.5,0l-2.1,3C0.9,5.7,0.8,6.3,1,6.9s0.5,0.9,1,0.9h1v5.9c0,2.5,1.4,4.4,3.1,4.4H9.6z"],["d","M10.5,1.8c-0.5,0-1,0.7-1,1.5s0.4,1.5,1,1.5h3.5c0.5,0,1,0.7,1,1.5v5.9h-1c-0.4,0-0.8,0.4-0.9,0.9s-0.1,1.2,0.2,1.6l2,3  c0.4,0.6,1,0.6,1.4,0l2-3c0.3-0.4,0.4-1.1,0.2-1.6c-0.2-0.6-0.5-0.9-0.9-0.9h-1V6.3c0-2.5-1.3-4.4-3-4.4H10.5z"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","aria-labelledby","altIconTitle",1,"icon-menu"],["d","M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"],[1,"c21-button","build_version_menu"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),e.NdJ("click",function(){return n.closeWidget()}),e.O4$(),e.TgZ(4,"svg",4),e._UZ(5,"path",5)(6,"path",6),e.TgZ(7,"title",7),e._uU(8),e.qZA()()(),e.kcU(),e.TgZ(9,"button",8),e.NdJ("click",function(){return n.toggleMenu()}),e.O4$(),e.TgZ(10,"svg",9),e._UZ(11,"path",5)(12,"path",10),e.TgZ(13,"title",7),e._uU(14),e.qZA()()(),e.kcU(),e.TgZ(15,"button",11),e.NdJ("click",function(){return n.returnHome()}),e.O4$(),e.TgZ(16,"svg",4),e._UZ(17,"path",5)(18,"path",12),e.TgZ(19,"title",7),e._uU(20),e.qZA()()(),e.kcU(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23),e.qZA()(),e.YNc(24,Bs,1,4,"user-typing",15),e.qZA()()(),e.YNc(25,Ws,11,9,"div",16)),2&t&&(e.Q6J("ngStyle",e.VKq(17,Ys,null==n.stylesMap?null:n.stylesMap.get("colorGradient"))),e.xp6(3),e.Q6J("ngStyle",e.VKq(19,oo,n.hideHeaderCloseButton?"none":"flex")),e.uIk("disabled",!!n.isButtonsDisabled||null),e.xp6(1),e.Q6J("ngStyle",e.VKq(21,io,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(null==n.translationMap?null:n.translationMap.get("BUTTON_CLOSE_TO_ICON")),e.xp6(1),e.Q6J("ngStyle",e.VKq(23,oo,n.hideHeaderConversationOptionsMenu?"none":"flex")),e.uIk("disabled",!!n.isButtonsDisabled||null),e.xp6(1),e.Q6J("ngStyle",e.VKq(25,io,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(null==n.translationMap?null:n.translationMap.get("OPTIONS")),e.xp6(1),e.Q6J("ngStyle",e.VKq(27,oo,n.hideHeaderBackButton?"none":"flex")),e.uIk("disabled",!!n.isButtonsDisabled||null),e.xp6(1),e.Q6J("ngStyle",e.VKq(29,io,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(null==n.translationMap?null:n.translationMap.get("PREV_CONVERSATIONS")),e.xp6(1),e.Q6J("ngStyle",e.VKq(31,Js,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.Oqu(n.widgetTitle),e.xp6(1),e.Q6J("ngIf",n.isTypings&&"header"===n.typingLocation),e.xp6(1),e.Q6J("ngIf",n.isMenuShow))},dependencies:[de.O5,de.PC,It],styles:[".c21-header[_ngcontent-%COMP%]{position:fixed;left:0;right:0}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-writing[_ngcontent-%COMP%]{position:absolute;left:40px;right:40px;bottom:3px;width:auto;text-align:center;margin:0;padding:0;font-size:1.1em;color:#fff}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .avatar-project[_ngcontent-%COMP%]{position:relative;padding:0;margin:0 10px 0 0;float:left;height:42px;width:42px;line-height:42px}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{font-size:16px}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{max-width:30px;max-height:30px;margin:6px}#c21-options-menu[_ngcontent-%COMP%]{width:auto;height:auto;min-width:100px;max-width:80%;position:absolute;z-index:10;top:40px;right:15px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;color:#2a6ac1;box-shadow:0 4px 15px #0003,0 1px 2px #0003;background-color:#fff}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{margin:5px;padding:5px 10px;display:flex;align-items:center;color:#777}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;border-radius:6px;cursor:pointer}#c21-options-menu[_ngcontent-%COMP%]   .label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}#c21-options-menu[_ngcontent-%COMP%]   .icon-menu[_ngcontent-%COMP%]{fill:#5f6368}#c21-options-menu[_ngcontent-%COMP%]   .icon-menu#archive[_ngcontent-%COMP%]{stroke:#5f6368}#c21-options-menu[_ngcontent-%COMP%]   .build_version_menu[_ngcontent-%COMP%]{color:#aaa;justify-content:center;font-size:.8em}#c21-options-menu[_ngcontent-%COMP%]   .build_version_menu[_ngcontent-%COMP%]:hover{cursor:default;background-color:unset}"]});var ro=be(5861);const Qs=["divPreview"];function Ks(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-image",25),e.NdJ("onImageRendered",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onImageRenderedFN(i))}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("metadata",n.fileSelected)("width",null==n.fileSelected?null:n.fileSelected.width)("height",null==n.fileSelected?null:n.fileSelected.height)}}const $s=function(r){return{display:r}},Xs=function(r){return{fill:r}};class bn{constructor(t){this.sanitizer=t,this.onSendAttachment=new e.vpe,this.onCloseModalPreview=new e.vpe,this.hideHeaderCloseButton=!1,this.arrayFiles=[],this.isFilePendingToLoad=!1,this.HEIGHT_DEFAULT="20px",this.currentHeight=0,this.startScroll=!0,this.idDivScroll="c21-contentScroll-preview",this.isScrolling=!1,this.isIE=/msie\s|trident\//i.test(window.navigator.userAgent),this.firstScroll=!0,this.logger=fe.getInstance()}ngOnInit(){this.logger.log("[LOADER-PREVIEW-PAGE] Hello!",this.textInputTextArea),this.setFocusOnId("chat21-main-message-context-preview");for(let t=0;t<this.attachments.length;t++)this.logger.log("[LOADER-PREVIEW-PAGE] ngOnInit",this.attachments[t]),this.readAsDataURL(this.attachments[t])}getMetadataSize(t){void 0===t.width&&(t.width=230),void 0===t.height&&(t.height=230);const i={width:t.width,height:t.height};if(t.width&&t.width>230){const l=t.width/t.height;i.width=t.width=230,i.height=t.height=230/l}else if(t.width&&t.width<=55){const l=t.width/t.height;i.width=130,i.height=130/l}return t.height&&t.height>150&&(i.width=150/(t.height/t.width),i.height=150),i}readAsDataURL(t){this.logger.log("[LOADER-PREVIEW-PAGE] readAsDataURL file",t),t.file.type.startsWith("image")&&!t.file.type.includes("svg")?(this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE IMAGE - IMAGE ",t),this.fileSelected||(this.fileSelected=Object.assign({},this.attachments[0].metadata),this.fileSelected=Object.assign(this.fileSelected,this.getMetadataSize(this.fileSelected)))):t.file.type.startsWith("image")&&t.file.type.includes("svg")?(this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE SVG - SVG ",t),t.metadata.src=this.sanitizer.bypassSecurityTrustUrl(t.metadata.src),this.fileSelected||(this.fileSelected=Object.assign({},this.attachments[0].metadata),this.fileSelected=Object.assign(this.fileSelected,this.getMetadataSize(this.fileSelected)))):t.file.type.startsWith("image")||(this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE FILE - FILE ",t),this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE FILE - FILE TYPE",t.file.type),this.file_extension=t.file.name.substring(t.file.name.lastIndexOf(".")+1,t.file.name.length)||t.file.name,this.createFile(t))}createFile(t){var n=this;return(0,ro.Z)(function*(){const o=n;let l=yield(yield fetch(o.baseLocation+"/assets/images/file-alt-solid.png")).blob(),E=new File([l],t.file.name);n.logger.log("[LOADER-PREVIEW-PAGE] - createFile file - file",E);const V=new FileReader;V.onloadend=()=>{const Q=new Image;n.logger.debug("[LOADER-PREVIEW-PAGE] onload ",Q),Q.src=V.result.toString(),Q.title=t.file.name,Q.onload=function(){const se={name:Q.title,src:o.sanitizer.bypassSecurityTrustUrl(Q.src),width:80,height:106,type:t.metadata.type,uid:t.metadata.uid};o.logger.debug("[LOADER-PREVIEW-PAGE] OK: ",se),o.arrayFiles.push({metadata:se}),o.fileSelected||(o.fileSelected=Object.assign({},se))}},V.readAsDataURL(E)})()}onTextAreaChange(){this.resizeInputField(),this.resizeModalHeight()}setFocusOnId(t){setTimeout(function(){const n=document.getElementById(t);n&&(n.setAttribute("value"," "),n.focus())},500)}resizeInputField(){try{const t=document.getElementById("chat21-main-message-context-preview");t.style.height="100%","\n"===t.value?(t.value="",t.style.height=this.HEIGHT_DEFAULT):t.scrollHeight>t.offsetHeight?(t.style.height=t.scrollHeight+2+"px",t.style.minHeight=this.HEIGHT_DEFAULT):t.style.height=this.HEIGHT_DEFAULT}catch(t){this.logger.error("[LOADER-PREVIEW-PAGE] > Error :"+t)}}resizeModalHeight(){try{const t=document.getElementById("chat21-main-message-context-preview"),n=+t.style.height.substring(0,t.style.height.length-2);n>20&&n<110?this.scrollMe.nativeElement.style.height="calc(39% + "+(n-20)+"px":n<=20&&(this.scrollMe.nativeElement.style.height="39%")}catch(t){this.logger.error("[LOADER-PREVIEW-PAGE] > Error :"+t)}}restoreTextArea(){this.resizeInputField();const t=document.getElementById("chat21-main-message-context-preview");this.textInputTextArea="",t?(t.value="",t.placeholder=this.translationMap.get("LABEL_PLACEHOLDER"),this.logger.debug("[LOADER-PREVIEW-PAGE] AppComponent:restoreTextArea::restoreTextArea::textArea:","restored")):this.logger.error("[LOADER-PREVIEW-PAGE] restoreTextArea::textArea:","not restored"),this.setFocusOnId("chat21-main-message-context-preview")}onkeypress(t){const n=t.which||t.keyCode;this.textInputTextArea=document.getElementById("chat21-main-message-context-preview").value,13===n?this.textInputTextArea&&""!==this.textInputTextArea.trim()&&(this.onSendAttachment.emit(this.textInputTextArea),this.restoreTextArea()):9===n&&t.preventDefault()}onkeydown(t){27===(t.which||t.keyCode)&&this.onClickClose()}onPaste(t){this.resizeInputField(),this.logger.debug("[LOADER-PREVIEW] onPaste",t)}onClickClose(){this.logger.debug("[LOADER-PREVIEW] onCLose"),this.onCloseModalPreview.emit()}onSendPressed(t){this.logger.debug("[LOADER-PREVIEW] onSendPressed",t),this.onSendAttachment.emit(this.textInputTextArea)}onImageRenderedFN(t){this.isFilePendingToLoad=!1}}bn.\u0275fac=function(t){return new(t||bn)(e.Y36(S.H7))},bn.\u0275cmp=e.Xpm({type:bn,selectors:[["chat-conversation-attachment-preview"]],viewQuery:function(t,n){if(1&t&&e.Gf(Qs,5),2&t){let o;e.iGM(o=e.CRH())&&(n.scrollMe=o.first)}},inputs:{textInputTextArea:"textInputTextArea",attachments:"attachments",baseLocation:"baseLocation",translationMap:"translationMap",stylesMap:"stylesMap"},outputs:{onSendAttachment:"onSendAttachment",onCloseModalPreview:"onCloseModalPreview"},decls:29,vars:13,consts:[["id","c21-preview"],["id","divPreview",1,"modal-preview-image"],["divPreview",""],[1,"c21-header"],[1,"c21-header-container"],[1,"c21-header-content"],["tabindex","-1",1,"c21-header-button","c21-right","c21-close","c21-button-clean",3,"ngStyle","click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],["id","scroll-me-preview",1,"c21-content"],["scrollMePreview",""],[3,"metadata","width","height","onImageRendered",4,"ngIf"],["id","img-preview-file-extension"],["id","c21-footer"],[1,"visible-text-area"],["start-focus-chat21-conversation-preview-component","","inputTextArea","","tabindex","1502","aria-labelledby","altTextArea","rows","1","id","chat21-main-message-context-preview",1,"f21textarea","c21-button-clean",3,"ngModel","placeholder","ngModelChange","keypress","keydown","paste"],["textbox",""],["tabindex","-1","id","chat21-button-send",1,"chat21-textarea-button",3,"click"],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",0,"xml","space","preserve",2,"enable-background","new 0 0 24 24"],["d","M1.8,18.9V1.7L22,10.3L1.8,18.9z M3.9,15.6l12.6-5.4L3.9,4.9v3.7l6.4,1.6l-6.4,1.6V15.6z M3.9,15.6V4.9v7V15.6z"],["id","testFocus","tabindex","1599","onFocus","document.querySelector('[start-focus-chat21-conversation-preview-component]').focus()"],["id","altTextArea",2,"display","none"],[3,"metadata","width","height","onImageRendered"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1,2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),e.NdJ("click",function(){return n.onClickClose()}),e.O4$(),e.TgZ(7,"svg",7),e._UZ(8,"path",8)(9,"path",9),e.TgZ(10,"title",10),e._uU(11),e.qZA()()()()()(),e.kcU(),e.TgZ(12,"div",11,12),e.YNc(14,Ks,1,3,"chat-image",13),e.TgZ(15,"div",14),e._uU(16),e.qZA()(),e.TgZ(17,"div",15)(18,"div",16)(19,"textarea",17,18),e.NdJ("ngModelChange",function(i){return n.textInputTextArea=i})("ngModelChange",function(){return n.onTextAreaChange()})("keypress",function(i){return n.onkeypress(i)})("keydown",function(i){return n.onkeydown(i)})("paste",function(i){return n.onPaste(i)}),e._uU(21,"        "),e.qZA()(),e.TgZ(22,"div",19),e.NdJ("click",function(i){return n.onSendPressed(i)}),e.TgZ(23,"span",20),e.O4$(),e.TgZ(24,"svg",21),e._UZ(25,"path",22),e.qZA()()()()()(),e.kcU(),e._UZ(26,"span",23),e.TgZ(27,"span",24),e._uU(28,"scrivi la tua domanda"),e.qZA()),2&t&&(e.xp6(6),e.Q6J("ngStyle",e.VKq(9,$s,n.hideHeaderCloseButton?"none":"flex")),e.xp6(1),e.Q6J("ngStyle",e.VKq(11,Xs,null==n.stylesMap?null:n.stylesMap.get("themeColor"))),e.xp6(4),e.Oqu(null==n.translationMap?null:n.translationMap.get("CLOSE")),e.xp6(3),e.Q6J("ngIf",n.fileSelected),e.xp6(2),e.hij("",n.file_extension," "),e.xp6(3),e.s9C("placeholder",null==n.translationMap?null:n.translationMap.get("LABEL_PLACEHOLDER")),e.Q6J("ngModel",n.textInputTextArea),e.xp6(3),e.ekj("active",!n.isFilePendingToLoad))},dependencies:[de.O5,de.PC,Ce.Fj,Ce.JJ,Ce.On,Pt],styles:["[_nghost-%COMP%]   .c21-content[_ngcontent-%COMP%]    >chat-image div{margin:2px auto!important}#c21-preview[_ngcontent-%COMP%]{--margin-top: 200px;--margin-left: 50px;--margin-right: 50px;--header-height: 40px;--modal-height: 240px;--modal-width: 80%;--content-height: 160px;--border-radius: 16px;background-color:#0006;height:100%;width:100%;position:absolute;z-index:25}#c21-preview[_ngcontent-%COMP%]   .modal-preview-image[_ngcontent-%COMP%]{width:auto;height:auto;min-height:var(--modal-height);min-width:100px;max-width:80%;border-radius:var(--border-radius);font-size:1.2em;line-height:normal;overflow:hidden;background-color:#fff;z-index:25;margin:auto;margin-top:var(--margin-top)}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{height:calc(var(--header-height));width:var(--modal-width);position:fixed;top:var(--margin-top)}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{height:calc(var(--header-height))}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;display:inline-block;width:auto;height:40px;padding:0;margin:0 10px;font-size:1em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{margin:6px;width:30px;height:30px}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]{position:fixed;top:calc(var(--margin-top) + var(--header-height));width:var(--modal-width);height:var(--content-height);display:flex;justify-content:center;align-items:center}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #c21-contentScroll-preview[_ngcontent-%COMP%]{position:absolute;left:0;right:10px;padding:10px;opacity:0;transition:opacity .5s;transition-timing-function:ease-in}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden;position:absolute;top:0;right:0}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview[_ngcontent-%COMP%]{scroll-behavior:smooth}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview.withoutAnimation[_ngcontent-%COMP%]{scroll-behavior:unset}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #img-preview-file-extension[_ngcontent-%COMP%]{text-align:center;position:absolute;text-transform:uppercase;color:#fff;bottom:30px;font-weight:500}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]{position:fixed;top:calc(var(--margin-top) + var(--header-height) + var(--content-height));width:var(--modal-width);border-radius:var(--border-radius);background:white;--heigth: calc( var(--modal-height) - var(--header-height) - var(--content-height));--paddingTopBottom: 8px;display:flex;gap:5px;padding:var(--paddingTopBottom) 10px;box-sizing:border-box}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word;resize:horizontal;overflow-y:auto;box-sizing:border-box;color:#1a1a1a;min-width:100%;outline:0;resize:none;font-size:1.4em;line-height:1.4em;font-weight:300;max-height:110px;min-height:auto;height:20px;padding:0 12px;margin:10px 0;border:none}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button[_ngcontent-%COMP%]{position:absolute;display:block;bottom:22px;height:var(--heigth);opacity:.3;cursor:initial}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button.active[_ngcontent-%COMP%]{opacity:1;cursor:pointer}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-button-send[_ngcontent-%COMP%]{right:8px;bottom:var(--paddingTopBottom)}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .visible-text-area[_ngcontent-%COMP%]{pointer-events:auto;border-radius:10px;background-color:#f6f7fb;-webkit-box-flex:1;width:88%}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button[_ngcontent-%COMP%]{pointer-events:auto}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button[_ngcontent-%COMP%]{fill:#5f6368;pointer-events:auto}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:visited, #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:hover, #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:active{all:unset}"]});const ea=["iframe"],Do=function(r){return{fill:r}};function ta(r,t){if(1&r){const n=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.returnOpenExternal())}),e.O4$(),e.TgZ(1,"svg",3),e._UZ(2,"path",15)(3,"path",16),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.VKq(1,Do,null==n.stylesMap?null:n.stylesMap.get("foregroundColor")))}}function na(r,t){1&r&&(e.TgZ(0,"div",17),e._UZ(1,"div")(2,"div")(3,"div")(4,"div")(5,"div")(6,"div")(7,"div")(8,"div"),e.qZA())}const oa=function(r){return{"background-image":r}},ia=function(r){return{color:r}};class Cn{constructor(t){this.sanitizer=t,this.onOpenExternal=new e.vpe,this.onClose=new e.vpe,this.isOpen="open",this.hideSpinner=!1,this.logger=fe.getInstance(),this.convertColorToRGBA=Ae}ngOnInit(){this.button&&this.button.link&&(this.url=this.sanitizer.bypassSecurityTrustResourceUrl(this.button.link))}ngAfterViewInit(){this.logger.debug("[INTERNALFRAME] ngAfterViewInit",this.iframe.nativeElement.contentDocument||this.iframe.nativeElement.contentWindow,this.iframe.nativeElement.contentWindow,this.iframe.nativeElement.contentWindow.history)}ngOnDestroy(){this.url=null,this.hideSpinner=!1}returnClose(){this.isOpen="closed",this.onClose.emit()}returnOpenExternal(){this.onOpenExternal.emit(this.button)}onIframeLoaded(t){this.hideSpinner=!0}onError(t){this.logger.error("[INTERNALFRAME] onError ",t)}}Cn.\u0275fac=function(t){return new(t||Cn)(e.Y36(S.H7))},Cn.\u0275cmp=e.Xpm({type:Cn,selectors:[["chat-internal-frame"]],viewQuery:function(t,n){if(1&t&&e.Gf(ea,5),2&t){let o;e.iGM(o=e.CRH())&&(n.iframe=o.first)}},inputs:{button:"button",openExternalLinkButton:"openExternalLinkButton",stylesMap:"stylesMap",translationMap:"translationMap"},outputs:{onOpenExternal:"onOpenExternal",onClose:"onClose"},decls:16,vars:15,consts:[[1,"c21-iframe-container"],[1,"c21-iframe-header","c21-header",3,"ngStyle"],["tabindex","1530",1,"c21-header-button","c21-left","c21-button-clean",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],["id","altIconTitle"],["tabindex","1530","class","c21-header-button c21-right c21-button-clean",3,"click",4,"ngIf"],[1,"c21-title",3,"ngStyle"],[1,"titleText"],[1,"c21-iframe"],["class","lds-roller",4,"ngIf"],["id","contentFrame","allowfullscreen","","title","","width","100%","height","100%",2,"border","none",3,"src","load","error"],["iframe",""],["tabindex","1530",1,"c21-header-button","c21-right","c21-button-clean",3,"click"],["d","M0 0h24v24H0z","fill","none"],["d","M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"],[1,"lds-roller"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return n.returnClose()}),e.O4$(),e.TgZ(3,"svg",3),e._UZ(4,"path",4)(5,"path",5),e.TgZ(6,"title",6),e._uU(7),e.qZA()()(),e.YNc(8,ta,4,3,"button",7),e.kcU(),e.TgZ(9,"div",8)(10,"div",9),e._uU(11),e.qZA()()(),e.TgZ(12,"div",10),e.YNc(13,na,9,0,"div",11),e.TgZ(14,"iframe",12,13),e.NdJ("load",function(i){return n.onIframeLoaded(i)})("error",function(i){return n.onError(i)}),e.qZA()()()),2&t&&(e.Q6J("@enterAnimation",void 0),e.xp6(1),e.Q6J("ngStyle",e.VKq(9,oa,null==n.stylesMap?null:n.stylesMap.get("colorGradient"))),e.xp6(2),e.Q6J("ngStyle",e.VKq(11,Do,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(null==n.translationMap?null:n.translationMap.get("CLOSE")),e.xp6(1),e.Q6J("ngIf",n.openExternalLinkButton),e.xp6(1),e.Q6J("ngStyle",e.VKq(13,ia,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.Oqu(null==n.button?null:n.button.value),e.xp6(2),e.Q6J("ngIf",!n.hideSpinner),e.xp6(1),e.Q6J("src",n.url,e.uOi))},dependencies:[de.O5,de.PC],styles:['.c21-iframe-container[_ngcontent-%COMP%]{max-width:100%;height:100%;width:100%;position:fixed;background-color:#fff;z-index:10}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]{left:0;right:0}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{display:block;align-items:center;text-align:center;width:40px;height:40px;margin:6px;padding:0;cursor:pointer}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button.c21-right[_ngcontent-%COMP%]{float:right}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button.c21-left[_ngcontent-%COMP%]{float:left}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button.c21-close[_ngcontent-%COMP%]{display:none}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:20px;width:20px;margin:10px}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe[_ngcontent-%COMP%]{height:calc(100% - 40px)}.lds-roller[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;margin:30px auto}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_lds-roller 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:7px;height:7px;border-radius:50%;background:rgb(30,96,181);margin:-4px 0 0 -4px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1){animation-delay:-36ms}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1):after{top:63px;left:63px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){animation-delay:-72ms}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2):after{top:68px;left:56px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){animation-delay:-.108s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3):after{top:71px;left:48px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4){animation-delay:-.144s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4):after{top:72px;left:40px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(5){animation-delay:-.18s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(5):after{top:71px;left:32px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(6){animation-delay:-.216s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(6):after{top:68px;left:24px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(7){animation-delay:-.252s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(7):after{top:63px;left:17px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(8){animation-delay:-.288s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(8):after{top:56px;left:12px}@keyframes _ngcontent-%COMP%_lds-roller{0%{transform:rotate(0)}to{transform:rotate(360deg)}}'],data:{animation:[(0,Se.X$)("enterAnimation",[(0,Se.eR)(":enter",[(0,Se.oB)({transform:"translateX(100%)",opacity:0}),(0,Se.jt)("400ms",(0,Se.oB)({transform:"translateX(0)",opacity:1}))]),(0,Se.eR)(":leave",[(0,Se.oB)({transform:"translateX(0)",opacity:1}),(0,Se.jt)("400ms",(0,Se.oB)({transform:"translateX(100%)",opacity:0}))])])]}});const ra=["afConversationComponent"];function sa(r,t){1&r&&(e.TgZ(0,"div",10)(1,"div",11),e._uU(2," drop zone "),e.qZA()())}function aa(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-internal-frame",12),e.NdJ("onOpenExternal",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onOpenExternalFrame(i))})("onClose",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onCloseInternalFrame(i))}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("button",n.buttonClicked)("openExternalLinkButton",null==n.g?null:n.g.openExternalLinkButton)("translationMap",n.translationMapHeader)("stylesMap",n.stylesMap)}}function la(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-conversation-attachment-preview",13),e.NdJ("onSendAttachment",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.onSendAttachment(i))})("onCloseModalPreview",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onCloseModalPreview())}),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("textInputTextArea",n.textInputTextArea)("attachments",n.attachments)("baseLocation",null==n.g?null:n.g.baseLocation)("translationMap",n.translationMapPreview)("stylesMap",n.stylesMap)}}function ca(r,t){if(1&r&&(e.O4$(),e.kcU(),e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.Oqu(n.messagesBadgeCount)}}function ha(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",14),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.scrollToBottom())}),e.O4$(),e.TgZ(1,"svg",15),e._UZ(2,"path",16)(3,"path",17),e.qZA(),e.YNc(4,ca,2,1,"div",18),e.qZA()}if(2&r){const n=e.oxw();e.xp6(4),e.Q6J("ngIf",0!=n.messagesBadgeCount)}}class wn{constructor(t,n,o,i,l,E,V,Q,se,ge,me,ce,ve){this.g=t,this.starRatingWidgetService=n,this.sanitizer=o,this.appComponent=i,this.appStorageService=l,this.conversationHandlerBuilderService=E,this.appConfigService=V,this.customTranslateService=Q,this.chatManager=se,this.typingService=ge,this.tiledeskRequestService=me,this.changeDetectorRef=ce,this.elementRef=ve,this.onBackHome=new e.vpe,this.onCloseWidget=new e.vpe,this.onSoundChange=new e.vpe,this.onConversationClosed=new e.vpe,this.onSignOut=new e.vpe,this.onBeforeMessageSent=new e.vpe,this.onAfterSendMessage=new e.vpe,this.onNewConversationInit=new e.vpe,this.onBeforeMessageRender=new e.vpe,this.onAfterMessageRender=new e.vpe,this.onNewMessageCreated=new e.vpe,this.onNewConversationButtonClicked=new e.vpe,this.isMenuShow=!1,this.isEmojiiPickerShow=!1,this.isButtonsDisabled=!0,this.hideFooterTextReply=!1,this.hideTextAreaContent=!1,this.footerMessagePlaceholder="",this.isTrascriptDownloadEnabled=!1,this.showContinueConversationButton=!1,this.isScrolling=!1,this.idDivScroll="c21-contentScroll",this.showBadgeScroollToBottom=!1,this.messagesBadgeCount=0,this.isFileSelected=!1,this.isOpenAttachmentPreview=!1,this.isPopupUrl=mo,this.popupUrl=Jn,this.messages=[],this.CLIENT_BROWSER=navigator.userAgent,this.subscriptions=[],this.unsubscribe$=new Fs.xQ,this.isIE=/msie\s|trident\//i.test(window.navigator.userAgent),this.firstScroll=!0,this.isHovering=!1,this.tooltipOptions={"show-delay":1500,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},this.isTypings=!1,this.isDirect=!1,this.membersConversation=["SYSTEM"],this.isButtonUrl=!1,this.logger=fe.getInstance()}onResize(t){this.logger.debug("[CONV-COMP] resize event",t)}ngOnInit(){this.logger.debug("[CONV-COMP] ngOnInit: ",this.senderId),this.showMessageWelcome=!1,this.translations()}translations(){this.translationMapHeader=this.customTranslateService.translateLanguage(["LABEL_LAST_ACCESS","LABEL_WRITING","BUTTON_CLOSE_TO_ICON","OPTIONS","PREV_CONVERSATIONS","SOUND_OFF","SOUND_ON","DOWNLOAD_TRANSCRIPT","BACK","CLOSE","MAXIMIZE","MINIMIZE","CLOSE_CHAT","RESTART","LOGOUT"]),this.translationMapFooter=this.customTranslateService.translateLanguage(["LABEL_PLACEHOLDER","GUEST_LABEL","LABEL_START_NW_CONV","CONTINUE"]),this.translationMapContent=this.customTranslateService.translateLanguage(["INFO_SUPPORT_USER_ADDED_SUBJECT","INFO_SUPPORT_USER_ADDED_YOU_VERB","INFO_SUPPORT_USER_ADDED_COMPLEMENT","INFO_SUPPORT_USER_ADDED_VERB","INFO_SUPPORT_CHAT_REOPENED","INFO_SUPPORT_CHAT_CLOSED","INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU","INFO_SUPPORT_LEAD_UPDATED","INFO_SUPPORT_MEMBER_LEFT_GROUP","INFO_SUPPORT_LIVE_PAGE","LABEL_TODAY","LABEL_TOMORROW","LABEL_LOADING","LABEL_TO","ARRAY_DAYS"]),this.translationMapPreview=this.customTranslateService.translateLanguage(["BACK","CLOSE","LABEL_PLACEHOLDER","LABEL_PREVIEW"])}ngAfterViewInit(){this.logger.debug("[CONV-COMP] --------ngAfterViewInit: conversation-------- "),setTimeout(()=>{this.initAll(),!0===this.g.newConversationStart&&(this.onNewConversationComponentInit(),this.g.newConversationStart=!1),this.setSubscriptions(),this.afConversationComponent&&this.afConversationComponent.nativeElement.focus(),this.isButtonsDisabled=!1},300)}ngAfterViewChecked(){this.changeDetectorRef.detectChanges()}ngOnChanges(t){this.logger.debug("[CONV-COMP] onChagnges",t),this.stylesMap&&(this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))),t&&t.conversationId&&void 0!==t.conversationId.previousValue&&t.conversationId.previousValue!==t.conversationId.currentValue&&(this.logger.debug("[CONV-COMP] UID CHANGESSSS",t.conversationId),this.ngOnDestroy(),this.ngOnInit(),this.ngAfterViewInit())}updateConversationBadge(){if(this.logger.debug("[CONV-COMP] updateConversationBadge",this.conversationId,this.isConversationArchived),this.isConversationArchived&&this.conversationId&&this.archivedConversationsHandlerService&&this.archivedConversationsHandlerService.setConversationRead(this.conversationId),!this.isConversationArchived&&this.conversationId&&this.conversationsHandlerService){this.conversationsHandlerService.setConversationRead(this.conversationId);const t=this.conversationsHandlerService.countIsNew();this.g.setParameter("conversationsBadge",t)}}initAll(){this.logger.debug("[CONV-COMP] ------ 2: setConversation ------ "),this.setConversation(),this.logger.debug("[CONV-COMP] ------ 3: connectConversation ------ "),this.initConversationHandler(),this.logger.debug("[CONV-COMP] ------ 4: initializeChatManager ------ "),this.logger.debug("[CONV-COMP] ------ 6: getConversationDetail ------ ",this.conversationId),this.getConversationDetail(t=>{this.logger.debug("[CONV-COMP] ------ 6: updateConversationbage ------ "),this.updateConversationBadge()}),this.g.customAttributes&&this.updateUserInfo(this.g.customAttributes),this.logger.debug("[CONV-COMP] ------ 7: initializeTyping()",this.conversationId),this.initializeTyping()}getConversationDetail(t){this.logger.debug("[CONV-COMP] getConversationDetail: isConversationArchived???",this.isConversationArchived,this.conversationWith),this.conversationsHandlerService.getConversationDetail(this.conversationWith,n=>{this.logger.debug("[CONV-COMP] getConversationDetail: conversationsHandlerService ",this.conversationWith,n,this.isConversationArchived),n&&(this.conversation=n,this.isConversationArchived=!1,t(this.isConversationArchived)),n||(this.logger.debug("[CONV-COMP] getConversationDetail: conv not exist --\x3e search in archived list",this.isConversationArchived,this.conversationWith),this.archivedConversationsHandlerService.getConversationDetail(this.conversationWith,o=>{this.logger.debug("[CONV-COMP] getConversationDetail: archivedConversationsHandlerService",this.conversationWith,o,this.isConversationArchived),o?(this.conversation=o,this.isConversationArchived=!0,this.showContinueConversationButton=function oi(r,t){const n=xt(r),o=xt(t),i=xt.duration(o.diff(n));return{days:i.asDays(),hours:i.asHours(),minutes:i.asMinutes()}}(this.conversation.timestamp,Date.now()).hours<this.g.continueConversationBeforeTime,t(this.isConversationArchived)):o||t(null)}))})}setConversation(){const t=this.g.recipientId,n=this.g.channelType;this.logger.debug("[CONV-COMP] setConversation recipientId::: ",t,n),t||this.g.setParameter("recipientId",this.setRecipientId()),n||this.g.setParameter("channelType",this.setChannelType()),this.conversationWith=t,this.logger.debug("[CONV-COMP] setConversation conversation::: ",this.conversation),this.conversation||(this.conversation=new Ns(t,this.g.attributes,n,this.g.recipientFullname,this.conversationWith,t,this.g.recipientFullname,"",!0,"","",this.senderId,"",this.g.userFullname,"0","",!0,"","",!1,"text"))}setRecipientId(){let t;return t=this.appStorageService.getItem(this.senderId),t||(t=po+this.g.projectid+"-"+(0,Nn.Z)().replace(/-/g,""),this.logger.debug("[CONV-COMP] recipitent",t)),t}setChannelType(){let t="group";const n=this.g.projectid;return this.g.recipientId&&-1!==this.g.recipientId.indexOf("group")?t="group":n||(t="direct"),t}initConversationHandler(){const t=this.g.tenant;this.messages=[];const n={uid:this.senderId},o=this.g.recipientFullname;this.logger.debug("[CONV-COMP] initconversation NEWWW",n,o,t),this.showMessageWelcome=!1;const i=this.chatManager.getConversationHandlerByConversationId(this.conversationWith);if(this.logger.debug("[CONV-COMP] DETTAGLIO CONV - handler **************",i,this.conversationWith),i)this.logger.debug("[CONV-COMP] NON ENTRO ***",this.conversationHandlerService,i),this.conversationHandlerService=i,this.messages=this.conversationHandlerService.messages;else{this.conversationHandlerService=this.conversationHandlerBuilderService.build(),this.conversationHandlerService.initialize(this.conversationWith,o,n,t,this.translationMapContent,this.g.showInfoMessage),this.conversationHandlerService.connect(),this.logger.debug("[CONV-COMP] DETTAGLIO CONV - NEW handler **************",this.conversationHandlerService),this.messages=this.conversationHandlerService.messages,this.sendFirstMessagePreChatForm(),this.logger.debug("[CONV-COMP] DETTAGLIO CONV - messages **************",this.messages),this.chatManager.addConversationHandler(this.conversationHandlerService);const l=this;setTimeout(()=>{(!l.messages||0===l.messages.length)&&(l.showMessageWelcome=!0,l.logger.debug("[CONV-COMP] setTimeout ***",l.showMessageWelcome))},8e3)}this.logger.debug("[CONV-COMP] CONVERSATION MESSAGES "+this.messages),this.conversationsHandlerService=this.chatManager.conversationsHandlerService,this.archivedConversationsHandlerService=this.chatManager.archivedConversationsService}sendFirstMessagePreChatForm(){setTimeout(()=>{this.messages&&0===this.messages.length&&(this.logger.debug("[CONV-COMP] sendFirstMessage: messages + attributes ",this.messages,this.g.attributes),this.g.attributes&&this.g.attributes.preChatForm&&this.g.attributes.preChatForm.firstMessage)&&this.conversationFooter.sendMessage(this.g.attributes.preChatForm.firstMessage,Fn,this.g.attributes)},1e3)}sendLivePage(){setTimeout(()=>{const t="Moved to: ["+this.g.attributes.sourceTitle+"]("+this.g.attributes.sourcePage+")",n={subtype:"info/support",messagelabel:{key:H}};this.logger.debug("[CONV-COMP] sendLivePage --\x3e attributes+message",n,t),this.conversationFooter.sendMessage(t,Fn,null,n)},1e3)}initializeTyping(){this.logger.debug("[CONV-COMP] membersconversation",this.membersConversation),this.membersConversation.push(this.senderId),this.typingService.isTyping(this.conversationId,this.senderId,this.isDirect)}subscribeTypings(t){const n=this;try{const o=t.uidUserTypingNow,i=t.waitTime;this.nameUserTypingNow=null,this.idUserTypingNow=null,t.nameUserTypingNow&&(this.nameUserTypingNow=t.nameUserTypingNow),t.uidUserTypingNow&&(this.idUserTypingNow=t.uidUserTypingNow),this.logger.debug("[CONV-COMP] subscribeTypings data:",t),!this.membersConversation.includes(o)&&o&&(this.isTypings=!0,setTimeout(function(){n.conversationContent.scrollToBottom()},0),this.setTimeoutWritingMessages=setTimeout(()=>{n.isTypings=!1},i))}catch(o){this.logger.error("[CONV-COMP] error: ",o)}}initiTimeout(t){const n=this;this.setTimeoutWritingMessages=setTimeout(()=>{n.isTypings=!1},t)}resetTimeout(){this.isTypings=!1,this.setTimeoutWritingMessages=null,clearTimeout(this.setTimeoutWritingMessages)}setSubscriptions(){const t=this;let n,o;o="starRating",n=this.subscriptions.find(i=>i.key===o),n||(this.starRatingWidgetService.setOsservable(!1),this.logger.debug("[CONV-COMP] setSubscriptions!!!! StartRating",this.starRatingWidgetService.obsCloseConversation.value),n=this.starRatingWidgetService.obsCloseConversation.pipe((0,Ct.R)(this.unsubscribe$)).subscribe(l=>{this.logger.debug("[CONV-COMP] startratingggg",l),t.g.setParameter("isOpenStartRating",l),!1===l?this.logger.debug("[CONV-COMP] NOT OPEN StartRating **"):!0===l&&this.logger.debug("[CONV-COMP] OPEN StartRating **")}),this.subscriptions.push({key:o,value:n})),o="messageAdded",n=this.subscriptions.find(i=>i.key===o),n||(this.logger.debug("[CONV-COMP] ***** add messageAdded *****",this.conversationHandlerService),n=this.conversationHandlerService.messageAdded.pipe((0,Ct.R)(this.unsubscribe$)).subscribe(l=>{this.logger.debug("[CONV-COMP] ***** DETAIL messageAdded *****",l),l&&(t.newMessageAdded(l),this.onNewMessageCreated.emit(l),this.checkMessagesLegntForTranscriptDownloadMenuOption(),this.resetTimeout())}),this.subscriptions.push({key:o,value:n})),o="conversationsRemoved",n=this.subscriptions.find(i=>i.key===o),n||(n=this.chatManager.conversationsHandlerService.conversationRemoved.pipe((0,Ct.R)(this.unsubscribe$)).subscribe(l=>{this.logger.debug("[CONV-COMP] ***** DATAIL conversationsRemoved *****",l,this.conversationWith,this.isConversationArchived),l&&l.uid===this.conversationWith&&(this.isConversationArchived=!0,this.g.nativeRating&&this.starRatingWidgetService.setOsservable(!0),this.g.nativeRating||this.onConversationClosed.emit(l.uid))}),this.subscriptions.push({key:o,value:n})),o="conversationsChanged",n=this.subscriptions.find(i=>i.key===o),n||(n=this.chatManager.conversationsHandlerService.conversationChanged.pipe((0,Ct.R)(this.unsubscribe$)).subscribe(l=>{this.logger.debug("[CONV-COMP] ***** DATAIL conversationsChanged *****",l,this.conversationWith,this.isConversationArchived),(!l||l.recipient!==this.g.senderId||!xo(l))&&l&&l.sender!==this.senderId&&t.conversationContent.checkContentScrollPosition()&&l.is_new&&(this.logger.debug("[CONV-COMP] updateConversationBadge..."),t.updateConversationBadge())}),this.subscriptions.push({key:o,value:n})),o="messageWait",n=this.subscriptions.find(i=>i.key===o),n||(this.logger.debug("[CONV-COMP] ***** add messageWait *****",this.conversationHandlerService),n=this.conversationHandlerService.messageWait.pipe((0,Ct.R)(this.unsubscribe$)).subscribe(l=>{this.logger.debug("[CONV-COMP] ***** DETAIL messageWait *****",l),l&&l.waitTime&&0!==l.waitTime&&this.conversationId===l.uid&&t.subscribeTypings(l)}),this.subscriptions.push({key:o,value:n})),o="messageInfo",n=this.subscriptions.find(i=>i.key===o),n||(this.logger.debug("[CONV-COMP] ***** add messageInfo *****",this.conversationHandlerService),n=this.conversationHandlerService.messageInfo.pipe((0,Ct.R)(this.unsubscribe$)).subscribe(l=>{this.logger.debug("[CONV-COMP] ***** DETAIL messageInfo *****",l),l&&this.updateLeadInfo(l)}),this.subscriptions.push({key:o,value:n})),o="conversationTyping",n=this.subscriptions.find(i=>i.key===o),n||(n=this.typingService.BSIsTyping.pipe((0,Ct.R)(this.unsubscribe$)).subscribe(l=>{this.logger.debug("[CONV-COMP] ***** BSIsTyping *****",l),l&&this.conversationId===l.uid&&t.subscribeTypings(l)}),this.subscriptions.push({key:o,value:n}))}checkMessagesLegntForTranscriptDownloadMenuOption(){this.messages.length>1&&this.g.allowTranscriptDownload&&(this.isTrascriptDownloadEnabled=!0)}newMessageAdded(t){const n=this,o=n.senderId;t.sender===o?(n.logger.debug("[CONV-COMP] *A1-------"),setTimeout(function(){n.conversationContent.scrollToBottom()},200)):t.sender!==o&&(n.conversationContent.checkContentScrollPosition()?(n.logger.debug("[CONV-COMP] *A2-------"),setTimeout(function(){n.conversationContent.scrollToBottom()},200)):(n.logger.debug("[CONV-COMP] *A3-------"),n.messagesBadgeCount++),t.attributes&&t.attributes.disableInputMessage?this.hideFooterTextReply=t.attributes.disableInputMessage:t.attributes&&!t.attributes.disableInputMessage&&(this.hideFooterTextReply=!1),this.footerMessagePlaceholder=t.attributes&&t.attributes.inputMessagePlaceholder?t.attributes.inputMessagePlaceholder:"")}updateLeadInfo(t){if(t.attributes&&t.attributes.updateUserFullname){const n=t.attributes.updateUserFullname;this.logger.debug("[CONV-COMP] newMessageAdded --\x3e updateUserFullname",n),this.g.setAttributeParameter("userFullname",n),this.g.setParameter("userFullname",n),this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes))}if(t.attributes&&t.attributes.updateUserEmail){const n=t.attributes.updateUserEmail;this.logger.debug("[CONV-COMP] newMessageAdded --\x3e userEmail",n),this.g.setAttributeParameter("userEmail",n),this.g.setParameter("userEmail",n),this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes))}}updateUserInfo(t){if(t&&t.userFullname){const n=t.userFullname;this.logger.debug("[CONV-COMP] updateUserInfo --\x3e userFullname",n),this.g.setAttributeParameter("userFullname",n),this.g.setParameter("userFullname",n)}if(t&&t.userEmail){const n=t.userEmail;this.logger.debug("[CONV-COMP] updateUserInfo --\x3e userEmail",n),this.g.setAttributeParameter("userEmail",n),this.g.setParameter("userEmail",n)}this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes))}scrollToBottom(){this.conversationContent.scrollToBottom()}onBackHomeFN(){this.onBackHome.emit()}onCloseWidgetFN(){this.onCloseWidget.emit()}onSoundChangeFN(t){this.onSoundChange.emit(t)}onCloseChat(t){this.logger.debug("[CONV-COMP] close chat with uid ",this.conversation.uid),this.tiledeskRequestService.closeSupportGroup(this.conversation.uid).then(n=>{"closed"===n&&(this.isMenuShow=!1,this.logger.debug("[CONV-COMP] chat closed successfully with uid ",this.conversation.uid))}).catch(n=>{this.logger.error("[CONV-COMP] ERROR while closing chat with id: ",this.conversation.uid,n)})}onRestartChat(t){this.hideTextAreaContent=!0}onWidgetHeightChange(t){var n=this.g.windowContext.window.document.getElementById("tiledeskdiv");"max"===t?n.style.maxHeight="unset":"min"===t&&(n.style.maxHeight="620px"),this.isMenuShow=!1}onSignOutFN(t){this.onSignOut.emit(!0)}onMenuOption(t){this.isMenuShow=t,this.conversationFooter.removeFocusOnId("chat21-main-message-context")}onBeforeMessageRenderFN(t){this.onBeforeMessageRender.emit(t)}onAfterMessageRenderFN(t){this.onAfterMessageRender.emit(t)}onAttachmentButtonClicked(t){if(this.logger.debug("[CONV-COMP] eventbutton",t),t&&t.target.type)switch(t.target.type){case"url":try{this.openLink(t.target.button)}catch(n){this.logger.error("[CONV-COMP] url > Error :"+n)}return;case"action":try{this.actionButton(t.target.button)}catch(n){this.logger.error("[CONV-COMP] action > Error :"+n)}return!1;case"text":try{this.conversationFooter.sendMessage(t.target.button.value,Fn,{button:!0})}catch(n){this.logger.error("[CONV-COMP] text > Error :"+n)}default:return}}onScrollContent(t){this.showBadgeScroollToBottom=!t,this.logger.debug("[CONV-COMP] scroool eventtt",t),this.showBadgeScroollToBottom||(this.messagesBadgeCount=0,this.updateConversationBadge())}onOpenExternalFrame(t){window.open(t.link,"_blank")}onCloseInternalFrame(t){this.isButtonUrl=!1,this.buttonClicked=null,this.restoreDefaultWidgetSize()}onSendAttachment(t){this.isOpenAttachmentPreview=!1,this.conversationFooter.uploadSingle(this.attachments[0].metadata,this.attachments[0].file,t)}onCloseModalPreview(){this.isOpenAttachmentPreview=!1,this.conversationFooter.isFilePendingToUpload=!1,this.logger.debug("[CONV-COMP] onCloseModalPreview::::",this.isOpenAttachmentPreview,this.conversationFooter)}onEmojiiPickerShow(t){this.isEmojiiPickerShow=t}onBeforeMessangeSentFN(t){this.onBeforeMessageSent.emit(t)}onAfterSendMessageFN(t){this.onAfterSendMessage.emit(t)}onChangeTextArea(t){if(t&&t.textAreaEl){const n=this.conversationContent.scrollMe,o=+t.textAreaEl.style.height.substring(0,t.textAreaEl.style.height.length-2);o>20&&o<110?(n.nativeElement.style.height="calc(100% - "+(o-20)+"px",this.scrollToBottom()):o<=20&&(n.nativeElement.style.height="100%")}}onAttachmentFileButtonClicked(t){this.logger.debug("[CONV-COMP] onAttachmentButtonClicked::::",t),this.attachments=t.attachments,this.textInputTextArea=t.message,this.logger.debug("[CONV-COMP] onAttachmentButtonClicked::::",this.textInputTextArea),this.isOpenAttachmentPreview=!0}onNewConversationButtonClickedFN(t){this.logger.debug("[CONV-COMP] floating onNewConversationButtonClicked"),this.onNewConversationButtonClicked.emit()}onBackButton(t){this.hideTextAreaContent=t;try{document.getElementById("chat21-footer").classList.remove("maximize-width")}catch(n){this.logger.error("[CONV-COMP] onBackButton > Error :"+n)}}openInputFiles(){alert("ok"),document.getElementById("chat21-file")&&(document.getElementById("chat21-file").style.display="block")}ngOnDestroy(){this.logger.debug("[CONV-COMP] ngOnDestroy ------------------\x3e this.subscriptions",this.subscriptions),this.isConversationArchived=!1,this.hideTextAreaContent=!1,this.conversationFooter.textInputTextArea="",this.hideFooterTextReply=!1,this.footerMessagePlaceholder="",this.unsubscribe()}unsubscribe(){this.logger.debug("[CONV-COMP] ******* unsubscribe *******"),this.unsubscribe$.next(),this.unsubscribe$.complete(),this.chatManager.conversationsHandlerService.conversationRemoved.next(null),this.conversationHandlerService.messageWait.next(null),this.typingService.BSIsTyping.next(null),this.subscriptions.forEach(function(t){t.value.unsubscribe()}),this.subscriptions=[],this.subscriptions.length=0,this.logger.debug("[CONV-COMP]this.subscriptions",this.subscriptions)}onIncreaseWith(){try{this.g.windowContext.window.document.getElementById("tiledeskdiv").classList.add("increaseSize"),document.getElementById("chat21-conversations").style.borderRadius="16px"}catch(t){this.logger.error("[CONV-COMP] onIncreaseWith > Error :"+t)}}restoreDefaultWidgetSize(){try{const t=this.g.windowContext.window.document.getElementById("tiledeskdiv");t.classList.remove("increaseSize"),t.classList.remove("decreaseSize")}catch(t){this.logger.error("[CONV-COMP] restoreDefaultWidgetSize > Error :"+t)}}openLink(t){const n=t.link?t.link:"",o=t.target?t.target:"";"self"===o?(this.isButtonUrl=!0,this.buttonClicked=t):"parent"===o?window.open(n,"_parent"):window.open(n,"_blank")}actionButton(t){this.conversationFooter.sendMessage(t.value?t.value:"",Fn,null,{action:t.action?t.action:"",subtype:t.show_echo?"":"info"}),this.logger.debug("[CONV-COMP] > action :")}onNewConversationComponentInit(){this.logger.debug("[CONV-COMP] ------- onNewConversationComponentInit ------- "),this.setConversation();const t=this.conversationWith,n=this.g.default_settings,o=this.appConfigService.getConfig();this.onNewConversationInit.emit({global:this.g,default_settings:n,newConvId:t,appConfigs:o})}drop(t){t.preventDefault(),t.stopPropagation(),this.logger.log("[CONV-COMP] ----\x3e FILE - DROP ev ",t);const n=t.dataTransfer.files;this.logger.log("[CONV-COMP] ----\x3e FILE - DROP ev.dataTransfer.files ",n),this.isHovering=!1,n.length>0&&(this.logger.log("[CONV-COMP] ----\x3e FILE - DROP file ",n[0]),this.logger.log("[CONV-COMP] ----\x3e FILE - DROP mimeType files ",n[0].type),this.dropEvent=t)}allowDrop(t){t.preventDefault(),t.stopPropagation(),this.logger.log("[CONV-COMP] ----\x3e FILE - (dragover) allowDrop ev ",t),this.isHovering=!0}drag(t){t.preventDefault(),t.stopPropagation(),console.log("dragleave--\x3e",t),this.isHovering=!1}}wn.\u0275fac=function(t){return new(t||wn)(e.Y36(Pe),e.Y36(lt),e.Y36(S.H7),e.Y36(_t),e.Y36(Re),e.Y36(Qe),e.Y36(ke),e.Y36(He),e.Y36(Xe),e.Y36(je),e.Y36(at),e.Y36(e.sBO),e.Y36(e.SBq))},wn.\u0275cmp=e.Xpm({type:wn,selectors:[["chat-conversation"]],viewQuery:function(t,n){if(1&t&&(e.Gf(ra,5),e.Gf(St,5),e.Gf(Rt,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.afConversationComponent=o.first),e.iGM(o=e.CRH())&&(n.conversationFooter=o.first),e.iGM(o=e.CRH())&&(n.conversationContent=o.first)}},hostBindings:function(t,n){1&t&&e.NdJ("resize",function(i){return n.onResize(i)},!1,e.Jf7)},inputs:{conversationId:"conversationId",stylesMap:"stylesMap",isOpen:"isOpen",senderId:"senderId",isConversationArchived:"isConversationArchived"},outputs:{onBackHome:"onBackHome",onCloseWidget:"onCloseWidget",onSoundChange:"onSoundChange",onConversationClosed:"onConversationClosed",onSignOut:"onSignOut",onBeforeMessageSent:"onBeforeMessageSent",onAfterSendMessage:"onAfterSendMessage",onNewConversationInit:"onNewConversationInit",onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender",onNewMessageCreated:"onNewMessageCreated",onNewConversationButtonClicked:"onNewConversationButtonClicked"},features:[e.TTD],decls:10,vars:56,consts:[["id","chat21-conversation-component","tabindex","1500","aria-modal","true"],["afConversationComponent",""],[3,"idConversation","senderId","soundEnabled","isTrascriptDownloadEnabled","hideHeaderCloseButton","hideHeaderBackButton","hideCloseConversationOptionMenu","hideRestartConversationOptionsMenu","hideHeaderConversationOptionsMenu","hideSignOutOptionMenu","stylesMap","translationMap","widgetTitle","build_version","windowContext","isMenuShow","isTypings","nameUserTypingNow","typingLocation","onBack","onCloseWidget","onSoundChange","onCloseChat","onRestartChat","onWidgetHeightChange","onSignOut","onMenuOptionShow"],["id","dropZone_container",4,"ngIf"],[3,"messages","senderId","baseLocation","isConversationArchived","isTypings","idUserTypingNow","nameUserTypingNow","typingLocation","fullscreenMode","translationMap","stylesMap","onBeforeMessageRender","onAfterMessageRender","onAttachmentButtonClicked","onScrollContent","onMenuOptionShow","onEmojiiPickerShow","drop","dragover","dragleave"],[3,"button","openExternalLinkButton","translationMap","stylesMap","onOpenExternal","onClose",4,"ngIf"],[3,"textInputTextArea","attachments","baseLocation","translationMap","stylesMap","onSendAttachment","onCloseModalPreview",4,"ngIf"],["id","chat21-footer"],["id","chat21-buttonToBottom",3,"click",4,"ngIf"],[3,"conversationWith","attributes","senderId","tenant","projectid","channelType","userFullname","userEmail","showContinueConversationButton","showAttachmentButton","hideTextAreaContent","isConversationArchived","hideTextReply","isMobile","isEmojiiPickerShow","footerMessagePlaceholder","fileUploadAccept","dropEvent","stylesMap","translationMap","onEmojiiPickerShow","onBeforeMessageSent","onAfterSendMessage","onChangeTextArea","onAttachmentFileButtonClicked","onNewConversationButtonClicked","onBackButton"],["id","dropZone_container"],[1,"drop"],[3,"button","openExternalLinkButton","translationMap","stylesMap","onOpenExternal","onClose"],[3,"textInputTextArea","attachments","baseLocation","translationMap","stylesMap","onSendAttachment","onCloseModalPreview"],["id","chat21-buttonToBottom",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["opacity",".87","fill","none","d","M24 24H0V0h24v24z"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],["id","chat21-divBudge","class","c21-divBudge",4,"ngIf"],["id","chat21-divBudge",1,"c21-divBudge"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0,1)(2,"chat-conversation-header",2),e.NdJ("onBack",function(){return n.onBackHomeFN()})("onCloseWidget",function(){return n.onCloseWidgetFN()})("onSoundChange",function(i){return n.onSoundChangeFN(i)})("onCloseChat",function(i){return n.onCloseChat(i)})("onRestartChat",function(i){return n.onRestartChat(i)})("onWidgetHeightChange",function(i){return n.onWidgetHeightChange(i)})("onSignOut",function(i){return n.onSignOutFN(i)})("onMenuOptionShow",function(i){return n.onMenuOption(i)}),e.qZA(),e.YNc(3,sa,3,0,"div",3),e.TgZ(4,"chat-conversation-content",4),e.NdJ("onBeforeMessageRender",function(i){return n.onBeforeMessageRenderFN(i)})("onAfterMessageRender",function(i){return n.onAfterMessageRenderFN(i)})("onAttachmentButtonClicked",function(i){return n.onAttachmentButtonClicked(i)})("onScrollContent",function(i){return n.onScrollContent(i)})("onMenuOptionShow",function(i){return n.onMenuOption(i)})("onEmojiiPickerShow",function(i){return n.onEmojiiPickerShow(i)})("drop",function(i){return n.drop(i)})("dragover",function(i){return n.allowDrop(i)})("dragleave",function(i){return n.drag(i)}),e.qZA(),e.YNc(5,aa,1,4,"chat-internal-frame",5),e.YNc(6,la,1,5,"chat-conversation-attachment-preview",6),e.TgZ(7,"div",7),e.YNc(8,ha,5,1,"div",8),e.TgZ(9,"chat-conversation-footer",9),e.NdJ("onEmojiiPickerShow",function(i){return n.onEmojiiPickerShow(i)})("onBeforeMessageSent",function(i){return n.onBeforeMessangeSentFN(i)})("onAfterSendMessage",function(i){return n.onAfterSendMessageFN(i)})("onChangeTextArea",function(i){return n.onChangeTextArea(i)})("onAttachmentFileButtonClicked",function(i){return n.onAttachmentFileButtonClicked(i)})("onNewConversationButtonClicked",function(i){return n.onNewConversationButtonClickedFN(i)})("onBackButton",function(i){return n.onBackButton(i)}),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("idConversation",n.conversationWith)("senderId",n.senderId)("soundEnabled",null==n.g?null:n.g.soundEnabled)("isTrascriptDownloadEnabled",n.isTrascriptDownloadEnabled)("hideHeaderCloseButton",null==n.g?null:n.g.hideHeaderCloseButton)("hideHeaderBackButton",null==n.g?null:n.g.singleConversation)("hideCloseConversationOptionMenu",n.isConversationArchived||(null==n.g?null:n.g.hideCloseConversationOptionMenu))("hideRestartConversationOptionsMenu",!(null!=n.g&&n.g.singleConversation)&&!n.hideTextAreaContent||(null==n.g?null:n.g.hideRestartConversationOptionsMenu))("hideHeaderConversationOptionsMenu",null==n.g?null:n.g.hideHeaderConversationOptionsMenu)("hideSignOutOptionMenu",!(null!=n.g&&n.g.singleConversation&&null!=n.g&&n.g.showLogoutOption))("stylesMap",n.stylesMap)("translationMap",n.translationMapHeader)("widgetTitle",null==n.g||null==n.g.project?null:n.g.project.widgetTitle)("build_version",null!=n.g&&n.g.singleConversation?null==n.g?null:n.g.BUILD_VERSION:null)("windowContext",null==n.g?null:n.g.windowContext)("isMenuShow",n.isMenuShow)("isTypings",n.isTypings)("nameUserTypingNow",n.nameUserTypingNow)("typingLocation",null==n.g?null:n.g.typingLocation),e.xp6(1),e.Q6J("ngIf",n.isHovering),e.xp6(1),e.Q6J("messages",n.messages)("senderId",n.senderId)("baseLocation",null==n.g||null==n.g.windowContext.tiledesk?null:n.g.windowContext.tiledesk.getBaseLocation())("isConversationArchived",n.isConversationArchived)("isTypings",n.isTypings)("idUserTypingNow",n.idUserTypingNow)("nameUserTypingNow",n.nameUserTypingNow)("typingLocation",null==n.g?null:n.g.typingLocation)("fullscreenMode",null==n.g?null:n.g.fullscreenMode)("translationMap",n.translationMapContent)("stylesMap",n.stylesMap),e.xp6(1),e.Q6J("ngIf",n.isButtonUrl),e.xp6(1),e.Q6J("ngIf",n.isOpenAttachmentPreview),e.xp6(1),e.ekj("maximize-width",(null==n.g?null:n.g.singleConversation)&&n.hideTextAreaContent||n.isConversationArchived&&!(null!=n.g&&n.g.allowReopen)),e.xp6(1),e.Q6J("ngIf",n.showBadgeScroollToBottom),e.xp6(1),e.Q6J("conversationWith",n.conversationWith)("attributes",null==n.g?null:n.g.attributes)("senderId",n.senderId)("tenant",null==n.g?null:n.g.tenant)("projectid",null==n.g?null:n.g.projectid)("channelType",null==n.g?null:n.g.channelType)("userFullname",null==n.g?null:n.g.userFullname)("userEmail",null==n.g?null:n.g.userEmail)("showContinueConversationButton",(null==n.g?null:n.g.singleConversation)&&n.showContinueConversationButton)("showAttachmentButton",null==n.g?null:n.g.showAttachmentButton)("hideTextAreaContent",(null==n.g?null:n.g.singleConversation)&&n.hideTextAreaContent||n.isConversationArchived&&!(null!=n.g&&n.g.allowReopen))("isConversationArchived",n.isConversationArchived)("hideTextReply",n.hideFooterTextReply)("isMobile",null==n.g?null:n.g.isMobile)("isEmojiiPickerShow",n.isEmojiiPickerShow)("footerMessagePlaceholder",n.footerMessagePlaceholder)("fileUploadAccept",null==n.appConfigService?null:n.appConfigService.getConfig().fileUploadAccept)("dropEvent",n.dropEvent)("stylesMap",n.stylesMap)("translationMap",n.translationMapFooter))},dependencies:[de.O5,vn,Rt,St,bn,Cn],styles:["[_nghost-%COMP%]{--themeColor: $bck-msg-sent;--foregroundColor: $col-msg-sent}#scroll-me[_ngcontent-%COMP%]{scroll-behavior:smooth}#scroll-me.withoutAnimation[_ngcontent-%COMP%]{scroll-behavior:unset}#chat21-conversation-component[_ngcontent-%COMP%]{position:absolute;background-color:#fff;width:100%;height:100%;inset:0}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#chat21-conversation-component[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}#chat21-conversation-component[_ngcontent-%COMP%]   .avatar-project[_ngcontent-%COMP%]{position:relative;padding:0;margin:0 10px 0 0;float:left;height:42px;width:42px;line-height:42px}#chat21-conversation-component[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{font-size:16px}#chat21-conversation-component[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{max-width:30px;max-height:30px;margin:6px}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{position:fixed;left:0;right:0}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-writing[_ngcontent-%COMP%]{position:absolute;left:40px;right:40px;bottom:3px;width:auto;text-align:center;margin:0;padding:0;font-size:1.1em;color:#fff}#chat21-conversation-component[_ngcontent-%COMP%]   .rowMsg[_ngcontent-%COMP%]{position:relative;height:auto;display:block}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{position:fixed}#chat21-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;margin:0;padding:8px 45px 8px 70px;background:white;min-height:40px}#chat21-footer.maximize-width[_ngcontent-%COMP%]{padding:8px 0}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]{display:flex;position:relative;margin-right:-25px;margin-top:-40px;float:right;width:30px;height:30px;border-radius:50%;z-index:1;cursor:pointer;background-color:#fff;border:1px solid rgba(191,191,191,.2);text-align:center}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:auto;fill:#aaa}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]:hover{background-color:var(--themeColor);opacity:1!important;transition:all .45s ease-in-out!important;-moz-transition:all .45s ease-in-out!important;-webkit-transition:all .45s ease-in-out!important;border:1px solid var(--foregroundColor)}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--foregroundColor)}#dropZone_container[_ngcontent-%COMP%]{position:absolute;inset:52px 0 56px;background-color:#f0f8ff99}#dropZone_container[_ngcontent-%COMP%]   .drop[_ngcontent-%COMP%]{position:absolute;inset:0;margin:5px;border:2px dashed #a4acb3;border-radius:16px}#c21-options-menu[_ngcontent-%COMP%]{width:auto;height:auto;min-height:40px;min-width:100px;max-width:80%;position:absolute;z-index:10;top:40px;right:15px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;border:1px solid #d7d7d7;background-color:#fff;padding:10px 0}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{padding:6px 10px;display:flex;align-items:center}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;cursor:pointer}#c21-options-menu[_ngcontent-%COMP%]   .label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}@media (max-width: 451px){#chat21-conversation-component[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-button.c21-close[_ngcontent-%COMP%]{display:flex}}"]});var da=be(9614);const ua=["div_input"];function ga(r,t){if(1&r&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.hij(" ",null==n.translationErrorLabelMap?null:n.translationErrorLabelMap.get("LABEL_ERROR_FIELD_REQUIRED")," ")}}function pa(r,t){if(1&r&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.hij(" ",null==n.element?null:n.element.errorLabel," ")}}const fa=function(r){return{"is-empty":r}};class yn{constructor(t,n){this.rootFormGroup=t,this.elementRef=n,this.onKeyEnterPressed=new e.vpe,this.inputType="text"}ngOnInit(){this.form=this.rootFormGroup.control,this.form&&this.form.controls&&this.form.controls[this.controlName]&&this.form.controls[this.controlName].valueChanges.subscribe(t=>{this.hasSubmitted=!1,this.setFormStyle()})}ngOnChanges(t){this.controlName&&(this.controlName.toLowerCase().includes("email")||this.controlName.toLowerCase().includes("e-mail"))&&(this.inputType="email"),this.stylesMap&&this.stylesMap.get("themeColor")&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.stylesMap&&this.stylesMap.get("foregroundColor")&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))}onFocusOut(){this.input.nativeElement.classList.remove("is-focused")}onFocus(){this.input.nativeElement.classList.add("is-focused")}onEnterPressed(t){this.onKeyEnterPressed.emit(t)}setFormStyle(){this.form.controls[this.controlName].hasError("pattern")||this.form.controls[this.controlName].hasError("required")||this.form.controls[this.controlName].invalid?(this.input.nativeElement.classList.add("form-danger"),this.input.nativeElement.classList.remove("form-success")):this.form.controls[this.controlName].valid&&(this.input.nativeElement.classList.remove("form-danger"),this.input.nativeElement.classList.add("form-success"))}}yn.\u0275fac=function(t){return new(t||yn)(e.Y36(Ce.sg),e.Y36(e.SBq))},yn.\u0275cmp=e.Xpm({type:yn,selectors:[["chat-form-text"]],viewQuery:function(t,n){if(1&t&&e.Gf(ua,5),2&t){let o;e.iGM(o=e.CRH())&&(n.input=o.first)}},inputs:{element:"element",controlName:"controlName",translationErrorLabelMap:"translationErrorLabelMap",stylesMap:"stylesMap",hasSubmitted:"hasSubmitted"},outputs:{onKeyEnterPressed:"onKeyEnterPressed"},features:[e.TTD],decls:8,vars:12,consts:[[3,"formGroup"],["id","div_input",1,"form-group","label-floating",3,"ngClass"],["div_input",""],[1,"control-label"],[1,"form-control",3,"formControlName","type","tabIndex","keydown.enter","focus","focusout"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"div",1,2)(3,"label",3),e._uU(4),e.qZA(),e.TgZ(5,"input",4),e.NdJ("keydown.enter",function(i){return n.onEnterPressed(i)})("focus",function(){return n.onFocus()})("focusout",function(){return n.onFocusOut()}),e.qZA()(),e.YNc(6,ga,2,1,"div",5),e.YNc(7,pa,2,1,"div",5),e.qZA()),2&t&&(e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("ngClass",e.VKq(10,fa,!(null!=n.form&&n.form.controls[n.element.name].value))),e.xp6(3),e.hij(" ",null==n.element?null:n.element.text," "),e.xp6(1),e.ekj("errors",(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].errors)&&n.hasSubmitted),e.Q6J("formControlName",null==n.element?null:n.element.name)("type",n.inputType)("tabIndex",null==n.element?null:n.element.tabIndex),e.xp6(1),e.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].errors)&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].hasError("required"))),e.xp6(1),e.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].errors)&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].hasError("pattern"))&&(null==n.element?null:n.element.errorLabel)))},dependencies:[de.mk,de.O5,Ce._Y,Ce.Fj,Ce.JJ,Ce.JL,Ce.sg,Ce.u],styles:["[_nghost-%COMP%]{--foregroundColor: #0000;--themeColor: #2a6ac1}.c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;overflow:hidden;width:100%;height:36px;display:inline-flex}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:visited{box-shadow:none;background-color:#fff;outline:none}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}input[type=text].errors[_ngcontent-%COMP%]{color:red}.text-danger[_ngcontent-%COMP%]{color:red;font-size:1em;min-height:20px;background-color:#fff;margin:0 10px}.form-group[_ngcontent-%COMP%]{position:relative;padding-bottom:0;margin:35px 0 0}.form-group[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{font-size:11px;line-height:1.07142857;color:#b3b6b8;font-weight:400;margin:16px 0 0}input[_ngcontent-%COMP%]{border:0;background-image:none;background-size:0 2px,100% 1px;background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-color:#f6f7fb;transition:background 0s ease-out;float:none;box-shadow:none;border-radius:16px;font-weight:400;height:48px;padding:16px;font-size:14px;line-height:1.42857143;display:block;width:100%;color:#555}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transition:.3s ease all}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{will-change:left,top,contents}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-2px;left:16px;font-size:14px;line-height:1.42857}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-40px;left:0;font-size:16px;line-height:1.07143;color:#9b9b9c}.form-group.label-floating[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-28px;left:0;font-size:11px;line-height:1.07143}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-11px;font-size:11px;line-height:1.5}.form-group.form-group-sm.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-5px;font-size:18px;line-height:1.33333}.form-group.form-group-lg.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.is-focused[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{outline:none;background-image:linear-gradient(var(--themeColor),var(--themeColor)),linear-gradient(#D2D2D2,#D2D2D2);background-size:100% 2px,100% 1px;box-shadow:none;transition-duration:.3s}.form-group.is-focused.form-info[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#00bcd4,#00bcd4),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-success[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#4caf50,#4caf50),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-warning[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#ff9800,#ff9800),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-danger[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#f44336,#f44336),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-rose[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#e91e63,#e91e63),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-white[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#FFFFFF,#FFFFFF),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-black[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#555555,#555555),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{color:#aaa}.form-group.is-focused[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{box-shadow:none;border-color:#d2d2d2}select.form-control[multiple][_ngcontent-%COMP%], .form-group.is-focused[_ngcontent-%COMP%]   select.form-control[multiple][_ngcontent-%COMP%]{height:85px}"]});class On{constructor(t){this.rootFormGroup=t}ngOnInit(){this.form=this.rootFormGroup.control}}function ma(r,t){if(1&r&&(e.TgZ(0,"div",5),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.hij(" ",n.translationErrorLabelMap.get("LABEL_ERROR_FIELD_REQUIRED")," ")}}On.\u0275fac=function(t){return new(t||On)(e.Y36(Ce.sg))},On.\u0275cmp=e.Xpm({type:On,selectors:[["chat-form-label"]],inputs:{element:"element",controlName:"controlName",hasSubmitted:"hasSubmitted"},decls:2,vars:2,consts:[[1,"c21-header-label"],[1,"c21-form-message-field",3,"innerHTML","tabIndex"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"label",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("innerHTML",null==n.element?null:n.element.text,e.oJD)("tabIndex",null==n.element?null:n.element.tabIndex))},styles:[".c21-header-label[_ngcontent-%COMP%]{padding:10px 0;position:relative;left:0;right:0}.c21-header-label[_ngcontent-%COMP%]   .c21-form-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}"]});const _a=function(r){return{errors:r}};class xn{constructor(t,n){this.rootFormGroup=t,this.elementRef=n,this.onKeyEnterPressed=new e.vpe}ngOnInit(){this.form=this.rootFormGroup.control}ngOnChanges(t){this.stylesMap&&this.stylesMap.get("themeColor")&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.stylesMap&&this.stylesMap.get("foregroundColor")&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))}onEnterPressed(t){this.onKeyEnterPressed.emit(t)}}xn.\u0275fac=function(t){return new(t||xn)(e.Y36(Ce.sg),e.Y36(e.SBq))},xn.\u0275cmp=e.Xpm({type:xn,selectors:[["chat-form-checkbox"]],inputs:{element:"element",controlName:"controlName",translationErrorLabelMap:"translationErrorLabelMap",stylesMap:"stylesMap",hasSubmitted:"hasSubmitted"},outputs:{onKeyEnterPressed:"onKeyEnterPressed"},features:[e.TTD],decls:6,vars:9,consts:[[3,"formGroup"],[1,"c21-body-header-checkbox"],["type","checkbox",1,"form-check-input","errors",3,"formControlName","checked","tabIndex","ngClass","keydown.enter"],[1,"c21-form-message-field"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"input",2),e.NdJ("keydown.enter",function(i){return n.onEnterPressed(i)}),e.qZA(),e.TgZ(3,"label",3),e._uU(4),e.qZA(),e.YNc(5,ma,2,1,"div",4),e.qZA()()),2&t&&(e.Q6J("formGroup",n.form),e.xp6(2),e.Q6J("formControlName",null==n.element?null:n.element.name)("checked",null==n.element?null:n.element.value)("tabIndex",null==n.element?null:n.element.tabIndex)("ngClass",e.VKq(7,_a,n.hasSubmitted&&n.form.controls[null==n.element?null:n.element.name].errors)),e.xp6(2),e.Oqu(null==n.element?null:n.element.text),e.xp6(1),e.Q6J("ngIf",n.hasSubmitted&&n.form.get(null==n.element?null:n.element.name).errors))},dependencies:[de.mk,de.O5,Ce._Y,Ce.Wl,Ce.JJ,Ce.JL,Ce.sg,Ce.u],styles:['[_nghost-%COMP%]{--foregroundColor: #0000;--themeColor: #2a6ac1;--backgroundUnchecked: #ffff;--dangerError: #ff0000}.c21-body-header-checkbox[_ngcontent-%COMP%]{--dangerError: #ff0000;position:relative;left:0;right:0}.c21-body-header-checkbox[_ngcontent-%COMP%]   .c21-form-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}input[type=radio][_ngcontent-%COMP%], input[type=checkbox][_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;margin:0 .4em .4em 0;border:1px solid var(--themeColor);border-radius:3px;-webkit-border-radius:3px;-webkit-appearance:none;transition:box-shadow .2s}input[type=checkbox][_ngcontent-%COMP%]:not(:checked):hover, input[type=checkbox][_ngcontent-%COMP%]:not(:checked):focus{border-width:2px;background-color:#fff;border-radius:4px;box-shadow:0 2px 5px #00000040;cursor:pointer;padding:15px 25px;transition:all .1s ease-in}input[type=radio][_ngcontent-%COMP%]:active:not(:disabled), input[type=checkbox][_ngcontent-%COMP%]:active:not(:disabled){border-width:2px}input[type=radio][_ngcontent-%COMP%]:focus, input[type=checkbox][_ngcontent-%COMP%]:focus{outline:none}input[type=radio][_ngcontent-%COMP%]:checked, input[type=checkbox][_ngcontent-%COMP%]:checked{background-color:var(--themeColor);animation:shrink-bounce .2s cubic-bezier(.4,0,.23,1)}input[type=radio][_ngcontent-%COMP%]:checked:before{display:block;height:.4em;width:.4em;position:relative;left:.4em;top:.4em;background:var(--backgroundUnchecked);border-radius:100%;content:""}input[type=checkbox][_ngcontent-%COMP%]:checked:before{content:"";display:block;width:4px;height:10px;border:solid var(--foregroundColor);color:var(--foregroundColor);border-width:0 3px 3px 0;transform:rotate(45deg);margin-left:0;margin-top:-5px;transform-origin:0% 100%;background-color:transparent;animation:_ngcontent-%COMP%_rippleOn .2s}input[type=checkbox][_ngcontent-%COMP%]:checked:after{border:solid var(--backgroundUnchecked);background-color:var(--themeColor);animation:_ngcontent-%COMP%_rippleOn .2s forwards}input[type=checkbox][_ngcontent-%COMP%]:not(:checked):before{animation:_ngcontent-%COMP%_rippleOff .2s}input[type=checkbox][_ngcontent-%COMP%]:not(:checked):after{animation:_ngcontent-%COMP%_rippleOff .2s}input[_ngcontent-%COMP%]:disabled{opacity:.6;background:rgba(0,0,0,.1);box-shadow:none}input[_ngcontent-%COMP%]:disabled + label[_ngcontent-%COMP%]{opacity:.6;cursor:default;-webkit-user-select:none}input[type=checkbox].errors[_ngcontent-%COMP%]{border:2px solid var(--dangerError)}.text-danger[_ngcontent-%COMP%]{color:var(--dangerError);font-size:1em;min-height:20px;background-color:var(--backgroundUnchecked);margin:0 10px}@keyframes _ngcontent-%COMP%_rippleOn{0%{opacity:0}50%{opacity:.3}to{opacity:0}}@keyframes _ngcontent-%COMP%_rippleOff{0%{opacity:0}50%{opacity:.2}to{opacity:0}}']});const va=["div_input"];function ba(r,t){if(1&r&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.hij(" ",n.translationErrorLabelMap.get("LABEL_ERROR_FIELD_REQUIRED")," ")}}function Ca(r,t){if(1&r&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.hij(" ",n.element.errorLabel," ")}}const wa=function(r){return{"is-empty":r}};class Mn{constructor(t,n){this.rootFormGroup=t,this.elementRef=n,this.rows=3,this.onKeyEnterPressed=new e.vpe}ngOnInit(){this.form=this.rootFormGroup.control,this.form&&this.form.controls&&this.form.controls[this.controlName]&&this.form.controls[this.controlName].valueChanges.subscribe(t=>{this.hasSubmitted=!1,this.setFormStyle()})}ngOnChanges(t){this.stylesMap&&this.stylesMap.get("themeColor")&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.stylesMap&&this.stylesMap.get("foregroundColor")&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))}onFocusOut(){this.input.nativeElement.classList.remove("is-focused")}onFocus(){this.input.nativeElement.classList.add("is-focused")}onEnterPressed(t){t.preventDefault(),this.onKeyEnterPressed.emit(t)}onkeydown(t){(t.metaKey||t.shiftKey||t.altKey||t.ctrlKey)&&13===(t.which||t.keyCode)&&(t.preventDefault(),this.form.controls[this.controlName].patchValue(this.form.controls[this.controlName].value+"\r\n"))}setFormStyle(){this.form.controls[this.controlName].hasError("pattern")||this.form.controls[this.controlName].hasError("required")||this.form.controls[this.controlName].invalid?(this.input.nativeElement.classList.add("form-danger"),this.input.nativeElement.classList.remove("form-success")):this.form.controls[this.controlName].valid&&(this.input.nativeElement.classList.remove("form-danger"),this.input.nativeElement.classList.add("form-success"))}}function ya(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-form-text",13),e.NdJ("onKeyEnterPressed",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onEnterButtonPressed(i))}),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("element",n)("controlName",null==n?null:n.name)("translationErrorLabelMap",o.translationErrorLabelMap)("stylesMap",o.stylesMap)("hasSubmitted",o.submitted)}}function Oa(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-form-label",14),e.NdJ("onKeyEnterPressed",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onEnterButtonPressed(i))}),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("element",n)("controlName",null==n?null:n.name)("hasSubmitted",o.submitted)}}function xa(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-form-checkbox",13),e.NdJ("onKeyEnterPressed",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onEnterButtonPressed(i))}),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("element",n)("controlName",null==n?null:n.name)("translationErrorLabelMap",o.translationErrorLabelMap)("stylesMap",o.stylesMap)("hasSubmitted",o.submitted)}}function Ma(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"chat-form-textarea",15),e.NdJ("onKeyEnterPressed",function(i){e.CHM(n);const l=e.oxw(2);return e.KtG(l.onEnterButtonPressed(i))}),e.qZA()}if(2&r){const n=e.oxw().$implicit,o=e.oxw();e.Q6J("element",n)("controlName",null==n?null:n.name)("rows",null==n?null:n.rows)("translationErrorLabelMap",o.translationErrorLabelMap)("stylesMap",o.stylesMap)("hasSubmitted",o.submitted)}}function Ea(r,t){if(1&r&&(e.TgZ(0,"span"),e.YNc(1,ya,1,5,"chat-form-text",10),e.YNc(2,Oa,1,3,"chat-form-label",11),e.YNc(3,xa,1,5,"chat-form-checkbox",10),e.YNc(4,Ma,1,6,"chat-form-textarea",12),e.qZA()),2&r){const n=t.$implicit;e.xp6(1),e.Q6J("ngIf","text"===(null==n?null:n.type)),e.xp6(1),e.Q6J("ngIf","static"===(null==n?null:n.type)),e.xp6(1),e.Q6J("ngIf","checkbox"===(null==n?null:n.type)),e.xp6(1),e.Q6J("ngIf","textarea"===(null==n?null:n.type))}}Mn.\u0275fac=function(t){return new(t||Mn)(e.Y36(Ce.sg),e.Y36(e.SBq))},Mn.\u0275cmp=e.Xpm({type:Mn,selectors:[["chat-form-textarea"]],viewQuery:function(t,n){if(1&t&&e.Gf(va,5),2&t){let o;e.iGM(o=e.CRH())&&(n.input=o.first)}},inputs:{element:"element",controlName:"controlName",rows:"rows",translationErrorLabelMap:"translationErrorLabelMap",stylesMap:"stylesMap",hasSubmitted:"hasSubmitted"},outputs:{onKeyEnterPressed:"onKeyEnterPressed"},features:[e.TTD],decls:9,vars:10,consts:[[3,"formGroup"],["id","div_input",1,"form-group","label-floating",3,"ngClass"],["div_input",""],[1,"control-label"],["type","text",1,"form-control",3,"formControlName","rows","tabIndex","keydown","keydown.enter","focus","focusout"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"div",1,2)(3,"label",3),e._uU(4),e.qZA(),e.TgZ(5,"textarea",4),e.NdJ("keydown",function(i){return n.onkeydown(i)})("keydown.enter",function(i){return n.onEnterPressed(i)})("focus",function(){return n.onFocus()})("focusout",function(){return n.onFocusOut()}),e._uU(6,"    "),e.qZA()(),e.YNc(7,ba,2,1,"div",5),e.YNc(8,Ca,2,1,"div",5),e.qZA()),2&t&&(e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("ngClass",e.VKq(8,wa,!(null!=n.form&&null!=n.form.controls[n.element.name]&&n.form.controls[n.element.name].value))),e.xp6(3),e.hij(" ",null==n.element?null:n.element.text," "),e.xp6(1),e.Q6J("formControlName",null==n.element?null:n.element.name)("rows",n.rows)("tabIndex",null==n.element?null:n.element.tabIndex),e.xp6(2),e.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[n.element.name].errors)&&(null==n.form?null:n.form.controls[n.element.name].hasError("required"))),e.xp6(1),e.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[n.element.name].errors)&&(null==n.form?null:n.form.controls[n.element.name].hasError("pattern"))&&(null==n.element?null:n.element.errorLabel)))},dependencies:[de.mk,de.O5,Ce._Y,Ce.Fj,Ce.JJ,Ce.JL,Ce.sg,Ce.u],styles:["[_nghost-%COMP%]{--foregroundColor: #0000;--themeColor: #2a6ac1}.c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;overflow:hidden;width:100%;display:inline-flex}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:active, .c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:hover, .c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:visited{background-image:linear-gradient(#3ea9f5,#3ea9f5),linear-gradient(#d2d2d2,#d2d2d2);background-size:0 2px,100% 1px;background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-color:#0000;transition:background 0s ease-out}textarea[type=text].errors[_ngcontent-%COMP%]{border-bottom:2px solid red;color:red}.text-danger[_ngcontent-%COMP%]{color:red;font-size:1em;min-height:20px;background-color:#fff;margin:0 10px}.form-group[_ngcontent-%COMP%]{position:relative;padding-bottom:0;margin:35px 0 0}.form-group[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{font-size:11px;line-height:1.07142857;color:#b3b6b8;font-weight:400;margin:16px 0 0}textarea[_ngcontent-%COMP%]{border:0;background-image:none;background-size:0 2px,100% 1px;background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-color:#f6f7fb;transition:background 0s ease-out;float:none;box-shadow:none;border-radius:16px;font-weight:400;padding:16px;font-size:14px;line-height:1.42857143;display:block;width:100%;color:#555;resize:vertical}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transition:.3s ease all}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{will-change:left,top,contents}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-2px;left:16px;font-size:14px;line-height:1.42857}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-40px;left:0;font-size:16px;line-height:1.07143;color:#9b9b9c}.form-group.label-floating[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-28px;left:0;font-size:11px;line-height:1.07143}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-11px;font-size:11px;line-height:1.5}.form-group.form-group-sm.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-5px;font-size:18px;line-height:1.33333}.form-group.form-group-lg.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.is-focused[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{outline:none;background-image:linear-gradient(var(--themeColor),var(--themeColor)),linear-gradient(#D2D2D2,#D2D2D2);background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-size:100% 2px,100% 1px;transition-duration:.3s;width:100%}.form-group.is-focused.form-info[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#00bcd4,#00bcd4),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-success[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#4caf50,#4caf50),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-warning[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#ff9800,#ff9800),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-danger[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#f44336,#f44336),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-rose[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#e91e63,#e91e63),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-white[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#FFFFFF,#FFFFFF),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-black[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#555555,#555555),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{color:#aaa}.form-group.is-focused[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{box-shadow:none;border-color:#d2d2d2}"]});const Ta=function(r,t,n){return{"background-color":r,"border-color":t,color:n}},Sa=function(r){return{fill:r}};class En{constructor(t,n){this.formBuilder=t,this.customTranslateService=n,this.onSubmitForm=new e.vpe,this.onErrorRenderForm=new e.vpe,this.submitted=!1,this.logger=fe.getInstance()}ngOnInit(){this.translationErrorLabelMap=this.customTranslateService.translateLanguage(["LABEL_ERROR_FIELD_REQUIRED","PRECHAT_REQUIRED_ERROR"]),this.translationMap=this.customTranslateService.translateLanguage(["LABEL_START_NW_CONV"]),this.logger.debug("[FORM-BUILDER] ngOnChanges: preChatFormJson ----\x3e",this.formArray),this.logger.debug("[FORM-BUILDER] ngOnChanges: preChatForm completed ----\x3e",this.preChatFormGroupCustom)}ngOnChanges(t){this.formArray&&(this.browserLang=navigator.language,this.preChatFormGroupCustom=this.buildFormGroup(this.formArray),this.formArray=this.setTranslations(this.formArray),this.subscribeToFormChanges())}buildFormGroup(t){let n={},o=!1;return t.forEach((l,E)=>{if(l.tabIndex=1411+E,this.lastTabIndex=1411+E+1,l.label||(l.label=l.name),l.type=l.type?l.type.toLowerCase():"text",!l.type||"text"!==l.type&&"textarea"!==l.type){if("checkbox"!==l.type){if("static"===l.type)return;return this.logger.error("[FORM-BUILDER] ERROR while rendering field --\x3e RESTORE DEFAULT"),void(o=!0)}{let V=[],Q=!1;l.mandatory&&V.push(Ce.kI.required,Ce.kI.requiredTrue),l.value&&(Q="true"===l.value||!0===l.value),n[l.name]=new Ce.NI(Q,Ce.kI.compose(V))}}else{let V=[],Q=null;l.mandatory&&V.push(Ce.kI.required),l.regex&&V.push(Ce.kI.pattern(new RegExp(function ri(r){let t=r;return"/"!==r.substring(0,1)&&(t="/"+r),"/"!==r.substring(r.length-1,r.length)&&(t+="/"),t}(l.regex).slice(1,-1)))),l.value&&(Q=l.value),n[l.name]=new Ce.NI(Q,Ce.kI.compose(V))}}),o&&(n={},this.logger.error("[FORM-BUILDER] ERROR while rendering field --\x3e restoreDefault",n),this.onErrorRenderForm.emit()),this.formBuilder.group(n)}setTranslations(t){return t.forEach(n=>{if("object"==typeof n.label){const o=this.getAcceptLanguage(n.label);this.logger.debug("[FORM-BUILDER] setTranslations acceptedLanguage for element.label:",n,o),n.text=n.label[o]}else"string"==typeof n.label&&(n.text=this.customTranslateService.translateLanguage([n.label]).get(n.label));if("object"==typeof n.errorLabel){const o=this.getAcceptLanguage(n.errorLabel);this.logger.debug("[FORM-BUILDER] setTranslations acceptedLanguage for element.errorLabel:",n,o),n.errorLabel=n.errorLabel[o]}else"string"==typeof n.errorLabel&&(n.errorLabel=this.customTranslateService.translateLanguage([n.errorLabel]).get(n.errorLabel))}),this.formArray}getAcceptLanguage(t){let n="",o="";t&&t.default&&(o="default"),navigator.languages.forEach(l=>{n+=l+","});const i=da.e(Object.keys(t),n);return i&&(o=i),o}subscribeToFormChanges(){this.preChatFormGroupCustom&&this.preChatFormGroupCustom.valueChanges.subscribe(t=>{this.submitted=!1})}onSubmitPreChatForm(){this.submitted=!0,this.logger.debug("[FORM-BUILDER] onSubmitPreChatForm",this.preChatFormGroupCustom),this.preChatFormGroupCustom.valid&&this.onSubmitForm.emit(this.preChatFormGroupCustom.value)}onEnterButtonPressed(t){this.logger.debug("[FORM-BUILDER] onEnterButtonPressed event",t),this.onSubmitPreChatForm()}onResetForm(){this.submitted=!1,this.preChatFormGroupCustom.reset()}}En.\u0275fac=function(t){return new(t||En)(e.Y36(Ce.qu),e.Y36(He))},En.\u0275cmp=e.Xpm({type:En,selectors:[["chat-form-builder"]],inputs:{formArray:"formArray",isOpenPrechatForm:"isOpenPrechatForm",stylesMap:"stylesMap"},outputs:{onSubmitForm:"onSubmitForm",onErrorRenderForm:"onErrorRenderForm"},features:[e.TTD],decls:12,vars:12,consts:[["id","chat21-form-container",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"c21-new-conversation"],[1,"c21-button-primary",3,"tabindex","ngStyle","click","keydown.enter"],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",3,"ngStyle"],["d","M0 0h24v24H0z","fill","none"],[1,"v-align-center","c21-label-button"],[1,"clear"],[3,"element","controlName","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed",4,"ngIf"],[3,"element","controlName","hasSubmitted","onKeyEnterPressed",4,"ngIf"],[3,"element","controlName","rows","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed",4,"ngIf"],[3,"element","controlName","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed"],[3,"element","controlName","hasSubmitted","onKeyEnterPressed"],[3,"element","controlName","rows","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed"]],template:function(t,n){1&t&&(e.TgZ(0,"div")(1,"form",0),e.YNc(2,Ea,5,4,"span",1),e.qZA(),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return n.onSubmitPreChatForm()})("keydown.enter",function(i){return n.onEnterButtonPressed(i)}),e.TgZ(5,"span",4),e.O4$(),e.TgZ(6,"svg",5),e._UZ(7,"path",6)(8,"path",7),e.qZA()(),e.kcU(),e.TgZ(9,"span",8),e._uU(10),e.qZA(),e._UZ(11,"div",9),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("formGroup",n.preChatFormGroupCustom),e.xp6(1),e.Q6J("ngForOf",n.formArray),e.xp6(2),e.Q6J("tabindex",n.lastTabIndex)("ngStyle",e.kEZ(6,Ta,null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(3),e.Q6J("ngStyle",e.VKq(10,Sa,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(3),e.hij(" ",null==n.translationMap?null:n.translationMap.get("LABEL_START_NW_CONV")," "))},dependencies:[de.sg,de.O5,de.PC,Ce._Y,Ce.JL,Ce.sg,yn,On,xn,Mn],styles:[".c21-label-button[_ngcontent-%COMP%]{font-size:1.2em!important}.c21-new-conversation[_ngcontent-%COMP%]{width:auto;height:auto;position:relative;border-top:0px solid #eeeeee;display:flex;align-items:center;justify-content:center;box-shadow:none;vertical-align:top}.c21-new-conversation[_ngcontent-%COMP%]   button.c21-button-primary[_ngcontent-%COMP%]{margin:10px 0}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;overflow:hidden;width:100%;height:36px;display:inline-flex}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:block;padding:11px 10px 8px;color:#616161;font-size:1.3em;font-weight:300;line-height:1.2em;box-shadow:none}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input.errors[_ngcontent-%COMP%]{border:1px solid red}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:visited{box-shadow:none;background-color:#fff;outline:none}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}"]});const Pa=["afPrechatFormComponent"],ka=["privacyInputField"],Aa=function(r,t){return{color:r,"background-image":t}},Ia=function(r){return{fill:r}},Ra=function(r){return{color:r}};class Tn{constructor(t,n,o){this.g=t,this.formBuilder=n,this.appStorageService=o,this.onClosePage=new e.vpe,this.onCloseForm=new e.vpe,this.logger=fe.getInstance()}ngOnInit(){this.initialize()}initialize(){}ngAfterViewInit(){setTimeout(()=>{this.afPrechatFormComponent&&this.afPrechatFormComponent.nativeElement.focus()},1e3)}openNewConversation(){if(this.g.attributes){const t=this.g.attributes;if(this.privacyInputField&&!1===this.privacyInputField.nativeElement.checked){this.g.privacyApproved=!1;const n=window.document.getElementById("span-checkmark");return void(n&&n.classList.add("unchecked"))}this.privacyInputField&&!0===this.privacyInputField.nativeElement.checked&&(this.g.privacyApproved=!0),this.g.setAttributeParameter("privacyApproved",this.g.privacyApproved),this.g.setAttributeParameter("userFullname",this.userFullname),this.g.setAttributeParameter("userEmail",this.userEmail),this.g.setParameter("userFullname",this.userFullname),this.g.setParameter("userEmail",this.userEmail),this.appStorageService.setItem("attributes",JSON.stringify(t)),this.onCloseForm.emit()}}returnClosePage(){this.onClosePage.emit()}onSubmitForm(t){this.logger.debug("[PRE-CHAT-FORM] onSubmitForm:",t),this.g.attributes&&(t.hasOwnProperty("userFullname")&&(this.g.setAttributeParameter("userFullname",t.userFullname),this.g.setParameter("userFullname",t.userFullname)),t.hasOwnProperty("userEmail")&&(this.g.setAttributeParameter("userEmail",t.userEmail),this.g.setParameter("userEmail",t.userEmail)),this.g.attributes.preChatForm=t,this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes)),this.onCloseForm.emit())}onErrorRenderForm(){this.logger.debug("[PRE-CHAT-FORM] onErrorRenderForm: RESTORE DEFAULT JSON"),this.g.setParameter("preChatFormJson",[{name:"userFullname",type:"text",mandatory:!0,label:"LABEL_FIELD_NAME"},{name:"userEmail",type:"text",mandatory:!0,regex:"/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)+$/",label:"LABEL_FIELD_EMAIL",errorLabel:"LABEL_ERROR_FIELD_EMAIL"}])}}function La(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"here is ignored"),e.qZA())}function Na(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"p",22),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(3);return e.KtG(i.popupUrl(i.g.windowContext,i.conversation.last_message_text,"windowName"))}),e._uU(1),e.qZA()}if(2&r){const n=e.oxw(3);e.xp6(1),e.hij("",n.strip_tags(n.conversation.last_message_text)," ")}}function Fa(r,t){if(1&r&&(e._UZ(0,"p",23),e.ALo(1,"marked"),e.ALo(2,"htmlEntitiesEncode")),2&r){const n=e.oxw(3);e.Q6J("innerHTML",e.lcZ(1,1,e.lcZ(2,3,n.conversation.last_message_text)),e.oJD)}}function Ba(r,t){if(1&r&&(e.TgZ(0,"div",18),e.YNc(1,La,2,0,"div",19),e.YNc(2,Na,2,1,"ng-template",null,20,e.W1O),e.YNc(4,Fa,3,5,"ng-template",null,21,e.W1O),e.qZA()),2&r){const n=e.MAs(3),o=e.MAs(5),i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.isPopupUrl(i.conversation.last_message_text))("ngIfThen",n)("ngIfElse",o)}}function Ua(r,t){if(1&r&&(e.TgZ(0,"time"),e._uU(1),e.ALo(2,"amTimeAgo"),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij("",e.lcZ(2,1,n.conversation.timestamp)," ")}}function Da(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openConversationByID(i.conversation))}),e.TgZ(5,"span"),e._uU(6,"View more"),e.qZA()(),e.TgZ(7,"div",6),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.closeMessagePreview())}),e.TgZ(8,"span"),e.O4$(),e.TgZ(9,"svg",7),e._UZ(10,"path",8)(11,"path",9),e.qZA()()()()(),e.kcU(),e.TgZ(12,"div",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openConversationByID(i.conversation))}),e.TgZ(13,"div",11),e._uU(14),e.qZA(),e.YNc(15,Ba,6,3,"div",12),e.TgZ(16,"div",13),e.YNc(17,Ua,3,3,"time",14),e.qZA(),e.TgZ(18,"div",15)(19,"div",16),e._UZ(20,"chat-avatar-image",17),e.qZA()()()()()}if(2&r){const n=e.oxw();e.xp6(14),e.Oqu(n.conversation.sender_fullname),e.xp6(1),e.Q6J("ngIf","text"==n.conversation.type),e.xp6(2),e.Q6J("ngIf","{.sv: timestamp}"!==n.conversation.timestamp),e.xp6(3),e.Q6J("senderID",n.conversation.sender)("senderFullname",n.conversation.sender_fullname)("baseLocation",n.baseLocation)}}Tn.\u0275fac=function(t){return new(t||Tn)(e.Y36(Pe),e.Y36(Ce.qu),e.Y36(Re))},Tn.\u0275cmp=e.Xpm({type:Tn,selectors:[["chat-prechat-form"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Pa,5),e.Gf(ka,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.afPrechatFormComponent=o.first),e.iGM(o=e.CRH())&&(n.privacyInputField=o.first)}},inputs:{stylesMap:"stylesMap"},outputs:{onClosePage:"onClosePage",onCloseForm:"onCloseForm"},decls:20,vars:14,consts:[["id","chat21-prechat-form","tabindex","1400","aria-modal","true","onFocus","document.querySelector('[start-focus-chat21-prechat-form]').focus()"],["afPrechatFormComponent",""],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-button"],[1,"c21-close-button","c21-small"],["tabindex","1490","aria-label"," chiudi pannello",1,"c21-close-button-body",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"c21-header-content"],[1,"c21-title",3,"ngStyle"],[1,"c21-body"],[1,"c21-body-container"],[1,"c21-body-header"],["start-focus-chat21-prechat-form","","tabindex","1410",1,"c21-form-message-field"],[1,"c21-body-content"],[3,"formArray","isOpenPrechatForm","stylesMap","onSubmitForm","onErrorRenderForm"],["tabindex","1499","onFocus","document.querySelector('[start-focus-chat21-prechat-form]').focus()"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),e.NdJ("click",function(){return n.returnClosePage()}),e.O4$(),e.TgZ(7,"svg",7),e._UZ(8,"path",8)(9,"path",9),e.qZA()()()(),e.kcU(),e.TgZ(10,"div",10),e._UZ(11,"div",11),e.qZA()()(),e.TgZ(12,"div",12)(13,"div",13)(14,"div",14)(15,"div",15),e._uU(16),e.qZA()(),e.TgZ(17,"div",16)(18,"chat-form-builder",17),e.NdJ("onSubmitForm",function(i){return n.onSubmitForm(i)})("onErrorRenderForm",function(){return n.onErrorRenderForm()}),e.qZA()()(),e._UZ(19,"span",18),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngStyle",e.WLB(7,Aa,n.g.themeForegroundColor,n.g.colorGradient180)),e.xp6(5),e.Q6J("ngStyle",e.VKq(10,Ia,n.g.themeForegroundColor)),e.xp6(4),e.Q6J("ngStyle",e.VKq(12,Ra,n.g.themeForegroundColor)),e.xp6(5),e.Oqu(n.g.LABEL_COMPLETE_FORM),e.xp6(2),e.Q6J("formArray",n.g.preChatFormJson)("isOpenPrechatForm",n.g.isOpenPrechatForm)("stylesMap",n.stylesMap))},dependencies:[de.PC,En],styles:['#chat21-prechat-form[_ngcontent-%COMP%]{background-color:#fff;width:100%;height:100%}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{overflow:hidden;width:100%;height:52px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]{width:31px;height:31px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]   .c21-close-button-body[_ngcontent-%COMP%]{width:31px;height:31px;-webkit-appearance:initial;border:none}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;margin:0 auto}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]{width:auto;height:auto;top:6px;left:40px;right:40px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{display:inline-block;width:100%;height:auto;padding:0;margin:10px 0;text-align:center;font-size:1.6em;line-height:normal}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{padding:0;margin:20px auto}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]{padding:10px 25px;position:relative;left:0;right:0}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .c21-form-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]{padding:10px 30px;position:relative}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .c21-label-button[_ngcontent-%COMP%]{font-size:1.2em}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]{padding:0 0 30px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]{background-color:#fff;overflow:hidden;position:relative;height:36px;margin:10px 10px 0}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .text-danger[_ngcontent-%COMP%]{color:#a94442;font-size:1em;min-height:20px;background-color:#fff;margin:0 10px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;width:100%;display:inline-flex}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:block;padding:11px 10px 8px;color:#616161;font-size:1.3em;font-weight:300;line-height:1.2em;box-shadow:none}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:visited{box-shadow:none;background-color:#fff;outline:none}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]{display:block;position:absolute;bottom:0;padding:35px;font-size:12px;text-align:left;-webkit-user-select:none;user-select:none}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:22px;position:absolute;top:30px;left:10px;opacity:0;cursor:pointer;height:18px;width:18px}#chat21-prechat-form[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;top:30;left:10;height:18px;width:18px;background-color:#eee;border:solid white;cursor:pointer}#chat21-prechat-form[_ngcontent-%COMP%]   .checkmark.unchecked[_ngcontent-%COMP%]{box-shadow:0 0 0 1px red}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{background-color:#ccc}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:#2196f3}#chat21-prechat-form[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:5px;top:2px;width:5px;height:8px;border:solid white;border-width:0 3px 3px 0;transform:rotate(45deg)}']});class Sn{constructor(t,n){this.imageRepoService=t,this.g=n,this.onCloseMessagePreview=new e.vpe,this.onSelectedConversation=new e.vpe,this.subscriptions=[],this.isPopupUrl=mo,this.popupUrl=Yo,this.strip_tags=Jo,this.isImage=$n,this.logger=fe.getInstance()}ngOnInit(){}ngAfterViewInit(){}ngOnChanges(t){this.logger.debug("[LASTMESSAGE] onChanges",t),this.conversation&&(this.conversation.image=this.imageRepoService.getImagePhotoUrl(this.conversation.sender))}getMetadataSize(t){void 0===t.width&&(t.width=$e),void 0===t.height&&(t.height=$e);const n={width:t.width,height:t.height};if(t.width&&t.width>$e){const o=t.width/t.height;n.width=$e,n.height=$e/o}return n}onAttachmentButtonClicked(t){this.logger.debug("[LASTMESSAGE] onAttachmentButtonClicked",t)}openConversationByID(t){this.logger.debug("[LASTMESSAGE] openConversationByID: ",t),this.conversation=null,this.g.isOpenNewMessage=!1,t&&this.onSelectedConversation.emit(t)}closeMessagePreview(){this.conversation=null,this.g.isOpenNewMessage=!1,this.onCloseMessagePreview.emit()}ngOnDestroy(){this.conversation=null,this.g.isOpenNewMessage=!1}unsubscribe(){this.subscriptions.forEach(function(t){t.unsubscribe()}),this.subscriptions=[],this.logger.debug("[LASTMESSAGE] this.subscriptions",this.subscriptions)}}Sn.\u0275fac=function(t){return new(t||Sn)(e.Y36(Ze),e.Y36(Pe))},Sn.\u0275cmp=e.Xpm({type:Sn,selectors:[["chat-last-message"]],inputs:{conversation:"conversation",baseLocation:"baseLocation",stylesMap:"stylesMap"},outputs:{onCloseMessagePreview:"onCloseMessagePreview",onSelectedConversation:"onSelectedConversation"},features:[e.TTD],decls:1,vars:1,consts:[["id","messagePreview",4,"ngIf"],["id","messagePreview"],["role","messaggio","id","new_message"],[1,"headerPreviewMessage"],[1,"boxButtons"],["role","button","tabindex","0",1,"buttonMore",3,"click"],["aria-label","Dismiss","role","button","tabindex","0",1,"buttonClose",3,"click"],["aria-labelledby","altIconTitle","height","20px","role","img","viewBox","0 0 24 24","width","20px","xmlns","http://www.w3.org/2000/svg",2,"fill","rgb(255, 255, 255)"],["d","M0 0h24v24H0V0z","fill","none"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"previewNewMessagge",3,"click"],["role","messaggio",1,"c21-text","message_sender_fullname"],["class","c21-box-text",4,"ngIf"],[1,"c21-time","c21-text"],[4,"ngIf"],[1,"c21-icon-avatar"],[1,"c21-avatar-image","profile_image"],[1,"slide-in-left",3,"senderID","senderFullname","baseLocation"],[1,"c21-box-text"],[4,"ngIf","ngIfThen","ngIfElse"],["contentPopup",""],["contentNewTab",""],[1,"c21-link",3,"click"],[1,"c21-text","overflow4Lines",3,"innerHTML"]],template:function(t,n){1&t&&e.YNc(0,Da,21,6,"div",0),2&t&&e.Q6J("ngIf",n.conversation&&n.g.isOpenNewMessage)},dependencies:[de.O5,At,Ke.eG,kt,bt],styles:['[_nghost-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]    >chat-avatar-image .c21-icon-avatar{height:32px;width:32px;min-width:32px;min-height:32px}[_nghost-%COMP%]   .slide-in-left[_ngcontent-%COMP%]    >chat-message-attachment>#buttons-in-message>span>chat-text-button-attachment .button-in-msg{font-size:13px;padding:5px 10px!important}#messagePreview[_ngcontent-%COMP%]{position:relative;width:320px;max-height:200px;height:100%;padding:0 10px 10px;background-color:transparent;font-family:Helvetica Neue,"Apple Color Emoji",Helvetica,Arial,sans-serif;font-size:100%;font-style:normal;letter-spacing:normal;font-stretch:normal;font-weight:400;text-align:left;text-align-last:initial;text-indent:0px;text-shadow:none;text-transform:none;box-sizing:content-box;-webkit-font-smoothing:antialiased;line-height:1;font-variant:normal}#new_message[_ngcontent-%COMP%]:hover   .boxButtons[_ngcontent-%COMP%]{display:block;animation:fade-in-dw-up .3s ease-in 0s}.previewNewMessagge[_ngcontent-%COMP%]{position:relative;box-sizing:border-box;background-color:#fff;box-shadow:#232f3517 0 2px 8px;clear:both;margin-left:45px;margin-bottom:8px;border-radius:5px 5px 5px 0;padding:4;font-size:14px}.previewNewMessagge[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:-5px;width:0px;height:0px;border-style:solid;border-width:0px 0px 13px 5px;border-color:transparent transparent white}.c21-text.message_sender_fullname[_ngcontent-%COMP%]{font-size:13px;padding:0 10;margin:4 0;clear:both;color:#686868}.c21-box-text[_ngcontent-%COMP%]{max-height:110;overflow-y:auto}.c21-text[_ngcontent-%COMP%]{font-size:14px;color:#000;padding:0 10;margin:0;line-height:1.4;word-break:break-word}.overflow4Lines[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical}.c21-img[_ngcontent-%COMP%]{margin-left:5px;width:120px}.c21-text.c21-time[_ngcontent-%COMP%]{font-size:13px;padding:0 10;clear:both;color:#737376}.c21-link[_ngcontent-%COMP%]{text-decoration:underline;padding:8px;cursor:pointer}.c21-icon-avatar[_ngcontent-%COMP%]{position:absolute;width:32px;height:32px;bottom:0;left:-40px;box-shadow:#232f3517 0 2px 8px;border-radius:100%;border:1px solid #eee;overflow:hidden}.c21-avatar-image[_ngcontent-%COMP%]{width:32px;height:32px;display:block;position:absolute}.c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.headerPreviewMessage[_ngcontent-%COMP%]{position:relative;height:40;margin:10 0 0 50}.boxButtons[_ngcontent-%COMP%]{display:none}.buttonClose[_ngcontent-%COMP%]{transform:translateY(0);opacity:1;position:absolute;top:0;right:0;transition:all .12s ease-out 80ms}.buttonMore[_ngcontent-%COMP%]{transform:translateY(0);opacity:1;display:inline-block;transition:all .12s ease-out 80ms;text-align:center}.buttonMore[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .buttonClose[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;background-color:#67788f;color:#fff;font-size:13px;height:32px;line-height:32px;cursor:pointer;border-radius:16px;background-position:center center;padding:0 20px}.buttonClose[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:32px;height:32px;padding:0}.buttonClose[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{padding:6}#new_message[_ngcontent-%COMP%]{position:absolute;left:0;right:10;bottom:0}']});const Pn=function(r){return{fill:r}};function Ha(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.prevStep())}),e.O4$(),e.TgZ(1,"svg",11),e._UZ(2,"path",12)(3,"path",13),e.TgZ(4,"title",14),e._uU(5),e.qZA()()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.VKq(2,Pn,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(n.g.BACK)}}const so=function(r){return{color:r}};function Za(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",38)(1,"div",39),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.dowloadTranscript())}),e.TgZ(2,"span",40),e._uU(3),e.qZA()()()}if(2&r){const n=e.oxw(2);e.xp6(2),e.Q6J("ngStyle",e.VKq(2,so,null==n.stylesMap?null:n.stylesMap.get("themeColor"))),e.xp6(1),e.Oqu(n.g.DOWNLOAD_TRANSCRIPT)}}const Zn=function(r,t,n){return{"background-color":r,"border-color":t,color:n}};function za(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",15),e.YNc(1,Za,4,4,"div",16),e._UZ(2,"div",17),e.TgZ(3,"div",18)(4,"div",19),e._uU(5),e.qZA(),e.TgZ(6,"fieldset",20),e._UZ(7,"input",21),e.TgZ(8,"label",22),e.NdJ("mouseover",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(1))})("mouseleave",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(0))})("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openRate(1))}),e.O4$(),e.TgZ(9,"svg",23),e._UZ(10,"path",24),e.qZA()(),e.kcU(),e._UZ(11,"input",25),e.TgZ(12,"label",26),e.NdJ("mouseover",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(2))})("mouseleave",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(0))})("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openRate(2))}),e.O4$(),e.TgZ(13,"svg",23),e._UZ(14,"path",24),e.qZA()(),e.kcU(),e._UZ(15,"input",27),e.TgZ(16,"label",28),e.NdJ("mouseover",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(3))})("mouseleave",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(0))})("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openRate(3))}),e.O4$(),e.TgZ(17,"svg",23),e._UZ(18,"path",24),e.qZA()(),e.kcU(),e._UZ(19,"input",29),e.TgZ(20,"label",30),e.NdJ("mouseover",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(4))})("mouseleave",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(0))})("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openRate(4))}),e.O4$(),e.TgZ(21,"svg",23),e._UZ(22,"path",24),e.qZA()(),e.kcU(),e._UZ(23,"input",31),e.TgZ(24,"label",32),e.NdJ("mouseover",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(5))})("mouseleave",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.mouseOverRate(0))})("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openRate(5))}),e.O4$(),e.TgZ(25,"svg",23),e._UZ(26,"path",24),e.qZA()()()(),e.kcU(),e._UZ(27,"div",17),e.TgZ(28,"button",33),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.returnClosePage())}),e.TgZ(29,"span",34),e.O4$(),e.TgZ(30,"svg",35),e._UZ(31,"path",12)(32,"path",36),e.TgZ(33,"title",14),e._uU(34),e.qZA()()(),e.kcU(),e.TgZ(35,"span",37),e._uU(36),e.qZA(),e._UZ(37,"div",17),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.g.allowTranscriptDownload),e.xp6(4),e.Oqu(n.g.YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE),e.xp6(1),e.uIk("disabled",n.g.isOpenStartRating?null:""),e.xp6(3),e.ekj("active",n.mouseRate>=1),e.xp6(4),e.ekj("active",n.mouseRate>=2),e.xp6(4),e.ekj("active",n.mouseRate>=3),e.xp6(4),e.ekj("active",n.mouseRate>=4),e.xp6(4),e.ekj("active",n.mouseRate>=5),e.xp6(3),e.Q6J("ngStyle",e.kEZ(17,Zn,null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.Q6J("ngStyle",e.VKq(21,Pn,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(n.g.CLOSE),e.xp6(2),e.hij(" ",n.g.CLOSE," ")}}function ja(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",15),e._UZ(1,"div",17),e.TgZ(2,"div",41)(3,"textarea",42,43),e._uU(5),e.qZA(),e._UZ(6,"div",17),e.TgZ(7,"button",44),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.returnClosePage())}),e.TgZ(8,"span",34),e.O4$(),e.TgZ(9,"svg",35),e._UZ(10,"path",12)(11,"path",36),e.TgZ(12,"title",14),e._uU(13),e.qZA()()(),e.kcU(),e.TgZ(14,"span",37),e._uU(15),e.qZA(),e._UZ(16,"div",17),e.qZA(),e.TgZ(17,"button",45),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.sendRate())}),e.TgZ(18,"span",34),e.O4$(),e.TgZ(19,"svg",35),e._UZ(20,"path",46)(21,"path",47),e.TgZ(22,"title",14),e._uU(23),e.qZA()()(),e.kcU(),e.TgZ(24,"span",37),e._uU(25),e.qZA(),e._UZ(26,"div",17),e.qZA()()()}if(2&r){const n=e.oxw();e.xp6(3),e.s9C("placeholder",n.g.WRITE_YOUR_OPINION),e.xp6(2),e.Oqu(n.message),e.xp6(2),e.Q6J("ngStyle",e.kEZ(10,Zn,null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.Q6J("ngStyle",e.VKq(14,Pn,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(n.g.CLOSE),e.xp6(2),e.hij(" ",n.g.CLOSE," "),e.xp6(2),e.Q6J("ngStyle",e.kEZ(16,Zn,null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.Q6J("ngStyle",e.VKq(20,Pn,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(n.g.SUBMIT),e.xp6(2),e.hij(" ",n.g.SUBMIT," ")}}function Va(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",38)(1,"div",39),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.dowloadTranscript())}),e.TgZ(2,"span",40),e._uU(3),e.qZA()()()}if(2&r){const n=e.oxw(2);e.xp6(2),e.Q6J("ngStyle",e.VKq(2,so,null==n.stylesMap?null:n.stylesMap.get("themeColor"))),e.xp6(1),e.Oqu(n.g.DOWNLOAD_TRANSCRIPT)}}function Ga(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"div",15),e.YNc(1,Va,4,4,"div",16),e._UZ(2,"div",17),e.TgZ(3,"div",41)(4,"div",48),e._uU(5),e.qZA(),e.TgZ(6,"div",19),e._uU(7),e.qZA()(),e.TgZ(8,"button",44),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.returnClosePage())}),e.TgZ(9,"span",34),e.O4$(),e.TgZ(10,"svg",35),e._UZ(11,"path",12)(12,"path",36),e.TgZ(13,"title",14),e._uU(14),e.qZA()()(),e.kcU(),e.TgZ(15,"span",37),e._uU(16),e.qZA(),e._UZ(17,"div",17),e.qZA()()}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.g.allowTranscriptDownload),e.xp6(4),e.Oqu(n.g.THANK_YOU_FOR_YOUR_EVALUATION),e.xp6(2),e.Oqu(n.g.YOUR_RATING_HAS_BEEN_RECEIVED),e.xp6(1),e.Q6J("ngStyle",e.kEZ(7,Zn,null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(2),e.Q6J("ngStyle",e.VKq(11,Pn,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),e.xp6(4),e.Oqu(n.g.CLOSE),e.xp6(2),e.hij(" ",n.g.CLOSE," ")}}const qa=function(r,t){return{color:r,"background-image":t}};class kn{constructor(t,n){this.starRatingWidgetService=t,this.g=n,this.onClosePage=new e.vpe,this.onCloseRate=new e.vpe,this.logger=fe.getInstance()}ngOnInit(){this.step=0}dowloadTranscript(){this.starRatingWidgetService._dowloadTranscript(this.recipientId)}openRate(t){const n=this;this.rate=t,setTimeout(function(){n.step=1},300)}mouseOverRate(t){this.mouseRate=t}nextStep(){this.step=this.step+1}prevStep(){this.step=this.step-1}sendRate(){this.message=document.getElementById("chat21-message-rate-context").value,this.logger.debug("[STAR-RATING_COMP] sendRate!!!::",this.message);const t=this;this.starRatingWidgetService.httpSendRate(this.rate,this.message).subscribe(n=>{t.logger.debug("[STAR-RATING_COMP] OK sender",n),t.nextStep()},n=>{t.nextStep()},()=>{})}ngOnDestroy(){this.step=0}returnClosePage(){this.logger.debug("[STAR-RATING_COMP] closePage: ",this.mouseRate,this.step,this.rate),this.rate&&0!==this.rate&&this.step<2?this.sendRate():this.step=0,this.starRatingWidgetService.setOsservable(!1),this.onClosePage.emit()}}kn.\u0275fac=function(t){return new(t||kn)(e.Y36(lt),e.Y36(Pe))},kn.\u0275cmp=e.Xpm({type:kn,selectors:[["chat-star-rating-widget"]],inputs:{recipientId:"recipientId",stylesMap:"stylesMap"},outputs:{onClosePage:"onClosePage",onCloseRate:"onCloseRate"},decls:14,vars:12,consts:[["id","chat21-star-rating-widget"],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-content"],["tabindex","1417","aria-label"," indietro ","class","c21-header-button c21-left c21-button-clean",3,"click",4,"ngIf"],[1,"c21-title",3,"ngStyle"],[1,"c21-body"],[1,"c21-body-container"],[1,"c21-body-content"],["class","step-rate",4,"ngIf"],["tabindex","1417","aria-label"," indietro ",1,"c21-header-button","c21-left","c21-button-clean",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],["id","altIconTitle"],[1,"step-rate"],["class","c21-modal-content","style","text-align: right; margin: 0px 20px 30px 10px;",4,"ngIf"],[1,"clear"],[1,"c21-modal-content"],[1,"default-text"],[1,"chat21-rating"],["type","radio","id","star1","name","rating","value","1",1,"c21-input-star"],["for","star1","title","scarso - 1 star",1,"full","c21-button",3,"mouseover","mouseleave","click"],["width","30px","height","30px","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 576 512",1,"star"],["d","M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"],["type","radio","id","star2","name","rating","value","2",1,"c21-input-star"],["for","star2","title","sufficiente - 2 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["type","radio","id","star3","name","rating","value","3",1,"c21-input-star"],["for","star3","title","buono - 3 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["type","radio","id","star4","name","rating","value","4",1,"c21-input-star"],["for","star4","title","ottimo - 4 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["type","radio","id","star5","name","rating","value","5",1,"c21-input-star"],["for","star5","title","eccellente - 5 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["tabindex","1414",1,"c21-button-primary",3,"ngStyle","click"],[1,"v-align-center"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24",3,"ngStyle"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"v-align-center","c21-label-button"],[1,"c21-modal-content",2,"text-align","right","margin","0px 20px 30px 10px"],[1,"c21-link",3,"click"],[3,"ngStyle"],[1,"c21-step-content"],["rows","1","id","chat21-message-rate-context",1,"textarea-rate",3,"placeholder"],["textbox",""],["tabindex","1415",1,"c21-button-primary",3,"ngStyle","click"],["tabindex","1416",1,"c21-button-primary",3,"ngStyle","click"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"],["d","M0 0h24v24H0z","fill","none"],[1,"default-title"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,Ha,6,4,"button",4),e.TgZ(5,"div",5)(6,"span"),e._uU(7),e.qZA()()()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8),e.YNc(11,za,38,23,"div",9),e.YNc(12,ja,27,22,"div",9),e.YNc(13,Ga,18,13,"div",9),e.qZA()()()()),2&t&&(e.xp6(1),e.Q6J("ngStyle",e.WLB(7,qa,n.g.themeForegroundColor,n.g.colorGradient180)),e.xp6(3),e.Q6J("ngIf",n.step>0&&2!=n.step),e.xp6(1),e.Q6J("ngStyle",e.VKq(10,so,n.g.themeForegroundColor)),e.xp6(2),e.Oqu(n.g.CUSTOMER_SATISFACTION),e.xp6(4),e.Q6J("ngIf",0==n.step),e.xp6(1),e.Q6J("ngIf",1==n.step),e.xp6(1),e.Q6J("ngIf",2==n.step))},dependencies:[de.O5,de.PC],styles:["#chat21-star-rating-widget[_ngcontent-%COMP%]{background-color:#fff;width:100%;height:100%;font-size:10px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{z-index:1}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button[_ngcontent-%COMP%]{width:31px;height:31px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button[_ngcontent-%COMP%]   .c21-close-button-body[_ngcontent-%COMP%]{width:31px;height:31px;-webkit-appearance:initial;border:none}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{display:flex;align-items:center}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:45px;right:45px;display:flex;align-items:center;width:auto;height:1.6em;line-height:1.6em;padding:0;margin:13px 0;text-align:center;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{overflow:hidden}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]{padding:10px 30px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .c21-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]{padding:10px 0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .default-title[_ngcontent-%COMP%]{font-size:2em;font-family:Roboto;color:#1a1a1a}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .default-text[_ngcontent-%COMP%]{font-size:1.4em;font-family:Roboto;color:#1a1a1a;margin:0 0 4px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]{text-align:center;position:relative;margin:10px 0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]{border:none;width:190px;min-height:30px;margin:20px auto;font-size:1.6em;padding:0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   input.c21-input-star[_ngcontent-%COMP%]{border:0;width:1px;height:1px;overflow:hidden;position:absolute!important;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);opacity:0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]{position:relative;display:inline;float:none;color:#c8c8c8}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]:before{margin:5px;display:inline-block;font-size:24px;color:#ccc;-webkit-user-select:none;user-select:none}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   input.c21-input-star[_ngcontent-%COMP%]:checked ~ label.c21-button[_ngcontent-%COMP%]:before{color:#ffc107}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]:hover ~ label.c21-button[_ngcontent-%COMP%]:before{color:#ffdb70}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]:hover:before{color:#ffc107}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   .chat21-stars[_ngcontent-%COMP%]{padding:0;position:absolute;text-align:right;display:block;top:0;right:40px;width:70px;line-height:20px;fill:gold}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   svg.star[_ngcontent-%COMP%]{fill:#efefef}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   svg.star[_ngcontent-%COMP%]:hover{fill:gold;stroke-width:15px;transform:rotate(-15deg) scale(1.3)}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   svg.star.active[_ngcontent-%COMP%]{fill:gold}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   .fa-star[_ngcontent-%COMP%]:before{margin:0;font-size:1em;display:inline-block;color:gold}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]{margin:0 auto 10px;border:hidden;overflow-x:hidden;overflow-y:visible;box-sizing:border-box;padding:10px;color:#1a1a1a;width:calc(100% - 40px);height:110px;resize:none;font-size:13px;border-radius:16px;background-color:#fafafa;text-align:left;font-weight:300}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-step-content[_ngcontent-%COMP%]{margin:10px 0 20px;position:relative}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-button-primary[_ngcontent-%COMP%]{font-size:1.4em;border:1px solid;margin:0 10px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-link[_ngcontent-%COMP%]{cursor:pointer;font-size:14px}#chat21-star-rating-widget[_ngcontent-%COMP%]   a.c21-link[_ngcontent-%COMP%]:visited, #chat21-star-rating-widget[_ngcontent-%COMP%]   a.c21-link[_ngcontent-%COMP%]:link{color:#2a6ac1}",".star.active[_ngcontent-%COMP%]{\n    fill:#FFD700;\n}\nsvg.star[_ngcontent-%COMP%]{\n    fill: #efefef;\n}\nsvg.star[_ngcontent-%COMP%]:hover{\n    fill: #FFD700;\n}"]});const Wa=["aflauncherbutton"];function Ya(r,t){if(1&r&&(e.TgZ(0,"div",5),e._uU(1),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.Oqu(n.g.conversationsBadge)}}const Ja=function(r){return{width:"100%",height:"100%",margin:"auto","border-radius":r}};function Qa(r,t){if(1&r&&e._UZ(0,"img",11),2&r){const n=e.oxw(3);e.Q6J("src",n.g.baloonImage,e.LSH)("ngStyle",e.VKq(2,Ja,n.g.baloonShape))}}const Ka=function(r,t){return{fill:r,display:t}};function $a(r,t){if(1&r&&(e.TgZ(0,"div",6),e.YNc(1,Qa,1,4,"img",7),e.O4$(),e.TgZ(2,"svg",8),e._UZ(3,"path",9)(4,"path",10),e.qZA()()),2&r){const n=e.oxw(2);e.Q6J("@enterBubbleAnimation",void 0),e.xp6(1),e.Q6J("ngIf",""!==n.g.baloonImage),e.xp6(1),e.Q6J("ngStyle",e.WLB(3,Ka,n.g.themeForegroundColor,""===n.g.baloonImage?"":"none"))}}const Xa=function(r){return{fill:r}};function el(r,t){if(1&r&&(e.TgZ(0,"div",6),e.O4$(),e.TgZ(1,"svg",8),e._UZ(2,"path",9)(3,"path",12),e.qZA()()),2&r){const n=e.oxw(2);e.Q6J("@enterCloseAnimation",void 0),e.xp6(1),e.Q6J("ngStyle",e.VKq(2,Xa,n.g.themeForegroundColor))}}const tl=function(r,t){return{"c21-align-left":r,"c21-align-right":t}},nl=function(r,t,n,o,i,l,E){return{"background-color":r,bottom:t,left:n,right:o,width:i,height:l,"border-radius":E}};function ol(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"button",1,2),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.openCloseWidget())}),e.YNc(2,Ya,2,1,"div",3),e.YNc(3,$a,5,6,"div",4),e.YNc(4,el,4,4,"div",4),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("ngClass",e.WLB(5,tl,"left"===n.g.align,"left"!==n.g.align))("ngStyle",e.Hh0(8,nl,n.g.baloonImage?null:n.g.themeColor,n.g.marginY+"px!important","left"===n.g.align?n.g.marginX+"px!important":"","right"===n.g.align?n.g.marginX+"px!important":"",n.g.launcherWidth,n.g.launcherHeight,n.g.baloonShape)),e.xp6(2),e.Q6J("ngIf",n.g.conversationsBadge>0),e.xp6(1),e.Q6J("ngIf",!n.g.isOpen),e.xp6(1),e.Q6J("ngIf",n.g.isOpen)}}class An{constructor(t,n){this.g=t,this.appStorageService=n,this.onButtonClicked=new e.vpe}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{!this.g.isOpen&&this.aflauncherbutton&&(this.aflauncherbutton.nativeElement.style["box-shadow"]="0px 4px 20px "+Ae(this.g.themeColor,50))},0)}openCloseWidget(){!0===this.g.isLogged&&this.onButtonClicked.emit(this.g.isOpen)}}An.\u0275fac=function(t){return new(t||An)(e.Y36(Pe),e.Y36(Re))},An.\u0275cmp=e.Xpm({type:An,selectors:[["chat-launcher-button"]],viewQuery:function(t,n){if(1&t&&e.Gf(Wa,5),2&t){let o;e.iGM(o=e.CRH())&&(n.aflauncherbutton=o.first)}},outputs:{onButtonClicked:"onButtonClicked"},decls:1,vars:1,consts:[["aflauncherbutton","","id","c21-launcher-button","class","c21-button-clean scale-in-center","tabindex","1000","aria-label","    apri chat",3,"ngClass","ngStyle","click",4,"ngIf"],["aflauncherbutton","","id","c21-launcher-button","tabindex","1000","aria-label","    apri chat",1,"c21-button-clean","scale-in-center",3,"ngClass","ngStyle","click"],["aflauncherbutton",""],["class","c21-divBudge",4,"ngIf"],["class","launcher-button rotate-center",4,"ngIf"],[1,"c21-divBudge"],[1,"launcher-button","rotate-center"],[3,"src","ngStyle",4,"ngIf"],["role","img","xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 90 90",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M33.57,31A4.58,4.58,0,0,0,29,35.57V58.3a1.94,1.94,0,0,0,3.32,1.38l3-3a.29.29,0,0,1,.21-.09H56.43A4.58,4.58,0,0,0,61,52V35.57A4.58,4.58,0,0,0,56.43,31Z"],[3,"src","ngStyle"],["d","M54.92,37.08l-2-2L45,43l-7.92-7.92-2,2L43,45l-7.92,7.92,2,2L45,47l7.92,7.92,2-2L47,45Z",1,"cls-1"]],template:function(t,n){1&t&&e.YNc(0,ol,5,16,"button",0),2&t&&e.Q6J("ngIf",1==n.g.isLogged&&0==n.g.isOpen)},dependencies:[de.mk,de.O5,de.PC],styles:["#c21-launcher-button[_ngcontent-%COMP%]{position:fixed;bottom:0;cursor:pointer;display:block;margin:20px;z-index:1;box-shadow:#00122e29 0 0 16px}#c21-launcher-button[_ngcontent-%COMP%]   .launcher-button[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;margin:0;display:flex}.c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:0;width:16px;height:16px;min-width:12px;font-size:1.2em;line-height:16px;border-radius:50%;background-color:red;color:#fff;font-weight:700;padding:5px;text-align:center;margin-top:-10px;display:inline-block}@media (max-width: 451px){#c21-launcher-button.c21-align-right[_ngcontent-%COMP%]{right:0}#c21-launcher-button.c21-align-left[_ngcontent-%COMP%]{left:0}}"],data:{animation:[(0,Se.X$)("enterCloseAnimation",[(0,Se.eR)(":enter",[(0,Se.oB)({transform:"rotate(-90deg)",opacity:1}),(0,Se.jt)("450ms ease-out",(0,Se.oB)({transform:"rotate(0deg)",opacity:1}))]),(0,Se.eR)(":leave",[(0,Se.oB)({transform:"scale(1)",opacity:1}),(0,Se.jt)("200ms ease-in",(0,Se.oB)({transform:"scale(0.5)",opacity:0}))])]),(0,Se.X$)("enterBubbleAnimation",[(0,Se.eR)(":enter",[(0,Se.oB)({transform:"scale(0.5)",opacity:0}),(0,Se.jt)("200ms ease-out",(0,Se.oB)({transform:"scale(1)",opacity:1}))]),(0,Se.eR)(":leave",[(0,Se.oB)({transform:"scale(1)",opacity:1}),(0,Se.jt)("200ms ease-in",(0,Se.oB)({transform:"scale(0.5)",opacity:0}))])])]}});const il=["afSelectionDepartment"];function rl(r,t){if(1&r){const n=e.EpF();e.TgZ(0,"li")(1,"button",20),e.NdJ("click",function(){const l=e.CHM(n).$implicit,E=e.oxw();return e.KtG(E.onSelectDepartment(l))}),e.TgZ(2,"span",21),e._uU(3),e.qZA(),e.TgZ(4,"span",22),e._uU(5),e.qZA()()()}if(2&r){const n=t.$implicit,o=t.index;e.xp6(3),e.Oqu(o+1),e.xp6(2),e.Oqu(null==n?null:n.name)}}const sl=function(r,t){return{color:r,"background-image":t}},al=function(r){return{color:r}};class In{constructor(t,n,o){this.elementRef=t,this.g=n,this.appStorageService=o,this.onDepartmentSelected=new e.vpe,this.onClose=new e.vpe,this.onOpen=new e.vpe,this.onBeforeDepartmentsFormRender=new e.vpe,this.logger=fe.getInstance()}ngOnInit(){this.logger.debug("[SELECT-DEP] ngOnInit"),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--backgroundColor",this.g.themeForegroundColor),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--textColor",this.g.themeColor),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--hoverBackgroundColor",this.g.themeColor),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--hoverTextColor",this.g.themeForegroundColor),this.g.departments&&this.g.departments.length>0&&(this.g.windowContext&&this.g.windowContext.tiledesk&&this.g.windowContext.tiledesk.beforeDepartmentsFormRender?(this.departments=this.g.departments,this.departments=this.g.windowContext.tiledesk.beforeDepartmentsFormRender(this.g.departments)):(this.departments=JSON.parse(JSON.stringify(this.g.departments)),this.triggerOnbeforeDepartmentsFormRender()))}ngAfterViewInit(){setTimeout(()=>{this.afSelectionDepartment&&this.afSelectionDepartment.nativeElement.focus()},1e3)}setDepartment(t){if(this.g.setParameter("departmentSelected",t),this.g.attributes){const n=this.g.attributes;this.g.setAttributeParameter("departmentId",t._id),this.g.setAttributeParameter("departmentName",t.name),this.appStorageService.setItem("attributes",JSON.stringify(n)),this.logger.debug("[SELECT-DEP] setDepartment: attributes",JSON.stringify(n))}}onSelectDepartment(t){this.logger.debug("[SELECT-DEP] onSelectDepartment: ",t),this.setDepartment(t),this.onDepartmentSelected.emit(t)}openPage(){this.logger.debug("[SELECT-DEP] openPage "),this.onOpen.emit()}closePage(){this.logger.debug("[SELECT-DEP] closePage"),this.onClose.emit()}cancelPage(){this.logger.debug("[SELECT-DEP] cancelPage"),this.g.newConversationStart=!1,this.onClose.emit()}triggerOnbeforeDepartmentsFormRender(){this.onBeforeDepartmentsFormRender.emit(this.departments)}}In.\u0275fac=function(t){return new(t||In)(e.Y36(e.SBq),e.Y36(Pe),e.Y36(Re))},In.\u0275cmp=e.Xpm({type:In,selectors:[["chat-selection-department"]],viewQuery:function(t,n){if(1&t&&e.Gf(il,5),2&t){let o;e.iGM(o=e.CRH())&&(n.afSelectionDepartment=o.first)}},outputs:{onDepartmentSelected:"onDepartmentSelected",onClose:"onClose",onOpen:"onOpen",onBeforeDepartmentsFormRender:"onBeforeDepartmentsFormRender"},decls:21,vars:9,consts:[["id","chat21-selection-department","tabindex","1200","aria-modal","true","onFocus","document.querySelector('[start-focus-chat21-selection-department]').focus()"],["afSelectionDepartment",""],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-button"],["role","button",1,"c21-close-button","c21-small"],["tabindex","1210","aria-label"," chiudi pannello",1,"c21-close-button-body",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"c21-header-content"],[1,"c21-title",3,"ngStyle"],[1,"c21-body"],[1,"c21-body-container"],[1,"c21-body-header"],["start-focus-chat21-selection-department","","tabindex","1201",1,"c21-message-field"],["tabindex","211","onFocus","document.querySelector('[start-focus]').focus()",1,"c21-body-content"],[1,"chat21-content-modal-select"],[4,"ngFor","ngForOf"],["tabindex","1299","onFocus","document.querySelector('[start-focus-chat21-selection-department]').focus()",2,"height","0px"],["tabindex","1202",1,"c21-button-department","c21-button-clean",3,"click"],[1,"chat21-badge"],[1,"chat21-name-list"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),e.NdJ("click",function(){return n.closePage()}),e.O4$(),e.TgZ(7,"svg",7),e._UZ(8,"path",8)(9,"path",9),e.qZA()()()(),e.kcU(),e.TgZ(10,"div",10),e._UZ(11,"div",11),e.qZA()()(),e.TgZ(12,"div",12)(13,"div",13)(14,"div",14)(15,"div",15),e._uU(16),e.qZA()(),e.TgZ(17,"div",16)(18,"ul",17),e.YNc(19,rl,6,2,"li",18),e.qZA()()()(),e._UZ(20,"span",19),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngStyle",e.WLB(4,sl,n.g.themeForegroundColor,n.g.colorGradient180)),e.xp6(9),e.Q6J("ngStyle",e.VKq(7,al,n.g.themeForegroundColor)),e.xp6(5),e.Oqu(n.g.LABEL_SELECT_TOPIC),e.xp6(3),e.Q6J("ngForOf",n.departments))},dependencies:[de.sg,de.PC],styles:["#chat21-selection-department[_ngcontent-%COMP%]{--backgroundColor: #f7f7f7;--textColor: rgb(42, 106, 193);--hoverBackgroundColor: rgb(42, 106, 193);--hoverTextColor: #f7f7f7;background-color:#fff;width:100%;height:100%}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{overflow:hidden;width:100%;height:52px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]{width:31px;height:31px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]   .c21-close-button-body[_ngcontent-%COMP%]{width:31px;height:31px;-webkit-appearance:initial;border:none}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;margin:0 auto}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]{width:100%;height:auto;padding:0 40px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{display:inline-block;width:100%;height:auto;padding:0;text-align:center;font-size:1.8em;line-height:normal}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:16px;padding-right:16px;gap:10px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]{position:relative;inset:0;padding:20px 30px 0}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .c21-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#aaa;font-size:1.6em;text-align:center;word-wrap:break-word}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]{padding:0 0 40px;position:relative;width:100%}.chat21-content-modal-select[_ngcontent-%COMP%]{margin:0 0 2em;list-style-type:none;padding:0;height:auto;overflow-y:auto;display:flex;flex-direction:column;gap:12px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{cursor:pointer;position:relative;margin:0;padding:20px 16px;font-size:1.4em;text-align:left;color:var(--textColor);border:1px solid var(--textColor);line-height:normal;display:block;border-radius:10px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .c21-button-department[_ngcontent-%COMP%]{width:100%;text-align:left;display:flex;gap:12px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{background-color:var(--hoverBackgroundColor);border-radius:10px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover   .chat21-name-list[_ngcontent-%COMP%]{color:var(--hoverTextColor)}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover   .chat21-badge[_ngcontent-%COMP%]{color:var(--hoverBackgroundColor);background-color:var(--hoverTextColor)}.chat21-content-modal-select[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:relative}.chat21-content-modal-select[_ngcontent-%COMP%]   .chat21-badge[_ngcontent-%COMP%]{box-sizing:initial;display:flex;justify-content:center;align-items:center;font-size:12px;padding:0;line-height:24px;height:24px;width:24px;border-radius:50%;margin:0 10px 0 0;text-align:center;font-weight:500;color:var(--backgroundColor);background-color:var(--textColor)}.chat21-content-modal-select[_ngcontent-%COMP%]   .chat21-name-list[_ngcontent-%COMP%]{font-size:18px;font-weight:500;line-height:24px;color:#7d87a4}.chat21-content-modal-select[_ngcontent-%COMP%]   .chat21-title[_ngcontent-%COMP%]{margin-left:10px;font-weight:initial;line-height:normal}"]});var ll=be(8746),zn=be(2344);class Lt{constructor(){}}Lt.\u0275fac=function(t){return new(t||Lt)},Lt.\u0275prov=e.Yz7({token:Lt,factory:Lt.\u0275fac});class Nt extends Lt{constructor(t){super(),this.logger=t,this.logLevel=Oe.ERROR,this.isLogEnabled=!0}setLoggerConfig(t,n){this.isLogEnabled=t,"string"==typeof n?this.logLevel=Oe[n.toUpperCase()]:console.error("logLevel is not a string. See the chat21-ionic README.md")}getLoggerConfig(){return{isLogEnabled:this.isLogEnabled,logLevel:this.logLevel}}error(t,...n){this.isLogEnabled&&this.logLevel>=Oe.ERROR&&this.logger.error(t,...n)}warn(t,...n){this.isLogEnabled&&this.logLevel>=Oe.WARN&&this.logger.warn(t,...n)}info(t,...n){this.isLogEnabled&&this.logLevel>=Oe.INFO&&this.logger.info(t,...n)}debug(t,...n){this.isLogEnabled&&this.logLevel>=Oe.DEBUG&&this.logger.debug(t,...n)}log(t,...n){this.isLogEnabled&&this.logLevel>=Oe.DEBUG&&this.logger.log(t,...n)}}Nt.\u0275fac=function(t){return new(t||Nt)(e.LFG(zn.Kf))},Nt.\u0275prov=e.Yz7({token:Nt,factory:Nt.\u0275fac});class ct{constructor(){}}ct.\u0275fac=function(t){return new(t||ct)},ct.\u0275prov=e.Yz7({token:ct,factory:ct.\u0275fac});var ye=be(7835);class Ge{constructor(){}static initFirebase(t){if(!Ge.firebaseInit){if(!t||"CHANGEIT"===t.apiKey)throw new Error("Firebase config is not defined. Please create your widget-config.json. See the Chat21-Web_widget Installation Page");Ge.firebaseInit=ye.Z.initializeApp(t)}return Ge.firebaseInit}}Ge.\u0275fac=function(t){return new(t||Ge)},Ge.\u0275prov=e.Yz7({token:Ge,factory:Ge.\u0275fac}),be(6035),be(7255),be(7315);class Ft extends et{constructor(t){super(),this.http=t,this.BSAuthStateChanged=new _e.X(null),this.BSSignOut=new _e.X(null),this.logger=fe.getInstance()}initialize(){this.SERVER_BASE_URL=this.getBaseUrl(),this.URL_TILEDESK_CREATE_CUSTOM_TOKEN=this.SERVER_BASE_URL+"chat21/firebase/auth/createCustomToken",this.logger.debug("[FIREBASEAuthSERVICE] - initialize URL_TILEDESK_CREATE_CUSTOM_TOKEN ",this.URL_TILEDESK_CREATE_CUSTOM_TOKEN),this.onAuthStateChanged()}getToken(){return this.firebaseToken}onAuthStateChanged(){const t=this;ye.Z.auth().onAuthStateChanged(n=>{this.logger.debug("[FIREBASEAuthSERVICE] onAuthStateChanged",n),n?(this.logger.debug("[FIREBASEAuthSERVICE] 2 - PUBLISH ONLINE to chat-manager"),t.BSAuthStateChanged.next("online")):(this.logger.debug("[FIREBASEAuthSERVICE] 1 - PUBLISH OFFLINE to chat-manager"),t.BSAuthStateChanged.next("offline"))})}signInFirebaseWithCustomToken(t){const n=this;let o;switch(this.getPersistence()){case"SESSION":o=ye.Z.auth.Auth.Persistence.SESSION;break;case"LOCAL":o=ye.Z.auth.Auth.Persistence.LOCAL;break;default:o=ye.Z.auth.Auth.Persistence.NONE}return ye.Z.auth().setPersistence(o).then((0,ro.Z)(function*(){return ye.Z.auth().signInWithCustomToken(t).then((0,ro.Z)(function*(){})).catch(i=>{n.logger.error("[FIREBASEAuthSERVICE] signInFirebaseWithCustomToken Error: ",i)})})).catch(i=>{n.logger.error("[FIREBASEAuthSERVICE] signInFirebaseWithCustomToken Error: ",i)})}createUserWithEmailAndPassword(t,n){const o=this;return ye.Z.auth().createUserWithEmailAndPassword(t,n).then(i=>(o.logger.debug("[FIREBASEAuthSERVICE] CRATE USER WITH EMAIL: ",t," & PSW: ",n),i)).catch(i=>(o.logger.error("[FIREBASEAuthSERVICE] createUserWithEmailAndPassword error: ",i.message),i))}sendPasswordResetEmail(t){const n=this;return ye.Z.auth().sendPasswordResetEmail(t).then(()=>{n.logger.debug("[FIREBASEAuthSERVICE] firebase-send-password-reset-email")}).catch(o=>{n.logger.error("[FIREBASEAuthSERVICE] sendPasswordResetEmail error: ",o)})}signOut(){const t=this;return new Promise((n,o)=>{ye.Z.auth().signOut().then(()=>{t.logger.debug("[FIREBASEAuthSERVICE] firebase-sign-out"),t.BSSignOut.next(!0),n(!0)}).catch(i=>{n(!1),t.logger.error("[FIREBASEAuthSERVICE] signOut error: ",i)})})}delete(){const t=this;ye.Z.auth().currentUser.delete().then(()=>{t.logger.debug("[FIREBASEAuthSERVICE] firebase-current-user-delete")}).catch(n=>{t.logger.error("[FIREBASEAuthSERVICE] delete error: ",n)})}createCustomToken(t){const n=new Ee.WM({"Content-type":"application/json",Authorization:t}),l=this;this.http.post(this.URL_TILEDESK_CREATE_CUSTOM_TOKEN,{},{headers:n,responseType:"text"}).subscribe(E=>{l.firebaseToken=E,l.signInFirebaseWithCustomToken(E)},E=>{l.logger.error("[FIREBASEAuthSERVICE] createFirebaseCustomToken ERR ",E)})}logout(){return this.logger.debug("[FIREBASEAuthSERVICE] logout"),this.signOut()}}Ft.\u0275fac=function(t){return new(t||Ft)(e.LFG(Ee.eN))},Ft.\u0275prov=e.Yz7({token:Ft,factory:Ft.\u0275fac});class Bt extends Ye{constructor(t,n){super(),this.http=t,this.appConfig=n,this.BSConversationDetail=new _e.X(null),this.conversationAdded=new _e.X(null),this.conversationChanged=new _e.X(null),this.conversationChangedDetailed=new _e.X(null),this.conversationRemoved=new _e.X(null),this.conversations=[],this.logger=fe.getInstance()}initialize(t,n,o){this.tenant=t,this.loggedUserId=n,this.translationMap=o,this.conversations=[],this.isConversationClosingMap=new Map,this.BASE_URL=this.appConfig.getConfig().firebaseConfig.chat21ApiUrl,this.BASE_URL_DATABASE=this.appConfig.getConfig().firebaseConfig.databaseURL}subscribeToConversations(t){const n=this,o=Bn(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEConversationsHandlerSERVICE] SubscribeToConversations conversations::ACTIVE urlNodeFirebase",o),this.ref=ye.Z.database().ref(o).orderByChild("timestamp").limitToLast(200),this.ref.on("child_changed",i=>{n.changed(i)}),this.ref.on("child_removed",i=>{n.removed(i)}),this.ref.on("child_added",i=>{n.added(i)}),setTimeout(()=>{t()},2e3)}getLastConversation(t){this.getFirebaseToken((n,o)=>{if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi  idToken",o),this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi  error",n),o){const i={headers:new Ee.WM({Accept:"application/json","Content-Type":"application/json"})},l=Bn(this.tenant,this.loggedUserId);this.http.get(this.BASE_URL_DATABASE+l+".json?auth="+o+'&orderBy="timestamp"&limitToLast=1',i).subscribe(Q=>{if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi - RES",Q),Q){const se=Q[Object.keys(Q)[0]];se.uid=Object.keys(Q)[0];const ge=this.completeConversation(se);t(ge,null)}else Q||t(null,null)},Q=>{this.logger.error("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi ERROR ",Q),t(null,"error")},()=>{this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi * COMPLETE *")})}else t(null,"error")})}countIsNew(){let t=0;return this.conversations.forEach(n=>{!0===n.is_new&&t++}),t}setConversationRead(t){const n=Bn(this.tenant,this.loggedUserId)+"/"+t;ye.Z.database().ref(n).update({"/is_new":!1})}getClosingConversation(t){return this.isConversationClosingMap[t]}setClosingConversation(t,n){this.isConversationClosingMap[t]=n}deleteClosingConversation(t){this.isConversationClosingMap.delete(t)}archiveConversation(t){const n=this;this.setClosingConversation(t,!0);const o=Le(this.conversations,t);this.deleteConversation(t,function(i){n.logger.debug("[FIREBASEConversationsHandlerSERVICE]  ARCHIVE-CONV",i),"success"===i?o>-1&&n.conversations.splice(o,1):"error"===i&&n.setClosingConversation(t,!1)})}deleteConversation(t,n){this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV conversationId",t),this.getFirebaseToken((o,i)=>{if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV idToken",i),this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV error",o),i){const l={headers:new Ee.WM({Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+i})};this.http.delete(this.BASE_URL+"/api/"+this.tenant+"/conversations/"+t,l).subscribe(V=>{this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV - RES",V),n("success")},V=>{this.logger.error("[FIREBASEConversationsHandlerSERVICE] DELETE CONV ERROR ",V),n("error")},()=>{this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV * COMPLETE *")})}else n("error")})}getFirebaseToken(t){const n=ye.Z.auth().currentUser;this.logger.debug(" // firebase current user ",n),n&&n.getIdToken(!0).then(function(o){t(null,o)}).catch(function(o){t(o,null)})}getConversationDetail(t,n){const o=this.conversations.find(i=>i.uid===t);if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE]  conversations *****: ",this.conversations),this.logger.debug("[FIREBASEConversationsHandlerSERVICE]  getConversationDetail *****: ",o),o)n(o);else{const i=Bn(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEConversationsHandlerSERVICE] conversationDetail urlNodeFirebase *****",i);const l=ye.Z.database().ref(i);this.subscribe=l.on("value",E=>{const V=E.child("/"+t);if(V.exists()){const Q=V.val();if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationDetail conversation exist",V.val(),V.key),V&&V.key&&Q){Q.uid=V.key;const se=this.completeConversation(Q);n(se||null)}}else this.logger.log("[FIREBASEConversationsHandlerSERVICE] getConversationDetail conversation NOT exist",t),n(null)})}}dispose(){this.conversations=[],this.uidConvSelected="",this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DISPOSE::: ",this.ref)}conversationGenerate(t){const n=t.val();n.uid=t.key;const o=this.completeConversation(n);if(this.isValidConversation(o)){this.setClosingConversation(t.key,!1);const i=Le(this.conversations,o.uid);return i>-1?this.conversations.splice(i,1,o):this.conversations.splice(0,0,o),this.conversations.sort(ut("timestamp","desc")),!0}return!1}added(t){if(this.conversationGenerate(t)){const n=Le(this.conversations,t.key);n>-1&&this.conversationAdded.next(this.conversations[n])}else this.logger.error("[FIREBASEConversationsHandlerSERVICE]ADDED::conversations with conversationId: ",t.key,"is not valid")}changed(t){const n=this.conversations[Le(this.conversations,t.key)];if(this.conversationGenerate(t)){const o=Le(this.conversations,t.key);if(o>-1){const i=this.conversations[o];this.conversationChanged.next(i),this.conversationChangedDetailed.next({value:i,previousValue:n})}}else this.logger.error("[FIREBASEConversationsHandlerSERVICE]CHANGED::conversations with conversationId: ",t.key,"is not valid")}removed(t){const n=Le(this.conversations,t.key);if(n>-1){const o=this.conversations[n];this.conversations.splice(n,1),this.conversationRemoved.next(o)}this.deleteClosingConversation(t.key)}completeConversation(t){this.logger.debug("[FIREBASEConversationsHandlerSERVICE] completeConversation --\x3e conv from firebase",t),t.selected=!1,(!t.sender_fullname||"undefined"===t.sender_fullname||""===t.sender_fullname.trim())&&(t.sender_fullname=t.sender),(!t.recipient_fullname||"undefined"===t.recipient_fullname||""===t.recipient_fullname.trim())&&(t.recipient_fullname=t.recipient);let n=t.sender_fullname,o=t.sender;return t.sender===this.loggedUserId?(o=t.recipient,n=t.recipient_fullname,t.sender_fullname=this.translationMap.get("YOU")):yo(t)&&(o=t.recipient,n=t.recipient_fullname),t.conversation_with=o,t.conversation_with_fullname=n,t.status=this.setStatusConversation(t.sender,t.uid),t.avatar=tn(n),t.color=en(n),t}setStatusConversation(t,n){let o="0";return o=t===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(t){return Xt(parseInt(t,10)/1e3)}isValidConversation(t){return!!(this.isValidField(t.uid)&&this.isValidField(t.is_new)&&this.isValidField(t.last_message_text)&&this.isValidField(t.recipient)&&this.isValidField(t.recipient_fullname)&&this.isValidField(t.sender)&&this.isValidField(t.sender_fullname)&&this.isValidField(t.status)&&this.isValidField(t.timestamp)&&this.isValidField(t.channel_type))}isValidField(t){return null!=t}}Bt.\u0275fac=function(t){return new(t||Bt)(e.LFG(Ee.eN),e.LFG(ke))},Bt.\u0275prov=e.Yz7({token:Bt,factory:Bt.\u0275fac});class Ut extends Je{constructor(){super(),this.BSConversationDetail=new _e.X(null),this.archivedConversationAdded=new _e.X(null),this.archivedConversationChanged=new _e.X(null),this.archivedConversationRemoved=new _e.X(null),this.archivedConversations=[],this.logger=fe.getInstance()}initialize(t,n,o){this.tenant=t,this.loggedUserId=n,this.translationMap=o,this.archivedConversations=[],this.isConversationClosingMap=new Map}subscribeToConversations(t){const n=this,o=Wn(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] SubscribeToConversations conversations::ARCHIVED urlNodeFirebase",o),this.ref=ye.Z.database().ref(o).orderByChild("timestamp").limitToLast(200),this.ref.on("child_changed",i=>{n.changed(i)}),this.ref.on("child_removed",i=>{n.removed(i)}),this.ref.on("child_added",i=>{n.added(i)}),setTimeout(()=>{t()},2e3)}countIsNew(){let t=0;return this.archivedConversations.forEach(n=>{!0===n.is_new&&t++}),t}setConversationRead(t){const n=Wn(this.tenant,this.loggedUserId)+"/"+t;ye.Z.database().ref(n).update({"/is_new":!1})}getClosingConversation(t){return this.isConversationClosingMap[t]}setClosingConversation(t,n){this.isConversationClosingMap[t]=n}deleteClosingConversation(t){this.isConversationClosingMap.delete(t)}getConversationDetail(t,n){const o=this.archivedConversations.find(i=>i.uid===t);if(this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] SubscribeToConversations getConversationDetail::ARCHIVED *****: ",o),o)n(o);else{const i=Wn(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] urlNodeFirebase conversationDetail *****",i,t);const l=ye.Z.database().ref(i);this.subscribe=l.on("value",E=>{const V=E.child("/"+t);if(V.exists()){const Q=V.val();if(this.logger.log("[FIREBASEArchivedConversationsHandlerSERVICE] getConversationDetail archived conversation exist",Q),V&&V.key&&Q){Q.uid=V.key;const se=this.completeConversation(Q);n(se||null)}}else this.logger.log("[FIREBASEArchivedConversationsHandlerSERVICE] getConversationDetail archived conversation NOT exist",t),n(null)})}}dispose(){this.archivedConversations=[],this.uidConvSelected="",this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] DISPOSE::: ",this.ref)}conversationGenerate(t){const n=t.val();n.uid=t.key;const o=this.completeConversation(n);if(this.isValidConversation(o)){this.setClosingConversation(t.key,!1);const i=Le(this.archivedConversations,o.uid);return i>-1?this.archivedConversations.splice(i,1,o):this.archivedConversations.splice(0,0,o),this.archivedConversations.sort(ut("timestamp","desc")),!0}return!1}added(t){if(this.conversationGenerate(t)){const n=Le(this.archivedConversations,t.key);n>-1&&this.archivedConversationAdded.next(this.archivedConversations[n])}else this.logger.error("[FIREBASEArchivedConversationsHandlerSERVICE] ADDED::conversations with conversationId: ",t.key,"is not valid")}changed(t){if(this.conversationGenerate(t)){const n=Le(this.archivedConversations,t.key);n>-1&&this.archivedConversationChanged.next(this.archivedConversations[n])}else this.logger.error("[FIREBASEArchivedConversationsHandlerSERVICE] CHANGED::conversations with conversationId: ",t.key,"is not valid")}removed(t){const n=Le(this.archivedConversations,t.key);if(n>-1){const o=this.archivedConversations[n];this.archivedConversations.splice(n,1),this.archivedConversationRemoved.next(o)}this.deleteClosingConversation(t.key)}completeConversation(t){t.selected=!1,(!t.sender_fullname||"undefined"===t.sender_fullname||""===t.sender_fullname.trim())&&(t.sender_fullname=t.sender),(!t.recipient_fullname||"undefined"===t.recipient_fullname||""===t.recipient_fullname.trim())&&(t.recipient_fullname=t.recipient);let n=t.sender_fullname,o=t.sender;return t.sender===this.loggedUserId?(o=t.recipient,n=t.recipient_fullname,t.sender_fullname=this.translationMap.get("YOU")):yo(t)&&(o=t.recipient,n=t.recipient_fullname),t.conversation_with=o,t.conversation_with_fullname=n,t.status=this.setStatusConversation(t.sender,t.uid),t.avatar=tn(n),t.color=en(n),t.archived=!0,t}setStatusConversation(t,n){let o="0";return o=t===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(t){return Xt(parseInt(t,10)/1e3)}isValidConversation(t){return!!(this.isValidField(t.uid)&&this.isValidField(t.is_new)&&this.isValidField(t.last_message_text)&&this.isValidField(t.recipient)&&this.isValidField(t.recipient_fullname)&&this.isValidField(t.sender)&&this.isValidField(t.sender_fullname)&&this.isValidField(t.status)&&this.isValidField(t.timestamp)&&this.isValidField(t.channel_type))}isValidField(t){return null!=t}}Ut.\u0275fac=function(t){return new(t||Ut)},Ut.\u0275prov=e.Yz7({token:Ut,factory:Ut.\u0275fac}),be(9361);class Ho{constructor(t,n,o,i,l,E,V,Q,se,ge,me,ce,ve,we,Me){this.uid=t,this.language=n,this.recipient=o,this.recipient_fullname=i,this.sender=l,this.sender_fullname=E,this.status=V,this.metadata=Q,this.text=se,this.timestamp=ge,this.type=me,this.attributes=ce,this.channel_type=ve,this.isSender=we,this.emoticon=Me}}class wt extends ct{constructor(t){super(),this.skipInfoMessage=t,this.messageAdded=new _e.X(null),this.messageChanged=new _e.X(null),this.messageRemoved=new _e.X(null),this.messageWait=new _e.X(null),this.messageInfo=new _e.X(null),this.startTime=new Date,this.logger=fe.getInstance()}initialize(t,n,o,i,l,E){this.logger.debug("[FIREBASEConversationHandlerSERVICE] initWithRecipient",t,n,o,i,l),this.recipientId=t,this.recipientFullname=n,this.loggedUser=o,o&&(this.senderId=o.uid),this.tenant=i,this.translationMap=l,this.listSubsriptions=[],this.CLIENT_BROWSER=navigator.userAgent,this.conversationWith=t,this.messages=[],this.showInfoMessage=E}connect(){const t=this;this.urlNodeFirebase=function Ko(r,t){return"/apps/"+r+"/users/"+t+"/messages/"}(this.tenant,this.loggedUser.uid),this.urlNodeFirebase=this.urlNodeFirebase+this.conversationWith,this.logger.debug("[FIREBASEConversationHandlerSERVICE] urlNodeFirebase *****",this.urlNodeFirebase);const n=ye.Z.database().ref(this.urlNodeFirebase);this.ref=n.orderByChild("timestamp").limitToLast(100),this.ref.on("child_added",o=>{t.logger.debug("[FIREBASEConversationHandlerSERVICE] >>>>>>>>>>>>>> child_added: ",o.val());const i=o.val();i.uid=o.key,i.attributes&&i.attributes.commands?(this.logger.debug("[FIREBASEConversationHandlerSERVICE] splitted message::::",i),t.addCommandMessage(i)):(this.logger.debug("[FIREBASEConversationHandlerSERVICE] NOT splitted message::::",i),t.addedNew(i))}),this.ref.on("child_changed",o=>{t.logger.debug("[FIREBASEConversationHandlerSERVICE] >>>>>>>>>>>>>> child_changed: ",o.val()),t.changed(o)}),this.ref.on("child_removed",o=>{t.removed(o)})}sendMessage(t,n,o,i,l,E,V,Q,se){(!Q||"undefined"===Q)&&(Q=ee);const me=ye.Z.database().ref(this.urlNodeFirebase),ce=document.documentElement.lang,ve=l,Me=new Ho("",ce,i,ve,E,V,0,o,t,ye.Z.database.ServerValue.TIMESTAMP,n,se,Q,!0);return me.push({language:ce,recipient:i,recipient_fullname:ve,sender:E,sender_fullname:V,status:0,metadata:o,text:t,timestamp:ye.Z.database.ServerValue.TIMESTAMP,type:n,attributes:se,channel_type:Q}),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e messages: ",this.messages),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e senderFullname: ",V),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e sender: ",E),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e SEND MESSAGE: ",t,Q),Me}dispose(){}added(t){const n=this.messageGenerate(t);We(U,n)||(this.addRepalceMessageInArray(t.key,n),this.messageAdded.next(n))}addedNew(t){const n=this.messageCommandGenerate(t);if(this.isValidMessage(n)){let o=We(U,n);if(o&&this.messageInfo.next(n),o&&Dn(n,this.showInfoMessage))return;if(o&&!Dn(n,this.showInfoMessage)&&!Mo(n,this.loggedUser))return;this.addRepalceMessageInArray(n.uid,n),this.messageAdded.next(n)}else this.logger.error("[FIREBASEConversationHandlerSERVICE] ADDED::message with uid: ",n.uid,"is not valid")}changed(t){const n=this.messageGenerate(t);if(this.isValidMessage(n)){if(We(U,n)||n.attributes&&n.attributes.commands)return;this.addRepalceMessageInArray(t.key,n),this.messageChanged.next(n)}else this.logger.error("[FIREBASEConversationHandlerSERVICE] CHANGED::message with uid: ",n.uid,"is not valid")}removed(t){const n=Le(this.messages,t.key);n>-1&&(this.messages.splice(n,1),this.messageRemoved.next(t.key))}messageGenerate(t){const n=t.val();return n.uid=t.key,n.text=n.text.trim(),(!n.sender_fullname||"undefined"===n.sender_fullname)&&(n.sender_fullname=n.sender),n.isSender=this.isSender(n.sender,this.loggedUser.uid),We(U,n)&&this.translateInfoSupportMessages(n),n}messageCommandGenerate(t){const n=t;return n.text&&(n.text=n.text.trim()),(!n.sender_fullname||"undefined"===n.sender_fullname)&&(n.sender_fullname=n.sender),n.isSender=this.isSender(n.sender,this.loggedUser.uid),We(U,n)&&this.translateInfoSupportMessages(n),n}addRepalceMessageInArray(t,n){const o=Le(this.messages,t);o>-1?this.messages.splice(o,1,n):this.messages.splice(0,0,n),this.messages.sort(ut("timestamp","asc")),this.setStatusMessage(n,this.conversationWith)}translateInfoSupportMessages(t){const n=this.translationMap.get("INFO_SUPPORT_USER_ADDED_SUBJECT"),o=this.translationMap.get("INFO_SUPPORT_USER_ADDED_YOU_VERB"),i=this.translationMap.get("INFO_SUPPORT_USER_ADDED_COMPLEMENT"),l=this.translationMap.get("INFO_SUPPORT_USER_ADDED_VERB"),E=this.translationMap.get("INFO_SUPPORT_CHAT_REOPENED"),V=this.translationMap.get("INFO_SUPPORT_CHAT_CLOSED"),Q=this.translationMap.get("INFO_SUPPORT_LEAD_UPDATED"),se=this.translationMap.get("INFO_SUPPORT_MEMBER_LEFT_GROUP"),ge=this.translationMap.get("INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU"),me=this.translationMap.get("INFO_SUPPORT_LIVE_PAGE");if(t.attributes.messagelabel&&t.attributes.messagelabel.parameters&&t.attributes.messagelabel.key===a){let ce,ve,we;t.attributes.messagelabel.parameters.member_id===this.loggedUser.uid?(ce=n,ve=o,we=i):t.attributes.messagelabel.parameters.fullname?(ce=t.attributes.messagelabel.parameters.fullname,ve=l,we=i):(ce=t.attributes.messagelabel.parameters.member_id,ve=l,we=i),t.text=ce+" "+ve+" "+we}else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===X)t.text=E;else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===s)t.text=V;else if(t.attributes&&t.attributes.messagelabel&&t.attributes.messagelabel.key===B&&"system"===t.sender){const ce=t.text.split(":")[1];void 0!==ce&&(t.text=ge+": "+ce)}else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===T)t.text=Q;else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===d){let ce="";ce=t.attributes.messagelabel.parameters.fullname?t.attributes.messagelabel.parameters.fullname:t.attributes.messagelabel.parameters.member_id,t.text=ce+" "+se}else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===H){let ce="";t.attributes&&t.attributes.sourcePage&&(ce=t.attributes.sourcePage),t.attributes&&t.attributes.sourceTitle&&(ce="["+t.attributes.sourceTitle+"]("+ce+")"),t.text=me+": "+ce}}setStatusMessage(t,n){if(this.logger.debug("[FIREBASEConversationHandlerSERVICE] update statusss",t),t.status<g){let o=t.uid;if(t.attributes.commands&&(o=t.attributes.parentUid),t.sender!==this.loggedUser.uid&&t.status<g){const i=this.urlNodeFirebase+"/"+o;this.logger.debug("[FIREBASEConversationHandlerSERVICE] update message status",i),ye.Z.database().ref(i).update({status:g})}}}isSender(t,n){return!!n&&t===n}unsubscribe(t){this.listSubsriptions.forEach(n=>{if(this.logger.debug("[FIREBASEConversationHandlerSERVICE] unsubscribe: ",n.uid,t),n.uid===t)return this.logger.debug("[FIREBASEConversationHandlerSERVICE] unsubscribe: ",n.uid,t),void n.unsubscribe(t,null)})}addCommandMessage(t){const n=this,o=t.attributes.commands;let i=0;!function l(E){if("message"===E.type){if(n.logger.debug('[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e type="message"',E,i),i>=2){if(o[i-1].time||(o[i-1].time=1e3),E.message.timestamp=o[i-2].message.timestamp+o[i-1].time,!Et(n.startTime.getTime(),t.timestamp)){let V=t.timestamp;o[i-2]&&(V=o[i-2].message.timestamp),E.message.timestamp=V+100,o[i+1]&&(o[i+1].time=0)}}else E.message.timestamp=t.timestamp,Et(n.startTime.getTime(),t.timestamp)||o[i+1]&&(o[i+1].time=0);n.generateMessageObject(t,E.message,function(){i+=1,i<o.length?l(o[i]):n.logger.debug("[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (wait), exit")})}else"wait"===E.type&&(n.logger.debug('[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e type="wait"',E,i,o.length),Et(n.startTime.getTime(),t.timestamp)&&n.messageWait.next({uid:n.conversationWith,uidUserTypingNow:t.sender,nameUserTypingNow:t.sender_fullname,waitTime:E.time,command:E}),setTimeout(function(){i+=1,i<o.length?l(o[i]):n.logger.debug("[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (send message), exit")},E.time))}(o[0])}generateMessageObject(t,n,o){let i=t.uid;n.uid=(0,Nn.Z)(),n.text&&(n.text=n.text.trim()),n.language=t.language,n.recipient=t.recipient,n.recipient_fullname=t.recipient_fullname,n.sender=t.sender,n.sender_fullname=t.sender_fullname,n.channel_type=t.channel_type,n.status=t.status,n.isSender=t.isSender,n.attributes?n.attributes.commands=!0:n.attributes={commands:!0},n.attributes.parentUid=i,this.addedNew(n),o()}isValidMessage(t){return!0}isValidField(t){return null!=t}}wt.\u0275fac=function(t){return new(t||wt)(e.LFG("skipMessage"))},wt.\u0275prov=e.Yz7({token:wt,factory:wt.\u0275fac});class Dt extends Qe{constructor(){super()}build(){return new wt(!1)}}Dt.\u0275fac=function(t){return new(t||Dt)},Dt.\u0275prov=e.Yz7({token:Dt,factory:Dt.\u0275fac});class cl{constructor(t,n,o,i){this.uid=t,this.timestamp=n,this.message=o,this.name=i}}class Ht extends je{constructor(){super(),this.BSIsTyping=new _e.X(null),this.BSSetTyping=new _e.X(null),this.logger=fe.getInstance()}initialize(t){this.tenant=t,this.logger.debug("[FIREBASETypingSERVICE] initialize - tenant ",this.tenant),this.urlNodeTypings="/apps/"+this.tenant+"/typings/"}isTyping(t,n,o){let l=this.urlNodeTypings+t;o&&(l=this.urlNodeTypings+n+"/"+t),this.logger.debug("[FIREBASETypingSERVICE] urlTyping: ",l),this.ref=ye.Z.database().ref(l),this.ref.on("child_changed",E=>{const V=E.val();this.logger.debug("[FIREBASETypingSERVICE] child_changed: ",V),this.BSIsTyping.next({uid:t,uidUserTypingNow:V.uid,nameUserTypingNow:V.name,waitTime:2e3})})}setTyping(t,n,o,i){clearTimeout(this.setTimeoutWritingMessages),this.setTimeoutWritingMessages=setTimeout(()=>{const E=this.urlNodeTypings+t+"/"+o;this.logger.debug("[FIREBASETypingSERVICE] setWritingMessages:",E,i);const Q=new cl(o,ye.Z.database.ServerValue.TIMESTAMP,n,i);ye.Z.database().ref(E).set(Q,se=>{se?this.logger.error("[FIREBASETypingSERVICE] setTyping error",se):this.BSSetTyping.next({uid:t,typing:Q})})},500)}}Ht.\u0275fac=function(t){return new(t||Ht)},Ht.\u0275prov=e.Yz7({token:Ht,factory:Ht.\u0275fac});class Zt extends tt{constructor(){super(),this.BSIsOnline=new _e.X(null),this.BSLastOnline=new _e.X(null),this.logger=fe.getInstance(),this.online_member=[]}initialize(t){this.tenant=t,this.logger.debug("[FIREBASEPresenceSERVICE] initialize this.tenant",this.tenant),this.urlNodePresence="/apps/"+this.tenant+"/presence/"}userIsOnline(t){const n=this;let o=new _e.X(null);const i=this.urlNodePresence+t+"/connections";this.logger.debug("[FIREBASEPresenceSERVICE] userIsOnline: ",i);const l=ye.Z.database().ref().child(i);return l.off(),l.on("value",E=>{n.logger.debug("[FIREBASEPresenceSERVICE] CONVERSATION-DETAIL group detail userIsOnline id user",t,"- child.val: ",E.val()),E.val()?(n.BSIsOnline.next({uid:t,isOnline:!0}),o.next({uid:t,isOnline:!0})):(n.BSIsOnline.next({uid:t,isOnline:!1}),o.next({uid:t,isOnline:!1}))}),o}lastOnlineForUser(t){this.logger.debug("[FIREBASEPresenceSERVICE] lastOnlineForUser",t),this.referenceLastOnlineForUser(t).on("value",i=>{i.val()?this.BSLastOnline.next({uid:t,lastOnline:i.val()}):this.BSLastOnline.next({uid:t,lastOnline:null})})}setPresence(t){this.onlineConnectionsRef=this.referenceOnlineForUser(t),this.lastOnlineConnectionsRef=this.referenceLastOnlineForUser(t),ye.Z.database().ref("/.info/connected").on("value",i=>{if(this.logger.debug("[FIREBASEPresenceSERVICE] self.deviceConnectionRef: ",i.val()),i.val())if(this.onlineConnectionsRef){this.keyConnectionRef=this.onlineConnectionsRef.push(!0),this.keyConnectionRef.onDisconnect().remove();const E=(new Date).valueOf();this.lastOnlineConnectionsRef.onDisconnect().set(E)}else this.logger.error("[FIREBASEPresenceSERVICE] setPresence --\x3e This is an error. self.deviceConnectionRef already set. Cannot be set again.")})}removePresence(){if(this.onlineConnectionsRef){const n=(new Date).valueOf();this.lastOnlineConnectionsRef.set(n),this.onlineConnectionsRef.off(),this.onlineConnectionsRef.remove(),this.logger.debug("[FIREBASEPresenceSERVICE] goOffline onlineConnectionsRef",this.onlineConnectionsRef)}}referenceLastOnlineForUser(t){const n=this.urlNodePresence+t+"/lastOnline";return ye.Z.database().ref().child(n)}referenceOnlineForUser(t){const n=this.urlNodePresence+t+"/connections";return ye.Z.database().ref().child(n)}}Zt.\u0275fac=function(t){return new(t||Zt)},Zt.\u0275prov=e.Yz7({token:Zt,factory:Zt.\u0275fac});class zt extends Ze{constructor(t){super(),this.http=t,this.urlStorageBucket=Ie.firebaseConfig.storageBucket+"/o/profiles%2F"}getImagePhotoUrl(t){this.baseImageURL=this.getImageBaseUrl();let n="";n=t&&t.includes("bot_")?t.slice(4):t;const i="/o/profiles%2F"+n+"%2Fthumb_photo.jpg?alt=media";return this.baseImageURL+ye.Z.storage().ref().bucket+i}checkImageExists(t,n){this.http.get(t,{responseType:"blob"}).subscribe(o=>{n(!0)},o=>{n(!1)})}}zt.\u0275fac=function(t){return new(t||zt)(e.LFG(Ee.eN))},zt.\u0275prov=e.Yz7({token:zt,factory:zt.\u0275fac});class jt extends Ve{constructor(){super(),this.BSStateUpload=new _e.X(null),this.logger=fe.getInstance()}initialize(){this.logger.debug("[FIREBASEUploadSERVICE] initialize")}upload(t,n){const o=this,l="/public/images/"+t+"/"+this.createGuid()+"/"+n.file.name;this.logger.debug("[FIREBASEUploadSERVICE] pushUpload ",l,n.file);const E=ye.Z.storage().ref();this.logger.debug("[FIREBASEUploadSERVICE] storageRef",E);const V=E.child(l);this.logger.debug("[FIREBASEUploadSERVICE] mountainsRef ",V);let se=V.put(n.file,{name:n.file.name,contentType:n.file.type,contentDisposition:"attachment; filename="+n.file.name});return new Promise((ge,me)=>{se.on("state_changed",function(ve){var we=ve.bytesTransferred/ve.totalBytes*100;switch(o.logger.debug("[FIREBASEUploadSERVICE] Upload is "+we+"% done"),o.BSStateUpload.next({upload:we,type:n.file.type}),ve.state){case ye.Z.storage.TaskState.PAUSED:o.logger.debug("[FIREBASEUploadSERVICE] Upload is paused");break;case ye.Z.storage.TaskState.RUNNING:o.logger.debug("[FIREBASEUploadSERVICE] Upload is running")}},function(ce){me(ce)},function(){o.logger.debug("[FIREBASEUploadSERVICE] Upload is complete",n),ge(se.snapshot.ref.getDownloadURL())})})}createGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=16*Math.random()|0;return("x"===t?n:3&n|8).toString(16)})}}jt.\u0275fac=function(t){return new(t||jt)},jt.\u0275prov=e.Yz7({token:jt,factory:jt.\u0275fac});let hl=be(7994);const ao="/clientadded",jn="/clientupdated",Zo="/clientdeleted",zo="onMessageUpdatedForConversation",jo="onMessageAddedForConversation";class nt{constructor(t){if(this.client=null,this.reconnections=0,this.client_id=this.uuidv4(),this.log=!!t.log,t&&t.MQTTendpoint)if(t.MQTTendpoint.startsWith("/")){var o;this.log&&console.log("MQTTendpoint relative url"),o="mqtt:",o+="//"+window.location.host,this.endpoint=o+=t.MQTTendpoint}else this.endpoint=t.MQTTendpoint;else this.endpoint="ws://34.253.207.0:15675/ws";this.APIendpoint=t.APIendpoint,this.appid=t.appId,this.log&&console.log("final endpoint:",this.endpoint),this.user_id=null,this.jwt=null,this.last_handler=0,this.onConversationAddedCallbacks=new Map,this.onConversationUpdatedCallbacks=new Map,this.onConversationDeletedCallbacks=new Map,this.onArchivedConversationAddedCallbacks=new Map,this.onArchivedConversationDeletedCallbacks=new Map,this.onMessageAddedCallbacks=new Map,this.onMessageUpdatedCallbacks=new Map,this.onGroupUpdatedCallbacks=new Map,this.callbackHandlers=new Map,this.on_message_handler=null,this.topic_inbox=null,this.connected=!1}subscribeToMyConversations(t){this.topic_inbox="apps/tilechat/users/"+this.user_id+"/#",this.log&&console.log("subscribing to:",this.user_id,"topic",this.topic_inbox),this.client.subscribe(this.topic_inbox,n=>{n&&console.error("An error occurred while subscribing user",this.user_id,"on topic:",this.topic_inbox,"Error:",n),this.log&&console.log("subscribed to:",this.topic_inbox," with err",n),t()})}sendMessage(t,n,o,i,l,E,V,Q,se){let ge=`apps/${this.appid}/outgoing/users/${this.user_id}/messages/${o}/outgoing`,me={text:t,type:n,recipient_fullname:i,sender_fullname:l,attributes:E,metadata:V,channel_type:Q};const ce=JSON.stringify(me);this.client.publish(ge,ce,null,ve=>{se(ve,me)})}basicMessageBuilder(t,n,o,i,l,E,V){return{text:t,type:n,recipient_fullname:o,sender_fullname:i,attributes:l,metadata:E,channel_type:V}}sendMessageRaw(t,n,o){let i=`apps/${this.appid}/outgoing/users/${this.user_id}/messages/${n}/outgoing`;this.log&&console.log("dest_topic:",i);const l=JSON.stringify(t);this.client.publish(i,l,null,E=>{o(E,t)})}updateMessageStatus(t,n,o,i){this.log&&console.log("updating recipient_id:",t,"on conversWith",n,"status",o);let l=`apps/${this.appid}/users/${this.user_id}/messages/${n}/${t}/update`;this.log&&console.log("update dest_topic:",l);let E={status:o};const V=JSON.stringify(E);this.log&&console.log("payload:",V),this.client.publish(l,V,null,Q=>{i&&i(Q,E)})}updateConversationIsNew(t,n,o){this.log&&console.log("updating conversation with:",t,"is_new",n);let i=`apps/${this.appid}/users/${this.user_id}/conversations/${t}/update`;this.log&&console.log("update dest_topic:",i);const E=JSON.stringify({is_new:n});this.log&&console.log("payload:",E),this.client.publish(i,E,null,V=>{o&&o(V)})}groupCreate(t,n,o,i){this.log&&console.log("creating group:",t,"id",n,"members",o);const l=`${this.APIendpoint}/${this.appid}/groups`;this.log&&console.log("creating group...",l),nt.myrequest({url:l,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:{group_name:t,group_id:n,group_members:o},method:"POST"},(V,Q,se)=>{V?i(V,null):se&&i&&i(null,se)},this.log)}groupData(t,n){nt.myrequest({url:`${this.APIendpoint}/${this.appid}/groups/${t}`,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},method:"GET"},(l,E,V)=>{l?n(l,null):V&&n&&n(null,V)},this.log)}groupLeave(t,n,o){this.log&&console.log("leaving group:",t);const i=`${this.APIendpoint}/${this.appid}/groups/${t}/members/${n}`;this.log&&console.log("leaving group:",i),nt.myrequest({url:i,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},method:"DELETE"},(E,V,Q)=>{E?o(E,null):o&&o(null,Q)},this.log)}groupJoin(t,n,o){this.log&&console.log("leaving group:",t);const i=`${this.APIendpoint}/${this.appid}/groups/${t}/members`;this.log&&console.log("joining group:",i),nt.myrequest({url:i,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:{member_id:n},method:"POST"},(E,V,Q)=>{E?o(E,null):o&&o(null,Q)},this.log)}groupSetMembers(t,n,o){this.log&&console.log("setting group members of",t,"members",n);const i=`${this.APIendpoint}/${this.appid}/groups/${t}/members`;this.log&&console.log("setting group members...",i),nt.myrequest({url:i,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:{members:n},method:"PUT"},(E,V,Q)=>{E?o(E,null):Q&&o&&o(null,Q)},this.log)}saveInstance(t,n,o){this.log&&console.log("saving instance_id:",t,"data",n);const i=`${this.APIendpoint}/${this.appid}/${this.user_id}/instances/${t}`;this.log&&console.log("saving instance..."),nt.myrequest({url:i,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:n,method:"POST"},(E,V,Q)=>{E?o(E,null):Q&&o&&o(null,Q)},this.log)}archiveConversation(t,n){this.log&&console.log("archiving conversation with:",t);let o="apps/tilechat/users/"+this.user_id+"/conversations/"+t+"/archive";this.log&&console.log("archive dest_topic:",o);const i=JSON.stringify({});this.client.publish(o,i,null,l=>{n&&n(l)})}onConversationAdded(t){return this.last_handler++,this.onConversationAddedCallbacks.set(this.last_handler,t),this.last_handler}onConversationUpdated(t){return this.last_handler++,this.onConversationUpdatedCallbacks.set(this.last_handler,t),this.last_handler}onConversationDeleted(t){return this.last_handler++,this.onConversationDeletedCallbacks.set(this.last_handler,t),this.last_handler}onArchivedConversationAdded(t){return this.last_handler++,this.onArchivedConversationAddedCallbacks.set(this.last_handler,t),this.last_handler}onArchivedConversationDeleted(t){return this.last_handler++,this.onArchivedConversationDeletedCallbacks.set(this.last_handler,t),this.last_handler}onMessageAdded(t){return this.last_handler++,this.onMessageAddedCallbacks.set(this.last_handler,t),this.last_handler}onMessageAddedInConversation(t,n){return this.last_handler++,this.callbackHandlers.set(this.last_handler,{type:jo,conversWith:t,callback:n}),this.last_handler}onMessageUpdatedInConversation(t,n){return this.last_handler++,this.callbackHandlers.set(this.last_handler,{type:zo,conversWith:t,callback:n}),this.last_handler}onMessageUpdated(t){return this.last_handler+=1,this.onMessageUpdatedCallbacks.set(this.last_handler,t),this.last_handler}onGroupUpdated(t){return this.last_handler+=1,this.onGroupUpdatedCallbacks.set(this.last_handler,t),this.last_handler}removeOnMessageAddedHandler(t){this.onMessageAddedCallbacks.delete(t)}removeOnGroupUpdatedHandler(t){this.onGroupUpdatedCallbacks.delete(t)}start(t){if(this.on_message_handler)return this.log&&console.log("this.on_message_handler already subscribed. Reconnected num",this.reconnections),void callbsubscribedCallbackack();this.subscribeToMyConversations(()=>{this.on_message_handler=this.client.on("message",(n,o)=>{this.log&&console.log("topic:"+n+"\nmessage payload:"+o);const i=this.parseTopic(n);if(!i)return void(this.log&&console.log("Invalid message topic:",n));const l=i.conversWith;try{const E=JSON.parse(o.toString());if(this.onConversationUpdatedCallbacks&&n.includes("/conversations/")&&n.endsWith(jn)&&(this.log&&console.log("conversation updated! /conversations/, topic:",n),this.onConversationUpdatedCallbacks.forEach((V,Q,se)=>{V(JSON.parse(o.toString()),i)})),this.onConversationDeletedCallbacks&&n.includes("/conversations/")&&n.endsWith(Zo)&&(this.log&&console.log("conversation deleted! /conversations/, topic:",n,o.toString()),this.onConversationDeletedCallbacks.forEach((V,Q,se)=>{V(JSON.parse(o.toString()),i)})),this.onArchivedConversationAddedCallbacks&&n.includes("/archived_conversations/")&&n.endsWith(ao)&&this.onArchivedConversationAddedCallbacks.forEach((V,Q,se)=>{V(JSON.parse(o.toString()),i)}),this.onArchivedConversationDeletedCallbacks&&n.includes("/archived_conversations/")&&n.endsWith(Zo)&&this.onArchivedConversationDeletedCallbacks.forEach((V,Q,se)=>{V(JSON.parse(o.toString()),i)}),n.includes("/messages/")&&n.endsWith(ao)){this.onMessageAddedCallbacks&&this.onMessageAddedCallbacks.forEach((Q,se,ge)=>{Q(JSON.parse(o.toString()),i)});let V=!0;E.attributes&&0==E.attributes.updateconversation&&(V=!1),V&&this.onConversationAddedCallbacks&&this.onConversationAddedCallbacks.forEach((Q,se,ge)=>{E.is_new=!0;const me=JSON.stringify(E);Q(JSON.parse(me),i)})}this.onMessageUpdatedCallbacks&&n.includes("/messages/")&&n.endsWith(jn)&&this.onMessageUpdatedCallbacks.forEach((V,Q,se)=>{V(JSON.parse(o.toString()),i)}),this.onGroupUpdatedCallbacks&&n.includes("/groups/")&&n.endsWith(jn)&&this.onGroupUpdatedCallbacks.forEach((V,Q,se)=>{V(JSON.parse(o.toString()),i)}),this.callbackHandlers.forEach((V,Q,se)=>{const ge=V,me=ge.type;n.includes("/messages/")&&n.endsWith(ao)&&(this.log&&console.log("/messages/_CLIENTADDED"),me===jo&&l===ge.conversWith&&(this.log&&console.log("/messages/_CLIENTADDED on: ",l),ge.callback(JSON.parse(o.toString()),i))),n.includes("/messages/")&&n.endsWith(jn)&&(this.log&&console.log("/messages/_CLIENTUPDATED"),me===zo&&l===ge.conversWith&&(this.log&&console.log("/messages/_CLIENTUPDATED on: ",l),ge.callback(JSON.parse(o.toString()),i)))})}catch(E){console.error("ERROR:",E)}}),t()})}parseTopic(t){var n=t.split("/");return n.length>=7?{conversWith:n[5]}:null}lastArchivedConversations(t){const n=`${this.APIendpoint}/${this.appid}/${this.user_id}/archived_conversations`;this.log&&console.log("getting last archived conversations...",n);var o=new XMLHttpRequest;o.open("GET",n,!0),o.setRequestHeader("authorization",this.jwt),o.onreadystatechange=function(){if(t&&4==o.readyState&&200==o.status&&o.responseText)try{const i=JSON.parse(o.responseText);t(null,i.result)}catch(i){console.error("parsing json ERROR",i),t(i,null)}},o.send(null)}lastConversations(t,n){const i=`${this.APIendpoint}/${this.appid}/${this.user_id}/conversations`+(t?"/archived":"");this.log&&console.log("getting last convs...",i);var l=new XMLHttpRequest;l.open("GET",i,!0),l.setRequestHeader("authorization",this.jwt),l.onreadystatechange=function(){if(n&&4==l.readyState&&200==l.status&&l.responseText)try{const E=JSON.parse(l.responseText);n(null,E.result)}catch(E){console.error("parsing json ERROR",E),n(E,null)}},l.send(null)}conversationDetail(t,n){this.log&&console.log("conversationDetail(). searching on user:",this.user_id," - conversWith:",t),this.crossConversationDetail(t,!1,n)}archivedConversationDetail(t,n){this.log&&console.log("archivedConversationDetail(). searching on user:",this.user_id," - conversWith:",t),this.crossConversationDetail(t,!0,n)}crossConversationDetail(t,n,o){this.log&&console.log("searching on user:",this.user_id," - conv of conversWith:",t," - archived:",n);let i="conversations";n&&(i="archived_conversations");const l=`${this.APIendpoint}/${this.appid}/${this.user_id}/${i}/${t}`;this.log&&(console.log("getting conversation detail:",l),console.log("conversWith:",t)),nt.myrequest({url:l,headers:{Authorization:this.jwt},method:"GET"},(V,Q,se)=>{this.log&&console.log("JSON...",se),se&&se.result&&Array.isArray(se.result)&&1==se.result.length?o(null,se.result[0]):o(null,null)},this.log)}lastMessages(t,n){const o=this.APIendpoint+"/"+this.appid+"/"+this.user_id+"/conversations/"+t+"/messages";var i=new XMLHttpRequest;i.open("GET",o,!0),i.setRequestHeader("authorization",this.jwt),i.onreadystatechange=function(){if(n&&4==i.readyState&&200==i.status&&i.responseText)try{const l=JSON.parse(i.responseText);n(null,l.result)}catch(l){console.error("parsing json messages ERROR",l),n(l,null)}},i.send(null)}static myrequest(t,n,o){o&&console.log("HTTP Request:",t);{let i=new XMLHttpRequest;i.open(t.method,t.url,!0),Object.keys(t.headers).forEach(l=>{i.setRequestHeader(l,t.headers[l])}),i.onreadystatechange=function(){if(n&&4==i.readyState&&200==i.status&&i.responseText)try{const l=JSON.parse(i.responseText);n(null,null,l)}catch(l){console.error("parsing json ERROR",l),n(l,null)}},i.send("POST"===t.method?JSON.stringify(t.data):null)}}connect(t,n,o){this.user_id=t,this.jwt=n,this.log&&(console.log("connecting user_id:",t),console.log("using jwt token:",n)),this.client&&this.client.end();const i="apps/tilechat/users/"+this.user_id+"/presence/"+this.client_id;let l={keepalive:10,reconnectPeriod:1e3,will:{topic:i,payload:'{"disconnected":true}',qos:1,retain:!0},clientId:this.client_id,username:"JWT",password:n,rejectUnauthorized:!1};this.log&&console.log("starting mqtt connection with LWT on:",i,this.endpoint),this.client=hl.connect(this.endpoint,l),this.client.on("connect",()=>{this.log&&console.log("Chat client connected. User:"+t),this.connected||(this.log&&console.log("Chat client first connection for:"+t),this.connected=!0,this.start(()=>{o()}))}),this.client.on("reconnect",()=>{this.log&&console.log("Chat client reconnect event")}),this.client.on("close",()=>{this.log&&console.log("Chat client close event")}),this.client.on("offline",()=>{this.log&&console.log("Chat client offline event")}),this.client.on("error",E=>{console.error("Chat client error event",E)})}close(t){this.topic_inbox&&this.client.unsubscribe(this.topic_inbox,n=>{this.log&&console.log("unsubscribed from",this.topic_inbox),this.client.end(()=>{this.connected=!1,this.onConversationAddedCallbacks=new Map,this.onConversationUpdatedCallbacks=new Map,this.onConversationDeletedCallbacks=new Map,this.onArchivedConversationAddedCallbacks=new Map,this.onArchivedConversationDeletedCallbacks=new Map,this.onMessageAddedCallbacks=new Map,this.onMessageUpdatedCallbacks=new Map,this.onGroupUpdatedCallbacks=new Map,this.callbackHandlers=new Map,this.on_message_handler=null,this.topic_inbox=null,t&&t()})})}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0;return("x"==t?n:3&n|8).toString(16)})}}class Fe{constructor(){}set config(t){this._config=t}get config(){return this._config}initChat(){if(!this._config||"CHANGEIT"===this._config.appId)throw new Error("chat21Config is not defined. Please setup your environment");this.chatClient?console.log("Did you try again to create a Chat21Client istance?"):this.chatClient=new nt(this._config)}}Fe.\u0275fac=function(t){return new(t||Fe)},Fe.\u0275prov=e.Yz7({token:Fe,factory:Fe.\u0275fac});class Vt extends et{constructor(t,n,o){super(),this.http=t,this.chat21Service=n,this.appStorage=o,this.BSAuthStateChanged=new _e.X(null),this.BSSignOut=new _e.X(null),this.logger=fe.getInstance()}initialize(){this.SERVER_BASE_URL=this.getBaseUrl(),this.URL_TILEDESK_CREATE_CUSTOM_TOKEN=this.SERVER_BASE_URL+"chat21/native/auth/createCustomToken",this.logger.log("[MQTTAuthService] initialize "),this.onAuthStateChanged()}logout(){return this.logger.log("[MQTTAuthService] logout: closing mqtt connection..."),new Promise((t,n)=>{this.chat21Service.chatClient.close(()=>{this.currentUser=null,this.logger.debug("[MQTTAuthService] logout: mqtt connection closed. user removed. OK"),this.BSSignOut.next(!0),this.BSAuthStateChanged.next("offline"),t(!0)})})}getUser(){return this.currentUser}getToken(){return this.logger.debug("[MQTTAuthService]::getToken"),this.token}onAuthStateChanged(){this.logger.debug("UserService::onAuthStateChanged"),this.BSAuthStateChanged.next("offline"),this.logger.debug("STORAGE CHANGED: added listner")}createCustomToken(t){this.connectWithCustomToken(t)}connectWithCustomToken(t){const n=new Ee.WM({"Content-type":"application/json",Authorization:t});this.http.post(this.URL_TILEDESK_CREATE_CUSTOM_TOKEN,{},{headers:n,responseType:"text"}).subscribe(l=>{this.logger.debug("[MQTTAuthService] connectWithCustomToken: **** data",l);const E=JSON.parse(l);this.connectMQTT(E)},l=>{this.logger.error(l)})}connectMQTT(t){this.logger.debug("[MQTTAuthService] connectMQTT: **** credentials:",t),this.chat21Service.chatClient.connect(t.userid,t.token,()=>{this.logger.debug("[MQTTAuthService] connectMQTT: Chat connected."),this.BSAuthStateChanged.next("online")})}}Vt.\u0275fac=function(t){return new(t||Vt)(e.LFG(Ee.eN),e.LFG(Fe),e.LFG(Re))},Vt.\u0275prov=e.Yz7({token:Vt,factory:Vt.\u0275fac});class Gt extends Ye{constructor(t){super(),this.chat21Service=t,this.BSConversationDetail=new _e.X(null),this.conversationAdded=new _e.X(null),this.conversationChanged=new _e.X(null),this.conversationChangedDetailed=new _e.X(null),this.conversationRemoved=new _e.X(null),this.conversations=[],this.logger=fe.getInstance()}initialize(t,n,o){this.logger.debug("[MQTTConversationsHandler] initialize"),this.tenant=t,this.loggedUserId=n,this.translationMap=o,this.conversations=[],this.isConversationClosingMap=new Map}getConversationDetail(t,n){const o=this.conversations.find(i=>i.conversation_with===t);this.logger.log("[MQTTConversationsHandler] getConversationDetail found locally? *****: ",o),o?n(o):(this.logger.log("[MQTTConversationsHandler] getConversationDetail Not found locally, remote.getConversationDetail *****: ",o),this.chat21Service.chatClient.conversationDetail(t,(i,l)=>{this.logger.log("[MQTTConversationsHandler] getConversationDetail --REMOTE CONV IS OBJ:",l),l?n&&n(this.completeConversation(l)):n&&n(null)}))}setConversationRead(t){this.logger.debug("[MQTTConversationsHandler] setConversationRead..."),this.chat21Service.chatClient.updateConversationIsNew(t,!1,n=>{n?this.logger.error("[MQTTConversationsHandler]setConversationRead: false. An error occurred",n):this.logger.debug("[MQTTConversationsHandler]setConversationRead: false. Ok")})}subscribeToConversations(t){this.logger.debug("[MQTTConversationsHandler] connecting MQTT conversations handler"),this.chat21Service.chatClient.onConversationAdded(n=>{let o=this.completeConversation(n);this.logger.log("onConversationAdded completed:",o),this.searchIndexInArrayForConversationWith(this.conversations,o.conversation_with)>-1?(this.logger.log("[MQTTConversationsHandler] Added conv -> Changed!"),this.changed(o)):(this.logger.log("[MQTTConversationsHandler] Added conv -> Added!"),this.added(o))}),this.chat21Service.chatClient.onConversationUpdated((n,o)=>{this.logger.debug("[MQTTConversationsHandler] conversation updated:",JSON.stringify(n)),this.changed(n)}),this.chat21Service.chatClient.onConversationDeleted((n,o)=>{this.logger.debug("[MQTTConversationsHandler] conversation deleted:",n,o),this.removed({uid:o.conversWith})}),this.chat21Service.chatClient.lastConversations(!1,(n,o)=>{this.logger.debug("[MQTTConversationsHandler] Last conversations",o,"err",n),n||(o.forEach(i=>{this.added(i)}),t())})}getLastConversation(t){this.chat21Service.chatClient.lastConversations(!1,(n,o)=>{if(this.logger.debug("[MQTTConversationsHandler] getLastConversation ",o,"err",n),n)t(null,n);else if(o&&o.length>0){let i=this.completeConversation(o[0]);t(i,null)}else t(null,null)})}added(t){this.logger.debug("[MQTTConversationsHandler] NEW CONV childSnapshot",t);let n=this.completeConversation(t);if(this.isValidConversation(n)){this.setClosingConversation(n.conversation_with,!1),this.logger.debug("[MQTTConversationsHandler] conversations:",n.uid,this.conversations);const o=this.searchIndexInArrayForConversationWith(this.conversations,n.conversation_with);o>-1?(this.logger.debug("[MQTTConversationsHandler] TROVATO"),this.conversations.splice(o,1,n)):(this.logger.debug("[MQTTConversationsHandler] NON TROVATO"),this.conversations.splice(0,0,n)),this.logger.debug("[MQTTConversationsHandler] NUOVA CONVER;.uid3"+n.uid),this.conversations.sort(ut("timestamp","desc")),this.logger.debug("[MQTTConversationsHandler] TUTTE:",this.conversations),this.conversationAdded.next(n)}else this.logger.error("[MQTTConversationsHandler] ChatConversationsHandler::added::conversations with conversationId: ",n.conversation_with,"is not valid")}searchIndexInArrayForConversationWith(t,n){return t.findIndex(o=>o.conversation_with===n)}changed(t){this.logger.debug("[MQTTConversationsHandler] Conversation changed:",t),t.conversation_with||(t.conversation_with=t.conversWith);const n=Le(this.conversations,t.conversation_with),o=this.conversations[n];n>-1&&(this.updateConversationWithSnapshot(this.conversations[n],t),this.logger.debug("[MQTTConversationsHandler] conversationchanged.isnew",JSON.stringify(t)),this.conversationChanged.next(this.conversations[n]),this.conversationChangedDetailed.next({value:this.conversations[n],previousValue:o}),this.conversations.splice(n,1,this.conversations[n]),this.conversations.sort(ut("timestamp","desc")))}updateConversationWithSnapshot(t,n){this.logger.debug("[MQTTConversationsHandler] updating conv",t,"with snap",n),Object.keys(n).forEach(o=>{"is_new"===o&&(t.is_new=n[o]),"text"===o&&(t.last_message_text=n[o],t.text=n[o]),"recipient"===o&&(t.recipient=n[o]),"recipient_fullname"===o&&(t.recipient_fullname=n[o]),"sender"===o&&(t.sender=n[o]),"sender_fullname"===o&&(t.sender_fullname=n[o]),"attributes"===o&&(t.attributes=n[o]),"timestamp"===o&&(t.timestamp=n[o]),"status"===o&&(t.status=this.setStatusConversation(t.sender,t.uid)),"type"===o&&(t.type=n[o])})}removed(t){const n=Le(this.conversations,t.uid);if(n>-1){const o=this.conversations[n];this.conversations.splice(n,1),this.logger.debug("[MQTTConversationsHandler] conversationRemoved::",o),this.conversationRemoved.next(o)}this.deleteClosingConversation(t.uid)}dispose(){this.conversations.length=0,this.conversations=[],this.uidConvSelected=""}getClosingConversation(t){return this.isConversationClosingMap[t]}setClosingConversation(t,n){this.isConversationClosingMap[t]=n}deleteClosingConversation(t){this.isConversationClosingMap.delete(t)}archiveConversation(t){this.chat21Service.chatClient.archiveConversation(t)}completeConversation(t){(!t.sender_fullname||"undefined"===t.sender_fullname||""===t.sender_fullname.trim())&&(t.sender_fullname=t.sender),(!t.recipient_fullname||"undefined"===t.recipient_fullname||""===t.recipient_fullname.trim())&&(t.recipient_fullname=t.recipient);let n=t.sender_fullname,o=t.sender;return(t.sender===this.loggedUserId||this.isGroup(t))&&(o=t.recipient,n=t.recipient_fullname,t.last_message_text=t.last_message_text),t.conversation_with_fullname=n,t.conversation_with=o,t.status=this.setStatusConversation(t.sender,t.uid),t.avatar=tn(n),t.color=en(n),t.last_message_text||(t.last_message_text=t.text),t.uid=t.conversation_with,t.uid===this.uidConvSelected&&(t.is_new=!1),t.sender===this.loggedUserId&&(t.is_new=!1),t}isGroup(t){return!(!t.recipient||!t.recipient.startsWith("group-")&&!t.recipient.startsWith("support-group"))}setStatusConversation(t,n){let o="0";return o=t===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(t){return Xt(parseInt(t)/1e3)}countIsNew(){let t=0;return this.conversations.forEach(n=>{!0===n.is_new&&t++}),t}isValidConversation(t){return this.logger.debug("[MQTTConversationsHandler] checking uid of",t),this.logger.debug("[MQTTConversationsHandler] conversation.uid",t.uid),this.logger.debug("[MQTTConversationsHandler] channel_type is:",t.channel_type),this.isValidField(t.uid)?this.isValidField(t.last_message_text)?this.isValidField(t.recipient)?this.isValidField(t.recipient_fullname)?this.isValidField(t.sender)?this.isValidField(t.sender_fullname)?this.isValidField(t.status)?this.isValidField(t.timestamp)?!!this.isValidField(t.channel_type)||(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "channel_type is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "timestamp is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "status is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender_fullname is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient_fullname is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "last_message_text is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "uid is not valid" '),!1)}isValidField(t){return null!=t}}Gt.\u0275fac=function(t){return new(t||Gt)(e.LFG(Fe))},Gt.\u0275prov=e.Yz7({token:Gt,factory:Gt.\u0275fac});class qt extends Je{constructor(t){super(),this.chat21Service=t,this.BSConversationDetail=new _e.X(null),this.archivedConversationAdded=new _e.X(null),this.archivedConversationChanged=new _e.X(null),this.archivedConversationRemoved=new _e.X(null),this.archivedConversations=[],this.logger=fe.getInstance()}initialize(t,n,o){this.logger.debug("[MQTTArchivedConversationsHandler] initialize"),this.tenant=t,this.loggedUserId=n,this.translationMap=o,this.archivedConversations=[],this.isConversationClosingMap=new Map}getConversationDetail(t,n){const o=this.archivedConversations.find(i=>i.conversation_with===t);this.logger.log("[MQTTArchivedConversationsHandler] getConversationDetail found locally? *****: ",o),o?n(o):(this.logger.log("[MQTTArchivedConversationsHandler] getConversationDetail Not found locally, remote.getConversationDetail *****: ",o),this.chat21Service.chatClient.archivedConversationDetail(t,(i,l)=>{this.logger.log("[MQTTArchivedConversationsHandler] getConversationDetail --REMOTE CONV IS OBJ:",l),l?n&&n(this.completeConversation(l)):n&&n(null)}))}setConversationRead(t){}subscribeToConversations(t){this.logger.debug("[MQTTArchivedConversationsHandler] connecting MQTT conversations handler"),this.chat21Service.chatClient.onArchivedConversationAdded(n=>{this.logger.log("[MQTTArchivedConversationsHandler] Added conv ->",n.text),this.added(n)}),this.chat21Service.chatClient.onArchivedConversationDeleted(n=>{this.logger.debug("[MQTTArchivedConversationsHandler] conversation deleted:",n),this.removed(n)}),this.chat21Service.chatClient.lastConversations(!0,(n,o)=>{this.logger.debug("[MQTTArchivedConversationsHandler] Last conversations",o,"err",n),n||(o.forEach(i=>{this.added(i)}),t())})}added(t){this.logger.debug("[MQTTArchivedConversationsHandler] NEW CONV childSnapshot",t);let n=this.completeConversation(t);if(n.uid=n.conversation_with,this.isValidConversation(n)){this.setClosingConversation(n.conversation_with,!1),this.logger.debug("[MQTTArchivedConversationsHandler] conversations:",n.uid,this.archivedConversations);const o=this.searchIndexInArrayForConversationWith(this.archivedConversations,n.conversation_with);o>-1?(this.logger.debug("[MQTTArchivedConversationsHandler] TROVATO"),this.archivedConversations.splice(o,1,n)):(this.logger.debug("[MQTTArchivedConversationsHandler] NON TROVATO"),this.archivedConversations.splice(0,0,n)),this.logger.debug("[MQTTArchivedConversationsHandler] NUOVA CONVER;.uid3"+n.uid),this.archivedConversations.sort(ut("timestamp","desc")),this.logger.debug("[MQTTArchivedConversationsHandler] TUTTE:",this.archivedConversations),this.archivedConversationChanged.next(n),this.archivedConversationAdded.next(n)}else this.logger.error("[MQTTArchivedConversationsHandler] ChatConversationsHandler::added::conversations with conversationId: ",n.conversation_with,"is not valid")}searchIndexInArrayForConversationWith(t,n){return t.findIndex(o=>o.conversation_with===n)}removed(t){const n=Le(this.archivedConversations,t.key);if(n>-1){const o=this.archivedConversations[n];this.archivedConversations.splice(n,1),this.archivedConversationRemoved.next(o)}this.deleteClosingConversation(t.key)}dispose(){this.archivedConversations=[],this.archivedConversations.length=0,this.uidConvSelected=""}getClosingConversation(t){return this.isConversationClosingMap[t]}setClosingConversation(t,n){this.isConversationClosingMap[t]=n}deleteClosingConversation(t){this.isConversationClosingMap.delete(t)}archiveConversation(t){}completeConversation(t){(!t.sender_fullname||"undefined"===t.sender_fullname||""===t.sender_fullname.trim())&&(t.sender_fullname=t.sender),(!t.recipient_fullname||"undefined"===t.recipient_fullname||""===t.recipient_fullname.trim())&&(t.recipient_fullname=t.recipient);let n=t.sender_fullname,o=t.sender;return(t.sender===this.loggedUserId||"group"===t.channel_type)&&(o=t.recipient,n=t.recipient_fullname,t.last_message_text=t.last_message_text),t.conversation_with_fullname=n,t.conversation_with=o,t.status=this.setStatusConversation(t.sender,t.uid),t.avatar=tn(n),t.color=en(n),t.last_message_text||(t.last_message_text=t.text),t}setStatusConversation(t,n){let o="0";return o=t===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(t){return Xt(parseInt(t)/1e3)}countIsNew(){let t=0;return this.archivedConversations.forEach(n=>{!0===n.is_new&&t++}),t}isValidConversation(t){return this.logger.debug("[MQTTArchivedConversationsHandler] checking uid of",t),this.logger.debug("[MQTTArchivedConversationsHandler] conversation.uid",t.uid),this.logger.debug("[MQTTArchivedConversationsHandler] channel_type is:",t.channel_type),this.isValidField(t.uid)?this.isValidField(t.last_message_text)?this.isValidField(t.recipient)?this.isValidField(t.recipient_fullname)?this.isValidField(t.sender)?this.isValidField(t.sender_fullname)?this.isValidField(t.status)?this.isValidField(t.timestamp)?!!this.isValidField(t.channel_type)||(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "channel_type is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "timestamp is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "status is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender_fullname is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient_fullname is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "last_message_text is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "uid is not valid" '),!1)}isValidField(t){return null!=t}}qt.\u0275fac=function(t){return new(t||qt)(e.LFG(Fe))},qt.\u0275prov=e.Yz7({token:qt,factory:qt.\u0275fac});class yt extends ct{constructor(t,n){super(),this.chat21Service=t,this.skipInfoMessage=n,this.messageAdded=new _e.X(null),this.messageChanged=new _e.X(null),this.messageRemoved=new _e.X(null),this.messageWait=new _e.X(null),this.messageInfo=new _e.X(null),this.startTime=new Date,this.logger=fe.getInstance()}initialize(t,n,o,i,l,E){this.logger.log("[MQTTConversationHandlerSERVICE] initWithRecipient:",i),this.recipientId=t,this.recipientFullname=n,this.loggedUser=o,o&&(this.senderId=o.uid),this.tenant=i,this.translationMap=l,this.listSubsriptions=[],this.CLIENT_BROWSER=navigator.userAgent,this.conversationWith=t,this.messages=[],this.showInfoMessage=E}connect(){this.logger.log("[MQTTConversationHandlerSERVICE] connecting conversation handler..."),null!=this.conversationWith?(this.chat21Service.chatClient.lastMessages(this.conversationWith,(o,i)=>{o||(this.logger.log("[MQTTConversationHandlerSERVICE] message lastMessages:",i),i.forEach(l=>{const E=l;E.uid=l.message_id,!(this.messages.filter(V=>V.attributes.parentUid===E.uid).length>0)&&(E.attributes&&E.attributes.commands?(this.logger.debug("[MQTTConversationHandlerSERVICE] splitted message::::",this.messages),this.addCommandMessage(E)):this.addedMessage(E))}))}),this.chat21Service.chatClient.onMessageAddedInConversation(this.conversationWith,(o,i)=>{this.logger.log("[MQTTConversationHandlerSERVICE] message added:",o,"on topic:",i,this.messages);const l=o;l.uid=o.message_id,!(this.messages.filter(E=>E.attributes.parentUid===l.uid).length>0)&&(l.attributes&&l.attributes.commands?(this.logger.debug("[MQTTConversationHandlerSERVICE] splitted message::::",l),this.addCommandMessage(l)):(this.logger.debug("[MQTTConversationHandlerSERVICE] NOT splitted message::::",l),this.addedMessage(l)))}),this.chat21Service.chatClient.onMessageUpdatedInConversation(this.conversationWith,(o,i)=>{this.logger.log("[MQTTConversationHandlerSERVICE] message updated:",o,"on topic:",i),this.changed(o)})):this.logger.error("[MQTTConversationHandlerSERVICE] cant connect invalid this.conversationWith",this.conversationWith)}sendMessage(t,n,o,i,l,E,V,Q,se){(!Q||"undefined"===Q)&&(Q=ee),this.logger.log("[MQTTConversationHandlerSERVICE] Senderfullname",V);const me=document.documentElement.lang,ce=l,ve=i;return se.lang=me,this.chat21Service.chatClient.sendMessage(t,n,ve,ce,V,se,o,Q,(we,Me)=>{we?(Me.status="-100",this.logger.log("[MQTTConversationHandlerSERVICE] ERROR",we)):Me.status="150"}),new Ho("",me,i,ce,E,V,0,o,t,Date.now(),n,this.attributes,Q,!1)}dispose(){}addedMessage(t){const n=this.messageGenerate(t);let o=We(U,n);o&&this.messageInfo.next(n),(!o||!Dn(n,this.showInfoMessage))&&(o&&!Dn(n,this.showInfoMessage)&&!Mo(n,this.loggedUser)||(this.logger.log("[MQTTConversationHandlerSERVICE] adding message:"+JSON.stringify(n)),this.addReplaceMessageInArray(n.uid,n),this.updateMessageStatusReceived(n),this.messageAdded.next(n)))}changed(t){if(We(U,t))return;this.logger.log("[MQTTConversationHandlerSERVICE] updating message with patch",t);const n=Le(this.messages,t.message_id);if(n>-1){const o=this.messages[n];o&&(o.status=t.status,this.logger.log("[MQTTConversationHandlerSERVICE] message found and patched (replacing)",o),this.addReplaceMessageInArray(o.uid,o),this.messageChanged.next(o))}}removed(t){const n=Le(this.messages,t.key);n>-1&&(this.messages.splice(n,1),this.messageRemoved.next(t.key))}messageGenerate(t){this.logger.log("[MQTTConversationHandlerSERVICE] childSnapshot >"+JSON.stringify(t));const n=t;return n.text=n.text.trim(),(!n.sender_fullname||"undefined"===n.sender_fullname)&&(n.sender_fullname=n.sender),this.logger.log("[MQTTConversationHandlerSERVICE] ****>msg.sender:"+n.sender),n.isSender=this.isSender(n.sender,this.loggedUser.uid),We(U,n)&&this.translateInfoSupportMessages(n),n}addReplaceMessageInArray(t,n){const o=Le(this.messages,t);o>-1?this.messages.splice(o,1,n):this.messages.splice(0,0,n),this.messages.sort(ut("timestamp","asc"))}translateInfoSupportMessages(t){const n=this.translationMap.get("INFO_SUPPORT_USER_ADDED_SUBJECT"),o=this.translationMap.get("INFO_SUPPORT_USER_ADDED_YOU_VERB"),i=this.translationMap.get("INFO_SUPPORT_USER_ADDED_COMPLEMENT"),l=this.translationMap.get("INFO_SUPPORT_USER_ADDED_VERB"),E=this.translationMap.get("INFO_SUPPORT_CHAT_REOPENED"),V=this.translationMap.get("INFO_SUPPORT_CHAT_CLOSED"),Q=this.translationMap.get("INFO_SUPPORT_LEAD_UPDATED"),se=this.translationMap.get("INFO_SUPPORT_MEMBER_LEFT_GROUP"),ge=this.translationMap.get("INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU"),me=this.translationMap.get("INFO_SUPPORT_LIVE_PAGE");if(t.attributes.messagelabel&&t.attributes.messagelabel.parameters&&t.attributes.messagelabel.key===a){let ce,ve,we;t.attributes.messagelabel.parameters.member_id===this.loggedUser.uid?(ce=n,ve=o,we=i):t.attributes.messagelabel.parameters.fullname?(ce=t.attributes.messagelabel.parameters.fullname,ve=l,we=i):(ce=t.attributes.messagelabel.parameters.member_id,ve=l,we=i),t.text=ce+" "+ve+" "+we}else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===X)t.text=E;else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===s)t.text=V;else if(t.attributes&&t.attributes.messagelabel&&t.attributes.messagelabel.key===B&&"system"===t.sender){const ce=t.text.split(":")[1];void 0!==ce&&(t.text=ge+": "+ce)}else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===T)t.text=Q;else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===d){let ce;ce=t.attributes.messagelabel.parameters.fullname?t.attributes.messagelabel.parameters.fullname:t.attributes.messagelabel.parameters.member_id,t.text=ce+" "+se}else if(t.attributes.messagelabel&&t.attributes.messagelabel.key===H){let ce="";t.attributes&&t.attributes.sourcePage&&(ce=t.attributes.sourcePage),t.attributes&&t.attributes.sourceTitle&&(ce="["+t.attributes.sourceTitle+"]("+ce+")"),t.text=me+": "+ce}}updateMessageStatusReceived(t){if(this.logger.log("[MQTTConversationHandlerSERVICE] updateMessageStatusReceived",t),t.status<g){this.logger.log("[MQTTConversationHandlerSERVICE] status ",t.status," < (RECEIVED:200)",g);let n=t.uid;t.attributes.commands&&(n=t.attributes.parentUid),t.sender!==this.loggedUser.uid&&t.status<g&&(this.logger.log("[MQTTConversationHandlerSERVICE] updating message with status received"),this.chat21Service.chatClient.updateMessageStatus(n,this.conversationWith,g,null))}}isSender(t,n){return!!n&&t===n}unsubscribe(t){this.logger.log("[MQTTConversationHandlerSERVICE] unsubscribe: ",t),this.listSubsriptions.forEach(n=>{this.logger.log("[MQTTConversationHandlerSERVICE] unsubscribe: ",n.uid,t),n.uid!==t||n.unsubscribe(t,null)})}addCommandMessage(t){const n=this,o=t.attributes.commands;let i=0;!function l(E){if("message"===E.type){if(n.logger.debug('[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e type="message"',E,i),i>=2){if(o[i-1].time||(o[i-1].time=1e3),E.message.timestamp=o[i-2].message.timestamp+o[i-1].time,!Et(n.startTime.getTime(),t.timestamp)){let V=t.timestamp;o[i-2]&&(V=o[i-2].message.timestamp),E.message.timestamp=V+100,o[i+1]&&(o[i+1].time=0)}}else E.message.timestamp=t.timestamp,Et(n.startTime.getTime(),t.timestamp)||o[i+1]&&(o[i+1].time=0);n.generateMessageObject(t,E.message,function(){i+=1,i<o.length?l(o[i]):n.logger.debug("[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (wait), exit")})}else"wait"===E.type&&(n.logger.debug('[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e type="wait"',E,i,o.length),Et(n.startTime.getTime(),t.timestamp)&&n.messageWait.next({uid:n.conversationWith,uidUserTypingNow:t.sender,nameUserTypingNow:t.sender_fullname,waitTime:E.time,command:E}),setTimeout(function(){i+=1,i<o.length?l(o[i]):n.logger.debug("[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (send message), exit")},E.time))}(o[0])}generateMessageObject(t,n,o){let i=t.uid;n.uid=(0,Nn.Z)(),n.text&&(n.text=n.text.trim()),n.language=t.language,n.recipient=t.recipient,n.recipient_fullname=t.recipient_fullname,n.sender=t.sender,n.sender_fullname=t.sender_fullname,n.channel_type=t.channel_type,n.status=t.status,n.isSender=t.isSender,n.attributes?n.attributes.commands=!0:n.attributes={commands:!0},n.attributes.parentUid=i,this.addedMessage(n),o()}}yt.\u0275fac=function(t){return new(t||yt)(e.LFG(Fe),e.LFG("skipMessage"))},yt.\u0275prov=e.Yz7({token:yt,factory:yt.\u0275fac});class Wt extends Qe{constructor(t){super(),this.chat21Service=t}build(){return new yt(this.chat21Service,!0)}}Wt.\u0275fac=function(t){return new(t||Wt)(e.LFG(Fe))},Wt.\u0275prov=e.Yz7({token:Wt,factory:Wt.\u0275fac});class Yt extends je{constructor(){super(),this.BSIsTyping=new _e.X(null),this.BSSetTyping=new _e.X(null),this.logger=fe.getInstance()}initialize(t){this.tenant=t,this.logger.debug("[MQTT-TYPING] initialize this.tenant",this.tenant),this.urlNodeTypings="/apps/"+this.tenant+"/typings/"}isTyping(t,n){}setTyping(t,n,o,i){}}Yt.\u0275fac=function(t){return new(t||Yt)},Yt.\u0275prov=e.Yz7({token:Yt,factory:Yt.\u0275fac});class Jt extends tt{constructor(){super(),this.BSIsOnline=new _e.X(null),this.BSLastOnline=new _e.X(null),this.logger=fe.getInstance()}initialize(t){this.tenant=t,this.logger.debug("[MQTT-PRESENCE] initialize this.tenant",this.tenant),this.urlNodePresence="/apps/"+this.tenant+"/presence/"}userIsOnline(t){return this.BSIsOnline}lastOnlineForUser(t){}setPresence(t){}removePresence(){}}Jt.\u0275fac=function(t){return new(t||Jt)},Jt.\u0275prov=e.Yz7({token:Jt,factory:Jt.\u0275fac});class Qt extends Ze{constructor(t){super(),this.http=t}getImagePhotoUrl(t){this.baseImageURL=this.getImageBaseUrl()+"images";let n="";return n=t.includes("bot_")?t.slice(4):t,this.baseImageURL+"?path=uploads/users/"+n+"/images/photo.jpg"}checkImageExists(t,n){this.http.get(t).subscribe(o=>{n(!0)},o=>{console.log("errorrrrrr",t,o),n(!1)})}}Qt.\u0275fac=function(t){return new(t||Qt)(e.LFG(Ee.eN))},Qt.\u0275prov=e.Yz7({token:Qt,factory:Qt.\u0275fac});class Kt extends Ve{constructor(t,n){super(),this.http=t,this.appStorage=n,this.BSStateUpload=new _e.X(null),this.logger=fe.getInstance()}initialize(){this.logger.debug("[NATIVE UPLOAD] initialize"),this.URL_TILEDESK_FILE=this.getBaseUrl()+"files",this.URL_TILEDESK_IMAGES=this.getBaseUrl()+"images",this.tiledeskToken=this.appStorage.getItem("tiledeskToken")}upload(t,n){this.logger.debug("[NATIVE UPLOAD] - upload new image/file ... upload",n);const i={headers:new Ee.WM({Authorization:this.tiledeskToken})},l=new FormData;l.append("file",n.file);const E=this;if(n.file.type.startsWith("image")&&!n.file.type.includes("svg")){this.logger.debug("[NATIVE UPLOAD] - upload new image");const V=this.URL_TILEDESK_IMAGES+"/users";return new Promise((Q,se)=>{E.http.post(V,l,i).subscribe(ge=>{Q(this.URL_TILEDESK_IMAGES+"?path="+ge.filename)},ge=>{se(ge)})})}{this.logger.debug("[NATIVE UPLOAD] - upload new file");const V=this.URL_TILEDESK_FILE+"/users";return new Promise((Q,se)=>{E.http.post(V,l,i).subscribe(ge=>{let me=this.URL_TILEDESK_FILE+"/download?path="+encodeURI(ge.filename);n.file.type.includes("pdf")&&(me=this.URL_TILEDESK_FILE+"?path="+encodeURI(ge.filename)),Q(me)},ge=>{this.logger.error("[NATIVE UPLOAD] - ERROR upload new file ",ge),se(ge)})})}}}Kt.\u0275fac=function(t){return new(t||Kt)(e.LFG(Ee.eN),e.LFG(Re))},Kt.\u0275prov=e.Yz7({token:Kt,factory:Kt.\u0275fac});class Ot extends Re{constructor(){super(...arguments),this.storagePrefix=pe,this.logger=fe.getInstance()}initialize(t,n,o){this.storagePrefix=t,this.projectID=o,this.persistence=n}getItem(t){let n;try{n=this.storagePrefix+"_"}catch(i){this.logger.error("[LocalSessionStorage] getItem >Error :",i)}return this.getValueForKey(n+this.projectID+"_"+t)}setItem(t,n){let o;try{o=this.storagePrefix+"_"}catch(l){this.logger.error("[LocalSessionStorage] setItem > Error :",l)}this.saveValueForKey(o+this.projectID+"_"+t,n)}getItemWithoutProjectID(t){let n;try{n=this.storagePrefix+"_"}catch(i){this.logger.error("[LocalSessionStorage] getItemWithoutProjectID > Error :",i)}return this.getValueForKey(n+t)}setItemWithoutProjectID(t,n){this.removeItem(t);let o=pe;try{o=this.storagePrefix+"_"}catch(l){this.logger.error("[LocalSessionStorage] setItemWithoutProjectID > Error :",l)}this.saveValueForKey(o+t,n)}removeItem(t){let n;try{n=this.storagePrefix+"_"}catch(i){this.logger.error("[LocalSessionStorage] removeItem > Error :",i)}return this.removeItemForKey(n+this.projectID+"_"+t)}clear(){let t;try{t=this.storagePrefix+"_"}catch(i){this.logger.error("[LocalSessionStorage] clear > Error :",i)}const n=t+this.projectID,o=[];for(let i=0;i<localStorage.length;i++){const l=localStorage.key(i);-1!==l.indexOf(n)&&o.push(l)}for(let i=0;i<o.length;i++)this.removeItemForKey(o[i])}getValueForKey(t){return"local"===this.persistence||"LOCAL"===this.persistence?dt()?localStorage.getItem(t):(this.logger.warn("localStorage is not defind. Storage disabled"),null):"session"===this.persistence||"SESSION"===this.persistence?Yn()?sessionStorage.getItem(t):(this.logger.warn("sessionStorage is not defind. Storage disabled"),null):"none"===this.persistence||"NONE"===this.persistence?null:dt()?localStorage.getItem(t):(this.logger.warn("localStorage is not defind. Storage disabled"),null)}saveValueForKey(t,n){return"local"===this.persistence||"LOCAL"===this.persistence?dt()?localStorage.setItem(t,n):(this.logger.warn("localStorage is not defind. Storage disabled"),null):"session"===this.persistence||"SESSION"===this.persistence?Yn()?sessionStorage.setItem(t,n):(this.logger.warn("sessionStorage is not defind. Storage disabled"),null):"none"===this.persistence||"NONE"===this.persistence?null:dt()?localStorage.setItem(t,n):(this.logger.warn("localStorage is not defind. Storage disabled"),null)}removeItemForKey(t){return"local"===this.persistence||"LOCAL"===this.persistence?dt()?localStorage.removeItem(t):(this.logger.warn("localStorage is not defind. Storage disabled"),null):"session"===this.persistence||"SESSION"===this.persistence?Yn()?sessionStorage.removeItem(t):(this.logger.warn("sessionStorage is not defind. Storage disabled"),null):"none"===this.persistence||"NONE"===this.persistence?null:dt()?localStorage.removeItem(t):(this.logger.warn("localStorage is not defind. Storage disabled"),null)}}Ot.\u0275fac=function(){let r;return function(n){return(r||(r=e.n5z(Ot)))(n||Ot)}}(),Ot.\u0275prov=e.Yz7({token:Ot,factory:Ot.\u0275fac});class $t{}$t.\u0275fac=function(t){return new(t||$t)},$t.\u0275mod=e.oAB({type:$t,bootstrap:[_t]}),$t.\u0275inj=e.cJS({providers:[ke,Fe,Pe,Eo,pt,ft,lt,{provide:e.ip1,useFactory:(r,t)=>()=>{let n=new Nt(t);if(fe.setInstance(n),Ie.remoteConfig)return r.loadAppConfig()},multi:!0,deps:[ke,zn.Kf]},{provide:Re,useClass:Ot},{provide:et,useFactory:function gl(r,t,n,o){const i=t.getConfig();if(i.chatEngine===J){n.config=i.chat21Config,n.initChat();const l=new Vt(r,n,o);return l.setBaseUrl(t.getConfig().apiUrl),l}{Ge.initFirebase(i.firebaseConfig);const l=new Ft(r);return l.setBaseUrl(i.apiUrl),l}},deps:[Ee.eN,ke,Fe,Re]},{provide:Ye,useFactory:function pl(r,t,n){return n.getConfig().chatEngine===J?new Gt(r):new Bt(t,n)},deps:[Fe,Ee.eN,ke]},{provide:Je,useFactory:function fl(r,t){return t.getConfig().chatEngine===J?new qt(r):new Ut},deps:[Fe,ke]},{provide:Qe,useFactory:function ml(r,t){return t.getConfig().chatEngine===J?new Wt(r):new Dt},deps:[Fe,ke]},{provide:ct,useFactory:function _l(r,t){return t.getConfig().chatEngine===J?new yt(r,!0):new wt(!0)},deps:[Fe,ke]},{provide:Ze,useFactory:function Cl(r,t){const n=r.getConfig();if(n.uploadEngine===v){const o=new Qt(t);return o.setImageBaseUrl(n.baseImageUrl),o}{const o=new zt(t);return Ge.initFirebase(n.firebaseConfig),o.setImageBaseUrl(n.baseImageUrl),o}},deps:[ke,Ee.eN]},{provide:tt,useFactory:function bl(r){return r.getConfig().chatEngine===J?new Jt:new Zt},deps:[ke]},{provide:je,useFactory:function vl(r){return r.getConfig().chatEngine===J?new Yt:new Ht},deps:[ke]},{provide:Ve,useFactory:function wl(r,t,n){const o=t.getConfig();if(o.uploadEngine===v){const i=new Kt(r,n);return i.setBaseUrl(o.baseImageUrl),i}return new jt},deps:[Ee.eN,ke,Re]},mt,at,st,He,gt,vt],imports:[S.b2,ll.PW,Ee.JF,Ce.u5,Ce.UX,Ke._G,to.z8.forRoot(Te),No.bd,eo.aw.forRoot({}),zn.f9.forRoot({level:zn._z.DEBUG,enableSourceMaps:!1,disableFileDetails:!0,colorScheme:["purple","yellow","gray","gray","red","red","red"]})]}),e.B6R(_t,function(){return[de.mk,de.O5,de.PC,An,Mt,rn,sn,In,kn,Sn,Tn,wn]},[]),Ie.production&&(0,e.G48)(),S.q6().bootstrapModule($t).catch(r=>console.error(r))},7994:(ze,Ln,be)=>{ze.exports=function S(e,J,O){function v(h,p){if(!J[h]){if(!e[h]){if(_)return _(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var w=J[h]={exports:{}};e[h][0].call(w.exports,function(x){return v(e[h][1][x]||x)},w,w.exports,S,e,J,O)}return J[h].exports}for(var _=void 0,c=0;c<O.length;c++)v(O[c]);return v}({1:[function(S,e,J){(function(O,v){"use strict";var _=S("events").EventEmitter,c=S("./store"),h=S("mqtt-packet"),p=S("readable-stream").Writable,b=S("inherits"),f=S("reinterval"),w=S("./validations"),x=S("xtend"),g=S("debug")("mqttjs:client"),u=O?O.nextTick:function(I){setTimeout(I,0)},y=v.setImmediate||function(I){u(I)},R={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0},P=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND"],D={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};function Z(I,N,W){g("sendPacket :: packet: %O",N),g("sendPacket :: emitting `packetsend`"),I.emit("packetsend",N),g("sendPacket :: writing to stream");var M=h.writeToStream(N,I.stream,I.options);g("sendPacket :: writeToStream result %s",M),!M&&W?(g("sendPacket :: handle events on `drain` once through callback."),I.stream.once("drain",W)):W&&(g("sendPacket :: invoking cb"),W())}function k(I,N,W,M){g("storeAndSend :: store packet with cmd %s to outgoingStore",N.cmd),I.outgoingStore.put(N,function(j){if(j)return W&&W(j);M(),Z(I,N,W)})}function ne(I){g("nop ::",I)}function A(I,N){var W,M=this;if(!(this instanceof A))return new A(I,N);for(W in this.options=N||{},R)this.options[W]=void 0===this.options[W]?R[W]:N[W];g("MqttClient :: options.protocol",N.protocol),g("MqttClient :: options.protocolVersion",N.protocolVersion),g("MqttClient :: options.username",N.username),g("MqttClient :: options.keepalive",N.keepalive),g("MqttClient :: options.reconnectPeriod",N.reconnectPeriod),g("MqttClient :: options.rejectUnauthorized",N.rejectUnauthorized),this.options.clientId="string"==typeof N.clientId?N.clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),g("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=5===N.protocolVersion&&N.customHandleAcks?N.customHandleAcks:function(){arguments[3](0)},this.streamBuilder=I,this.outgoingStore=N.outgoingStore||new c,this.incomingStore=N.incomingStore||new c,this.queueQoSZero=void 0===N.queueQoSZero||N.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this.nextId=Math.max(1,Math.floor(65535*Math.random())),this.outgoing={},this._firstConnection=!0,this.on("connect",function(){var j=this.queue;g("connect :: sending queued packets"),function q(){var ie,oe=j.shift();g("deliver :: entry %o",oe),oe&&(g("deliver :: call _sendPacket for %o",ie=oe.packet),M._sendPacket(ie,function(ee){oe.cb&&oe.cb(ee),q()}))}()}),this.on("close",function(){g("close :: connected set to `false`"),this.connected=!1,g("close :: clearing connackTimer"),clearTimeout(this.connackTimer),g("close :: clearing ping timer"),null!==M.pingTimer&&(M.pingTimer.clear(),M.pingTimer=null),g("close :: calling _setupReconnect"),this._setupReconnect()}),_.call(this),g("MqttClient :: setting up stream"),this._setupStream()}b(A,_),A.prototype._setupStream=function(){var I,N=this,W=new p,M=h.parser(this.options),j=null,q=[];function oe(){if(q.length)u(ie);else{var ee=j;j=null,ee()}}function ie(){g("work :: getting next packet in queue");var ee=q.shift();if(ee)g("work :: packet pulled from queue"),N._handlePacket(ee,oe);else{g("work :: no packets in queue");var z=j;j=null,g("work :: done flag is %s",!!z),z&&z()}}if(g("_setupStream :: calling method to clear reconnect"),this._clearReconnect(),g("_setupStream :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),M.on("packet",function(ee){g("parser :: on packet push to packets array."),q.push(ee)}),W._write=function(ee,z,L){j=L,g("writable stream :: parsing buffer"),M.parse(ee),ie()},g("_setupStream :: pipe stream to writable stream"),this.stream.pipe(W),this.stream.on("error",function(ee){g("streamErrorHandler :: error",ee.message),P.includes(ee.code)?(g("streamErrorHandler :: emitting error"),N.emit("error",ee)):ne(ee)}),this.stream.on("close",function(){var ee;g("(%s)stream :: on close",N.options.clientId),(ee=N.outgoing)&&(g("flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(ee).forEach(function(z){ee[z].volatile&&"function"==typeof ee[z].cb&&(ee[z].cb(new Error("Connection closed")),delete ee[z])})),g("stream: emit close to MqttClient"),N.emit("close")}),g("_setupStream: sending packet `connect`"),(I=Object.create(this.options)).cmd="connect",Z(this,I),M.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return N.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;this.options.properties.authenticationMethod&&this.options.authPacket&&"object"==typeof this.options.authPacket&&Z(this,x({cmd:"auth",reasonCode:0},this.options.authPacket))}this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(function(){g("!!connectTimeout hit!! Calling _cleanUp with force `true`"),N._cleanUp(!0)},this.options.connectTimeout)},A.prototype._handlePacket=function(I,N){var W=this.options;if(5===W.protocolVersion&&W.properties&&W.properties.maximumPacketSize&&W.properties.maximumPacketSize<I.length)return this.emit("error",new Error("exceeding packets size "+I.cmd)),this.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),this;switch(g("_handlePacket :: emitting packetreceive"),this.emit("packetreceive",I),I.cmd){case"publish":this._handlePublish(I,N);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(I),N();break;case"pubrel":this._handlePubrel(I,N);break;case"connack":this._handleConnack(I),N();break;case"pingresp":this._handlePingresp(I),N();break;case"disconnect":this._handleDisconnect(I),N()}},A.prototype._checkDisconnecting=function(I){return this.disconnecting&&(I?I(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},A.prototype.publish=function(I,N,W,M){var j;g("publish :: message `%s` to topic `%s`",N,I);var q=this.options;if("function"==typeof W&&(M=W,W=null),W=x({qos:0,retain:!1,dup:!1},W),this._checkDisconnecting(M))return this;switch(j={cmd:"publish",topic:I,payload:N,qos:W.qos,retain:W.retain,messageId:this._nextId(),dup:W.dup},5===q.protocolVersion&&(j.properties=W.properties,(!q.properties&&j.properties&&j.properties.topicAlias||W.properties&&q.properties&&(W.properties.topicAlias&&q.properties.topicAliasMaximum&&W.properties.topicAlias>q.properties.topicAliasMaximum||!q.properties.topicAliasMaximum&&W.properties.topicAlias))&&delete j.properties.topicAlias),g("publish :: qos",W.qos),W.qos){case 1:case 2:this.outgoing[j.messageId]={volatile:!1,cb:M||ne},this._storeProcessing?(g("_storeProcessing enabled"),this._packetIdsDuringStoreProcessing[j.messageId]=!1,this._storePacket(j,void 0,W.cbStorePut)):(g("MqttClient:publish: packet cmd: %s",j.cmd),this._sendPacket(j,void 0,W.cbStorePut));break;default:this._storeProcessing?(g("_storeProcessing enabled"),this._storePacket(j,M,W.cbStorePut)):(g("MqttClient:publish: packet cmd: %s",j.cmd),this._sendPacket(j,M,W.cbStorePut))}return this},A.prototype.subscribe=function(){for(var I,N=new Array(arguments.length),W=0;W<arguments.length;W++)N[W]=arguments[W];var M,j=[],q=N.shift(),oe=q.resubscribe,ie=N.pop()||ne,ee=N.pop(),z=this,L=this.options.protocolVersion;if(delete q.resubscribe,"string"==typeof q&&(q=[q]),"function"!=typeof ie&&(ee=ie,ie=ne),null!==(M=w.validateTopics(q)))return y(ie,new Error("Invalid topic "+M)),this;if(this._checkDisconnecting(ie))return g("subscribe: discconecting true"),this;var G={qos:0};if(5===L&&(G.nl=!1,G.rap=!1,G.rh=0),ee=x(G,ee),Array.isArray(q)?q.forEach(function(m){if(g("subscribe: array topic %s",m),!z._resubscribeTopics.hasOwnProperty(m)||z._resubscribeTopics[m].qos<ee.qos||oe){var C={topic:m,qos:ee.qos};5===L&&(C.nl=ee.nl,C.rap=ee.rap,C.rh=ee.rh,C.properties=ee.properties),g("subscribe: pushing topic `%s` and qos `%s` to subs list",C.topic,C.qos),j.push(C)}}):Object.keys(q).forEach(function(m){if(g("subscribe: object topic %s",m),!z._resubscribeTopics.hasOwnProperty(m)||z._resubscribeTopics[m].qos<q[m].qos||oe){var C={topic:m,qos:q[m].qos};5===L&&(C.nl=q[m].nl,C.rap=q[m].rap,C.rh=q[m].rh,C.properties=ee.properties),g("subscribe: pushing `%s` to subs list",C),j.push(C)}}),I={cmd:"subscribe",subscriptions:j,qos:1,retain:!1,dup:!1,messageId:this._nextId()},ee.properties&&(I.properties=ee.properties),j.length){if(this.options.resubscribe){g("subscribe :: resubscribe true");var Y=[];j.forEach(function(m){if(z.options.reconnectPeriod>0){var C={qos:m.qos};5===L&&(C.nl=m.nl||!1,C.rap=m.rap||!1,C.rh=m.rh||0,C.properties=m.properties),z._resubscribeTopics[m.topic]=C,Y.push(m.topic)}}),z.messageIdToTopic[I.messageId]=Y}return this.outgoing[I.messageId]={volatile:!0,cb:function(m,C){if(!m)for(var F=C.granted,U=0;U<F.length;U+=1)j[U].qos=F[U];ie(m,j)}},g("subscribe :: call _sendPacket"),this._sendPacket(I),this}ie(null,[])},A.prototype.unsubscribe=function(){for(var I={cmd:"unsubscribe",qos:1,messageId:this._nextId()},N=this,W=new Array(arguments.length),M=0;M<arguments.length;M++)W[M]=arguments[M];var j=W.shift(),q=W.pop()||ne,oe=W.pop();return"string"==typeof j&&(j=[j]),"function"!=typeof q&&(oe=q,q=ne),this._checkDisconnecting(q)||("string"==typeof j?I.unsubscriptions=[j]:Array.isArray(j)&&(I.unsubscriptions=j),this.options.resubscribe&&I.unsubscriptions.forEach(function(ie){delete N._resubscribeTopics[ie]}),"object"==typeof oe&&oe.properties&&(I.properties=oe.properties),this.outgoing[I.messageId]={volatile:!0,cb:q},g("unsubscribe: call _sendPacket"),this._sendPacket(I)),this},A.prototype.end=function(I,N,W){var M=this;function j(){g("end :: (%s) :: finish :: calling _cleanUp with force %s",M.options.clientId,I),M._cleanUp(I,()=>{g("end :: finish :: calling process.nextTick on closeStores"),u(function(){g("end :: closeStores: closing incoming and outgoing stores"),M.disconnected=!0,M.incomingStore.close(function(q){M.outgoingStore.close(function(oe){if(g("end :: closeStores: emitting end"),M.emit("end"),W){let ie=q||oe;g("end :: closeStores: invoking callback with args"),W(ie)}})}),M._deferredReconnect&&M._deferredReconnect()}.bind(M))},N)}return g("end :: (%s)",this.options.clientId),null!=I&&"boolean"==typeof I||(W=N||ne,N=I,I=!1,"object"!=typeof N&&(W=N,N=null,"function"!=typeof W&&(W=ne))),"object"!=typeof N&&(W=N,N=null),g("end :: cb? %s",!!W),W=W||ne,this.disconnecting?(W(),this):(this._clearReconnect(),this.disconnecting=!0,!I&&Object.keys(this.outgoing).length>0?(g("end :: (%s) :: calling finish in 10ms once outgoing is empty",M.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,j,10))):(g("end :: (%s) :: immediately calling finish",M.options.clientId),j()),this)},A.prototype.removeOutgoingMessage=function(I){var N=this.outgoing[I]?this.outgoing[I].cb:null;return delete this.outgoing[I],this.outgoingStore.del({messageId:I},function(){N(new Error("Message removed"))}),this},A.prototype.reconnect=function(I){g("client reconnect");var N=this,W=function(){I?(N.options.incomingStore=I.incomingStore,N.options.outgoingStore=I.outgoingStore):(N.options.incomingStore=null,N.options.outgoingStore=null),N.incomingStore=N.options.incomingStore||new c,N.outgoingStore=N.options.outgoingStore||new c,N.disconnecting=!1,N.disconnected=!1,N._deferredReconnect=null,N._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=W:W(),this},A.prototype._reconnect=function(){g("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this._setupStream()}),g("client already connected. disconnecting first.")):(g("_reconnect: calling _setupStream"),this._setupStream())},A.prototype._setupReconnect=function(){var I=this;!I.disconnecting&&!I.reconnectTimer&&I.options.reconnectPeriod>0?(this.reconnecting||(g("_setupReconnect :: emit `offline` state"),this.emit("offline"),g("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),g("_setupReconnect :: setting reconnectTimer for %d ms",I.options.reconnectPeriod),I.reconnectTimer=setInterval(function(){g("reconnectTimer :: reconnect triggered!"),I._reconnect()},I.options.reconnectPeriod)):g("_setupReconnect :: doing nothing...")},A.prototype._clearReconnect=function(){g("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},A.prototype._cleanUp=function(I,N){var W,M=arguments[2];if(N&&(g("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",N)),g("_cleanUp :: forced? %s",I),I)0===this.options.reconnectPeriod&&this.options.clean&&(W=this.outgoing)&&(g("flush: queue exists? %b",!!W),Object.keys(W).forEach(function(q){"function"==typeof W[q].cb&&(W[q].cb(new Error("Connection closed")),delete W[q])})),g("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{var j=x({cmd:"disconnect"},M);g("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(j,y.bind(null,this.stream.end.bind(this.stream)))}this.disconnecting||(g("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(g("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),N&&!this.connected&&(g("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",N),N())},A.prototype._sendPacket=function(I,N,W){if(g("_sendPacket :: (%s) ::  start",this.options.clientId),W=W||ne,!this.connected)return g("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(I,N,W);switch(this._shiftPingInterval(),I.cmd){case"publish":break;case"pubrel":return void k(this,I,N,W);default:return void Z(this,I,N)}switch(I.qos){case 2:case 1:k(this,I,N,W);break;default:Z(this,I,N)}g("_sendPacket :: (%s) ::  end",this.options.clientId)},A.prototype._storePacket=function(I,N,W){g("_storePacket :: packet: %o",I),g("_storePacket :: cb? %s",!!N),W=W||ne,0===(I.qos||0)&&this.queueQoSZero||"publish"!==I.cmd?this.queue.push({packet:I,cb:N}):I.qos>0?(N=this.outgoing[I.messageId]?this.outgoing[I.messageId].cb:null,this.outgoingStore.put(I,function(M){if(M)return N&&N(M);W()})):N&&N(new Error("No connection to broker"))},A.prototype._setupPingTimer=function(){g("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive);var I=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=f(function(){I._checkPing()},1e3*this.options.keepalive))},A.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},A.prototype._checkPing=function(){g("_checkPing :: checking ping..."),this.pingResp?(g("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(g("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))},A.prototype._handlePingresp=function(){this.pingResp=!0},A.prototype._handleConnack=function(I){g("_handleConnack");var N=this.options,W=5===N.protocolVersion?I.reasonCode:I.returnCode;if(clearTimeout(this.connackTimer),I.properties&&(I.properties.topicAliasMaximum&&(N.properties||(N.properties={}),N.properties.topicAliasMaximum=I.properties.topicAliasMaximum),I.properties.serverKeepAlive&&N.keepalive&&(N.keepalive=I.properties.serverKeepAlive,this._shiftPingInterval()),I.properties.maximumPacketSize&&(N.properties||(N.properties={}),N.properties.maximumPacketSize=I.properties.maximumPacketSize)),0===W)this.reconnecting=!1,this._onConnect(I);else if(W>0){var M=new Error("Connection refused: "+D[W]);M.code=W,this.emit("error",M)}},A.prototype._handlePublish=function(I,N){g("_handlePublish: packet %o",I),N=void 0!==N?N:ne;var W=I.topic.toString(),M=I.payload,j=I.qos,q=I.messageId,oe=this,ie=this.options,ee=[0,16,128,131,135,144,145,151,153];switch(g("_handlePublish: qos %d",j),j){case 2:ie.customHandleAcks(W,M,I,function(z,L){return z instanceof Error||(L=z,z=null),z?oe.emit("error",z):-1===ee.indexOf(L)?oe.emit("error",new Error("Wrong reason code for pubrec")):void(L?oe._sendPacket({cmd:"pubrec",messageId:q,reasonCode:L},N):oe.incomingStore.put(I,function(){oe._sendPacket({cmd:"pubrec",messageId:q},N)}))});break;case 1:ie.customHandleAcks(W,M,I,function(z,L){return z instanceof Error||(L=z,z=null),z?oe.emit("error",z):-1===ee.indexOf(L)?oe.emit("error",new Error("Wrong reason code for puback")):(L||oe.emit("message",W,M,I),void oe.handleMessage(I,function(G){if(G)return N&&N(G);oe._sendPacket({cmd:"puback",messageId:q,reasonCode:L},N)}))});break;case 0:this.emit("message",W,M,I),this.handleMessage(I,N);break;default:g("_handlePublish: unknown QoS. Doing nothing.")}},A.prototype.handleMessage=function(I,N){N()},A.prototype._handleAck=function(I){var N,W=I.messageId,M=I.cmd,j=null,q=this.outgoing[W]?this.outgoing[W].cb:null,oe=this;if(q){switch(g("_handleAck :: packet type",M),M){case"pubcomp":case"puback":var ie=I.reasonCode;ie&&ie>0&&16!==ie&&((N=new Error("Publish error: "+D[ie])).code=ie,q(N,I)),delete this.outgoing[W],this.outgoingStore.del(I,q);break;case"pubrec":j={cmd:"pubrel",qos:2,messageId:W};var ee=I.reasonCode;ee&&ee>0&&16!==ee?((N=new Error("Publish error: "+D[ee])).code=ee,q(N,I)):this._sendPacket(j);break;case"suback":delete this.outgoing[W];for(var z=0;z<I.granted.length;z++)if(0!=(128&I.granted[z])){var L=this.messageIdToTopic[W];L&&L.forEach(function(G){delete oe._resubscribeTopics[G]})}q(null,I);break;case"unsuback":delete this.outgoing[W],q(null);break;default:oe.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}else g("_handleAck :: Server sent an ack in error. Ignoring.")},A.prototype._handlePubrel=function(I,N){g("handling pubrel packet"),N=void 0!==N?N:ne;var W=this,M={cmd:"pubcomp",messageId:I.messageId};W.incomingStore.get(I,function(j,q){j?W._sendPacket(M,N):(W.emit("message",q.topic,q.payload,q),W.handleMessage(q,function(oe){if(oe)return N(oe);W.incomingStore.del(q,ne),W._sendPacket(M,N)}))})},A.prototype._handleDisconnect=function(I){this.emit("disconnect",I)},A.prototype._nextId=function(){var I=this.nextId++;return 65536===this.nextId&&(this.nextId=1),I},A.prototype.getLastMessageId=function(){return 1===this.nextId?65535:this.nextId-1},A.prototype._resubscribe=function(I){g("_resubscribe");var N=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||5===this.options.protocolVersion&&!I.sessionPresent)&&N.length>0)if(this.options.resubscribe)if(5===this.options.protocolVersion){g("_resubscribe: protocolVersion 5");for(var W=0;W<N.length;W++){var M={};M[N[W]]=this._resubscribeTopics[N[W]],M.resubscribe=!0,this.subscribe(M,{properties:M[N[W]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1},A.prototype._onConnect=function(I){if(this.disconnected)this.emit("connect",I);else{var N=this;this._setupPingTimer(),this._resubscribe(I),this.connected=!0,function W(){var M=N.outgoingStore.createStream();function j(){N._storeProcessing=!1,N._packetIdsDuringStoreProcessing={}}function q(){M.destroy(),M=null,j()}N.once("close",q),M.on("error",function(oe){j(),N.removeListener("close",q),N.emit("error",oe)}),M.on("end",function(){var oe=!0;for(var ie in N._packetIdsDuringStoreProcessing)if(!N._packetIdsDuringStoreProcessing[ie]){oe=!1;break}oe?(j(),N.removeListener("close",q),N.emit("connect",I)):W()}),function oe(){if(M){N._storeProcessing=!0;var ie,ee=M.read(1);ee?N._packetIdsDuringStoreProcessing[ee.messageId]?oe():N.disconnecting||N.reconnectTimer?M.destroy&&M.destroy():(ie=N.outgoing[ee.messageId]?N.outgoing[ee.messageId].cb:null,N.outgoing[ee.messageId]={volatile:!1,cb:function(z,L){ie&&ie(z,L),oe()}},N._packetIdsDuringStoreProcessing[ee.messageId]=!0,N._sendPacket(ee)):M.once("readable",oe)}}()}()}},e.exports=A}).call(this,S("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./store":7,"./validations":8,_process:44,debug:14,events:27,inherits:29,"mqtt-packet":34,"readable-stream":63,reinterval:64,xtend:74}],2:[function(S,e,J){(function(O){"use strict";var v,_,c,h=S("readable-stream").Transform,p=S("duplexify"),b=!1;e.exports=function(f,w){if(w.hostname=w.hostname||w.host,!w.hostname)throw new Error("Could not determine host. Specify host manually.");var u,x="MQIsdp"===w.protocolId&&3===w.protocolVersion?"mqttv3.1":"mqtt";(u=w).hostname||(u.hostname="localhost"),u.path||(u.path="/"),u.wsOptions||(u.wsOptions={});var g=function(u,y){var R="alis"===u.protocol?"wss":"ws",P=R+"://"+u.hostname+u.path;return u.port&&80!==u.port&&443!==u.port&&(P=R+"://"+u.hostname+":"+u.port+u.path),"function"==typeof u.transformWsUrl&&(P=u.transformWsUrl(P,u,y)),P}(w,f);return(v=w.my).connectSocket({url:g,protocols:x}),_=function(){var u=new h;return u._write=function(y,R,P){v.sendSocketMessage({data:y.buffer,success:function(){P()},fail:function(){P(new Error)}})},u._flush=function(y){v.closeSocket({success:function(){y()}})},u}(),c=p.obj(),b||(b=!0,v.onSocketOpen(function(){c.setReadable(_),c.setWritable(_),c.emit("connect")}),v.onSocketMessage(function(u){if("string"==typeof u.data){var y=O.from(u.data,"base64");_.push(y)}else{var R=new FileReader;R.addEventListener("load",function(){var P=R.result;P=P instanceof ArrayBuffer?O.from(P):O.from(P,"utf8"),_.push(P)}),R.readAsArrayBuffer(u.data)}}),v.onSocketClose(function(){c.end(),c.destroy()}),v.onSocketError(function(u){c.destroy(u)})),c}}).call(this,S("buffer").Buffer)},{buffer:12,duplexify:16,"readable-stream":63}],3:[function(S,e,J){"use strict";var O=S("net"),v=S("debug")("mqttjs:tcp");e.exports=function(_,c){var h,p;return c.port=c.port||1883,c.hostname=c.hostname||c.host||"localhost",v("port %d and host %s",h=c.port,p=c.hostname),O.createConnection(h,p)}},{debug:14,net:11}],4:[function(S,e,J){"use strict";var O=S("tls"),v=S("debug")("mqttjs:tls");e.exports=function(_,c){var h;function p(b){c.rejectUnauthorized&&_.emit("error",b),h.end()}return c.port=c.port||8883,c.host=c.hostname||c.host||"localhost",c.servername=c.host,c.rejectUnauthorized=!1!==c.rejectUnauthorized,delete c.path,v("port %d host %s rejectUnauthorized %b",c.port,c.host,c.rejectUnauthorized),(h=O.connect(c)).on("secureConnect",function(){c.rejectUnauthorized&&!h.authorized?h.emit("error",new Error("TLS not authorized")):h.removeListener("error",p)}),h.on("error",p),h}},{debug:14,tls:11}],5:[function(S,e,J){(function(O,v){"use strict";const _=S("ws"),c=S("debug")("mqttjs:ws"),h=S("duplexify"),p=S("readable-stream").Transform;let b=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];const f=void 0!==O&&"browser"===O.title||"function"==typeof be;function w(g,u){let y=g.protocol+"://"+g.hostname+":"+g.port+g.path;return"function"==typeof g.transformWsUrl&&(y=g.transformWsUrl(y,g,u)),y}function x(g){let u=g;return g.hostname||(u.hostname="localhost"),g.port||(u.port="wss"===g.protocol?443:80),g.path||(u.path="/"),g.wsOptions||(u.wsOptions={}),f||"wss"!==g.protocol||b.forEach(function(y){g.hasOwnProperty(y)&&!g.wsOptions.hasOwnProperty(y)&&(u.wsOptions[y]=g[y])}),u}e.exports=f?function(g,u){let y;c("browserStreamBuilder");const R=function(j){let q=x(j);if(q.hostname||(q.hostname=q.host),!q.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");const oe=new URL(document.URL);q.hostname=oe.hostname,q.port||(q.port=oe.port)}return void 0===q.objectMode&&(q.objectMode=!(!0===q.binary||void 0===q.binary)),q}(u).browserBufferSize||524288,P=u.browserBufferTimeout||1e3,D=!u.objectMode;let Z=function(j,q){const oe="MQIsdp"===q.protocolId&&3===q.protocolVersion?"mqttv3.1":"mqtt";let ie=w(q,j),ee=new WebSocket(ie,[oe]);return ee.binaryType="arraybuffer",ee}(g,u),k=function(j,q,oe){let ie=new p({objectModeMode:j.objectMode});return ie._write=function j(q,oe,ie){Z.bufferedAmount>R&&setTimeout(j,P,q,oe,ie),D&&"string"==typeof q&&(q=v.from(q,"utf8"));try{Z.send(q)}catch(ee){return ie(ee)}ie()},ie._flush=function(j){Z.close(),j()},ie}(u);u.objectMode||(k._writev=M),k.on("close",()=>{Z.close()});const ne=void 0===Z.addEventListener;function A(){y.setReadable(k),y.setWritable(k),y.emit("connect")}function I(){y.end(),y.destroy()}function N(j){y.destroy(j)}function W(j){let q=j.data;q=q instanceof ArrayBuffer?v.from(q):v.from(q,"utf8"),k.push(q)}function M(j,q){const oe=new Array(j.length);for(let ie=0;ie<j.length;ie++)oe[ie]="string"==typeof j[ie].chunk?v.from(j[ie],"utf8"):j[ie].chunk;this._write(v.concat(oe),"binary",q)}return Z.readyState===Z.OPEN?y=k:(y=y=h(void 0,void 0,u),u.objectMode||(y._writev=M),ne?Z.addEventListener("open",A):Z.onopen=A),y.socket=Z,ne?(Z.addEventListener("close",I),Z.addEventListener("error",N),Z.addEventListener("message",W)):(Z.onclose=I,Z.onerror=N,Z.onmessage=W),y}:function(g,u){c("streamBuilder");let y=x(u);const R=w(y,g);let P=function(Z,k,ne){c("createWebSocket"),c("protocol: "+ne.protocolId+" "+ne.protocolVersion);const A="MQIsdp"===ne.protocolId&&3===ne.protocolVersion?"mqttv3.1":"mqtt";return c("creating new Websocket for url: "+k+" and protocol: "+A),new _(k,[A],ne.wsOptions)}(0,R,y),D=_.createWebSocketStream(P,y.wsOptions);return D.url=R,D}}).call(this,S("_process"),S("buffer").Buffer)},{_process:44,buffer:12,debug:14,duplexify:16,"readable-stream":63,ws:73}],6:[function(S,e,J){(function(O){"use strict";var v,_,c,h=S("readable-stream").Transform,p=S("duplexify");e.exports=function(b,f){if(f.hostname=f.hostname||f.host,!f.hostname)throw new Error("Could not determine host. Specify host manually.");var u,w="MQIsdp"===f.protocolId&&3===f.protocolVersion?"mqttv3.1":"mqtt";(u=f).hostname||(u.hostname="localhost"),u.path||(u.path="/"),u.wsOptions||(u.wsOptions={});var x=function(u,y){var R="wxs"===u.protocol?"wss":"ws",P=R+"://"+u.hostname+u.path;return u.port&&80!==u.port&&443!==u.port&&(P=R+"://"+u.hostname+":"+u.port+u.path),"function"==typeof u.transformWsUrl&&(P=u.transformWsUrl(P,u,y)),P}(f,b);v=wx.connectSocket({url:x,protocols:[w]}),_=function(){var u=new h;return u._write=function(y,R,P){v.send({data:y.buffer,success:function(){P()},fail:function(D){P(new Error(D))}})},u._flush=function(y){v.close({success:function(){y()}})},u}(),(c=p.obj())._destroy=function(u,y){v.close({success:function(){y&&y(u)}})};var g=c.destroy;return c.destroy=function(){c.destroy=g;var u=this;setTimeout(function(){v.close({fail:function(){u._destroy(new Error)}})},0)}.bind(c),v.onOpen(function(){c.setReadable(_),c.setWritable(_),c.emit("connect")}),v.onMessage(function(u){var y=u.data;y=y instanceof ArrayBuffer?O.from(y):O.from(y,"utf8"),_.push(y)}),v.onClose(function(){c.end(),c.destroy()}),v.onError(function(u){c.destroy(new Error(u.errMsg))}),c}}).call(this,S("buffer").Buffer)},{buffer:12,duplexify:16,"readable-stream":63}],7:[function(S,e,J){"use strict";var O=S("xtend"),v=S("readable-stream").Readable,_={objectMode:!0},c={clean:!0};function h(p){if(!(this instanceof h))return new h(p);this.options=p||{},this.options=O(c,p),this._inflights=new Map}h.prototype.put=function(p,b){return this._inflights.set(p.messageId,p),b&&b(),this},h.prototype.createStream=function(){var p=new v(_),b=!1,f=[],w=0;return this._inflights.forEach(function(x,g){f.push(x)}),p._read=function(){this.push(!b&&w<f.length?f[w++]:null)},p.destroy=function(){if(!b){var x=this;b=!0,setTimeout(function(){x.emit("close")},0)}},p},h.prototype.del=function(p,b){return(p=this._inflights.get(p.messageId))?(this._inflights.delete(p.messageId),b(null,p)):b&&b(new Error("missing packet")),this},h.prototype.get=function(p,b){return(p=this._inflights.get(p.messageId))?b(null,p):b&&b(new Error("missing packet")),this},h.prototype.close=function(p){this.options.clean&&(this._inflights=null),p&&p()},e.exports=h},{"readable-stream":63,xtend:74}],8:[function(S,e,J){"use strict";function O(v){for(var _=v.split("/"),c=0;c<_.length;c++)if("+"!==_[c]){if("#"===_[c])return c===_.length-1;if(-1!==_[c].indexOf("+")||-1!==_[c].indexOf("#"))return!1}return!0}e.exports={validateTopics:function(v){if(0===v.length)return"empty_topic_list";for(var _=0;_<v.length;_++)if(!O(v[_]))return v[_];return null}}},{}],9:[function(S,e,J){(function(O){"use strict";var v=S("../client"),_=S("../store"),c=S("url"),h=S("xtend"),p=S("debug")("mqttjs"),b={};function f(w,x){if(p("connecting to an MQTT broker..."),"object"!=typeof w||x||(x=w,w=null),x=x||{},w){var g=c.parse(w,!0);if(null!=g.port&&(g.port=Number(g.port)),null===(x=h(g,x)).protocol)throw new Error("Missing protocol");x.protocol=x.protocol.replace(/:$/,"")}if((R=x).auth&&((P=R.auth.match(/^(.+):(.+)$/))?(R.username=P[1],R.password=P[2]):R.username=R.auth),x.query&&"string"==typeof x.query.clientId&&(x.clientId=x.query.clientId),x.cert&&x.key){if(!x.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs","alis"].indexOf(x.protocol))switch(x.protocol){case"mqtt":x.protocol="mqtts";break;case"ws":x.protocol="wss";break;case"wx":x.protocol="wxs";break;case"ali":x.protocol="alis";break;default:throw new Error('Unknown protocol for secure connection: "'+x.protocol+'"!')}}var R,P;if(!b[x.protocol]){var u=-1!==["mqtts","wss"].indexOf(x.protocol);x.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter(function(R,P){return(!u||P%2!=0)&&"function"==typeof b[R]})[0]}if(!1===x.clean&&!x.clientId)throw new Error("Missing clientId for unclean clients");x.protocol&&(x.defaultProtocol=x.protocol);var y=new v(function(R){return x.servers&&(R._reconnectCount&&R._reconnectCount!==x.servers.length||(R._reconnectCount=0),x.host=x.servers[R._reconnectCount].host,x.port=x.servers[R._reconnectCount].port,x.protocol=x.servers[R._reconnectCount].protocol?x.servers[R._reconnectCount].protocol:x.defaultProtocol,x.hostname=x.host,R._reconnectCount++),p("calling streambuilder for",x.protocol),b[x.protocol](R,x)},x);return y.on("error",function(){}),y}void 0!==O&&"browser"!==O.title||"function"!=typeof be?(b.mqtt=S("./tcp"),b.tcp=S("./tcp"),b.ssl=S("./tls"),b.tls=S("./tls"),b.mqtts=S("./tls")):(b.wx=S("./wx"),b.wxs=S("./wx"),b.ali=S("./ali"),b.alis=S("./ali")),b.ws=S("./ws"),b.wss=S("./ws"),e.exports=f,e.exports.connect=f,e.exports.MqttClient=v,e.exports.Store=_}).call(this,S("_process"))},{"../client":1,"../store":7,"./ali":2,"./tcp":3,"./tls":4,"./ws":5,"./wx":6,_process:44,debug:14,url:69,xtend:74}],10:[function(S,e,J){"use strict";J.byteLength=function(w){var x=b(w),u=x[1];return 3*(x[0]+u)/4-u},J.toByteArray=function(w){var x,g,A,u=b(w),y=u[0],R=u[1],P=new _(3*(y+(A=R))/4-A),D=0,Z=R>0?y-4:y;for(g=0;g<Z;g+=4)x=v[w.charCodeAt(g)]<<18|v[w.charCodeAt(g+1)]<<12|v[w.charCodeAt(g+2)]<<6|v[w.charCodeAt(g+3)],P[D++]=x>>16&255,P[D++]=x>>8&255,P[D++]=255&x;return 2===R&&(x=v[w.charCodeAt(g)]<<2|v[w.charCodeAt(g+1)]>>4,P[D++]=255&x),1===R&&(x=v[w.charCodeAt(g)]<<10|v[w.charCodeAt(g+1)]<<4|v[w.charCodeAt(g+2)]>>2,P[D++]=x>>8&255,P[D++]=255&x),P},J.fromByteArray=function(w){for(var x,g=w.length,u=g%3,y=[],R=0,P=g-u;R<P;R+=16383)y.push(f(w,R,R+16383>P?P:R+16383));return 1===u?y.push(O[(x=w[g-1])>>2]+O[x<<4&63]+"=="):2===u&&y.push(O[(x=(w[g-2]<<8)+w[g-1])>>10]+O[x>>4&63]+O[x<<2&63]+"="),y.join("")};for(var O=[],v=[],_=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,p=c.length;h<p;++h)O[h]=c[h],v[c.charCodeAt(h)]=h;function b(w){var x=w.length;if(x%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=w.indexOf("=");return-1===g&&(g=x),[g,g===x?0:4-g%4]}function f(w,x,g){for(var y,R=[],P=x;P<g;P+=3)R.push(O[(y=(w[P]<<16&16711680)+(w[P+1]<<8&65280)+(255&w[P+2]))>>18&63]+O[y>>12&63]+O[y>>6&63]+O[63&y]);return R.join("")}v["-".charCodeAt(0)]=62,v["_".charCodeAt(0)]=63},{}],11:[function(S,e,J){},{}],12:[function(S,e,J){(function(p){"use strict";var v=S("base64-js"),_=S("ieee754");J.Buffer=p,J.SlowBuffer=function(s){return+s!=s&&(s=0),p.alloc(+s)},J.INSPECT_MAX_BYTES=50;var c=2147483647;function h(s){if(s>c)throw new RangeError('The value "'+s+'" is invalid for option "size"');var a=new Uint8Array(s);return a.__proto__=p.prototype,a}function p(s,a,d){if("number"==typeof s){if("string"==typeof a)throw new TypeError('The "string" argument must be of type string. Received type number');return w(s)}return b(s,a,d)}function b(s,a,d){if("string"==typeof s)return function(H,K){if("string"==typeof K&&""!==K||(K="utf8"),!p.isEncoding(K))throw new TypeError("Unknown encoding: "+K);var ae=0|u(H,K),re=h(ae),he=re.write(H,K);return he!==ae&&(re=re.slice(0,he)),re}(s,a);if(ArrayBuffer.isView(s))return x(s);if(null==s)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s);if(te(s,ArrayBuffer)||s&&te(s.buffer,ArrayBuffer))return function(H,K,ae){if(K<0||H.byteLength<K)throw new RangeError('"offset" is outside of buffer bounds');if(H.byteLength<K+(ae||0))throw new RangeError('"length" is outside of buffer bounds');var re;return(re=void 0===K&&void 0===ae?new Uint8Array(H):void 0===ae?new Uint8Array(H,K):new Uint8Array(H,K,ae)).__proto__=p.prototype,re}(s,a,d);if("number"==typeof s)throw new TypeError('The "value" argument must not be of type number. Received type number');var T=s.valueOf&&s.valueOf();if(null!=T&&T!==s)return p.from(T,a,d);var B=function(H){if(p.isBuffer(H)){var K=0|g(H.length),ae=h(K);return 0===ae.length||H.copy(ae,0,0,K),ae}return void 0!==H.length?"number"!=typeof H.length||X(H.length)?h(0):x(H):"Buffer"===H.type&&Array.isArray(H.data)?x(H.data):void 0}(s);if(B)return B;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof s[Symbol.toPrimitive])return p.from(s[Symbol.toPrimitive]("string"),a,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s)}function f(s){if("number"!=typeof s)throw new TypeError('"size" argument must be of type number');if(s<0)throw new RangeError('The value "'+s+'" is invalid for option "size"')}function w(s){return f(s),h(s<0?0:0|g(s))}function x(s){for(var a=s.length<0?0:0|g(s.length),d=h(a),T=0;T<a;T+=1)d[T]=255&s[T];return d}function g(s){if(s>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return 0|s}function u(s,a){if(p.isBuffer(s))return s.length;if(ArrayBuffer.isView(s)||te(s,ArrayBuffer))return s.byteLength;if("string"!=typeof s)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof s);var d=s.length,T=arguments.length>2&&!0===arguments[2];if(!T&&0===d)return 0;for(var B=!1;;)switch(a){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return F(s).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return U(s).length;default:if(B)return T?-1:F(s).length;a=(""+a).toLowerCase(),B=!0}}function y(s,a,d){var T=s[a];s[a]=s[d],s[d]=T}function R(s,a,d,T,B){if(0===s.length)return-1;if("string"==typeof d?(T=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),X(d=+d)&&(d=B?0:s.length-1),d<0&&(d=s.length+d),d>=s.length){if(B)return-1;d=s.length-1}else if(d<0){if(!B)return-1;d=0}if("string"==typeof a&&(a=p.from(a,T)),p.isBuffer(a))return 0===a.length?-1:P(s,a,d,T,B);if("number"==typeof a)return a&=255,"function"==typeof Uint8Array.prototype.indexOf?B?Uint8Array.prototype.indexOf.call(s,a,d):Uint8Array.prototype.lastIndexOf.call(s,a,d):P(s,[a],d,T,B);throw new TypeError("val must be string, number or Buffer")}function P(s,a,d,T,B){var H,K=1,ae=s.length,re=a.length;if(void 0!==T&&("ucs2"===(T=String(T).toLowerCase())||"ucs-2"===T||"utf16le"===T||"utf-16le"===T)){if(s.length<2||a.length<2)return-1;K=2,ae/=2,re/=2,d/=2}function he(De,Oe){return 1===K?De[Oe]:De.readUInt16BE(Oe*K)}if(B){var pe=-1;for(H=d;H<ae;H++)if(he(s,H)===he(a,-1===pe?0:H-pe)){if(-1===pe&&(pe=H),H-pe+1===re)return pe*K}else-1!==pe&&(H-=H-pe),pe=-1}else for(d+re>ae&&(d=ae-re),H=d;H>=0;H--){for(var Ue=!0,Be=0;Be<re;Be++)if(he(s,H+Be)!==he(a,Be)){Ue=!1;break}if(Ue)return H}return-1}function D(s,a,d,T){d=Number(d)||0;var B=s.length-d;T?(T=Number(T))>B&&(T=B):T=B;var H=a.length;T>H/2&&(T=H/2);for(var K=0;K<T;++K){var ae=parseInt(a.substr(2*K,2),16);if(X(ae))return K;s[d+K]=ae}return K}function Z(s,a,d,T){return $(F(a,s.length-d),s,d,T)}function k(s,a,d,T){return $(function(B){for(var H=[],K=0;K<B.length;++K)H.push(255&B.charCodeAt(K));return H}(a),s,d,T)}function ne(s,a,d,T){return k(s,a,d,T)}function A(s,a,d,T){return $(U(a),s,d,T)}function I(s,a,d,T){return $(function(B,H){for(var K,ae,he=[],pe=0;pe<B.length&&!((H-=2)<0);++pe)ae=(K=B.charCodeAt(pe))>>8,he.push(K%256),he.push(ae);return he}(a,s.length-d),s,d,T)}function N(s,a,d){return v.fromByteArray(0===a&&d===s.length?s:s.slice(a,d))}function W(s,a,d){d=Math.min(s.length,d);for(var T=[],B=a;B<d;){var H,K,ae,re,he=s[B],pe=null,Ue=he>239?4:he>223?3:he>191?2:1;if(B+Ue<=d)switch(Ue){case 1:he<128&&(pe=he);break;case 2:128==(192&(H=s[B+1]))&&(re=(31&he)<<6|63&H)>127&&(pe=re);break;case 3:K=s[B+2],128==(192&(H=s[B+1]))&&128==(192&K)&&(re=(15&he)<<12|(63&H)<<6|63&K)>2047&&(re<55296||re>57343)&&(pe=re);break;case 4:K=s[B+2],ae=s[B+3],128==(192&(H=s[B+1]))&&128==(192&K)&&128==(192&ae)&&(re=(15&he)<<18|(63&H)<<12|(63&K)<<6|63&ae)>65535&&re<1114112&&(pe=re)}null===pe?(pe=65533,Ue=1):pe>65535&&(T.push((pe-=65536)>>>10&1023|55296),pe=56320|1023&pe),T.push(pe),B+=Ue}return function(Be){var De=Be.length;if(De<=M)return String.fromCharCode.apply(String,Be);for(var Oe="",Te=0;Te<De;)Oe+=String.fromCharCode.apply(String,Be.slice(Te,Te+=M));return Oe}(T)}J.kMaxLength=c,(p.TYPED_ARRAY_SUPPORT=function(){try{var s=new Uint8Array(1);return s.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===s.foo()}catch{return!1}}())||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&null!=Symbol.species&&p[Symbol.species]===p&&Object.defineProperty(p,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),p.poolSize=8192,p.from=function(s,a,d){return b(s,a,d)},p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,p.alloc=function(s,a,d){return B=a,H=d,f(T=s),T<=0?h(T):void 0!==B?"string"==typeof H?h(T).fill(B,H):h(T).fill(B):h(T);var T,B,H},p.allocUnsafe=function(s){return w(s)},p.allocUnsafeSlow=function(s){return w(s)},p.isBuffer=function(s){return null!=s&&!0===s._isBuffer&&s!==p.prototype},p.compare=function(s,a){if(te(s,Uint8Array)&&(s=p.from(s,s.offset,s.byteLength)),te(a,Uint8Array)&&(a=p.from(a,a.offset,a.byteLength)),!p.isBuffer(s)||!p.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===a)return 0;for(var d=s.length,T=a.length,B=0,H=Math.min(d,T);B<H;++B)if(s[B]!==a[B]){d=s[B],T=a[B];break}return d<T?-1:T<d?1:0},p.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(s,a){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(0===s.length)return p.alloc(0);var d;if(void 0===a)for(a=0,d=0;d<s.length;++d)a+=s[d].length;var T=p.allocUnsafe(a),B=0;for(d=0;d<s.length;++d){var H=s[d];if(te(H,Uint8Array)&&(H=p.from(H)),!p.isBuffer(H))throw new TypeError('"list" argument must be an Array of Buffers');H.copy(T,B),B+=H.length}return T},p.byteLength=u,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var s=this.length;if(s%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<s;a+=2)y(this,a,a+1);return this},p.prototype.swap32=function(){var s=this.length;if(s%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<s;a+=4)y(this,a,a+3),y(this,a+1,a+2);return this},p.prototype.swap64=function(){var s=this.length;if(s%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<s;a+=8)y(this,a,a+7),y(this,a+1,a+6),y(this,a+2,a+5),y(this,a+3,a+4);return this},p.prototype.toLocaleString=p.prototype.toString=function(){var s=this.length;return 0===s?"":0===arguments.length?W(this,0,s):function(a,d,T){var B=!1;if((void 0===d||d<0)&&(d=0),d>this.length||((void 0===T||T>this.length)&&(T=this.length),T<=0)||(T>>>=0)<=(d>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return oe(this,d,T);case"utf8":case"utf-8":return W(this,d,T);case"ascii":return j(this,d,T);case"latin1":case"binary":return q(this,d,T);case"base64":return N(this,d,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,d,T);default:if(B)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),B=!0}}.apply(this,arguments)},p.prototype.equals=function(s){if(!p.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s||0===p.compare(this,s)},p.prototype.inspect=function(){var s="",a=J.INSPECT_MAX_BYTES;return s=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(s+=" ... "),"<Buffer "+s+">"},p.prototype.compare=function(s,a,d,T,B){if(te(s,Uint8Array)&&(s=p.from(s,s.offset,s.byteLength)),!p.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(void 0===a&&(a=0),void 0===d&&(d=s?s.length:0),void 0===T&&(T=0),void 0===B&&(B=this.length),a<0||d>s.length||T<0||B>this.length)throw new RangeError("out of range index");if(T>=B&&a>=d)return 0;if(T>=B)return-1;if(a>=d)return 1;if(this===s)return 0;for(var H=(B>>>=0)-(T>>>=0),K=(d>>>=0)-(a>>>=0),ae=Math.min(H,K),re=this.slice(T,B),he=s.slice(a,d),pe=0;pe<ae;++pe)if(re[pe]!==he[pe]){H=re[pe],K=he[pe];break}return H<K?-1:K<H?1:0},p.prototype.includes=function(s,a,d){return-1!==this.indexOf(s,a,d)},p.prototype.indexOf=function(s,a,d){return R(this,s,a,d,!0)},p.prototype.lastIndexOf=function(s,a,d){return R(this,s,a,d,!1)},p.prototype.write=function(s,a,d,T){if(void 0===a)T="utf8",d=this.length,a=0;else if(void 0===d&&"string"==typeof a)T=a,d=this.length,a=0;else{if(!isFinite(a))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");a>>>=0,isFinite(d)?(d>>>=0,void 0===T&&(T="utf8")):(T=d,d=void 0)}var B=this.length-a;if((void 0===d||d>B)&&(d=B),s.length>0&&(d<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");T||(T="utf8");for(var H=!1;;)switch(T){case"hex":return D(this,s,a,d);case"utf8":case"utf-8":return Z(this,s,a,d);case"ascii":return k(this,s,a,d);case"latin1":case"binary":return ne(this,s,a,d);case"base64":return A(this,s,a,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,s,a,d);default:if(H)throw new TypeError("Unknown encoding: "+T);T=(""+T).toLowerCase(),H=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function j(s,a,d){var T="";d=Math.min(s.length,d);for(var B=a;B<d;++B)T+=String.fromCharCode(127&s[B]);return T}function q(s,a,d){var T="";d=Math.min(s.length,d);for(var B=a;B<d;++B)T+=String.fromCharCode(s[B]);return T}function oe(s,a,d){var T=s.length;(!a||a<0)&&(a=0),(!d||d<0||d>T)&&(d=T);for(var B="",H=a;H<d;++H)B+=C(s[H]);return B}function ie(s,a,d){for(var T=s.slice(a,d),B="",H=0;H<T.length;H+=2)B+=String.fromCharCode(T[H]+256*T[H+1]);return B}function ee(s,a,d){if(s%1!=0||s<0)throw new RangeError("offset is not uint");if(s+a>d)throw new RangeError("Trying to access beyond buffer length")}function z(s,a,d,T,B,H){if(!p.isBuffer(s))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>B||a<H)throw new RangeError('"value" argument is out of bounds');if(d+T>s.length)throw new RangeError("Index out of range")}function L(s,a,d,T,B,H){if(d+T>s.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("Index out of range")}function G(s,a,d,T,B){return a=+a,d>>>=0,B||L(s,0,d,4),_.write(s,a,d,T,23,4),d+4}function Y(s,a,d,T,B){return a=+a,d>>>=0,B||L(s,0,d,8),_.write(s,a,d,T,52,8),d+8}p.prototype.slice=function(s,a){var d=this.length;(s=~~s)<0?(s+=d)<0&&(s=0):s>d&&(s=d),(a=void 0===a?d:~~a)<0?(a+=d)<0&&(a=0):a>d&&(a=d),a<s&&(a=s);var T=this.subarray(s,a);return T.__proto__=p.prototype,T},p.prototype.readUIntLE=function(s,a,d){s>>>=0,a>>>=0,d||ee(s,a,this.length);for(var T=this[s],B=1,H=0;++H<a&&(B*=256);)T+=this[s+H]*B;return T},p.prototype.readUIntBE=function(s,a,d){s>>>=0,a>>>=0,d||ee(s,a,this.length);for(var T=this[s+--a],B=1;a>0&&(B*=256);)T+=this[s+--a]*B;return T},p.prototype.readUInt8=function(s,a){return s>>>=0,a||ee(s,1,this.length),this[s]},p.prototype.readUInt16LE=function(s,a){return s>>>=0,a||ee(s,2,this.length),this[s]|this[s+1]<<8},p.prototype.readUInt16BE=function(s,a){return s>>>=0,a||ee(s,2,this.length),this[s]<<8|this[s+1]},p.prototype.readUInt32LE=function(s,a){return s>>>=0,a||ee(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+16777216*this[s+3]},p.prototype.readUInt32BE=function(s,a){return s>>>=0,a||ee(s,4,this.length),16777216*this[s]+(this[s+1]<<16|this[s+2]<<8|this[s+3])},p.prototype.readIntLE=function(s,a,d){s>>>=0,a>>>=0,d||ee(s,a,this.length);for(var T=this[s],B=1,H=0;++H<a&&(B*=256);)T+=this[s+H]*B;return T>=(B*=128)&&(T-=Math.pow(2,8*a)),T},p.prototype.readIntBE=function(s,a,d){s>>>=0,a>>>=0,d||ee(s,a,this.length);for(var T=a,B=1,H=this[s+--T];T>0&&(B*=256);)H+=this[s+--T]*B;return H>=(B*=128)&&(H-=Math.pow(2,8*a)),H},p.prototype.readInt8=function(s,a){return s>>>=0,a||ee(s,1,this.length),128&this[s]?-1*(255-this[s]+1):this[s]},p.prototype.readInt16LE=function(s,a){s>>>=0,a||ee(s,2,this.length);var d=this[s]|this[s+1]<<8;return 32768&d?4294901760|d:d},p.prototype.readInt16BE=function(s,a){s>>>=0,a||ee(s,2,this.length);var d=this[s+1]|this[s]<<8;return 32768&d?4294901760|d:d},p.prototype.readInt32LE=function(s,a){return s>>>=0,a||ee(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},p.prototype.readInt32BE=function(s,a){return s>>>=0,a||ee(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},p.prototype.readFloatLE=function(s,a){return s>>>=0,a||ee(s,4,this.length),_.read(this,s,!0,23,4)},p.prototype.readFloatBE=function(s,a){return s>>>=0,a||ee(s,4,this.length),_.read(this,s,!1,23,4)},p.prototype.readDoubleLE=function(s,a){return s>>>=0,a||ee(s,8,this.length),_.read(this,s,!0,52,8)},p.prototype.readDoubleBE=function(s,a){return s>>>=0,a||ee(s,8,this.length),_.read(this,s,!1,52,8)},p.prototype.writeUIntLE=function(s,a,d,T){s=+s,a>>>=0,d>>>=0,T||z(this,s,a,d,Math.pow(2,8*d)-1,0);var B=1,H=0;for(this[a]=255&s;++H<d&&(B*=256);)this[a+H]=s/B&255;return a+d},p.prototype.writeUIntBE=function(s,a,d,T){s=+s,a>>>=0,d>>>=0,T||z(this,s,a,d,Math.pow(2,8*d)-1,0);var B=d-1,H=1;for(this[a+B]=255&s;--B>=0&&(H*=256);)this[a+B]=s/H&255;return a+d},p.prototype.writeUInt8=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,1,255,0),this[a]=255&s,a+1},p.prototype.writeUInt16LE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,2,65535,0),this[a]=255&s,this[a+1]=s>>>8,a+2},p.prototype.writeUInt16BE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,2,65535,0),this[a]=s>>>8,this[a+1]=255&s,a+2},p.prototype.writeUInt32LE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,4,4294967295,0),this[a+3]=s>>>24,this[a+2]=s>>>16,this[a+1]=s>>>8,this[a]=255&s,a+4},p.prototype.writeUInt32BE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,4,4294967295,0),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=255&s,a+4},p.prototype.writeIntLE=function(s,a,d,T){if(s=+s,a>>>=0,!T){var B=Math.pow(2,8*d-1);z(this,s,a,d,B-1,-B)}var H=0,K=1,ae=0;for(this[a]=255&s;++H<d&&(K*=256);)s<0&&0===ae&&0!==this[a+H-1]&&(ae=1),this[a+H]=(s/K>>0)-ae&255;return a+d},p.prototype.writeIntBE=function(s,a,d,T){if(s=+s,a>>>=0,!T){var B=Math.pow(2,8*d-1);z(this,s,a,d,B-1,-B)}var H=d-1,K=1,ae=0;for(this[a+H]=255&s;--H>=0&&(K*=256);)s<0&&0===ae&&0!==this[a+H+1]&&(ae=1),this[a+H]=(s/K>>0)-ae&255;return a+d},p.prototype.writeInt8=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,1,127,-128),s<0&&(s=255+s+1),this[a]=255&s,a+1},p.prototype.writeInt16LE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,2,32767,-32768),this[a]=255&s,this[a+1]=s>>>8,a+2},p.prototype.writeInt16BE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,2,32767,-32768),this[a]=s>>>8,this[a+1]=255&s,a+2},p.prototype.writeInt32LE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,4,2147483647,-2147483648),this[a]=255&s,this[a+1]=s>>>8,this[a+2]=s>>>16,this[a+3]=s>>>24,a+4},p.prototype.writeInt32BE=function(s,a,d){return s=+s,a>>>=0,d||z(this,s,a,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=255&s,a+4},p.prototype.writeFloatLE=function(s,a,d){return G(this,s,a,!0,d)},p.prototype.writeFloatBE=function(s,a,d){return G(this,s,a,!1,d)},p.prototype.writeDoubleLE=function(s,a,d){return Y(this,s,a,!0,d)},p.prototype.writeDoubleBE=function(s,a,d){return Y(this,s,a,!1,d)},p.prototype.copy=function(s,a,d,T){if(!p.isBuffer(s))throw new TypeError("argument should be a Buffer");if(d||(d=0),T||0===T||(T=this.length),a>=s.length&&(a=s.length),a||(a=0),T>0&&T<d&&(T=d),T===d||0===s.length||0===this.length)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("sourceEnd out of bounds");T>this.length&&(T=this.length),s.length-a<T-d&&(T=s.length-a+d);var B=T-d;if(this===s&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(a,d,T);else if(this===s&&d<a&&a<T)for(var H=B-1;H>=0;--H)s[H+a]=this[H+d];else Uint8Array.prototype.set.call(s,this.subarray(d,T),a);return B},p.prototype.fill=function(s,a,d,T){if("string"==typeof s){if("string"==typeof a?(T=a,a=0,d=this.length):"string"==typeof d&&(T=d,d=this.length),void 0!==T&&"string"!=typeof T)throw new TypeError("encoding must be a string");if("string"==typeof T&&!p.isEncoding(T))throw new TypeError("Unknown encoding: "+T);if(1===s.length){var B=s.charCodeAt(0);("utf8"===T&&B<128||"latin1"===T)&&(s=B)}}else"number"==typeof s&&(s&=255);if(a<0||this.length<a||this.length<d)throw new RangeError("Out of range index");if(d<=a)return this;var H;if(a>>>=0,d=void 0===d?this.length:d>>>0,s||(s=0),"number"==typeof s)for(H=a;H<d;++H)this[H]=s;else{var K=p.isBuffer(s)?s:p.from(s,T),ae=K.length;if(0===ae)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(H=0;H<d-a;++H)this[H+a]=K[H%ae]}return this};var m=/[^+/0-9A-Za-z-_]/g;function C(s){return s<16?"0"+s.toString(16):s.toString(16)}function F(s,a){var d;a=a||1/0;for(var T=s.length,B=null,H=[],K=0;K<T;++K){if((d=s.charCodeAt(K))>55295&&d<57344){if(!B){if(d>56319){(a-=3)>-1&&H.push(239,191,189);continue}if(K+1===T){(a-=3)>-1&&H.push(239,191,189);continue}B=d;continue}if(d<56320){(a-=3)>-1&&H.push(239,191,189),B=d;continue}d=65536+(B-55296<<10|d-56320)}else B&&(a-=3)>-1&&H.push(239,191,189);if(B=null,d<128){if((a-=1)<0)break;H.push(d)}else if(d<2048){if((a-=2)<0)break;H.push(d>>6|192,63&d|128)}else if(d<65536){if((a-=3)<0)break;H.push(d>>12|224,d>>6&63|128,63&d|128)}else{if(!(d<1114112))throw new Error("Invalid code point");if((a-=4)<0)break;H.push(d>>18|240,d>>12&63|128,d>>6&63|128,63&d|128)}}return H}function U(s){return v.toByteArray(function(a){if((a=(a=a.split("=")[0]).trim().replace(m,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}(s))}function $(s,a,d,T){for(var B=0;B<T&&!(B+d>=a.length||B>=s.length);++B)a[B+d]=s[B];return B}function te(s,a){return s instanceof a||null!=s&&null!=s.constructor&&null!=s.constructor.name&&s.constructor.name===a.name}function X(s){return s!=s}}).call(this,S("buffer").Buffer)},{"base64-js":10,buffer:12,ieee754:28}],13:[function(S,e,J){(function(O){function v(_){return Object.prototype.toString.call(_)}J.isArray=function(_){return Array.isArray?Array.isArray(_):"[object Array]"===v(_)},J.isBoolean=function(_){return"boolean"==typeof _},J.isNull=function(_){return null===_},J.isNullOrUndefined=function(_){return null==_},J.isNumber=function(_){return"number"==typeof _},J.isString=function(_){return"string"==typeof _},J.isSymbol=function(_){return"symbol"==typeof _},J.isUndefined=function(_){return void 0===_},J.isRegExp=function(_){return"[object RegExp]"===v(_)},J.isObject=function(_){return"object"==typeof _&&null!==_},J.isDate=function(_){return"[object Date]"===v(_)},J.isError=function(_){return"[object Error]"===v(_)||_ instanceof Error},J.isFunction=function(_){return"function"==typeof _},J.isPrimitive=function(_){return null===_||"boolean"==typeof _||"number"==typeof _||"string"==typeof _||"symbol"==typeof _||void 0===_},J.isBuffer=O.isBuffer}).call(this,{isBuffer:S("../../is-buffer/index.js")})},{"../../is-buffer/index.js":30}],14:[function(S,e,J){(function(O){J.log=function(..._){return"object"==typeof console&&console.log&&console.log(..._)},J.formatArgs=function(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;_.splice(1,0,c,"color: inherit");let h=0,p=0;_[0].replace(/%[a-zA-Z%]/g,b=>{"%%"!==b&&"%c"===b&&(p=++h)}),_.splice(p,0,c)},J.save=function(_){try{_?J.storage.setItem("debug",_):J.storage.removeItem("debug")}catch{}},J.load=function(){let _;try{_=J.storage.getItem("debug")}catch{}return!_&&void 0!==O&&"env"in O&&(_=O.env.DEBUG),_},J.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},J.storage=function(){try{return localStorage}catch{}}(),J.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=S("./common")(J);const{formatters:v}=e.exports;v.j=function(_){try{return JSON.stringify(_)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}}).call(this,S("_process"))},{"./common":15,_process:44}],15:[function(S,e,J){e.exports=function(O){function v(b){let f=0;for(let w=0;w<b.length;w++)f=(f<<5)-f+b.charCodeAt(w),f|=0;return _.colors[Math.abs(f)%_.colors.length]}function _(b){let f;function w(...x){if(!w.enabled)return;const g=w,u=Number(new Date);g.diff=u-(f||u),g.prev=f,g.curr=u,f=u,x[0]=_.coerce(x[0]),"string"!=typeof x[0]&&x.unshift("%O");let R=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(P,D)=>{if("%%"===P)return P;R++;const Z=_.formatters[D];return"function"==typeof Z&&(P=Z.call(g,x[R]),x.splice(R,1),R--),P}),_.formatArgs.call(g,x),(g.log||_.log).apply(g,x)}return w.namespace=b,w.enabled=_.enabled(b),w.useColors=_.useColors(),w.color=v(b),w.destroy=c,w.extend=h,"function"==typeof _.init&&_.init(w),_.instances.push(w),w}function c(){const b=_.instances.indexOf(this);return-1!==b&&(_.instances.splice(b,1),!0)}function h(b,f){const w=_(this.namespace+(void 0===f?":":f)+b);return w.log=this.log,w}function p(b){return b.toString().substring(2,b.toString().length-2).replace(/\.\*\?$/,"*")}return _.debug=_,_.default=_,_.coerce=function(b){return b instanceof Error?b.stack||b.message:b},_.disable=function(){const b=[..._.names.map(p),..._.skips.map(p).map(f=>"-"+f)].join(",");return _.enable(""),b},_.enable=function(b){let f;_.save(b),_.names=[],_.skips=[];const w=("string"==typeof b?b:"").split(/[\s,]+/),x=w.length;for(f=0;f<x;f++)w[f]&&("-"===(b=w[f].replace(/\*/g,".*?"))[0]?_.skips.push(new RegExp("^"+b.substr(1)+"$")):_.names.push(new RegExp("^"+b+"$")));for(f=0;f<_.instances.length;f++){const g=_.instances[f];g.enabled=_.enabled(g.namespace)}},_.enabled=function(b){if("*"===b[b.length-1])return!0;let f,w;for(f=0,w=_.skips.length;f<w;f++)if(_.skips[f].test(b))return!1;for(f=0,w=_.names.length;f<w;f++)if(_.names[f].test(b))return!0;return!1},_.humanize=S("ms"),Object.keys(O).forEach(b=>{_[b]=O[b]}),_.instances=[],_.names=[],_.skips=[],_.formatters={},_.selectColor=v,_.enable(_.load()),_}},{ms:41}],16:[function(S,e,J){(function(O,v){var _=S("readable-stream"),c=S("end-of-stream"),h=S("inherits"),p=S("stream-shift"),b=v.from&&v.from!==Uint8Array.from?v.from([0]):new v([0]),f=function(g,u){g._corked?g.once("uncork",u):u()},w=function(g,u){return function(y){var R;y?(R=g)._autoDestroy&&R.destroy("premature close"===y.message?null:y):u&&!g._ended&&g.end()}},x=function(g,u,y){if(!(this instanceof x))return new x(g,u,y);_.Duplex.call(this,y),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!y||!1!==y.autoDestroy,this._forwardDestroy=!y||!1!==y.destroy,this._forwardEnd=!y||!1!==y.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,g&&this.setWritable(g),u&&this.setReadable(u)};h(x,_.Duplex),x.obj=function(g,u,y){return y||(y={}),y.objectMode=!0,y.highWaterMark=16,new x(g,u,y)},x.prototype.cork=function(){1==++this._corked&&this.emit("cork")},x.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},x.prototype.setWritable=function(g){if(this._unwrite&&this._unwrite(),this.destroyed)g&&g.destroy&&g.destroy();else if(null!==g&&!1!==g){var u=this,y=c(g,{writable:!0,readable:!1},w(this,this._forwardEnd)),R=function(){var P=u._ondrain;u._ondrain=null,P&&P()};this._unwrite&&O.nextTick(R),this._writable=g,this._writable.on("drain",R),this._unwrite=function(){u._writable.removeListener("drain",R),y()},this.uncork()}else this.end()},x.prototype.setReadable=function(g){if(this._unread&&this._unread(),this.destroyed)g&&g.destroy&&g.destroy();else{if(null===g||!1===g)return this.push(null),void this.resume();var u,y=this,R=c(g,{writable:!1,readable:!0},w(this)),P=function(){y._forward()},D=function(){y.push(null)};this._drained=!0,this._readable=g,this._readable2=g._readableState?g:(u=g,new _.Readable({objectMode:!0,highWaterMark:16}).wrap(u)),this._readable2.on("readable",P),this._readable2.on("end",D),this._unread=function(){y._readable2.removeListener("readable",P),y._readable2.removeListener("end",D),R()},this._forward()}},x.prototype._read=function(){this._drained=!0,this._forward()},x.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var g;for(this._forwarding=!0;this._drained&&null!==(g=p(this._readable2));)this.destroyed||(this._drained=this.push(g));this._forwarding=!1}},x.prototype.destroy=function(g){if(!this.destroyed){this.destroyed=!0;var u=this;O.nextTick(function(){u._destroy(g)})}},x.prototype._destroy=function(g){if(g){var u=this._ondrain;this._ondrain=null,u?u(g):this.emit("error",g)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},x.prototype._write=function(g,u,y){return this.destroyed?y():this._corked?f(this,this._write.bind(this,g,u,y)):g===b?this._finish(y):this._writable?void(!1===this._writable.write(g)?this._ondrain=y:y()):y()},x.prototype._finish=function(g){var u=this;this.emit("preend"),f(this,function(){var y,R;R=function(){!1===u._writableState.prefinished&&(u._writableState.prefinished=!0),u.emit("prefinish"),f(u,g)},(y=u._forwardEnd&&u._writable)?y._writableState&&y._writableState.finished?R():y._writableState?y.end(R):(y.end(),R()):R()})},x.prototype.end=function(g,u,y){return"function"==typeof g?this.end(null,null,g):"function"==typeof u?this.end(g,null,u):(this._ended=!0,g&&this.write(g),this._writableState.ending||this.write(b),_.Writable.prototype.end.call(this,y))},e.exports=x}).call(this,S("_process"),S("buffer").Buffer)},{_process:44,buffer:12,"end-of-stream":26,inherits:29,"readable-stream":25,"stream-shift":66}],17:[function(S,e,J){"use strict";var O=S("process-nextick-args"),v=Object.keys||function(u){var y=[];for(var R in u)y.push(R);return y};e.exports=w;var _=Object.create(S("core-util-is"));_.inherits=S("inherits");var c=S("./_stream_readable"),h=S("./_stream_writable");_.inherits(w,c);for(var p=v(h.prototype),b=0;b<p.length;b++){var f=p[b];w.prototype[f]||(w.prototype[f]=h.prototype[f])}function w(u){if(!(this instanceof w))return new w(u);c.call(this,u),h.call(this,u),u&&!1===u.readable&&(this.readable=!1),u&&!1===u.writable&&(this.writable=!1),this.allowHalfOpen=!0,u&&!1===u.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",x)}function x(){this.allowHalfOpen||this._writableState.ended||O.nextTick(g,this)}function g(u){u.end()}Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(w.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(u){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),w.prototype._destroy=function(u,y){this.push(null),this.end(),O.nextTick(y,u)}},{"./_stream_readable":19,"./_stream_writable":21,"core-util-is":13,inherits:29,"process-nextick-args":43}],18:[function(S,e,J){"use strict";e.exports=_;var O=S("./_stream_transform"),v=Object.create(S("core-util-is"));function _(c){if(!(this instanceof _))return new _(c);O.call(this,c)}v.inherits=S("inherits"),v.inherits(_,O),_.prototype._transform=function(c,h,p){p(null,c)}},{"./_stream_transform":20,"core-util-is":13,inherits:29}],19:[function(S,e,J){(function(O,v){"use strict";var _=S("process-nextick-args");e.exports=k;var c,h=S("isarray");k.ReadableState=Z,S("events");var p=function(m,C){return m.listeners(C).length},b=S("./internal/streams/stream"),f=S("safe-buffer").Buffer,w=v.Uint8Array||function(){},x=Object.create(S("core-util-is"));x.inherits=S("inherits");var g=S("util"),u=void 0;u=g&&g.debuglog?g.debuglog("stream"):function(){};var y,R=S("./internal/streams/BufferList"),P=S("./internal/streams/destroy");x.inherits(k,b);var D=["error","close","destroy","pause","resume"];function Z(m,C){var F=C instanceof(c=c||S("./_stream_duplex"));this.objectMode=!!(m=m||{}).objectMode,F&&(this.objectMode=this.objectMode||!!m.readableObjectMode);var U=m.highWaterMark,$=m.readableHighWaterMark;this.highWaterMark=U||0===U?U:F&&($||0===$)?$:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new R,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=m.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,m.encoding&&(y||(y=S("string_decoder/").StringDecoder),this.decoder=new y(m.encoding),this.encoding=m.encoding)}function k(m){if(c=c||S("./_stream_duplex"),!(this instanceof k))return new k(m);this._readableState=new Z(m,this),this.readable=!0,m&&("function"==typeof m.read&&(this._read=m.read),"function"==typeof m.destroy&&(this._destroy=m.destroy)),b.call(this)}function ne(m,C,F,U,$){var te,s,a,d,T,X=m._readableState;return null===C?(X.reading=!1,function(s,a){if(!a.ended){if(a.decoder){var d=a.decoder.end();d&&d.length&&(a.buffer.push(d),a.length+=a.objectMode?1:d.length)}a.ended=!0,W(s)}}(m,X)):($||(s=X,f.isBuffer(T=a=C)||T instanceof w||"string"==typeof a||void 0===a||s.objectMode||(d=new TypeError("Invalid non-string/buffer chunk")),te=d),te?m.emit("error",te):X.objectMode||C&&C.length>0?("string"==typeof C||X.objectMode||Object.getPrototypeOf(C)===f.prototype||(C=function(s){return f.from(s)}(C)),U?X.endEmitted?m.emit("error",new Error("stream.unshift() after end event")):A(m,X,C,!0):X.ended?m.emit("error",new Error("stream.push() after EOF")):(X.reading=!1,X.decoder&&!F?(C=X.decoder.write(C),X.objectMode||0!==C.length?A(m,X,C,!1):j(m,X)):A(m,X,C,!1))):U||(X.reading=!1)),function(s){return!s.ended&&(s.needReadable||s.length<s.highWaterMark||0===s.length)}(X)}function A(m,C,F,U){C.flowing&&0===C.length&&!C.sync?(m.emit("data",F),m.read(0)):(C.length+=C.objectMode?1:F.length,U?C.buffer.unshift(F):C.buffer.push(F),C.needReadable&&W(m)),j(m,C)}Object.defineProperty(k.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(m){this._readableState&&(this._readableState.destroyed=m)}}),k.prototype.destroy=P.destroy,k.prototype._undestroy=P.undestroy,k.prototype._destroy=function(m,C){this.push(null),C(m)},k.prototype.push=function(m,C){var F,U=this._readableState;return U.objectMode?F=!0:"string"==typeof m&&((C=C||U.defaultEncoding)!==U.encoding&&(m=f.from(m,C),C=""),F=!0),ne(this,m,C,!1,F)},k.prototype.unshift=function(m){return ne(this,m,null,!0,!1)},k.prototype.isPaused=function(){return!1===this._readableState.flowing},k.prototype.setEncoding=function(m){return y||(y=S("string_decoder/").StringDecoder),this._readableState.decoder=new y(m),this._readableState.encoding=m,this};var I=8388608;function N(m,C){return m<=0||0===C.length&&C.ended?0:C.objectMode?1:m!=m?C.flowing&&C.length?C.buffer.head.data.length:C.length:(m>C.highWaterMark&&(C.highWaterMark=((F=m)>=I?F=I:(F--,F|=F>>>1,F|=F>>>2,F|=F>>>4,F|=F>>>8,F|=F>>>16,F++),F)),m<=C.length?m:C.ended?C.length:(C.needReadable=!0,0));var F}function W(m){var C=m._readableState;C.needReadable=!1,C.emittedReadable||(u("emitReadable",C.flowing),C.emittedReadable=!0,C.sync?_.nextTick(M,m):M(m))}function M(m){u("emit readable"),m.emit("readable"),ee(m)}function j(m,C){C.readingMore||(C.readingMore=!0,_.nextTick(q,m,C))}function q(m,C){for(var F=C.length;!C.reading&&!C.flowing&&!C.ended&&C.length<C.highWaterMark&&(u("maybeReadMore read 0"),m.read(0),F!==C.length);)F=C.length;C.readingMore=!1}function oe(m){u("readable nexttick read 0"),m.read(0)}function ie(m,C){C.reading||(u("resume read 0"),m.read(0)),C.resumeScheduled=!1,C.awaitDrain=0,m.emit("resume"),ee(m),C.flowing&&!C.reading&&m.read(0)}function ee(m){var C=m._readableState;for(u("flow",C.flowing);C.flowing&&null!==m.read(););}function z(m,C){return 0===C.length?null:(C.objectMode?F=C.buffer.shift():!m||m>=C.length?(F=C.decoder?C.buffer.join(""):1===C.buffer.length?C.buffer.head.data:C.buffer.concat(C.length),C.buffer.clear()):(te=C.decoder,(U=m)<($=C.buffer).head.data.length?(X=$.head.data.slice(0,U),$.head.data=$.head.data.slice(U)):X=U===$.head.data.length?$.shift():te?function(s,a){var d=a.head,T=1,B=d.data;for(s-=B.length;d=d.next;){var H=d.data,K=s>H.length?H.length:s;if(B+=K===H.length?H:H.slice(0,s),0==(s-=K)){K===H.length?(++T,a.head=d.next?d.next:a.tail=null):(a.head=d,d.data=H.slice(K));break}++T}return a.length-=T,B}(U,$):function(s,a){var d=f.allocUnsafe(s),T=a.head,B=1;for(T.data.copy(d),s-=T.data.length;T=T.next;){var H=T.data,K=s>H.length?H.length:s;if(H.copy(d,d.length-s,0,K),0==(s-=K)){K===H.length?(++B,a.head=T.next?T.next:a.tail=null):(a.head=T,T.data=H.slice(K));break}++B}return a.length-=B,d}(U,$),F=X),F);var U,$,te,X,F}function L(m){var C=m._readableState;if(C.length>0)throw new Error('"endReadable()" called on non-empty stream');C.endEmitted||(C.ended=!0,_.nextTick(G,C,m))}function G(m,C){m.endEmitted||0!==m.length||(m.endEmitted=!0,C.readable=!1,C.emit("end"))}function Y(m,C){for(var F=0,U=m.length;F<U;F++)if(m[F]===C)return F;return-1}k.prototype.read=function(m){u("read",m),m=parseInt(m,10);var C=this._readableState,F=m;if(0!==m&&(C.emittedReadable=!1),0===m&&C.needReadable&&(C.length>=C.highWaterMark||C.ended))return u("read: emitReadable",C.length,C.ended),0===C.length&&C.ended?L(this):W(this),null;if(0===(m=N(m,C))&&C.ended)return 0===C.length&&L(this),null;var U,$=C.needReadable;return u("need readable",$),(0===C.length||C.length-m<C.highWaterMark)&&u("length less than watermark",$=!0),C.ended||C.reading?u("reading or ended",$=!1):$&&(u("do read"),C.reading=!0,C.sync=!0,0===C.length&&(C.needReadable=!0),this._read(C.highWaterMark),C.sync=!1,C.reading||(m=N(F,C))),null===(U=m>0?z(m,C):null)?(C.needReadable=!0,m=0):C.length-=m,0===C.length&&(C.ended||(C.needReadable=!0),F!==m&&C.ended&&L(this)),null!==U&&this.emit("data",U),U},k.prototype._read=function(m){this.emit("error",new Error("_read() is not implemented"))},k.prototype.pipe=function(m,C){var F=this,U=this._readableState;switch(U.pipesCount){case 0:U.pipes=m;break;case 1:U.pipes=[U.pipes,m];break;default:U.pipes.push(m)}U.pipesCount+=1,u("pipe count=%d opts=%j",U.pipesCount,C);var $=C&&!1===C.end||m===O.stdout||m===O.stderr?ae:X;function X(){u("onend"),m.end()}U.endEmitted?_.nextTick($):F.once("end",$),m.on("unpipe",function te(re,he){u("onunpipe"),re===F&&he&&!1===he.hasUnpiped&&(he.hasUnpiped=!0,u("cleanup"),m.removeListener("close",H),m.removeListener("finish",K),m.removeListener("drain",s),m.removeListener("error",B),m.removeListener("unpipe",te),F.removeListener("end",X),F.removeListener("end",ae),F.removeListener("data",T),a=!0,!U.awaitDrain||m._writableState&&!m._writableState.needDrain||s())});var re,s=(re=F,function(){var he=re._readableState;u("pipeOnDrain",he.awaitDrain),he.awaitDrain&&he.awaitDrain--,0===he.awaitDrain&&p(re,"data")&&(he.flowing=!0,ee(re))});m.on("drain",s);var a=!1,d=!1;function T(re){u("ondata"),d=!1,!1!==m.write(re)||d||((1===U.pipesCount&&U.pipes===m||U.pipesCount>1&&-1!==Y(U.pipes,m))&&!a&&(u("false write response, pause",F._readableState.awaitDrain),F._readableState.awaitDrain++,d=!0),F.pause())}function B(re){u("onerror",re),ae(),m.removeListener("error",B),0===p(m,"error")&&m.emit("error",re)}function H(){m.removeListener("finish",K),ae()}function K(){u("onfinish"),m.removeListener("close",H),ae()}function ae(){u("unpipe"),F.unpipe(m)}return F.on("data",T),function(re,he,pe){if("function"==typeof re.prependListener)return re.prependListener(he,pe);re._events&&re._events[he]?h(re._events[he])?re._events[he].unshift(pe):re._events[he]=[pe,re._events[he]]:re.on(he,pe)}(m,"error",B),m.once("close",H),m.once("finish",K),m.emit("pipe",F),U.flowing||(u("pipe resume"),F.resume()),m},k.prototype.unpipe=function(m){var C=this._readableState,F={hasUnpiped:!1};if(0===C.pipesCount)return this;if(1===C.pipesCount)return m&&m!==C.pipes||(m||(m=C.pipes),C.pipes=null,C.pipesCount=0,C.flowing=!1,m&&m.emit("unpipe",this,F)),this;if(!m){var U=C.pipes,$=C.pipesCount;C.pipes=null,C.pipesCount=0,C.flowing=!1;for(var te=0;te<$;te++)U[te].emit("unpipe",this,F);return this}var X=Y(C.pipes,m);return-1===X||(C.pipes.splice(X,1),C.pipesCount-=1,1===C.pipesCount&&(C.pipes=C.pipes[0]),m.emit("unpipe",this,F)),this},k.prototype.addListener=k.prototype.on=function(m,C){var F=b.prototype.on.call(this,m,C);if("data"===m)!1!==this._readableState.flowing&&this.resume();else if("readable"===m){var U=this._readableState;U.endEmitted||U.readableListening||(U.readableListening=U.needReadable=!0,U.emittedReadable=!1,U.reading?U.length&&W(this):_.nextTick(oe,this))}return F},k.prototype.resume=function(){var F,m=this._readableState;return m.flowing||(u("resume"),m.flowing=!0,this,(F=m).resumeScheduled||(F.resumeScheduled=!0,_.nextTick(ie,this,F))),this},k.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this},k.prototype.wrap=function(m){var C=this,F=this._readableState,U=!1;for(var $ in m.on("end",function(){if(u("wrapped end"),F.decoder&&!F.ended){var X=F.decoder.end();X&&X.length&&C.push(X)}C.push(null)}),m.on("data",function(X){u("wrapped data"),F.decoder&&(X=F.decoder.write(X)),(!F.objectMode||null!=X)&&(F.objectMode||X&&X.length)&&(C.push(X)||(U=!0,m.pause()))}),m)void 0===this[$]&&"function"==typeof m[$]&&(this[$]=function(X){return function(){return m[X].apply(m,arguments)}}($));for(var te=0;te<D.length;te++)m.on(D[te],this.emit.bind(this,D[te]));return this._read=function(X){u("wrapped _read",X),U&&(U=!1,m.resume())},this},Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),k._fromList=z}).call(this,S("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":17,"./internal/streams/BufferList":22,"./internal/streams/destroy":23,"./internal/streams/stream":24,_process:44,"core-util-is":13,events:27,inherits:29,isarray:31,"process-nextick-args":43,"safe-buffer":65,"string_decoder/":67,util:11}],20:[function(S,e,J){"use strict";e.exports=_;var O=S("./_stream_duplex"),v=Object.create(S("core-util-is"));function _(p){if(!(this instanceof _))return new _(p);O.call(this,p),this._transformState={afterTransform:function(b,f){var w=this._transformState;w.transforming=!1;var x=w.writecb;if(!x)return this.emit("error",new Error("write callback called multiple times"));w.writechunk=null,w.writecb=null,null!=f&&this.push(f),x(b);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&("function"==typeof p.transform&&(this._transform=p.transform),"function"==typeof p.flush&&(this._flush=p.flush)),this.on("prefinish",c)}function c(){var p=this;"function"==typeof this._flush?this._flush(function(b,f){h(p,b,f)}):h(this,null,null)}function h(p,b,f){if(b)return p.emit("error",b);if(null!=f&&p.push(f),p._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(p._transformState.transforming)throw new Error("Calling transform done when still transforming");return p.push(null)}v.inherits=S("inherits"),v.inherits(_,O),_.prototype.push=function(p,b){return this._transformState.needTransform=!1,O.prototype.push.call(this,p,b)},_.prototype._transform=function(p,b,f){throw new Error("_transform() is not implemented")},_.prototype._write=function(p,b,f){var w=this._transformState;if(w.writecb=f,w.writechunk=p,w.writeencoding=b,!w.transforming){var x=this._readableState;(w.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},_.prototype._read=function(p){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0},_.prototype._destroy=function(p,b){var f=this;O.prototype._destroy.call(this,p,function(w){b(w),f.emit("close")})}},{"./_stream_duplex":17,"core-util-is":13,inherits:29}],21:[function(S,e,J){(function(O,v,_){"use strict";var c=S("process-nextick-args");function h(M){var j=this;this.next=null,this.entry=null,this.finish=function(){!function(q,oe,ie){var ee=q.entry;for(q.entry=null;ee;){var z=ee.callback;oe.pendingcb--,z(undefined),ee=ee.next}oe.corkedRequestsFree?oe.corkedRequestsFree.next=q:oe.corkedRequestsFree=q}(j,M)}}e.exports=Z;var p,b=!O.browser&&["v0.10","v0.9."].indexOf(O.version.slice(0,5))>-1?_:c.nextTick;Z.WritableState=D;var f=Object.create(S("core-util-is"));f.inherits=S("inherits");var y,w={deprecate:S("util-deprecate")},x=S("./internal/streams/stream"),g=S("safe-buffer").Buffer,u=v.Uint8Array||function(){},R=S("./internal/streams/destroy");function P(){}function D(M,j){p=p||S("./_stream_duplex");var q=j instanceof p;this.objectMode=!!(M=M||{}).objectMode,q&&(this.objectMode=this.objectMode||!!M.writableObjectMode);var oe=M.highWaterMark,ie=M.writableHighWaterMark;this.highWaterMark=oe||0===oe?oe:q&&(ie||0===ie)?ie:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===M.decodeStrings),this.defaultEncoding=M.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(L){!function(G,Y){var $,m=G._writableState,C=m.sync,F=m.writecb;if(($=m).writing=!1,$.writecb=null,$.length-=$.writelen,$.writelen=0,Y)!function($,te,X,s,a){--te.pendingcb,X?(c.nextTick(a,s),c.nextTick(W,$,te),$._writableState.errorEmitted=!0,$.emit("error",s)):(a(s),$._writableState.errorEmitted=!0,$.emit("error",s),W($,te))}(G,m,C,Y,F);else{var U=I(m);U||m.corked||m.bufferProcessing||!m.bufferedRequest||A(G,m),C?b(ne,G,m,U,F):ne(G,m,U,F)}}(j,L)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function Z(M){if(p=p||S("./_stream_duplex"),!(y.call(Z,this)||this instanceof p))return new Z(M);this._writableState=new D(M,this),this.writable=!0,M&&("function"==typeof M.write&&(this._write=M.write),"function"==typeof M.writev&&(this._writev=M.writev),"function"==typeof M.destroy&&(this._destroy=M.destroy),"function"==typeof M.final&&(this._final=M.final)),x.call(this)}function k(M,j,q,oe,ie,ee,z){j.writelen=oe,j.writecb=z,j.writing=!0,j.sync=!0,q?M._writev(ie,j.onwrite):M._write(ie,ee,j.onwrite),j.sync=!1}function ne(M,j,q,oe){var ie,ee;q||(ie=M,0===(ee=j).length&&ee.needDrain&&(ee.needDrain=!1,ie.emit("drain"))),j.pendingcb--,oe(),W(M,j)}function A(M,j){j.bufferProcessing=!0;var q=j.bufferedRequest;if(M._writev&&q&&q.next){var ie=new Array(j.bufferedRequestCount),ee=j.corkedRequestsFree;ee.entry=q;for(var z=0,L=!0;q;)ie[z]=q,q.isBuf||(L=!1),q=q.next,z+=1;ie.allBuffers=L,k(M,j,!0,j.length,ie,"",ee.finish),j.pendingcb++,j.lastBufferedRequest=null,ee.next?(j.corkedRequestsFree=ee.next,ee.next=null):j.corkedRequestsFree=new h(j),j.bufferedRequestCount=0}else{for(;q;){var G=q.chunk;if(k(M,j,!1,j.objectMode?1:G.length,G,q.encoding,q.callback),q=q.next,j.bufferedRequestCount--,j.writing)break}null===q&&(j.lastBufferedRequest=null)}j.bufferedRequest=q,j.bufferProcessing=!1}function I(M){return M.ending&&0===M.length&&null===M.bufferedRequest&&!M.finished&&!M.writing}function N(M,j){M._final(function(q){j.pendingcb--,q&&M.emit("error",q),j.prefinished=!0,M.emit("prefinish"),W(M,j)})}function W(M,j){var oe,ie,q=I(j);return q&&(oe=M,(ie=j).prefinished||ie.finalCalled||("function"==typeof oe._final?(ie.pendingcb++,ie.finalCalled=!0,c.nextTick(N,oe,ie)):(ie.prefinished=!0,oe.emit("prefinish"))),0===j.pendingcb&&(j.finished=!0,M.emit("finish"))),q}f.inherits(Z,x),D.prototype.getBuffer=function(){for(var M=this.bufferedRequest,j=[];M;)j.push(M),M=M.next;return j},function(){try{Object.defineProperty(D.prototype,"buffer",{get:w.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(y=Function.prototype[Symbol.hasInstance],Object.defineProperty(Z,Symbol.hasInstance,{value:function(M){return!!y.call(this,M)||this===Z&&M&&M._writableState instanceof D}})):y=function(M){return M instanceof this},Z.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Z.prototype.write=function(M,j,q){var oe,L,G,Y,ie=this._writableState,ee=!1,z=!ie.objectMode&&(g.isBuffer(oe=M)||oe instanceof u);return z&&!g.isBuffer(M)&&(M=g.from(M)),"function"==typeof j&&(q=j,j=null),z?j="buffer":j||(j=ie.defaultEncoding),"function"!=typeof q&&(q=P),ie.ended?(L=this,G=q,Y=new Error("write after end"),L.emit("error",Y),c.nextTick(G,Y)):(z||function(L,G,Y,m){var C=!0,F=!1;return null===Y?F=new TypeError("May not write null values to stream"):"string"==typeof Y||void 0===Y||G.objectMode||(F=new TypeError("Invalid non-string/buffer chunk")),F&&(L.emit("error",F),c.nextTick(m,F),C=!1),C}(this,ie,M,q))&&(ie.pendingcb++,ee=function(L,G,Y,m,C,F){if(!Y){var U=(a=m,(s=G).objectMode||!1===s.decodeStrings||"string"!=typeof a||(a=g.from(a,C)),a);m!==U&&(Y=!0,C="buffer",m=U)}var s,a,$=G.objectMode?1:m.length;G.length+=$;var te=G.length<G.highWaterMark;if(te||(G.needDrain=!0),G.writing||G.corked){var X=G.lastBufferedRequest;G.lastBufferedRequest={chunk:m,encoding:C,isBuf:Y,callback:F,next:null},X?X.next=G.lastBufferedRequest:G.bufferedRequest=G.lastBufferedRequest,G.bufferedRequestCount+=1}else k(L,G,!1,$,m,C,F);return te}(this,ie,z,M,j,q)),ee},Z.prototype.cork=function(){this._writableState.corked++},Z.prototype.uncork=function(){var M=this._writableState;M.corked&&(M.corked--,M.writing||M.corked||M.finished||M.bufferProcessing||!M.bufferedRequest||A(this,M))},Z.prototype.setDefaultEncoding=function(M){if("string"==typeof M&&(M=M.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((M+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+M);return this._writableState.defaultEncoding=M,this},Object.defineProperty(Z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Z.prototype._write=function(M,j,q){q(new Error("_write() is not implemented"))},Z.prototype._writev=null,Z.prototype.end=function(M,j,q){var ee,z,oe=this._writableState;"function"==typeof M?(q=M,M=null,j=null):"function"==typeof j&&(q=j,j=null),null!=M&&this.write(M,j),oe.corked&&(oe.corked=1,this.uncork()),oe.ending||oe.finished||(this,z=q,(ee=oe).ending=!0,W(this,ee),z&&(ee.finished?c.nextTick(z):this.once("finish",z)),ee.ended=!0,this.writable=!1)},Object.defineProperty(Z.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(M){this._writableState&&(this._writableState.destroyed=M)}}),Z.prototype.destroy=R.destroy,Z.prototype._undestroy=R.undestroy,Z.prototype._destroy=function(M,j){this.end(),j(M)}}).call(this,S("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},S("timers").setImmediate)},{"./_stream_duplex":17,"./internal/streams/destroy":23,"./internal/streams/stream":24,_process:44,"core-util-is":13,inherits:29,"process-nextick-args":43,"safe-buffer":65,timers:68,"util-deprecate":71}],22:[function(S,e,J){"use strict";var O=S("safe-buffer").Buffer,v=S("util");e.exports=function(){function _(){(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,_),this.head=null,this.tail=null,this.length=0}return _.prototype.push=function(c){var h={data:c,next:null};this.length>0?this.tail.next=h:this.head=h,this.tail=h,++this.length},_.prototype.unshift=function(c){var h={data:c,next:this.head};0===this.length&&(this.tail=h),this.head=h,++this.length},_.prototype.shift=function(){if(0!==this.length){var c=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,c}},_.prototype.clear=function(){this.head=this.tail=null,this.length=0},_.prototype.join=function(c){if(0===this.length)return"";for(var h=this.head,p=""+h.data;h=h.next;)p+=c+h.data;return p},_.prototype.concat=function(c){if(0===this.length)return O.alloc(0);if(1===this.length)return this.head.data;for(var f=O.allocUnsafe(c>>>0),w=this.head,x=0;w;)w.data.copy(f,x),x+=w.data.length,w=w.next;return f},_}(),v&&v.inspect&&v.inspect.custom&&(e.exports.prototype[v.inspect.custom]=function(){var _=v.inspect({length:this.length});return this.constructor.name+" "+_})},{"safe-buffer":65,util:11}],23:[function(S,e,J){"use strict";var O=S("process-nextick-args");function v(_,c){_.emit("error",c)}e.exports={destroy:function(_,c){var h=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(c?c(_):!_||this._writableState&&this._writableState.errorEmitted||O.nextTick(v,this,_),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(_||null,function(f){!c&&f?(O.nextTick(v,h,f),h._writableState&&(h._writableState.errorEmitted=!0)):c&&c(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":43}],24:[function(S,e,J){e.exports=S("events").EventEmitter},{events:27}],25:[function(S,e,J){(J=e.exports=S("./lib/_stream_readable.js")).Stream=J,J.Readable=J,J.Writable=S("./lib/_stream_writable.js"),J.Duplex=S("./lib/_stream_duplex.js"),J.Transform=S("./lib/_stream_transform.js"),J.PassThrough=S("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":17,"./lib/_stream_passthrough.js":18,"./lib/_stream_readable.js":19,"./lib/_stream_transform.js":20,"./lib/_stream_writable.js":21}],26:[function(S,e,J){(function(O){var v=S("once"),_=function(){},c=function(h,p,b){if("function"==typeof p)return c(h,null,p);p||(p={}),b=v(b||_);var I,f=h._writableState,w=h._readableState,x=p.readable||!1!==p.readable&&h.readable,g=p.writable||!1!==p.writable&&h.writable,u=!1,y=function(){h.writable||R()},R=function(){g=!1,x||b.call(h)},P=function(){x=!1,g||b.call(h)},D=function(I){b.call(h,I?new Error("exited with error code: "+I):null)},Z=function(I){b.call(h,I)},k=function(){O.nextTick(ne)},ne=function(){if(!u)return(!x||w&&w.ended&&!w.destroyed)&&(!g||f&&f.ended&&!f.destroyed)?void 0:b.call(h,new Error("premature close"))},A=function(){h.req.on("finish",R)};return(I=h).setHeader&&"function"==typeof I.abort?(h.on("complete",R),h.on("abort",k),h.req?A():h.on("request",A)):g&&!f&&(h.on("end",y),h.on("close",y)),function(I){return I.stdio&&Array.isArray(I.stdio)&&3===I.stdio.length}(h)&&h.on("exit",D),h.on("end",P),h.on("finish",R),!1!==p.error&&h.on("error",Z),h.on("close",k),function(){u=!0,h.removeListener("complete",R),h.removeListener("abort",k),h.removeListener("request",A),h.req&&h.req.removeListener("finish",R),h.removeListener("end",y),h.removeListener("close",y),h.removeListener("finish",R),h.removeListener("exit",D),h.removeListener("end",P),h.removeListener("error",Z),h.removeListener("close",k)}};e.exports=c}).call(this,S("_process"))},{_process:44,once:42}],27:[function(S,e,J){var O=Object.create||function(P){var D=function(){};return D.prototype=P,new D},v=Object.keys||function(P){var D=[];for(var Z in P)Object.prototype.hasOwnProperty.call(P,Z)&&D.push(Z);return Z},_=Function.prototype.bind||function(P){var D=this;return function(){return D.apply(P,arguments)}};function c(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=O(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0;var h,p=10;try{var b={};Object.defineProperty&&Object.defineProperty(b,"x",{value:0}),h=0===b.x}catch{h=!1}function f(P){return void 0===P._maxListeners?c.defaultMaxListeners:P._maxListeners}function w(P,D,Z,k){var ne,A,I;if("function"!=typeof Z)throw new TypeError('"listener" argument must be a function');if((A=P._events)?(A.newListener&&(P.emit("newListener",D,Z.listener?Z.listener:Z),A=P._events),I=A[D]):(A=P._events=O(null),P._eventsCount=0),I){if("function"==typeof I?I=A[D]=k?[Z,I]:[I,Z]:k?I.unshift(Z):I.push(Z),!I.warned&&(ne=f(P))&&ne>0&&I.length>ne){I.warned=!0;var N=new Error("Possible EventEmitter memory leak detected. "+I.length+' "'+String(D)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');N.name="MaxListenersExceededWarning",N.emitter=P,N.type=D,N.count=I.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",N.name,N.message)}}else I=A[D]=Z,++P._eventsCount;return P}function x(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var P=new Array(arguments.length),D=0;D<P.length;++D)P[D]=arguments[D];this.listener.apply(this.target,P)}}function g(P,D,Z){var k={fired:!1,wrapFn:void 0,target:P,type:D,listener:Z},ne=_.call(x,k);return ne.listener=Z,k.wrapFn=ne,ne}function u(P,D,Z){var k=P._events;if(!k)return[];var ne=k[D];return ne?"function"==typeof ne?Z?[ne.listener||ne]:[ne]:Z?function(A){for(var I=new Array(A.length),N=0;N<I.length;++N)I[N]=A[N].listener||A[N];return I}(ne):R(ne,ne.length):[]}function y(P){var D=this._events;if(D){var Z=D[P];if("function"==typeof Z)return 1;if(Z)return Z.length}return 0}function R(P,D){for(var Z=new Array(D),k=0;k<D;++k)Z[k]=P[k];return Z}h?Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(P){if("number"!=typeof P||P<0||P!=P)throw new TypeError('"defaultMaxListeners" must be a positive number');p=P}}):c.defaultMaxListeners=p,c.prototype.setMaxListeners=function(P){if("number"!=typeof P||P<0||isNaN(P))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=P,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(P){var D,Z,k,ne,A,I,N="error"===P;if(I=this._events)N=N&&null==I.error;else if(!N)return!1;if(N){if(arguments.length>1&&(D=arguments[1]),D instanceof Error)throw D;var W=new Error('Unhandled "error" event. ('+D+")");throw W.context=D,W}if(!(Z=I[P]))return!1;var M="function"==typeof Z;switch(k=arguments.length){case 1:!function(j,q,oe){if(q)j.call(oe);else for(var ie=j.length,ee=R(j,ie),z=0;z<ie;++z)ee[z].call(oe)}(Z,M,this);break;case 2:!function(j,q,oe,ie){if(q)j.call(oe,ie);else for(var ee=j.length,z=R(j,ee),L=0;L<ee;++L)z[L].call(oe,ie)}(Z,M,this,arguments[1]);break;case 3:!function(j,q,oe,ie,ee){if(q)j.call(oe,ie,ee);else for(var z=j.length,L=R(j,z),G=0;G<z;++G)L[G].call(oe,ie,ee)}(Z,M,this,arguments[1],arguments[2]);break;case 4:!function(j,q,oe,ie,ee,z){if(q)j.call(oe,ie,ee,z);else for(var L=j.length,G=R(j,L),Y=0;Y<L;++Y)G[Y].call(oe,ie,ee,z)}(Z,M,this,arguments[1],arguments[2],arguments[3]);break;default:for(ne=new Array(k-1),A=1;A<k;A++)ne[A-1]=arguments[A];!function(j,q,oe,ie){if(q)j.apply(oe,ie);else for(var ee=j.length,z=R(j,ee),L=0;L<ee;++L)z[L].apply(oe,ie)}(Z,M,this,ne)}return!0},c.prototype.on=c.prototype.addListener=function(P,D){return w(this,P,D,!1)},c.prototype.prependListener=function(P,D){return w(this,P,D,!0)},c.prototype.once=function(P,D){if("function"!=typeof D)throw new TypeError('"listener" argument must be a function');return this.on(P,g(this,P,D)),this},c.prototype.prependOnceListener=function(P,D){if("function"!=typeof D)throw new TypeError('"listener" argument must be a function');return this.prependListener(P,g(this,P,D)),this},c.prototype.removeListener=function(P,D){var Z,k,ne,A,I;if("function"!=typeof D)throw new TypeError('"listener" argument must be a function');if(!(k=this._events))return this;if(!(Z=k[P]))return this;if(Z===D||Z.listener===D)0==--this._eventsCount?this._events=O(null):(delete k[P],k.removeListener&&this.emit("removeListener",P,Z.listener||D));else if("function"!=typeof Z){for(ne=-1,A=Z.length-1;A>=0;A--)if(Z[A]===D||Z[A].listener===D){I=Z[A].listener,ne=A;break}if(ne<0)return this;0===ne?Z.shift():function(N,W){for(var M=W,j=M+1,q=N.length;j<q;M+=1,j+=1)N[M]=N[j];N.pop()}(Z,ne),1===Z.length&&(k[P]=Z[0]),k.removeListener&&this.emit("removeListener",P,I||D)}return this},c.prototype.removeAllListeners=function(P){var D,Z,k;if(!(Z=this._events))return this;if(!Z.removeListener)return 0===arguments.length?(this._events=O(null),this._eventsCount=0):Z[P]&&(0==--this._eventsCount?this._events=O(null):delete Z[P]),this;if(0===arguments.length){var ne,A=v(Z);for(k=0;k<A.length;++k)"removeListener"!==(ne=A[k])&&this.removeAllListeners(ne);return this.removeAllListeners("removeListener"),this._events=O(null),this._eventsCount=0,this}if("function"==typeof(D=Z[P]))this.removeListener(P,D);else if(D)for(k=D.length-1;k>=0;k--)this.removeListener(P,D[k]);return this},c.prototype.listeners=function(P){return u(this,P,!0)},c.prototype.rawListeners=function(P){return u(this,P,!1)},c.listenerCount=function(P,D){return"function"==typeof P.listenerCount?P.listenerCount(D):y.call(P,D)},c.prototype.listenerCount=y,c.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],28:[function(S,e,J){J.read=function(O,v,_,c,h){var p,b,f=8*h-c-1,w=(1<<f)-1,x=w>>1,g=-7,u=_?h-1:0,y=_?-1:1,R=O[v+u];for(u+=y,p=R&(1<<-g)-1,R>>=-g,g+=f;g>0;p=256*p+O[v+u],u+=y,g-=8);for(b=p&(1<<-g)-1,p>>=-g,g+=c;g>0;b=256*b+O[v+u],u+=y,g-=8);if(0===p)p=1-x;else{if(p===w)return b?NaN:1/0*(R?-1:1);b+=Math.pow(2,c),p-=x}return(R?-1:1)*b*Math.pow(2,p-c)},J.write=function(O,v,_,c,h,p){var b,f,w,x=8*p-h-1,g=(1<<x)-1,u=g>>1,y=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,R=c?0:p-1,P=c?1:-1,D=v<0||0===v&&1/v<0?1:0;for(v=Math.abs(v),isNaN(v)||v===1/0?(f=isNaN(v)?1:0,b=g):(b=Math.floor(Math.log(v)/Math.LN2),v*(w=Math.pow(2,-b))<1&&(b--,w*=2),(v+=b+u>=1?y/w:y*Math.pow(2,1-u))*w>=2&&(b++,w/=2),b+u>=g?(f=0,b=g):b+u>=1?(f=(v*w-1)*Math.pow(2,h),b+=u):(f=v*Math.pow(2,u-1)*Math.pow(2,h),b=0));h>=8;O[_+R]=255&f,R+=P,f/=256,h-=8);for(b=b<<h|f,x+=h;x>0;O[_+R]=255&b,R+=P,b/=256,x-=8);O[_+R-P]|=128*D}},{}],29:[function(S,e,J){e.exports="function"==typeof Object.create?function(O,v){v&&(O.super_=v,O.prototype=Object.create(v.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}))}:function(O,v){if(v){O.super_=v;var _=function(){};_.prototype=v.prototype,O.prototype=new _,O.prototype.constructor=O}}},{}],30:[function(S,e,J){function O(v){return!!v.constructor&&"function"==typeof v.constructor.isBuffer&&v.constructor.isBuffer(v)}e.exports=function(v){return null!=v&&(O(v)||"function"==typeof(_=v).readFloatLE&&"function"==typeof _.slice&&O(_.slice(0,0))||!!v._isBuffer);var _}},{}],31:[function(S,e,J){var O={}.toString;e.exports=Array.isArray||function(v){return"[object Array]"==O.call(v)}},{}],32:[function(S,e,J){(function(O){const v=e.exports;v.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},v.codes={};for(const c in v.types)v.codes[v.types[c]]=c;v.CMD_SHIFT=4,v.CMD_MASK=240,v.DUP_MASK=8,v.QOS_MASK=3,v.QOS_SHIFT=1,v.RETAIN_MASK=1,v.VARBYTEINT_MASK=127,v.VARBYTEINT_FIN_MASK=128,v.SESSIONPRESENT_MASK=1,v.SESSIONPRESENT_HEADER=O.from([v.SESSIONPRESENT_MASK]),v.CONNACK_HEADER=O.from([v.codes.connack<<v.CMD_SHIFT]),v.USERNAME_MASK=128,v.PASSWORD_MASK=64,v.WILL_RETAIN_MASK=32,v.WILL_QOS_MASK=24,v.WILL_QOS_SHIFT=3,v.WILL_FLAG_MASK=4,v.CLEAN_SESSION_MASK=2,v.CONNECT_HEADER=O.from([v.codes.connect<<v.CMD_SHIFT]),v.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},v.propertiesCodes={};for(const c in v.properties)v.propertiesCodes[v.properties[c]]=c;function _(c){return[0,1,2].map(h=>[0,1].map(p=>[0,1].map(b=>{const f=O.alloc(1);return f.writeUInt8(v.codes[c]<<v.CMD_SHIFT|(p?v.DUP_MASK:0)|h<<v.QOS_SHIFT|b,0,!0),f})))}v.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},v.PUBLISH_HEADER=_("publish"),v.SUBSCRIBE_HEADER=_("subscribe"),v.SUBSCRIBE_OPTIONS_QOS_MASK=3,v.SUBSCRIBE_OPTIONS_NL_MASK=1,v.SUBSCRIBE_OPTIONS_NL_SHIFT=2,v.SUBSCRIBE_OPTIONS_RAP_MASK=1,v.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,v.SUBSCRIBE_OPTIONS_RH_MASK=3,v.SUBSCRIBE_OPTIONS_RH_SHIFT=4,v.SUBSCRIBE_OPTIONS_RH=[0,16,32],v.SUBSCRIBE_OPTIONS_NL=4,v.SUBSCRIBE_OPTIONS_RAP=8,v.SUBSCRIBE_OPTIONS_QOS=[0,1,2],v.UNSUBSCRIBE_HEADER=_("unsubscribe"),v.ACKS={unsuback:_("unsuback"),puback:_("puback"),pubcomp:_("pubcomp"),pubrel:_("pubrel"),pubrec:_("pubrec")},v.SUBACK_HEADER=O.from([v.codes.suback<<v.CMD_SHIFT]),v.VERSION3=O.from([3]),v.VERSION4=O.from([4]),v.VERSION5=O.from([5]),v.QOS=[0,1,2].map(c=>O.from([c])),v.EMPTY={pingreq:O.from([v.codes.pingreq<<4,0]),pingresp:O.from([v.codes.pingresp<<4,0]),disconnect:O.from([v.codes.disconnect<<4,0])}}).call(this,S("buffer").Buffer)},{buffer:12}],33:[function(S,e,J){(function(O){const v=S("./writeToStream"),_=S("events");class c extends _{constructor(){super(),this._array=new Array(20),this._i=0}write(p){return this._array[this._i++]=p,!0}concat(){let p=0;const b=new Array(this._array.length),f=this._array;let w,x=0;for(w=0;w<f.length&&void 0!==f[w];w++)b[w]="string"!=typeof f[w]?f[w].length:O.byteLength(f[w]),p+=b[w];const g=O.allocUnsafe(p);for(w=0;w<f.length&&void 0!==f[w];w++)"string"!=typeof f[w]?(f[w].copy(g,x),x+=b[w]):(g.write(f[w],x),x+=b[w]);return g}}e.exports=function(h,p){const b=new c;return v(h,b,p),b.concat()}}).call(this,S("buffer").Buffer)},{"./writeToStream":40,buffer:12,events:27}],34:[function(S,e,J){J.parser=S("./parser").parser,J.generate=S("./generate"),J.writeToStream=S("./writeToStream")},{"./generate":33,"./parser":39,"./writeToStream":40}],35:[function(S,e,J){"use strict";const{Buffer:O}=S("buffer"),v=Symbol.for("BufferList");function _(c){if(!(this instanceof _))return new _(c);_._init.call(this,c)}_._init=function(c){Object.defineProperty(this,v,{value:!0}),this._bufs=[],this.length=0,c&&this.append(c)},_.prototype._new=function(c){return new _(c)},_.prototype._offset=function(c){if(0===c)return[0,0];let h=0;for(let p=0;p<this._bufs.length;p++){const b=h+this._bufs[p].length;if(c<b||p===this._bufs.length-1)return[p,c-h];h=b}},_.prototype._reverseOffset=function(c){const h=c[0];let p=c[1];for(let b=0;b<h;b++)p+=this._bufs[b].length;return p},_.prototype.get=function(c){if(c>this.length||c<0)return;const h=this._offset(c);return this._bufs[h[0]][h[1]]},_.prototype.slice=function(c,h){return"number"==typeof c&&c<0&&(c+=this.length),"number"==typeof h&&h<0&&(h+=this.length),this.copy(null,0,c,h)},_.prototype.copy=function(c,h,p,b){if(("number"!=typeof p||p<0)&&(p=0),("number"!=typeof b||b>this.length)&&(b=this.length),p>=this.length||b<=0)return c||O.alloc(0);const f=!!c,w=this._offset(p),x=b-p;let g=x,u=f&&h||0,y=w[1];if(0===p&&b===this.length){if(!f)return 1===this._bufs.length?this._bufs[0]:O.concat(this._bufs,this.length);for(let R=0;R<this._bufs.length;R++)this._bufs[R].copy(c,u),u+=this._bufs[R].length;return c}if(g<=this._bufs[w[0]].length-y)return f?this._bufs[w[0]].copy(c,h,y,y+g):this._bufs[w[0]].slice(y,y+g);f||(c=O.allocUnsafe(x));for(let R=w[0];R<this._bufs.length;R++){const P=this._bufs[R].length-y;if(!(g>P)){this._bufs[R].copy(c,u,y,y+g),u+=P;break}this._bufs[R].copy(c,u,y),u+=P,g-=P,y&&(y=0)}return c.length>u?c.slice(0,u):c},_.prototype.shallowSlice=function(c,h){if((c=c||0)<0&&(c+=this.length),(h="number"!=typeof h?this.length:h)<0&&(h+=this.length),c===h)return this._new();const p=this._offset(c),b=this._offset(h),f=this._bufs.slice(p[0],b[0]+1);return 0===b[1]?f.pop():f[f.length-1]=f[f.length-1].slice(0,b[1]),0!==p[1]&&(f[0]=f[0].slice(p[1])),this._new(f)},_.prototype.toString=function(c,h,p){return this.slice(h,p).toString(c)},_.prototype.consume=function(c){if(c=Math.trunc(c),Number.isNaN(c)||c<=0)return this;for(;this._bufs.length;){if(!(c>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(c),this.length-=c;break}c-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},_.prototype.duplicate=function(){const c=this._new();for(let h=0;h<this._bufs.length;h++)c.append(this._bufs[h]);return c},_.prototype.append=function(c){if(null==c)return this;if(c.buffer)this._appendBuffer(O.from(c.buffer,c.byteOffset,c.byteLength));else if(Array.isArray(c))for(let h=0;h<c.length;h++)this.append(c[h]);else if(this._isBufferList(c))for(let h=0;h<c._bufs.length;h++)this.append(c._bufs[h]);else"number"==typeof c&&(c=c.toString()),this._appendBuffer(O.from(c));return this},_.prototype._appendBuffer=function(c){this._bufs.push(c),this.length+=c.length},_.prototype.indexOf=function(c,h,p){if(void 0===p&&"string"==typeof h&&(p=h,h=void 0),"function"==typeof c||Array.isArray(c))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof c?c=O.from([c]):"string"==typeof c?c=O.from(c,p):this._isBufferList(c)?c=c.slice():Array.isArray(c.buffer)?c=O.from(c.buffer,c.byteOffset,c.byteLength):O.isBuffer(c)||(c=O.from(c)),h=Number(h||0),isNaN(h)&&(h=0),h<0&&(h=this.length+h),h<0&&(h=0),0===c.length)return h>this.length?this.length:h;const b=this._offset(h);let f=b[0],w=b[1];for(;f<this._bufs.length;f++){const x=this._bufs[f];for(;w<x.length;)if(x.length-w>=c.length){const g=x.indexOf(c,w);if(-1!==g)return this._reverseOffset([f,g]);w=x.length-c.length+1}else{const g=this._reverseOffset([f,w]);if(this._match(g,c))return g;w++}w=0}return-1},_.prototype._match=function(c,h){if(this.length-c<h.length)return!1;for(let p=0;p<h.length;p++)if(this.get(c+p)!==h[p])return!1;return!0},function(){const c={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const h in c)!function(p){_.prototype[p]=null===c[p]?function(b,f){return this.slice(b,b+f)[p](0,f)}:function(b){return this.slice(b,b+c[p])[p](0)}}(h)}(),_.prototype._isBufferList=function(c){return c instanceof _||_.isBufferList(c)},_.isBufferList=function(c){return null!=c&&c[v]},e.exports=_},{buffer:12}],36:[function(S,e,J){"use strict";const O=S("readable-stream").Duplex,v=S("inherits"),_=S("./BufferList");function c(h){if(!(this instanceof c))return new c(h);if("function"==typeof h){this._callback=h;const p=function(b){this._callback&&(this._callback(b),this._callback=null)}.bind(this);this.on("pipe",function(b){b.on("error",p)}),this.on("unpipe",function(b){b.removeListener("error",p)}),h=null}_._init.call(this,h),O.call(this)}v(c,O),Object.assign(c.prototype,_.prototype),c.prototype._new=function(h){return new c(h)},c.prototype._write=function(h,p,b){this._appendBuffer(h),"function"==typeof b&&b()},c.prototype._read=function(h){if(!this.length)return this.push(null);h=Math.min(h,this.length),this.push(this.slice(0,h)),this.consume(h)},c.prototype.end=function(h){O.prototype.end.call(this,h),this._callback&&(this._callback(null,this.slice()),this._callback=null)},c.prototype._destroy=function(h,p){this._bufs.length=0,this.length=0,p(h)},c.prototype._isBufferList=function(h){return h instanceof c||h instanceof _||c.isBufferList(h)},c.isBufferList=_.isBufferList,e.exports=c,e.exports.BufferListStream=c,e.exports.BufferList=_},{"./BufferList":35,inherits:29,"readable-stream":63}],37:[function(S,e,J){(function(O){const _={},c=O.isBuffer(O.from([1,2]).subarray(0,1));function h(p){const b=O.allocUnsafe(2);return b.writeUInt8(p>>8,0),b.writeUInt8(255&p,1),b}e.exports={cache:_,generateCache:function(){for(let p=0;p<65536;p++)_[p]=h(p)},generateNumber:h,genBufVariableByteInt:function(p){let b=0,f=0;const w=O.allocUnsafe(4);do{b=p%128|0,(p=p/128|0)>0&&(b|=128),w.writeUInt8(b,f++)}while(p>0&&f<4);return p>0&&(f=0),c?w.subarray(0,f):w.slice(0,f)},generate4ByteBuffer:function(p){const b=O.allocUnsafe(4);return b.writeUInt32BE(p,0),b}}}).call(this,S("buffer").Buffer)},{buffer:12}],38:[function(S,e,J){e.exports=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}}},{}],39:[function(S,e,J){const O=S("bl"),v=S("events"),_=S("./packet"),c=S("./constants"),h=S("debug")("mqtt-packet:parser");class p extends v{constructor(){super(),this.parser=this.constructor.parser}static parser(f){return this instanceof p?(this.settings=f||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):(new p).parser(f)}_resetState(){h("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new _,this.error=null,this._list=O(),this._stateCounter=0}parse(f){for(this.error&&this._resetState(),this._list.append(f),h("parse: current state: %s",this._states[this._stateCounter]);(-1!==this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,h("parse: state complete. _stateCounter is now: %d",this._stateCounter),h("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return h("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){const f=this._list.readUInt8(0);return this.packet.cmd=c.types[f>>c.CMD_SHIFT],this.packet.retain=0!=(f&c.RETAIN_MASK),this.packet.qos=f>>c.QOS_SHIFT&c.QOS_MASK,this.packet.dup=0!=(f&c.DUP_MASK),h("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0}_parseLength(){const f=this._parseVarByteNum(!0);return f?(this.packet.length=f.value,this._list.consume(f.bytes)):this._emitError(new Error("Invalid length")),h("_parseLength %d",f.value),!!f}_parsePayload(){h("_parsePayload: payload %O",this._list);let f=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}f=!0}return h("_parsePayload complete result: %s",f),f}_parseConnect(){let f,w,x,g;h("_parseConnect");const u={},y=this.packet,R=this._parseString();if(null===R)return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==R&&"MQIsdp"!==R)return this._emitError(new Error("Invalid protocolId"));if(y.protocolId=R,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(y.protocolVersion=this._list.readUInt8(this._pos),3!==y.protocolVersion&&4!==y.protocolVersion&&5!==y.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(u.username=this._list.readUInt8(this._pos)&c.USERNAME_MASK,u.password=this._list.readUInt8(this._pos)&c.PASSWORD_MASK,u.will=this._list.readUInt8(this._pos)&c.WILL_FLAG_MASK,u.will&&(y.will={},y.will.retain=0!=(this._list.readUInt8(this._pos)&c.WILL_RETAIN_MASK),y.will.qos=(this._list.readUInt8(this._pos)&c.WILL_QOS_MASK)>>c.WILL_QOS_SHIFT),y.clean=0!=(this._list.readUInt8(this._pos)&c.CLEAN_SESSION_MASK),this._pos++,y.keepalive=this._parseNum(),-1===y.keepalive)return this._emitError(new Error("Packet too short"));if(5===y.protocolVersion){const D=this._parseProperties();Object.getOwnPropertyNames(D).length&&(y.properties=D)}const P=this._parseString();if(null===P)return this._emitError(new Error("Packet too short"));if(y.clientId=P,h("_parseConnect: packet.clientId: %s",y.clientId),u.will){if(5===y.protocolVersion){const D=this._parseProperties();Object.getOwnPropertyNames(D).length&&(y.will.properties=D)}if(null===(f=this._parseString()))return this._emitError(new Error("Cannot parse will topic"));if(y.will.topic=f,h("_parseConnect: packet.will.topic: %s",y.will.topic),null===(w=this._parseBuffer()))return this._emitError(new Error("Cannot parse will payload"));y.will.payload=w,h("_parseConnect: packet.will.paylaod: %s",y.will.payload)}if(u.username){if(null===(g=this._parseString()))return this._emitError(new Error("Cannot parse username"));y.username=g,h("_parseConnect: packet.username: %s",y.username)}if(u.password){if(null===(x=this._parseBuffer()))return this._emitError(new Error("Cannot parse password"));y.password=x}return this.settings=y,h("_parseConnect: complete"),y}_parseConnack(){h("_parseConnack");const f=this.packet;if(this._list.length<2)return null;if(f.sessionPresent=!!(this._list.readUInt8(this._pos++)&c.SESSIONPRESENT_MASK),5===this.settings.protocolVersion?f.reasonCode=this._list.readUInt8(this._pos++):f.returnCode=this._list.readUInt8(this._pos++),-1===f.returnCode||-1===f.reasonCode)return this._emitError(new Error("Cannot parse return code"));if(5===this.settings.protocolVersion){const w=this._parseProperties();Object.getOwnPropertyNames(w).length&&(f.properties=w)}h("_parseConnack: complete")}_parsePublish(){h("_parsePublish");const f=this.packet;if(f.topic=this._parseString(),null===f.topic)return this._emitError(new Error("Cannot parse topic"));if(!(f.qos>0)||this._parseMessageId()){if(5===this.settings.protocolVersion){const w=this._parseProperties();Object.getOwnPropertyNames(w).length&&(f.properties=w)}f.payload=this._list.slice(this._pos,f.length),h("_parsePublish: payload from buffer list: %o",f.payload)}}_parseSubscribe(){h("_parseSubscribe");const f=this.packet;let w,x,g,u,y,R,P;if(1!==f.qos)return this._emitError(new Error("Wrong subscribe header"));if(f.subscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const D=this._parseProperties();Object.getOwnPropertyNames(D).length&&(f.properties=D)}for(;this._pos<f.length;){if(null===(w=this._parseString()))return this._emitError(new Error("Cannot parse topic"));if(this._pos>=f.length)return this._emitError(new Error("Malformed Subscribe Payload"));g=(x=this._parseByte())&c.SUBSCRIBE_OPTIONS_QOS_MASK,R=0!=(x>>c.SUBSCRIBE_OPTIONS_NL_SHIFT&c.SUBSCRIBE_OPTIONS_NL_MASK),y=0!=(x>>c.SUBSCRIBE_OPTIONS_RAP_SHIFT&c.SUBSCRIBE_OPTIONS_RAP_MASK),u=x>>c.SUBSCRIBE_OPTIONS_RH_SHIFT&c.SUBSCRIBE_OPTIONS_RH_MASK,P={topic:w,qos:g},5===this.settings.protocolVersion&&(P.nl=R,P.rap=y,P.rh=u),h("_parseSubscribe: push subscription `%s` to subscription",P),f.subscriptions.push(P)}}}_parseSuback(){h("_parseSuback");const f=this.packet;if(this.packet.granted=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const w=this._parseProperties();Object.getOwnPropertyNames(w).length&&(f.properties=w)}for(;this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}}_parseUnsubscribe(){h("_parseUnsubscribe");const f=this.packet;if(f.unsubscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const w=this._parseProperties();Object.getOwnPropertyNames(w).length&&(f.properties=w)}for(;this._pos<f.length;){const w=this._parseString();if(null===w)return this._emitError(new Error("Cannot parse topic"));h("_parseUnsubscribe: push topic `%s` to unsubscriptions",w),f.unsubscriptions.push(w)}}}_parseUnsuback(){h("_parseUnsuback");const f=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if(5===this.settings.protocolVersion){const w=this._parseProperties();for(Object.getOwnPropertyNames(w).length&&(f.properties=w),f.granted=[];this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}}_parseConfirmation(){h("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);const f=this.packet;if(this._parseMessageId(),5===this.settings.protocolVersion&&(f.length>2&&(f.reasonCode=this._parseByte(),h("_parseConfirmation: packet.reasonCode `%d`",f.reasonCode)),f.length>3)){const w=this._parseProperties();Object.getOwnPropertyNames(w).length&&(f.properties=w)}return!0}_parseDisconnect(){const f=this.packet;if(h("_parseDisconnect"),5===this.settings.protocolVersion){f.reasonCode=this._parseByte();const w=this._parseProperties();Object.getOwnPropertyNames(w).length&&(f.properties=w)}return h("_parseDisconnect result: true"),!0}_parseAuth(){h("_parseAuth");const f=this.packet;if(5!==this.settings.protocolVersion)return this._emitError(new Error("Not supported auth packet for this version MQTT"));f.reasonCode=this._parseByte();const w=this._parseProperties();return Object.getOwnPropertyNames(w).length&&(f.properties=w),h("_parseAuth: result: true"),!0}_parseMessageId(){const f=this.packet;return f.messageId=this._parseNum(),null===f.messageId?(this._emitError(new Error("Cannot parse messageId")),!1):(h("_parseMessageId: packet.messageId %d",f.messageId),!0)}_parseString(f){const w=this._parseNum(),x=w+this._pos;if(-1===w||x>this._list.length||x>this.packet.length)return null;const g=this._list.toString("utf8",this._pos,x);return this._pos+=w,h("_parseString: result: %s",g),g}_parseStringPair(){return h("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){const f=this._parseNum(),w=f+this._pos;if(-1===f||w>this._list.length||w>this.packet.length)return null;const x=this._list.slice(this._pos,w);return this._pos+=f,h("_parseBuffer: result: %o",x),x}_parseNum(){if(this._list.length-this._pos<2)return-1;const f=this._list.readUInt16BE(this._pos);return this._pos+=2,h("_parseNum: result: %s",f),f}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;const f=this._list.readUInt32BE(this._pos);return this._pos+=4,h("_parse4ByteNum: result: %s",f),f}_parseVarByteNum(f){h("_parseVarByteNum");let w,x=0,g=1,u=0,y=!1;const R=this._pos?this._pos:0;for(;x<5;){if(u+=g*((w=this._list.readUInt8(R+x++))&c.VARBYTEINT_MASK),g*=128,0==(w&c.VARBYTEINT_FIN_MASK)){y=!0;break}if(this._list.length<=x)break}return R&&(this._pos+=x),h("_parseVarByteNum: result: %o",y=!!y&&(f?{bytes:x,value:u}:u)),y}_parseByte(){const f=this._list.readUInt8(this._pos);return this._pos++,h("_parseByte: result: %o",f),f}_parseByType(f){switch(h("_parseByType: type: %s",f),f){case"byte":return 0!==this._parseByte();case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){h("_parseProperties");const f=this._parseVarByteNum(),w=this._pos+f,x={};for(;this._pos<w;){const g=this._parseByte(),u=c.propertiesCodes[g];if(!u)return this._emitError(new Error("Unknown property")),!1;if("userProperties"!==u)x[u]?(Array.isArray(x[u])||(x[u]=[x[u]]),x[u].push(this._parseByType(c.propertiesTypes[u]))):x[u]=this._parseByType(c.propertiesTypes[u]);else{x[u]||(x[u]=Object.create(null));const y=this._parseByType(c.propertiesTypes[u]);x[u][y.name]?(Array.isArray(x[u][y.name])||(x[u][y.name]=[x[u][y.name]]),x[u][y.name].push(y.value)):x[u][y.name]=y.value}}return x}_newPacket(){return h("_newPacket"),this.packet&&(this._list.consume(this.packet.length),h("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),h("_newPacket: new packet"),this.packet=new _,this._pos=0,!0}_emitError(f){h("_emitError"),this.error=f,this.emit("error",f)}}e.exports=p},{"./constants":32,"./packet":38,bl:36,debug:14,events:27}],40:[function(S,e,J){(function(O){const v=S("./constants"),_=O.allocUnsafe(0),c=O.from([0]),h=S("./numbers"),p=S("process-nextick-args").nextTick,b=S("debug")("mqtt-packet:writeToStream"),f=h.cache,w=h.generateNumber,x=h.generateCache,g=h.genBufVariableByteInt,u=h.generate4ByteBuffer;let y=I,R=!0;function P(z,L,G){switch(b("generate called"),L.cork&&(L.cork(),p(D,L)),R&&(R=!1,x()),b("generate: packet.cmd: %s",z.cmd),z.cmd){case"connect":return function(Y,m,C){const F=Y||{},U=F.protocolId||"MQTT",$=F.protocolVersion||4,te=F.will;let X=F.clean;const s=F.keepalive||0,a=F.clientId||"",d=F.username,T=F.password,B=F.properties;void 0===X&&(X=!0);let H=0;if(!U||"string"!=typeof U&&!O.isBuffer(U))return m.emit("error",new Error("Invalid protocolId")),!1;if(H+=U.length+2,3!==$&&4!==$&&5!==$)return m.emit("error",new Error("Invalid protocol version")),!1;if(H+=1,"string"!=typeof a&&!O.isBuffer(a)||!a&&4!==$||!a&&!X){if($<4)return m.emit("error",new Error("clientId must be supplied before 3.1.1")),!1;if(1*X==0)return m.emit("error",new Error("clientId must be given if cleanSession set to 0")),!1}else H+=a.length+2;if("number"!=typeof s||s<0||s>65535||s%1!=0)return m.emit("error",new Error("Invalid keepalive")),!1;if(H+=2,H+=1,5===$){var K=M(m,B);if(!K)return!1;H+=K.length}if(te){if("object"!=typeof te)return m.emit("error",new Error("Invalid will")),!1;if(!te.topic||"string"!=typeof te.topic)return m.emit("error",new Error("Invalid will topic")),!1;if(H+=O.byteLength(te.topic)+2,H+=2,te.payload){if(!(te.payload.length>=0))return m.emit("error",new Error("Invalid will payload")),!1;H+="string"==typeof te.payload?O.byteLength(te.payload):te.payload.length}var ae={};if(5===$){if(!(ae=M(m,te.properties)))return!1;H+=ae.length}}let re=!1;if(null!=d){if(!ee(d))return m.emit("error",new Error("Invalid username")),!1;re=!0,H+=O.byteLength(d)+2}if(null!=T){if(!re)return m.emit("error",new Error("Username is required to use password")),!1;if(!ee(T))return m.emit("error",new Error("Invalid password")),!1;H+=ie(T)+2}m.write(v.CONNECT_HEADER),k(m,H),W(m,U),m.write(4===$?v.VERSION4:5===$?v.VERSION5:v.VERSION3);let he=0;return he|=null!=d?v.USERNAME_MASK:0,he|=null!=T?v.PASSWORD_MASK:0,he|=te&&te.retain?v.WILL_RETAIN_MASK:0,he|=te&&te.qos?te.qos<<v.WILL_QOS_SHIFT:0,he|=te?v.WILL_FLAG_MASK:0,he|=X?v.CLEAN_SESSION_MASK:0,m.write(O.from([he])),y(m,s),5===$&&K.write(),W(m,a),te&&(5===$&&ae.write(),ne(m,te.topic),W(m,te.payload)),null!=d&&W(m,d),null!=T&&W(m,T),!0}(z,L);case"connack":return function(Y,m,C){const F=C?C.protocolVersion:4,U=Y||{},$=5===F?U.reasonCode:U.returnCode,te=U.properties;let X=2;if("number"!=typeof $)return m.emit("error",new Error("Invalid return code")),!1;let s=null;if(5===F){if(!(s=M(m,te)))return!1;X+=s.length}return m.write(v.CONNACK_HEADER),k(m,X),m.write(U.sessionPresent?v.SESSIONPRESENT_HEADER:c),m.write(O.from([$])),s?.write(),!0}(z,L,G);case"publish":return function(Y,m,C){b("publish: packet: %o",Y);const F=C?C.protocolVersion:4,U=Y||{},$=U.qos||0,te=U.retain?v.RETAIN_MASK:0,X=U.topic,s=U.payload||_,a=U.messageId,d=U.properties;let T=0;if("string"==typeof X)T+=O.byteLength(X)+2;else{if(!O.isBuffer(X))return m.emit("error",new Error("Invalid topic")),!1;T+=X.length+2}if(O.isBuffer(s)?T+=s.length:T+=O.byteLength(s),$&&"number"!=typeof a)return m.emit("error",new Error("Invalid messageId")),!1;$&&(T+=2);let B=null;if(5===F){if(!(B=M(m,d)))return!1;T+=B.length}return m.write(v.PUBLISH_HEADER[$][U.dup?1:0][te?1:0]),k(m,T),y(m,ie(X)),m.write(X),$>0&&y(m,a),B?.write(),b("publish: payload: %o",s),m.write(s)}(z,L,G);case"puback":case"pubrec":case"pubrel":case"pubcomp":return function(Y,m,C){const F=C?C.protocolVersion:4,U=Y||{},$=U.cmd||"puback",te=U.messageId,X=U.dup&&"pubrel"===$?v.DUP_MASK:0;let s=0;const a=U.reasonCode,d=U.properties;let T=5===F?3:2;if("pubrel"===$&&(s=1),"number"!=typeof te)return m.emit("error",new Error("Invalid messageId")),!1;let B=null;if(5===F&&"object"==typeof d){if(!(B=j(m,d,C,T)))return!1;T+=B.length}return m.write(v.ACKS[$][s][X][0]),k(m,T),y(m,te),5===F&&m.write(O.from([a])),null!==B&&B.write(),!0}(z,L,G);case"subscribe":return function(Y,m,C){b("subscribe: packet: ");const F=C?C.protocolVersion:4,U=Y||{},$=U.dup?v.DUP_MASK:0,te=U.messageId,X=U.subscriptions,s=U.properties;let a=0;if("number"!=typeof te)return m.emit("error",new Error("Invalid messageId")),!1;a+=2;let d=null;if(5===F){if(!(d=M(m,s)))return!1;a+=d.length}if("object"!=typeof X||!X.length)return m.emit("error",new Error("Invalid subscriptions")),!1;for(let B=0;B<X.length;B+=1){const H=X[B].topic,K=X[B].qos;if("string"!=typeof H)return m.emit("error",new Error("Invalid subscriptions - invalid topic")),!1;if("number"!=typeof K)return m.emit("error",new Error("Invalid subscriptions - invalid qos")),!1;if(5===F){if("boolean"!=typeof(X[B].nl||!1))return m.emit("error",new Error("Invalid subscriptions - invalid No Local")),!1;if("boolean"!=typeof(X[B].rap||!1))return m.emit("error",new Error("Invalid subscriptions - invalid Retain as Published")),!1;const he=X[B].rh||0;if("number"!=typeof he||he>2)return m.emit("error",new Error("Invalid subscriptions - invalid Retain Handling")),!1}a+=O.byteLength(H)+2+1}b("subscribe: writing to stream: %o",v.SUBSCRIBE_HEADER),m.write(v.SUBSCRIBE_HEADER[1][$?1:0][0]),k(m,a),y(m,te),null!==d&&d.write();let T=!0;for(const B of X){const K=B.qos,ae=+B.nl,re=+B.rap,he=B.rh;let pe;ne(m,B.topic),pe=v.SUBSCRIBE_OPTIONS_QOS[K],5===F&&(pe|=ae?v.SUBSCRIBE_OPTIONS_NL:0,pe|=re?v.SUBSCRIBE_OPTIONS_RAP:0,pe|=he?v.SUBSCRIBE_OPTIONS_RH[he]:0),T=m.write(O.from([pe]))}return T}(z,L,G);case"suback":return function(Y,m,C){const F=C?C.protocolVersion:4,U=Y||{},$=U.messageId,te=U.granted,X=U.properties;let s=0;if("number"!=typeof $)return m.emit("error",new Error("Invalid messageId")),!1;if(s+=2,"object"!=typeof te||!te.length)return m.emit("error",new Error("Invalid qos vector")),!1;for(let d=0;d<te.length;d+=1){if("number"!=typeof te[d])return m.emit("error",new Error("Invalid qos vector")),!1;s+=1}let a=null;if(5===F){if(!(a=j(m,X,C,s)))return!1;s+=a.length}return m.write(v.SUBACK_HEADER),k(m,s),y(m,$),null!==a&&a.write(),m.write(O.from(te))}(z,L,G);case"unsubscribe":return function(Y,m,C){const F=C?C.protocolVersion:4,U=Y||{},$=U.messageId,te=U.dup?v.DUP_MASK:0,X=U.unsubscriptions,s=U.properties;let a=0;if("number"!=typeof $)return m.emit("error",new Error("Invalid messageId")),!1;if(a+=2,"object"!=typeof X||!X.length)return m.emit("error",new Error("Invalid unsubscriptions")),!1;for(let B=0;B<X.length;B+=1){if("string"!=typeof X[B])return m.emit("error",new Error("Invalid unsubscriptions")),!1;a+=O.byteLength(X[B])+2}let d=null;if(5===F){if(!(d=M(m,s)))return!1;a+=d.length}m.write(v.UNSUBSCRIBE_HEADER[1][te?1:0][0]),k(m,a),y(m,$),null!==d&&d.write();let T=!0;for(let B=0;B<X.length;B++)T=ne(m,X[B]);return T}(z,L,G);case"unsuback":return function(Y,m,C){const F=C?C.protocolVersion:4,U=Y||{},$=U.messageId,te=U.dup?v.DUP_MASK:0,X=U.granted,s=U.properties,a=U.cmd;let d=2;if("number"!=typeof $)return m.emit("error",new Error("Invalid messageId")),!1;if(5===F){if("object"!=typeof X||!X.length)return m.emit("error",new Error("Invalid qos vector")),!1;for(let B=0;B<X.length;B+=1){if("number"!=typeof X[B])return m.emit("error",new Error("Invalid qos vector")),!1;d+=1}}let T=null;if(5===F){if(!(T=j(m,s,C,d)))return!1;d+=T.length}return m.write(v.ACKS[a][0][te][0]),k(m,d),y(m,$),null!==T&&T.write(),5===F&&m.write(O.from(X)),!0}(z,L,G);case"pingreq":case"pingresp":return L.write(v.EMPTY[z.cmd]);case"disconnect":return function(Y,m,C){const F=C?C.protocolVersion:4,U=Y||{},$=U.reasonCode;let X=5===F?1:0,s=null;if(5===F){if(!(s=j(m,U.properties,C,X)))return!1;X+=s.length}return m.write(O.from([v.codes.disconnect<<4])),k(m,X),5===F&&m.write(O.from([$])),null!==s&&s.write(),!0}(z,L,G);case"auth":return function(Y,m,C){const F=C?C.protocolVersion:4,U=Y||{},$=U.reasonCode,te=U.properties;let X=5===F?1:0;5!==F&&m.emit("error",new Error("Invalid mqtt version for auth packet"));const s=j(m,te,C,X);return!!s&&(X+=s.length,m.write(O.from([v.codes.auth<<4])),k(m,X),m.write(O.from([$])),null!==s&&s.write(),!0)}(z,L,G);default:return L.emit("error",new Error("Unknown command")),!1}}function D(z){z.uncork()}Object.defineProperty(P,"cacheNumbers",{get:()=>y===I,set(z){z?(f&&0!==Object.keys(f).length||(R=!0),y=I):(R=!1,y=N)}});const Z={};function k(z,L){let G=Z[L];G||(G=g(L),L<16384&&(Z[L]=G)),b("writeVarByteInt: writing to stream: %o",G),z.write(G)}function ne(z,L){const G=O.byteLength(L);return y(z,G),b("writeString: %s",L),z.write(L,"utf8")}function A(z,L,G){ne(z,L),ne(z,G)}function I(z,L){return b("writeNumberCached: number: %d",L),b("writeNumberCached: %o",f[L]),z.write(f[L])}function N(z,L){const G=w(L);return b("writeNumberGenerated: %o",G),z.write(G)}function W(z,L){"string"==typeof L?ne(z,L):L?(y(z,L.length),z.write(L)):y(z,0)}function M(z,L){if("object"!=typeof L||null!=L.length)return{length:1,write(){oe(z,{},0)}};let G=0;function Y(m,C){let F=0;switch(v.propertiesTypes[m]){case"byte":if("boolean"!=typeof C)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=2;break;case"int8":if("number"!=typeof C||C<0||C>255)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=2;break;case"binary":if(C&&null===C)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=1+O.byteLength(C)+2;break;case"int16":if("number"!=typeof C||C<0||C>65535)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=3;break;case"int32":if("number"!=typeof C||C<0||C>4294967295)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=5;break;case"var":if("number"!=typeof C||C<0||C>268435455)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=1+O.byteLength(g(C));break;case"string":if("string"!=typeof C)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=3+O.byteLength(C.toString());break;case"pair":if("object"!=typeof C)return z.emit("error",new Error(`Invalid ${m}: ${C}`)),!1;F+=Object.getOwnPropertyNames(C).reduce((U,$)=>{const te=C[$];return Array.isArray(te)?U+=te.reduce((X,s)=>X+(3+O.byteLength($.toString())+2+O.byteLength(s.toString())),0):U+=3+O.byteLength($.toString())+2+O.byteLength(C[$].toString()),U},0);break;default:return z.emit("error",new Error(`Invalid property ${m}: ${C}`)),!1}return F}if(L)for(const m in L){let C=0,F=0;const U=L[m];if(Array.isArray(U))for(let $=0;$<U.length;$++){if(!(F=Y(m,U[$])))return!1;C+=F}else{if(!(F=Y(m,U)))return!1;C=F}if(!C)return!1;G+=C}return{length:O.byteLength(g(G))+G,write(){oe(z,L,G)}}}function j(z,L,G,Y){const m=["reasonString","userProperties"],C=G&&G.properties&&G.properties.maximumPacketSize?G.properties.maximumPacketSize:0;let F=M(z,L);if(C)for(;Y+F.length>C;){const U=m.shift();if(!U||!L[U])return!1;delete L[U],F=M(z,L)}return F}function q(z,L,G){switch(v.propertiesTypes[L]){case"byte":z.write(O.from([v.properties[L]])),z.write(O.from([+G]));break;case"int8":z.write(O.from([v.properties[L]])),z.write(O.from([G]));break;case"binary":z.write(O.from([v.properties[L]])),W(z,G);break;case"int16":z.write(O.from([v.properties[L]])),y(z,G);break;case"int32":z.write(O.from([v.properties[L]])),function(Y,m){const C=u(m);b("write4ByteNumber: %o",C),Y.write(C)}(z,G);break;case"var":z.write(O.from([v.properties[L]])),k(z,G);break;case"string":z.write(O.from([v.properties[L]])),ne(z,G);break;case"pair":Object.getOwnPropertyNames(G).forEach(Y=>{const m=G[Y];Array.isArray(m)?m.forEach(C=>{z.write(O.from([v.properties[L]])),A(z,Y.toString(),C.toString())}):(z.write(O.from([v.properties[L]])),A(z,Y.toString(),m.toString()))});break;default:return z.emit("error",new Error(`Invalid property ${L} value: ${G}`)),!1}}function oe(z,L,G){k(z,G);for(const Y in L)if(Object.prototype.hasOwnProperty.call(L,Y)&&null!==L[Y]){const m=L[Y];if(Array.isArray(m))for(let C=0;C<m.length;C++)q(z,Y,m[C]);else q(z,Y,m)}}function ie(z){return z?z instanceof O?z.length:O.byteLength(z):0}function ee(z){return"string"==typeof z||z instanceof O}e.exports=P}).call(this,S("buffer").Buffer)},{"./constants":32,"./numbers":37,buffer:12,debug:14,"process-nextick-args":43}],41:[function(S,e,J){var O=1e3,v=60*O,_=60*v,c=24*_;function b(f,w,x,g){var u=w>=1.5*x;return Math.round(f/x)+" "+g+(u?"s":"")}e.exports=function(f,w){w=w||{};var g,u,x=typeof f;if("string"===x&&f.length>0)return function(g){if(!((g=String(g)).length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(g);if(u){var y=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*y;case"weeks":case"week":case"w":return 6048e5*y;case"days":case"day":case"d":return y*c;case"hours":case"hour":case"hrs":case"hr":case"h":return y*_;case"minutes":case"minute":case"mins":case"min":case"m":return y*v;case"seconds":case"second":case"secs":case"sec":case"s":return y*O;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return y;default:return}}}}(f);if("number"===x&&isFinite(f))return w.long?(g=f,(u=Math.abs(g))>=c?b(g,u,c,"day"):u>=_?b(g,u,_,"hour"):u>=v?b(g,u,v,"minute"):u>=O?b(g,u,O,"second"):g+" ms"):function(g){var u=Math.abs(g);return u>=c?Math.round(g/c)+"d":u>=_?Math.round(g/_)+"h":u>=v?Math.round(g/v)+"m":u>=O?Math.round(g/O)+"s":g+"ms"}(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],42:[function(S,e,J){var O=S("wrappy");function v(c){var h=function(){return h.called?h.value:(h.called=!0,h.value=c.apply(this,arguments))};return h.called=!1,h}function _(c){var h=function(){if(h.called)throw new Error(h.onceError);return h.called=!0,h.value=c.apply(this,arguments)};return h.onceError=(c.name||"Function wrapped with `once`")+" shouldn't be called more than once",h.called=!1,h}e.exports=O(v),e.exports.strict=O(_),v.proto=v(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return v(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return _(this)},configurable:!0})})},{wrappy:72}],43:[function(S,e,J){(function(O){"use strict";e.exports=void 0===O||!O.version||0===O.version.indexOf("v0.")||0===O.version.indexOf("v1.")&&0!==O.version.indexOf("v1.8.")?{nextTick:function(v,_,c,h){if("function"!=typeof v)throw new TypeError('"callback" argument must be a function');var p,b,f=arguments.length;switch(f){case 0:case 1:return O.nextTick(v);case 2:return O.nextTick(function(){v.call(null,_)});case 3:return O.nextTick(function(){v.call(null,_,c)});case 4:return O.nextTick(function(){v.call(null,_,c,h)});default:for(p=new Array(f-1),b=0;b<p.length;)p[b++]=arguments[b];return O.nextTick(function(){v.apply(null,p)})}}}:O}).call(this,S("_process"))},{_process:44}],44:[function(S,e,J){var O,v,_=e.exports={};function c(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function p(P){if(O===setTimeout)return setTimeout(P,0);if((O===c||!O)&&setTimeout)return O=setTimeout,setTimeout(P,0);try{return O(P,0)}catch{try{return O.call(null,P,0)}catch{return O.call(this,P,0)}}}!function(){try{O="function"==typeof setTimeout?setTimeout:c}catch{O=c}try{v="function"==typeof clearTimeout?clearTimeout:h}catch{v=h}}();var b,f=[],w=!1,x=-1;function g(){w&&b&&(w=!1,b.length?f=b.concat(f):x=-1,f.length&&u())}function u(){if(!w){var P=p(g);w=!0;for(var D=f.length;D;){for(b=f,f=[];++x<D;)b&&b[x].run();x=-1,D=f.length}b=null,w=!1,function(Z){if(v===clearTimeout)return clearTimeout(Z);if((v===h||!v)&&clearTimeout)return v=clearTimeout,clearTimeout(Z);try{v(Z)}catch{try{return v.call(null,Z)}catch{return v.call(this,Z)}}}(P)}}function y(P,D){this.fun=P,this.array=D}function R(){}_.nextTick=function(P){var D=new Array(arguments.length-1);if(arguments.length>1)for(var Z=1;Z<arguments.length;Z++)D[Z-1]=arguments[Z];f.push(new y(P,D)),1!==f.length||w||p(u)},y.prototype.run=function(){this.fun.apply(null,this.array)},_.title="browser",_.browser=!0,_.env={},_.argv=[],_.version="",_.versions={},_.on=R,_.addListener=R,_.once=R,_.off=R,_.removeListener=R,_.removeAllListeners=R,_.emit=R,_.prependListener=R,_.prependOnceListener=R,_.listeners=function(P){return[]},_.binding=function(P){throw new Error("process.binding is not supported")},_.cwd=function(){return"/"},_.chdir=function(P){throw new Error("process.chdir is not supported")},_.umask=function(){return 0}},{}],45:[function(S,e,J){(function(O){!function(v){var _="object"==typeof J&&J&&!J.nodeType&&J,c="object"==typeof e&&e&&!e.nodeType&&e,h="object"==typeof O&&O;h.global!==h&&h.window!==h&&h.self!==h||(v=h);var p,b,f=2147483647,w=36,Z=/^xn--/,k=/[^\x20-\x7E]/,ne=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=Math.floor,W=String.fromCharCode;function M(Y){throw new RangeError(A[Y])}function j(Y,m){for(var C=Y.length,F=[];C--;)F[C]=m(Y[C]);return F}function q(Y,m){var C=Y.split("@"),F="";return C.length>1&&(F=C[0]+"@",Y=C[1]),F+j((Y=Y.replace(ne,".")).split("."),m).join(".")}function oe(Y){for(var m,C,F=[],U=0,$=Y.length;U<$;)(m=Y.charCodeAt(U++))>=55296&&m<=56319&&U<$?56320==(64512&(C=Y.charCodeAt(U++)))?F.push(((1023&m)<<10)+(1023&C)+65536):(F.push(m),U--):F.push(m);return F}function ie(Y){return j(Y,function(m){var C="";return m>65535&&(C+=W((m-=65536)>>>10&1023|55296),m=56320|1023&m),C+W(m)}).join("")}function ee(Y,m){return Y+22+75*(Y<26)-((0!=m)<<5)}function z(Y,m,C){var F=0;for(Y=C?N(Y/700):Y>>1,Y+=N(Y/m);Y>455;F+=w)Y=N(Y/35);return N(F+36*Y/(Y+38))}function L(Y){var m,C,F,U,$,te,X,s,a,d,T,B=[],H=Y.length,K=0,ae=128,re=72;for((C=Y.lastIndexOf("-"))<0&&(C=0),F=0;F<C;++F)Y.charCodeAt(F)>=128&&M("not-basic"),B.push(Y.charCodeAt(F));for(U=C>0?C+1:0;U<H;){for($=K,te=1,X=w;U>=H&&M("invalid-input"),((s=(T=Y.charCodeAt(U++))-48<10?T-22:T-65<26?T-65:T-97<26?T-97:w)>=w||s>N((f-K)/te))&&M("overflow"),K+=s*te,!(s<(a=X<=re?1:X>=re+26?26:X-re));X+=w)te>N(f/(d=w-a))&&M("overflow"),te*=d;re=z(K-$,m=B.length+1,0==$),N(K/m)>f-ae&&M("overflow"),ae+=N(K/m),K%=m,B.splice(K++,0,ae)}return ie(B)}function G(Y){var m,C,F,U,$,te,X,s,a,d,T,B,H,K,ae,re=[];for(B=(Y=oe(Y)).length,m=128,C=0,$=72,te=0;te<B;++te)(T=Y[te])<128&&re.push(W(T));for(F=U=re.length,U&&re.push("-");F<B;){for(X=f,te=0;te<B;++te)(T=Y[te])>=m&&T<X&&(X=T);for(X-m>N((f-C)/(H=F+1))&&M("overflow"),C+=(X-m)*H,m=X,te=0;te<B;++te)if((T=Y[te])<m&&++C>f&&M("overflow"),T==m){for(s=C,a=w;!(s<(d=a<=$?1:a>=$+26?26:a-$));a+=w)re.push(W(ee(d+(ae=s-d)%(K=w-d),0))),s=N(ae/K);re.push(W(ee(s,0))),$=z(C,H,F==U),C=0,++F}++C,++m}return re.join("")}if(p={version:"1.4.1",ucs2:{decode:oe,encode:ie},decode:L,encode:G,toASCII:function(Y){return q(Y,function(m){return k.test(m)?"xn--"+G(m):m})},toUnicode:function(Y){return q(Y,function(m){return Z.test(m)?L(m.slice(4).toLowerCase()):m})}},_&&c)if(e.exports==_)c.exports=p;else for(b in p)p.hasOwnProperty(b)&&(_[b]=p[b]);else v.punycode=p}(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],46:[function(S,e,J){"use strict";function O(_,c){return Object.prototype.hasOwnProperty.call(_,c)}e.exports=function(_,c,h,p){h=h||"=";var b={};if("string"!=typeof _||0===_.length)return b;var f=/\+/g;_=_.split(c=c||"&");var w=1e3;p&&"number"==typeof p.maxKeys&&(w=p.maxKeys);var x=_.length;w>0&&x>w&&(x=w);for(var g=0;g<x;++g){var u,y,R,P,D=_[g].replace(f,"%20"),Z=D.indexOf(h);Z>=0?(u=D.substr(0,Z),y=D.substr(Z+1)):(u=D,y=""),R=decodeURIComponent(u),P=decodeURIComponent(y),O(b,R)?v(b[R])?b[R].push(P):b[R]=[b[R],P]:b[R]=P}return b};var v=Array.isArray||function(_){return"[object Array]"===Object.prototype.toString.call(_)}},{}],47:[function(S,e,J){"use strict";var O=function(h){switch(typeof h){case"string":return h;case"boolean":return h?"true":"false";case"number":return isFinite(h)?h:"";default:return""}};e.exports=function(h,p,b,f){return p=p||"&",b=b||"=",null===h&&(h=void 0),"object"==typeof h?_(c(h),function(w){var x=encodeURIComponent(O(w))+b;return v(h[w])?_(h[w],function(g){return x+encodeURIComponent(O(g))}).join(p):x+encodeURIComponent(O(h[w]))}).join(p):f?encodeURIComponent(O(f))+b+encodeURIComponent(O(h)):""};var v=Array.isArray||function(h){return"[object Array]"===Object.prototype.toString.call(h)};function _(h,p){if(h.map)return h.map(p);for(var b=[],f=0;f<h.length;f++)b.push(p(h[f],f));return b}var c=Object.keys||function(h){var p=[];for(var b in h)Object.prototype.hasOwnProperty.call(h,b)&&p.push(b);return p}},{}],48:[function(S,e,J){"use strict";J.decode=J.parse=S("./decode"),J.encode=J.stringify=S("./encode")},{"./decode":46,"./encode":47}],49:[function(S,e,J){"use strict";var O={};function v(c,h,p){p||(p=Error);var b=function(f){var w,x;function g(u,y,R){return f.call(this,"string"==typeof h?h:h(u,y,R))||this}return x=f,(w=g).prototype=Object.create(x.prototype),w.prototype.constructor=w,w.__proto__=x,g}(p);b.prototype.name=p.name,b.prototype.code=c,O[c]=b}function _(c,h){if(Array.isArray(c)){var p=c.length;return c=c.map(function(b){return String(b)}),p>2?"one of ".concat(h," ").concat(c.slice(0,p-1).join(", "),", or ")+c[p-1]:2===p?"one of ".concat(h," ").concat(c[0]," or ").concat(c[1]):"of ".concat(h," ").concat(c[0])}return"of ".concat(h," ").concat(String(c))}v("ERR_INVALID_OPT_VALUE",function(c,h){return'The value "'+h+'" is invalid for option "'+c+'"'},TypeError),v("ERR_INVALID_ARG_TYPE",function(c,h,p){var b,x,u,R;if("string"==typeof h&&"not "===h.substr(0,"not ".length)?(b="must not be",h=h.replace(/^not /,"")):b="must be",u=c,(void 0===R||R>u.length)&&(R=u.length)," argument"===u.substring(R-" argument".length,R))x="The ".concat(c," ").concat(b," ").concat(_(h,"type"));else{var g=function(u,y,R){return"number"!=typeof R&&(R=0),!(R+".".length>u.length)&&-1!==u.indexOf(".",R)}(c)?"property":"argument";x='The "'.concat(c,'" ').concat(g," ").concat(b," ").concat(_(h,"type"))}return x+". Received type ".concat(typeof p)},TypeError),v("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),v("ERR_METHOD_NOT_IMPLEMENTED",function(c){return"The "+c+" method is not implemented"}),v("ERR_STREAM_PREMATURE_CLOSE","Premature close"),v("ERR_STREAM_DESTROYED",function(c){return"Cannot call "+c+" after a stream was destroyed"}),v("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),v("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),v("ERR_STREAM_WRITE_AFTER_END","write after end"),v("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),v("ERR_UNKNOWN_ENCODING",function(c){return"Unknown encoding: "+c},TypeError),v("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=O},{}],50:[function(S,e,J){(function(O){"use strict";var v=Object.keys||function(g){var u=[];for(var y in g)u.push(y);return u};e.exports=f;var _=S("./_stream_readable"),c=S("./_stream_writable");S("inherits")(f,_);for(var h=v(c.prototype),p=0;p<h.length;p++){var b=h[p];f.prototype[b]||(f.prototype[b]=c.prototype[b])}function f(g){if(!(this instanceof f))return new f(g);_.call(this,g),c.call(this,g),this.allowHalfOpen=!0,g&&(!1===g.readable&&(this.readable=!1),!1===g.writable&&(this.writable=!1),!1===g.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",w)))}function w(){this._writableState.ended||O.nextTick(x,this)}function x(g){g.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this,S("_process"))},{"./_stream_readable":52,"./_stream_writable":54,_process:44,inherits:29}],51:[function(S,e,J){"use strict";e.exports=v;var O=S("./_stream_transform");function v(_){if(!(this instanceof v))return new v(_);O.call(this,_)}S("inherits")(v,O),v.prototype._transform=function(_,c,h){h(null,_)}},{"./_stream_transform":53,inherits:29}],52:[function(S,e,J){(function(O,v){"use strict";var _;e.exports=M,M.ReadableState=W,S("events");var f,c=function(s,a){return s.listeners(a).length},h=S("./internal/streams/stream"),p=S("buffer").Buffer,b=v.Uint8Array||function(){},w=S("util");f=w&&w.debuglog?w.debuglog("stream"):function(){};var x,g,u,y=S("./internal/streams/buffer_list"),R=S("./internal/streams/destroy"),P=S("./internal/streams/state").getHighWaterMark,D=S("../errors").codes,Z=D.ERR_INVALID_ARG_TYPE,k=D.ERR_STREAM_PUSH_AFTER_EOF,ne=D.ERR_METHOD_NOT_IMPLEMENTED,A=D.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;S("inherits")(M,h);var I=R.errorOrDestroy,N=["error","close","destroy","pause","resume"];function W(s,a,d){_=_||S("./_stream_duplex"),"boolean"!=typeof d&&(d=a instanceof _),this.objectMode=!!(s=s||{}).objectMode,d&&(this.objectMode=this.objectMode||!!s.readableObjectMode),this.highWaterMark=P(this,s,"readableHighWaterMark",d),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==s.emitClose,this.autoDestroy=!!s.autoDestroy,this.destroyed=!1,this.defaultEncoding=s.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,s.encoding&&(x||(x=S("string_decoder/").StringDecoder),this.decoder=new x(s.encoding),this.encoding=s.encoding)}function M(s){if(_=_||S("./_stream_duplex"),!(this instanceof M))return new M(s);this._readableState=new W(s,this,this instanceof _),this.readable=!0,s&&("function"==typeof s.read&&(this._read=s.read),"function"==typeof s.destroy&&(this._destroy=s.destroy)),h.call(this)}function j(s,a,d,T,B){f("readableAddChunk",a);var H,ae,re,he,pe,K=s._readableState;if(null===a)K.reading=!1,function(ae,re){if(f("onEofChunk"),!re.ended){if(re.decoder){var he=re.decoder.end();he&&he.length&&(re.buffer.push(he),re.length+=re.objectMode?1:he.length)}re.ended=!0,re.sync?ee(ae):(re.needReadable=!1,re.emittedReadable||(re.emittedReadable=!0,z(ae)))}}(s,K);else if(B||(ae=K,p.isBuffer(pe=re=a)||pe instanceof b||"string"==typeof re||void 0===re||ae.objectMode||(he=new Z("chunk",["string","Buffer","Uint8Array"],re)),H=he),H)I(s,H);else if(K.objectMode||a&&a.length>0)if("string"==typeof a||K.objectMode||Object.getPrototypeOf(a)===p.prototype||(a=function(ae){return p.from(ae)}(a)),T)K.endEmitted?I(s,new A):q(s,K,a,!0);else if(K.ended)I(s,new k);else{if(K.destroyed)return!1;K.reading=!1,K.decoder&&!d?(a=K.decoder.write(a),K.objectMode||0!==a.length?q(s,K,a,!1):L(s,K)):q(s,K,a,!1)}else T||(K.reading=!1,L(s,K));return!K.ended&&(K.length<K.highWaterMark||0===K.length)}function q(s,a,d,T){a.flowing&&0===a.length&&!a.sync?(a.awaitDrain=0,s.emit("data",d)):(a.length+=a.objectMode?1:d.length,T?a.buffer.unshift(d):a.buffer.push(d),a.needReadable&&ee(s)),L(s,a)}Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(s){this._readableState&&(this._readableState.destroyed=s)}}),M.prototype.destroy=R.destroy,M.prototype._undestroy=R.undestroy,M.prototype._destroy=function(s,a){a(s)},M.prototype.push=function(s,a){var d,T=this._readableState;return T.objectMode?d=!0:"string"==typeof s&&((a=a||T.defaultEncoding)!==T.encoding&&(s=p.from(s,a),a=""),d=!0),j(this,s,a,!1,d)},M.prototype.unshift=function(s){return j(this,s,null,!0,!1)},M.prototype.isPaused=function(){return!1===this._readableState.flowing},M.prototype.setEncoding=function(s){x||(x=S("string_decoder/").StringDecoder);var a=new x(s);this._readableState.decoder=a,this._readableState.encoding=this._readableState.decoder.encoding;for(var d=this._readableState.buffer.head,T="";null!==d;)T+=a.write(d.data),d=d.next;return this._readableState.buffer.clear(),""!==T&&this._readableState.buffer.push(T),this._readableState.length=T.length,this};var oe=1073741824;function ie(s,a){return s<=0||0===a.length&&a.ended?0:a.objectMode?1:s!=s?a.flowing&&a.length?a.buffer.head.data.length:a.length:(s>a.highWaterMark&&(a.highWaterMark=((d=s)>=oe?d=oe:(d--,d|=d>>>1,d|=d>>>2,d|=d>>>4,d|=d>>>8,d|=d>>>16,d++),d)),s<=a.length?s:a.ended?a.length:(a.needReadable=!0,0));var d}function ee(s){var a=s._readableState;f("emitReadable",a.needReadable,a.emittedReadable),a.needReadable=!1,a.emittedReadable||(f("emitReadable",a.flowing),a.emittedReadable=!0,O.nextTick(z,s))}function z(s){var a=s._readableState;f("emitReadable_",a.destroyed,a.length,a.ended),a.destroyed||!a.length&&!a.ended||(s.emit("readable"),a.emittedReadable=!1),a.needReadable=!a.flowing&&!a.ended&&a.length<=a.highWaterMark,F(s)}function L(s,a){a.readingMore||(a.readingMore=!0,O.nextTick(G,s,a))}function G(s,a){for(;!a.reading&&!a.ended&&(a.length<a.highWaterMark||a.flowing&&0===a.length);){var d=a.length;if(f("maybeReadMore read 0"),s.read(0),d===a.length)break}a.readingMore=!1}function Y(s){var a=s._readableState;a.readableListening=s.listenerCount("readable")>0,a.resumeScheduled&&!a.paused?a.flowing=!0:s.listenerCount("data")>0&&s.resume()}function m(s){f("readable nexttick read 0"),s.read(0)}function C(s,a){f("resume",a.reading),a.reading||s.read(0),a.resumeScheduled=!1,s.emit("resume"),F(s),a.flowing&&!a.reading&&s.read(0)}function F(s){var a=s._readableState;for(f("flow",a.flowing);a.flowing&&null!==s.read(););}function U(s,a){return 0===a.length?null:(a.objectMode?d=a.buffer.shift():!s||s>=a.length?(d=a.decoder?a.buffer.join(""):1===a.buffer.length?a.buffer.first():a.buffer.concat(a.length),a.buffer.clear()):d=a.buffer.consume(s,a.decoder),d);var d}function $(s){var a=s._readableState;f("endReadable",a.endEmitted),a.endEmitted||(a.ended=!0,O.nextTick(te,a,s))}function te(s,a){if(f("endReadableNT",s.endEmitted,s.length),!s.endEmitted&&0===s.length&&(s.endEmitted=!0,a.readable=!1,a.emit("end"),s.autoDestroy)){var d=a._writableState;(!d||d.autoDestroy&&d.finished)&&a.destroy()}}function X(s,a){for(var d=0,T=s.length;d<T;d++)if(s[d]===a)return d;return-1}M.prototype.read=function(s){f("read",s),s=parseInt(s,10);var a=this._readableState,d=s;if(0!==s&&(a.emittedReadable=!1),0===s&&a.needReadable&&((0!==a.highWaterMark?a.length>=a.highWaterMark:a.length>0)||a.ended))return f("read: emitReadable",a.length,a.ended),0===a.length&&a.ended?$(this):ee(this),null;if(0===(s=ie(s,a))&&a.ended)return 0===a.length&&$(this),null;var T,B=a.needReadable;return f("need readable",B),(0===a.length||a.length-s<a.highWaterMark)&&f("length less than watermark",B=!0),a.ended||a.reading?f("reading or ended",B=!1):B&&(f("do read"),a.reading=!0,a.sync=!0,0===a.length&&(a.needReadable=!0),this._read(a.highWaterMark),a.sync=!1,a.reading||(s=ie(d,a))),null===(T=s>0?U(s,a):null)?(a.needReadable=a.length<=a.highWaterMark,s=0):(a.length-=s,a.awaitDrain=0),0===a.length&&(a.ended||(a.needReadable=!0),d!==s&&a.ended&&$(this)),null!==T&&this.emit("data",T),T},M.prototype._read=function(s){I(this,new ne("_read()"))},M.prototype.pipe=function(s,a){var d=this,T=this._readableState;switch(T.pipesCount){case 0:T.pipes=s;break;case 1:T.pipes=[T.pipes,s];break;default:T.pipes.push(s)}T.pipesCount+=1,f("pipe count=%d opts=%j",T.pipesCount,a);var B=a&&!1===a.end||s===O.stdout||s===O.stderr?De:K;function K(){f("onend"),s.end()}T.endEmitted?O.nextTick(B):d.once("end",B),s.on("unpipe",function H(Oe,Te){f("onunpipe"),Oe===d&&Te&&!1===Te.hasUnpiped&&(Te.hasUnpiped=!0,f("cleanup"),s.removeListener("close",Ue),s.removeListener("finish",Be),s.removeListener("drain",ae),s.removeListener("error",pe),s.removeListener("unpipe",H),d.removeListener("end",K),d.removeListener("end",De),d.removeListener("data",he),re=!0,!T.awaitDrain||s._writableState&&!s._writableState.needDrain||ae())});var Oe,ae=(Oe=d,function(){var Te=Oe._readableState;f("pipeOnDrain",Te.awaitDrain),Te.awaitDrain&&Te.awaitDrain--,0===Te.awaitDrain&&c(Oe,"data")&&(Te.flowing=!0,F(Oe))});s.on("drain",ae);var re=!1;function he(Oe){f("ondata");var Te=s.write(Oe);f("dest.write",Te),!1===Te&&((1===T.pipesCount&&T.pipes===s||T.pipesCount>1&&-1!==X(T.pipes,s))&&!re&&(f("false write response, pause",T.awaitDrain),T.awaitDrain++),d.pause())}function pe(Oe){f("onerror",Oe),De(),s.removeListener("error",pe),0===c(s,"error")&&I(s,Oe)}function Ue(){s.removeListener("finish",Be),De()}function Be(){f("onfinish"),s.removeListener("close",Ue),De()}function De(){f("unpipe"),d.unpipe(s)}return d.on("data",he),function(Oe,Te,Ie){if("function"==typeof Oe.prependListener)return Oe.prependListener(Te,Ie);Oe._events&&Oe._events[Te]?Array.isArray(Oe._events[Te])?Oe._events[Te].unshift(Ie):Oe._events[Te]=[Ie,Oe._events[Te]]:Oe.on(Te,Ie)}(s,"error",pe),s.once("close",Ue),s.once("finish",Be),s.emit("pipe",d),T.flowing||(f("pipe resume"),d.resume()),s},M.prototype.unpipe=function(s){var a=this._readableState,d={hasUnpiped:!1};if(0===a.pipesCount)return this;if(1===a.pipesCount)return s&&s!==a.pipes||(s||(s=a.pipes),a.pipes=null,a.pipesCount=0,a.flowing=!1,s&&s.emit("unpipe",this,d)),this;if(!s){var T=a.pipes,B=a.pipesCount;a.pipes=null,a.pipesCount=0,a.flowing=!1;for(var H=0;H<B;H++)T[H].emit("unpipe",this,{hasUnpiped:!1});return this}var K=X(a.pipes,s);return-1===K||(a.pipes.splice(K,1),a.pipesCount-=1,1===a.pipesCount&&(a.pipes=a.pipes[0]),s.emit("unpipe",this,d)),this},M.prototype.addListener=M.prototype.on=function(s,a){var d=h.prototype.on.call(this,s,a),T=this._readableState;return"data"===s?(T.readableListening=this.listenerCount("readable")>0,!1!==T.flowing&&this.resume()):"readable"===s&&(T.endEmitted||T.readableListening||(T.readableListening=T.needReadable=!0,T.flowing=!1,T.emittedReadable=!1,f("on readable",T.length,T.reading),T.length?ee(this):T.reading||O.nextTick(m,this))),d},M.prototype.removeListener=function(s,a){var d=h.prototype.removeListener.call(this,s,a);return"readable"===s&&O.nextTick(Y,this),d},M.prototype.removeAllListeners=function(s){var a=h.prototype.removeAllListeners.apply(this,arguments);return"readable"!==s&&void 0!==s||O.nextTick(Y,this),a},M.prototype.resume=function(){var d,s=this._readableState;return s.flowing||(f("resume"),s.flowing=!s.readableListening,this,(d=s).resumeScheduled||(d.resumeScheduled=!0,O.nextTick(C,this,d))),s.paused=!1,this},M.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},M.prototype.wrap=function(s){var a=this,d=this._readableState,T=!1;for(var B in s.on("end",function(){if(f("wrapped end"),d.decoder&&!d.ended){var K=d.decoder.end();K&&K.length&&a.push(K)}a.push(null)}),s.on("data",function(K){f("wrapped data"),d.decoder&&(K=d.decoder.write(K)),(!d.objectMode||null!=K)&&(d.objectMode||K&&K.length)&&(a.push(K)||(T=!0,s.pause()))}),s)void 0===this[B]&&"function"==typeof s[B]&&(this[B]=function(K){return function(){return s[K].apply(s,arguments)}}(B));for(var H=0;H<N.length;H++)s.on(N[H],this.emit.bind(this,N[H]));return this._read=function(K){f("wrapped _read",K),T&&(T=!1,s.resume())},this},"function"==typeof Symbol&&(M.prototype[Symbol.asyncIterator]=function(){return void 0===g&&(g=S("./internal/streams/async_iterator")),g(this)}),Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(M.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(M.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(s){this._readableState&&(this._readableState.flowing=s)}}),M._fromList=U,Object.defineProperty(M.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(M.from=function(s,a){return void 0===u&&(u=S("./internal/streams/from")),u(M,s,a)})}).call(this,S("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":49,"./_stream_duplex":50,"./internal/streams/async_iterator":55,"./internal/streams/buffer_list":56,"./internal/streams/destroy":57,"./internal/streams/from":59,"./internal/streams/state":61,"./internal/streams/stream":62,_process:44,buffer:12,events:27,inherits:29,"string_decoder/":67,util:11}],53:[function(S,e,J){"use strict";e.exports=b;var O=S("../errors").codes,v=O.ERR_METHOD_NOT_IMPLEMENTED,_=O.ERR_MULTIPLE_CALLBACK,c=O.ERR_TRANSFORM_ALREADY_TRANSFORMING,h=O.ERR_TRANSFORM_WITH_LENGTH_0,p=S("./_stream_duplex");function b(x){if(!(this instanceof b))return new b(x);p.call(this,x),this._transformState={afterTransform:function(g,u){var y=this._transformState;y.transforming=!1;var R=y.writecb;if(null===R)return this.emit("error",new _);y.writechunk=null,y.writecb=null,null!=u&&this.push(u),R(g);var P=this._readableState;P.reading=!1,(P.needReadable||P.length<P.highWaterMark)&&this._read(P.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,x&&("function"==typeof x.transform&&(this._transform=x.transform),"function"==typeof x.flush&&(this._flush=x.flush)),this.on("prefinish",f)}function f(){var x=this;"function"!=typeof this._flush||this._readableState.destroyed?w(this,null,null):this._flush(function(g,u){w(x,g,u)})}function w(x,g,u){if(g)return x.emit("error",g);if(null!=u&&x.push(u),x._writableState.length)throw new h;if(x._transformState.transforming)throw new c;return x.push(null)}S("inherits")(b,p),b.prototype.push=function(x,g){return this._transformState.needTransform=!1,p.prototype.push.call(this,x,g)},b.prototype._transform=function(x,g,u){u(new v("_transform()"))},b.prototype._write=function(x,g,u){var y=this._transformState;if(y.writecb=u,y.writechunk=x,y.writeencoding=g,!y.transforming){var R=this._readableState;(y.needTransform||R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}},b.prototype._read=function(x){var g=this._transformState;null===g.writechunk||g.transforming?g.needTransform=!0:(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform))},b.prototype._destroy=function(x,g){p.prototype._destroy.call(this,x,function(u){g(u)})}},{"../errors":49,"./_stream_duplex":50,inherits:29}],54:[function(S,e,J){(function(O,v){"use strict";function _(L){var G=this;this.next=null,this.entry=null,this.finish=function(){!function(Y,m,C){var F=Y.entry;for(Y.entry=null;F;){var U=F.callback;m.pendingcb--,U(undefined),F=F.next}m.corkedRequestsFree.next=Y}(G,L)}}var c;e.exports=M,M.WritableState=W;var w,h={deprecate:S("util-deprecate")},p=S("./internal/streams/stream"),b=S("buffer").Buffer,f=v.Uint8Array||function(){},x=S("./internal/streams/destroy"),g=S("./internal/streams/state").getHighWaterMark,u=S("../errors").codes,y=u.ERR_INVALID_ARG_TYPE,R=u.ERR_METHOD_NOT_IMPLEMENTED,P=u.ERR_MULTIPLE_CALLBACK,D=u.ERR_STREAM_CANNOT_PIPE,Z=u.ERR_STREAM_DESTROYED,k=u.ERR_STREAM_NULL_VALUES,ne=u.ERR_STREAM_WRITE_AFTER_END,A=u.ERR_UNKNOWN_ENCODING,I=x.errorOrDestroy;function N(){}function W(L,G,Y){c=c||S("./_stream_duplex"),"boolean"!=typeof Y&&(Y=G instanceof c),this.objectMode=!!(L=L||{}).objectMode,Y&&(this.objectMode=this.objectMode||!!L.writableObjectMode),this.highWaterMark=g(this,L,"writableHighWaterMark",Y),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===L.decodeStrings),this.defaultEncoding=L.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(C){!function(F,U){var a,$=F._writableState,te=$.sync,X=$.writecb;if("function"!=typeof X)throw new P;if((a=$).writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0,U)!function(a,d,T,B,H){--d.pendingcb,T?(O.nextTick(H,B),O.nextTick(z,a,d),a._writableState.errorEmitted=!0,I(a,B)):(H(B),a._writableState.errorEmitted=!0,I(a,B),z(a,d))}(F,$,te,U,X);else{var s=ie($)||F.destroyed;s||$.corked||$.bufferProcessing||!$.bufferedRequest||oe(F,$),te?O.nextTick(q,F,$,s,X):q(F,$,s,X)}}(G,C)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==L.emitClose,this.autoDestroy=!!L.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new _(this)}function M(L){var G=this instanceof(c=c||S("./_stream_duplex"));if(!G&&!w.call(M,this))return new M(L);this._writableState=new W(L,this,G),this.writable=!0,L&&("function"==typeof L.write&&(this._write=L.write),"function"==typeof L.writev&&(this._writev=L.writev),"function"==typeof L.destroy&&(this._destroy=L.destroy),"function"==typeof L.final&&(this._final=L.final)),p.call(this)}function j(L,G,Y,m,C,F,U){G.writelen=m,G.writecb=U,G.writing=!0,G.sync=!0,G.destroyed?G.onwrite(new Z("write")):Y?L._writev(C,G.onwrite):L._write(C,F,G.onwrite),G.sync=!1}function q(L,G,Y,m){var C,F;Y||(C=L,0===(F=G).length&&F.needDrain&&(F.needDrain=!1,C.emit("drain"))),G.pendingcb--,m(),z(L,G)}function oe(L,G){G.bufferProcessing=!0;var Y=G.bufferedRequest;if(L._writev&&Y&&Y.next){var C=new Array(G.bufferedRequestCount),F=G.corkedRequestsFree;F.entry=Y;for(var U=0,$=!0;Y;)C[U]=Y,Y.isBuf||($=!1),Y=Y.next,U+=1;C.allBuffers=$,j(L,G,!0,G.length,C,"",F.finish),G.pendingcb++,G.lastBufferedRequest=null,F.next?(G.corkedRequestsFree=F.next,F.next=null):G.corkedRequestsFree=new _(G),G.bufferedRequestCount=0}else{for(;Y;){var te=Y.chunk;if(j(L,G,!1,G.objectMode?1:te.length,te,Y.encoding,Y.callback),Y=Y.next,G.bufferedRequestCount--,G.writing)break}null===Y&&(G.lastBufferedRequest=null)}G.bufferedRequest=Y,G.bufferProcessing=!1}function ie(L){return L.ending&&0===L.length&&null===L.bufferedRequest&&!L.finished&&!L.writing}function ee(L,G){L._final(function(Y){G.pendingcb--,Y&&I(L,Y),G.prefinished=!0,L.emit("prefinish"),z(L,G)})}function z(L,G){var C,F,Y=ie(G);if(Y&&(C=L,(F=G).prefinished||F.finalCalled||("function"!=typeof C._final||F.destroyed?(F.prefinished=!0,C.emit("prefinish")):(F.pendingcb++,F.finalCalled=!0,O.nextTick(ee,C,F))),0===G.pendingcb&&(G.finished=!0,L.emit("finish"),G.autoDestroy))){var m=L._readableState;(!m||m.autoDestroy&&m.endEmitted)&&L.destroy()}return Y}S("inherits")(M,p),W.prototype.getBuffer=function(){for(var L=this.bufferedRequest,G=[];L;)G.push(L),L=L.next;return G},function(){try{Object.defineProperty(W.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(w=Function.prototype[Symbol.hasInstance],Object.defineProperty(M,Symbol.hasInstance,{value:function(L){return!!w.call(this,L)||this===M&&L&&L._writableState instanceof W}})):w=function(L){return L instanceof this},M.prototype.pipe=function(){I(this,new D)},M.prototype.write=function(L,G,Y){var m,$,te,X,C=this._writableState,F=!1,U=!C.objectMode&&(b.isBuffer(m=L)||m instanceof f);return U&&!b.isBuffer(L)&&(L=b.from(L)),"function"==typeof G&&(Y=G,G=null),U?G="buffer":G||(G=C.defaultEncoding),"function"!=typeof Y&&(Y=N),C.ending?($=this,te=Y,X=new ne,I($,X),O.nextTick(te,X)):(U||function($,te,X,s){var a;return null===X?a=new k:"string"==typeof X||te.objectMode||(a=new y("chunk",["string","Buffer"],X)),!a||(I($,a),O.nextTick(s,a),!1)}(this,C,L,Y))&&(C.pendingcb++,F=function($,te,X,s,a,d){if(!X){var T=(re=s,(ae=te).objectMode||!1===ae.decodeStrings||"string"!=typeof re||(re=b.from(re,a)),re);s!==T&&(X=!0,a="buffer",s=T)}var ae,re,B=te.objectMode?1:s.length;te.length+=B;var H=te.length<te.highWaterMark;if(H||(te.needDrain=!0),te.writing||te.corked){var K=te.lastBufferedRequest;te.lastBufferedRequest={chunk:s,encoding:a,isBuf:X,callback:d,next:null},K?K.next=te.lastBufferedRequest:te.bufferedRequest=te.lastBufferedRequest,te.bufferedRequestCount+=1}else j($,te,!1,B,s,a,d);return H}(this,C,U,L,G,Y)),F},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){var L=this._writableState;L.corked&&(L.corked--,L.writing||L.corked||L.bufferProcessing||!L.bufferedRequest||oe(this,L))},M.prototype.setDefaultEncoding=function(L){if("string"==typeof L&&(L=L.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((L+"").toLowerCase())>-1))throw new A(L);return this._writableState.defaultEncoding=L,this},Object.defineProperty(M.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(M.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),M.prototype._write=function(L,G,Y){Y(new R("_write()"))},M.prototype._writev=null,M.prototype.end=function(L,G,Y){var C,F,U,m=this._writableState;return"function"==typeof L?(Y=L,L=null,G=null):"function"==typeof G&&(Y=G,G=null),null!=L&&this.write(L,G),m.corked&&(m.corked=1,this.uncork()),m.ending||(C=this,U=Y,(F=m).ending=!0,z(C,F),U&&(F.finished?O.nextTick(U):C.once("finish",U)),F.ended=!0,C.writable=!1),this},Object.defineProperty(M.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(L){this._writableState&&(this._writableState.destroyed=L)}}),M.prototype.destroy=x.destroy,M.prototype._undestroy=x.undestroy,M.prototype._destroy=function(L,G){G(L)}}).call(this,S("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":49,"./_stream_duplex":50,"./internal/streams/destroy":57,"./internal/streams/state":61,"./internal/streams/stream":62,_process:44,buffer:12,inherits:29,"util-deprecate":71}],55:[function(S,e,J){(function(O){"use strict";var v;function _(D,Z,k){return Z in D?Object.defineProperty(D,Z,{value:k,enumerable:!0,configurable:!0,writable:!0}):D[Z]=k,D}var c=S("./end-of-stream"),h=Symbol("lastResolve"),p=Symbol("lastReject"),b=Symbol("error"),f=Symbol("ended"),w=Symbol("lastPromise"),x=Symbol("handlePromise"),g=Symbol("stream");function u(D,Z){return{value:D,done:Z}}function y(D){var Z=D[h];if(null!==Z){var k=D[g].read();null!==k&&(D[w]=null,D[h]=null,D[p]=null,Z(u(k,!1)))}}var R=Object.getPrototypeOf(function(){}),P=Object.setPrototypeOf((_(v={get stream(){return this[g]},next:function(){var D=this,Z=this[b];if(null!==Z)return Promise.reject(Z);if(this[f])return Promise.resolve(u(void 0,!0));if(this[g].destroyed)return new Promise(function(I,N){O.nextTick(function(){D[b]?N(D[b]):I(u(void 0,!0))})});var k,I,N,ne=this[w];if(ne)k=new Promise((I=ne,N=this,function(W,M){I.then(function(){N[f]?W(u(void 0,!0)):N[x](W,M)},M)}));else{var A=this[g].read();if(null!==A)return Promise.resolve(u(A,!1));k=new Promise(this[x])}return this[w]=k,k}},Symbol.asyncIterator,function(){return this}),_(v,"return",function(){var D=this;return new Promise(function(Z,k){D[g].destroy(null,function(ne){ne?k(ne):Z(u(void 0,!0))})})}),v),R);e.exports=function(D){var Z,k=Object.create(P,(_(Z={},g,{value:D,writable:!0}),_(Z,h,{value:null,writable:!0}),_(Z,p,{value:null,writable:!0}),_(Z,b,{value:null,writable:!0}),_(Z,f,{value:D._readableState.endEmitted,writable:!0}),_(Z,x,{value:function(ne,A){var I=k[g].read();I?(k[w]=null,k[h]=null,k[p]=null,ne(u(I,!1))):(k[h]=ne,k[p]=A)},writable:!0}),Z));return k[w]=null,c(D,function(ne){if(ne&&"ERR_STREAM_PREMATURE_CLOSE"!==ne.code){var A=k[p];return null!==A&&(k[w]=null,k[h]=null,k[p]=null,A(ne)),void(k[b]=ne)}var I=k[h];null!==I&&(k[w]=null,k[h]=null,k[p]=null,I(u(void 0,!0))),k[f]=!0}),D.on("readable",function(ne){O.nextTick(y,ne)}.bind(null,k)),k}}).call(this,S("_process"))},{"./end-of-stream":58,_process:44}],56:[function(S,e,J){"use strict";function O(b,f){var w=Object.keys(b);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(b);f&&(x=x.filter(function(g){return Object.getOwnPropertyDescriptor(b,g).enumerable})),w.push.apply(w,x)}return w}function v(b,f,w){return f in b?Object.defineProperty(b,f,{value:w,enumerable:!0,configurable:!0,writable:!0}):b[f]=w,b}function _(b,f){for(var w=0;w<f.length;w++){var x=f[w];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(b,x.key,x)}}var c=S("buffer").Buffer,h=S("util").inspect,p=h&&h.custom||"inspect";e.exports=function(){function b(){(function(g,u){if(!(g instanceof u))throw new TypeError("Cannot call a class as a function")})(this,b),this.head=null,this.tail=null,this.length=0}var f,w;return f=b,(w=[{key:"push",value:function(g){var u={data:g,next:null};this.length>0?this.tail.next=u:this.head=u,this.tail=u,++this.length}},{key:"unshift",value:function(g){var u={data:g,next:this.head};0===this.length&&(this.tail=u),this.head=u,++this.length}},{key:"shift",value:function(){if(0!==this.length){var g=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(0===this.length)return"";for(var u=this.head,y=""+u.data;u=u.next;)y+=g+u.data;return y}},{key:"concat",value:function(g){if(0===this.length)return c.alloc(0);for(var P=c.allocUnsafe(g>>>0),D=this.head,Z=0;D;)c.prototype.copy.call(D.data,P,Z),Z+=D.data.length,D=D.next;return P}},{key:"consume",value:function(g,u){var y;return g<this.head.data.length?(y=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):y=g===this.head.data.length?this.shift():u?this._getString(g):this._getBuffer(g),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var u=this.head,y=1,R=u.data;for(g-=R.length;u=u.next;){var P=u.data,D=g>P.length?P.length:g;if(R+=D===P.length?P:P.slice(0,g),0==(g-=D)){D===P.length?(++y,this.head=u.next?u.next:this.tail=null):(this.head=u,u.data=P.slice(D));break}++y}return this.length-=y,R}},{key:"_getBuffer",value:function(g){var u=c.allocUnsafe(g),y=this.head,R=1;for(y.data.copy(u),g-=y.data.length;y=y.next;){var P=y.data,D=g>P.length?P.length:g;if(P.copy(u,u.length-g,0,D),0==(g-=D)){D===P.length?(++R,this.head=y.next?y.next:this.tail=null):(this.head=y,y.data=P.slice(D));break}++R}return this.length-=R,u}},{key:p,value:function(g,u){return h(this,function(y){for(var R=1;R<arguments.length;R++){var P=null!=arguments[R]?arguments[R]:{};R%2?O(Object(P),!0).forEach(function(D){v(y,D,P[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(P)):O(Object(P)).forEach(function(D){Object.defineProperty(y,D,Object.getOwnPropertyDescriptor(P,D))})}return y}({},u,{depth:0,customInspect:!1}))}}])&&_(f.prototype,w),b}()},{buffer:12,util:11}],57:[function(S,e,J){(function(O){"use strict";function v(h,p){c(h,p),_(h)}function _(h){h._writableState&&!h._writableState.emitClose||h._readableState&&!h._readableState.emitClose||h.emit("close")}function c(h,p){h.emit("error",p)}e.exports={destroy:function(h,p){var b=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(p?p(h):h&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,O.nextTick(c,this,h)):O.nextTick(c,this,h)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(h||null,function(x){!p&&x?b._writableState?b._writableState.errorEmitted?O.nextTick(_,b):(b._writableState.errorEmitted=!0,O.nextTick(v,b,x)):O.nextTick(v,b,x):p?(O.nextTick(_,b),p(x)):O.nextTick(_,b)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(h,p){var b=h._readableState,f=h._writableState;b&&b.autoDestroy||f&&f.autoDestroy?h.destroy(p):h.emit("error",p)}}}).call(this,S("_process"))},{_process:44}],58:[function(S,e,J){"use strict";var O=S("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function v(){}e.exports=function _(c,h,p){if("function"==typeof h)return _(c,null,h);var Z,k;h||(h={}),Z=p||v,k=!1,p=function(){if(!k){k=!0;for(var ne=arguments.length,A=new Array(ne),I=0;I<ne;I++)A[I]=arguments[I];Z.apply(this,A)}};var b=h.readable||!1!==h.readable&&c.readable,f=h.writable||!1!==h.writable&&c.writable,w=function(){c.writable||g()},x=c._writableState&&c._writableState.finished,g=function(){f=!1,x=!0,b||p.call(c)},u=c._readableState&&c._readableState.endEmitted,y=function(){b=!1,u=!0,f||p.call(c)},R=function(Z){p.call(c,Z)},P=function(){var Z;return b&&!u?(c._readableState&&c._readableState.ended||(Z=new O),p.call(c,Z)):f&&!x?(c._writableState&&c._writableState.ended||(Z=new O),p.call(c,Z)):void 0},D=function(){c.req.on("finish",g)};return function(Z){return Z.setHeader&&"function"==typeof Z.abort}(c)?(c.on("complete",g),c.on("abort",P),c.req?D():c.on("request",D)):f&&!c._writableState&&(c.on("end",w),c.on("close",w)),c.on("end",y),c.on("finish",g),!1!==h.error&&c.on("error",R),c.on("close",P),function(){c.removeListener("complete",g),c.removeListener("abort",P),c.removeListener("request",D),c.req&&c.req.removeListener("finish",g),c.removeListener("end",w),c.removeListener("close",w),c.removeListener("finish",g),c.removeListener("end",y),c.removeListener("error",R),c.removeListener("close",P)}}},{"../../../errors":49}],59:[function(S,e,J){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],60:[function(S,e,J){"use strict";var O,v=S("../../../errors").codes,_=v.ERR_MISSING_ARGS,c=v.ERR_STREAM_DESTROYED;function h(f){if(f)throw f}function p(f){f()}function b(f,w){return f.pipe(w)}e.exports=function(){for(var f=arguments.length,w=new Array(f),x=0;x<f;x++)w[x]=arguments[x];var g,R,u=(R=w).length?"function"!=typeof R[R.length-1]?h:R.pop():h;if(Array.isArray(w[0])&&(w=w[0]),w.length<2)throw new _("streams");var y=w.map(function(R,P){var D=P<w.length-1;return function(Z,k,ne,A){var W,M;W=A,M=!1,A=function(){M||(M=!0,W.apply(void 0,arguments))};var I=!1;Z.on("close",function(){I=!0}),void 0===O&&(O=S("./end-of-stream")),O(Z,{readable:k,writable:ne},function(W){if(W)return A(W);I=!0,A()});var N=!1;return function(W){if(!I&&!N)return N=!0,function(M){return M.setHeader&&"function"==typeof M.abort}(Z)?Z.abort():"function"==typeof Z.destroy?Z.destroy():void A(W||new c("pipe"))}}(R,D,P>0,function(Z){g||(g=Z),Z&&y.forEach(p),D||(y.forEach(p),u(g))})});return w.reduce(b)}},{"../../../errors":49,"./end-of-stream":58}],61:[function(S,e,J){"use strict";var O=S("../../../errors").codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(v,_,c,h){var b,p=null!=(b=_).highWaterMark?b.highWaterMark:h?b[c]:null;if(null!=p){if(!isFinite(p)||Math.floor(p)!==p||p<0)throw new O(h?c:"highWaterMark",p);return Math.floor(p)}return v.objectMode?16:16384}}},{"../../../errors":49}],62:[function(S,e,J){arguments[4][24][0].apply(J,arguments)},{dup:24,events:27}],63:[function(S,e,J){(J=e.exports=S("./lib/_stream_readable.js")).Stream=J,J.Readable=J,J.Writable=S("./lib/_stream_writable.js"),J.Duplex=S("./lib/_stream_duplex.js"),J.Transform=S("./lib/_stream_transform.js"),J.PassThrough=S("./lib/_stream_passthrough.js"),J.finished=S("./lib/internal/streams/end-of-stream.js"),J.pipeline=S("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":50,"./lib/_stream_passthrough.js":51,"./lib/_stream_readable.js":52,"./lib/_stream_transform.js":53,"./lib/_stream_writable.js":54,"./lib/internal/streams/end-of-stream.js":58,"./lib/internal/streams/pipeline.js":60}],64:[function(S,e,J){"use strict";e.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("interval needed");var O;if(arguments.length>0){O=new Array(arguments.length-2);for(var v=0;v<O.length;v++)O[v]=arguments[v+2]}return new function(_,c,h){var p=this;this._callback=_,this._args=h,this._interval=setInterval(_,c,this._args),this.reschedule=function(b){b||(b=p._interval),p._interval&&clearInterval(p._interval),p._interval=setInterval(p._callback,b,p._args)},this.clear=function(){p._interval&&(clearInterval(p._interval),p._interval=void 0)},this.destroy=function(){p._interval&&clearInterval(p._interval),p._callback=void 0,p._interval=void 0,p._args=void 0}}(arguments[0],arguments[1],O)}},{}],65:[function(S,e,J){var O=S("buffer"),v=O.Buffer;function _(h,p){for(var b in h)p[b]=h[b]}function c(h,p,b){return v(h,p,b)}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?e.exports=O:(_(O,J),J.Buffer=c),_(v,c),c.from=function(h,p,b){if("number"==typeof h)throw new TypeError("Argument must not be a number");return v(h,p,b)},c.alloc=function(h,p,b){if("number"!=typeof h)throw new TypeError("Argument must be a number");var f=v(h);return void 0!==p?"string"==typeof b?f.fill(p,b):f.fill(p):f.fill(0),f},c.allocUnsafe=function(h){if("number"!=typeof h)throw new TypeError("Argument must be a number");return v(h)},c.allocUnsafeSlow=function(h){if("number"!=typeof h)throw new TypeError("Argument must be a number");return O.SlowBuffer(h)}},{buffer:12}],66:[function(S,e,J){e.exports=function(O){var _,v=O._readableState;return v?v.objectMode||"number"==typeof O._duplexState?O.read():O.read((_=v).buffer.length?_.buffer.head?_.buffer.head.data.length:_.buffer[0].length:_.length):null}},{}],67:[function(S,e,J){"use strict";var O=S("safe-buffer").Buffer,v=O.isEncoding||function(u){switch((u=""+u)&&u.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _(u){var y;switch(this.encoding=function(R){var P=function(D){if(!D)return"utf8";for(var Z;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(Z)return;D=(""+D).toLowerCase(),Z=!0}}(R);if("string"!=typeof P&&(O.isEncoding===v||!v(R)))throw new Error("Unknown encoding: "+R);return P||R}(u),this.encoding){case"utf16le":this.text=p,this.end=b,y=4;break;case"utf8":this.fillLast=h,y=4;break;case"base64":this.text=f,this.end=w,y=3;break;default:return this.write=x,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=O.allocUnsafe(y)}function c(u){return u<=127?0:u>>5==6?2:u>>4==14?3:u>>3==30?4:u>>6==2?-1:-2}function h(u){var y=this.lastTotal-this.lastNeed,R=function(P,D,Z){if(128!=(192&D[0]))return P.lastNeed=0,"\ufffd";if(P.lastNeed>1&&D.length>1){if(128!=(192&D[1]))return P.lastNeed=1,"\ufffd";if(P.lastNeed>2&&D.length>2&&128!=(192&D[2]))return P.lastNeed=2,"\ufffd"}}(this,u);return void 0!==R?R:this.lastNeed<=u.length?(u.copy(this.lastChar,y,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(u.copy(this.lastChar,y,0,u.length),void(this.lastNeed-=u.length))}function p(u,y){if((u.length-y)%2==0){var R=u.toString("utf16le",y);if(R){var P=R.charCodeAt(R.length-1);if(P>=55296&&P<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1],R.slice(0,-1)}return R}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=u[u.length-1],u.toString("utf16le",y,u.length-1)}function b(u){var y=u&&u.length?this.write(u):"";return this.lastNeed?y+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):y}function f(u,y){var R=(u.length-y)%3;return 0===R?u.toString("base64",y):(this.lastNeed=3-R,this.lastTotal=3,1===R?this.lastChar[0]=u[u.length-1]:(this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1]),u.toString("base64",y,u.length-R))}function w(u){var y=u&&u.length?this.write(u):"";return this.lastNeed?y+this.lastChar.toString("base64",0,3-this.lastNeed):y}function x(u){return u.toString(this.encoding)}function g(u){return u&&u.length?this.write(u):""}J.StringDecoder=_,_.prototype.write=function(u){if(0===u.length)return"";var y,R;if(this.lastNeed){if(void 0===(y=this.fillLast(u)))return"";R=this.lastNeed,this.lastNeed=0}else R=0;return R<u.length?y?y+this.text(u,R):this.text(u,R):y||""},_.prototype.end=function(u){var y=u&&u.length?this.write(u):"";return this.lastNeed?y+"\ufffd":y},_.prototype.text=function(u,y){var R=function(D,Z,k){var ne=Z.length-1;if(ne<k)return 0;var A=c(Z[ne]);return A>=0?(A>0&&(D.lastNeed=A-1),A):--ne<k||-2===A?0:(A=c(Z[ne]))>=0?(A>0&&(D.lastNeed=A-2),A):--ne<k||-2===A?0:(A=c(Z[ne]))>=0?(A>0&&(2===A?A=0:D.lastNeed=A-3),A):0}(this,u,y);if(!this.lastNeed)return u.toString("utf8",y);this.lastTotal=R;var P=u.length-(R-this.lastNeed);return u.copy(this.lastChar,0,P),u.toString("utf8",y,P)},_.prototype.fillLast=function(u){if(this.lastNeed<=u.length)return u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,u.length),this.lastNeed-=u.length}},{"safe-buffer":65}],68:[function(S,e,J){(function(O,v){var _=S("process/browser.js").nextTick,c=Function.prototype.apply,h=Array.prototype.slice,p={},b=0;function f(w,x){this._id=w,this._clearFn=x}J.setTimeout=function(){return new f(c.call(setTimeout,window,arguments),clearTimeout)},J.setInterval=function(){return new f(c.call(setInterval,window,arguments),clearInterval)},J.clearTimeout=J.clearInterval=function(w){w.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},J.enroll=function(w,x){clearTimeout(w._idleTimeoutId),w._idleTimeout=x},J.unenroll=function(w){clearTimeout(w._idleTimeoutId),w._idleTimeout=-1},J._unrefActive=J.active=function(w){clearTimeout(w._idleTimeoutId);var x=w._idleTimeout;x>=0&&(w._idleTimeoutId=setTimeout(function(){w._onTimeout&&w._onTimeout()},x))},J.setImmediate="function"==typeof O?O:function(w){var x=b++,g=!(arguments.length<2)&&h.call(arguments,1);return p[x]=!0,_(function(){p[x]&&(g?w.apply(null,g):w.call(null),J.clearImmediate(x))}),x},J.clearImmediate="function"==typeof v?v:function(w){delete p[w]}}).call(this,S("timers").setImmediate,S("timers").clearImmediate)},{"process/browser.js":44,timers:68}],69:[function(S,e,J){"use strict";var O=S("punycode"),v=S("./util");function _(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}J.parse=Z,J.resolve=function(k,ne){return Z(k,!1,!0).resolve(ne)},J.resolveObject=function(k,ne){return k?Z(k,!1,!0).resolveObject(ne):ne},J.format=function(k){return v.isString(k)&&(k=Z(k)),k instanceof _?k.format():_.prototype.format.call(k)},J.Url=_;var c=/^([a-z0-9.+-]+:)/i,h=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,b=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),f=["'"].concat(b),w=["%","/","?",";","#"].concat(f),x=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,u=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},R={javascript:!0,"javascript:":!0},P={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},D=S("querystring");function Z(k,ne,A){if(k&&v.isObject(k)&&k instanceof _)return k;var I=new _;return I.parse(k,ne,A),I}_.prototype.parse=function(k,ne,A){if(!v.isString(k))throw new TypeError("Parameter 'url' must be a string, not "+typeof k);var I=k.indexOf("?"),N=-1!==I&&I<k.indexOf("#")?"?":"#",W=k.split(N);W[0]=W[0].replace(/\\/g,"/");var M=k=W.join(N);if(M=M.trim(),!A&&1===k.split("#").length){var j=p.exec(M);if(j)return this.path=M,this.href=M,this.pathname=j[1],j[2]?(this.search=j[2],this.query=ne?D.parse(this.search.substr(1)):this.search.substr(1)):ne&&(this.search="",this.query={}),this}var q=c.exec(M);if(q){var oe=(q=q[0]).toLowerCase();this.protocol=oe,M=M.substr(q.length)}if(A||q||M.match(/^\/\/[^@\/]+@[^@\/]+/)){var ie="//"===M.substr(0,2);!ie||q&&R[q]||(M=M.substr(2),this.slashes=!0)}if(!R[q]&&(ie||q&&!P[q])){for(var ee,z,L=-1,G=0;G<x.length;G++)-1!==(Y=M.indexOf(x[G]))&&(-1===L||Y<L)&&(L=Y);for(-1!==(z=-1===L?M.lastIndexOf("@"):M.lastIndexOf("@",L))&&(ee=M.slice(0,z),M=M.slice(z+1),this.auth=decodeURIComponent(ee)),L=-1,G=0;G<w.length;G++){var Y;-1!==(Y=M.indexOf(w[G]))&&(-1===L||Y<L)&&(L=Y)}-1===L&&(L=M.length),this.host=M.slice(0,L),M=M.slice(L),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var C=this.hostname.split(/\./),F=(G=0,C.length);G<F;G++){var U=C[G];if(U&&!U.match(g)){for(var $="",te=0,X=U.length;te<X;te++)U.charCodeAt(te)>127?$+="x":$+=U[te];if(!$.match(g)){var s=C.slice(0,G),a=C.slice(G+1),d=U.match(u);d&&(s.push(d[1]),a.unshift(d[2])),a.length&&(M="/"+a.join(".")+M),this.hostname=s.join(".");break}}}this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),m||(this.hostname=O.toASCII(this.hostname));var T=this.port?":"+this.port:"";this.host=(this.hostname||"")+T,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==M[0]&&(M="/"+M))}if(!y[oe])for(G=0,F=f.length;G<F;G++){var H=f[G];if(-1!==M.indexOf(H)){var K=encodeURIComponent(H);K===H&&(K=escape(H)),M=M.split(H).join(K)}}var ae=M.indexOf("#");-1!==ae&&(this.hash=M.substr(ae),M=M.slice(0,ae));var re=M.indexOf("?");return-1!==re?(this.search=M.substr(re),this.query=M.substr(re+1),ne&&(this.query=D.parse(this.query)),M=M.slice(0,re)):ne&&(this.search="",this.query={}),M&&(this.pathname=M),P[oe]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(T=this.pathname||"")+(this.search||"")),this.href=this.format(),this},_.prototype.format=function(){var k=this.auth||"";k&&(k=(k=encodeURIComponent(k)).replace(/%3A/i,":"),k+="@");var ne=this.protocol||"",A=this.pathname||"",I=this.hash||"",N=!1,W="";this.host?N=k+this.host:this.hostname&&(N=k+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(N+=":"+this.port)),this.query&&v.isObject(this.query)&&Object.keys(this.query).length&&(W=D.stringify(this.query));var M=this.search||W&&"?"+W||"";return ne&&":"!==ne.substr(-1)&&(ne+=":"),this.slashes||(!ne||P[ne])&&!1!==N?(N="//"+(N||""),A&&"/"!==A.charAt(0)&&(A="/"+A)):N||(N=""),I&&"#"!==I.charAt(0)&&(I="#"+I),M&&"?"!==M.charAt(0)&&(M="?"+M),ne+N+(A=A.replace(/[?#]/g,function(j){return encodeURIComponent(j)}))+(M=M.replace("#","%23"))+I},_.prototype.resolve=function(k){return this.resolveObject(Z(k,!1,!0)).format()},_.prototype.resolveObject=function(k){if(v.isString(k)){var ne=new _;ne.parse(k,!1,!0),k=ne}for(var A=new _,I=Object.keys(this),N=0;N<I.length;N++){var W=I[N];A[W]=this[W]}if(A.hash=k.hash,""===k.href)return A.href=A.format(),A;if(k.slashes&&!k.protocol){for(var M=Object.keys(k),j=0;j<M.length;j++){var q=M[j];"protocol"!==q&&(A[q]=k[q])}return P[A.protocol]&&A.hostname&&!A.pathname&&(A.path=A.pathname="/"),A.href=A.format(),A}if(k.protocol&&k.protocol!==A.protocol){if(!P[k.protocol]){for(var oe=Object.keys(k),ie=0;ie<oe.length;ie++){var ee=oe[ie];A[ee]=k[ee]}return A.href=A.format(),A}if(A.protocol=k.protocol,k.host||R[k.protocol])A.pathname=k.pathname;else{for(var z=(k.pathname||"").split("/");z.length&&!(k.host=z.shift()););k.host||(k.host=""),k.hostname||(k.hostname=""),""!==z[0]&&z.unshift(""),z.length<2&&z.unshift(""),A.pathname=z.join("/")}return A.search=k.search,A.query=k.query,A.host=k.host||"",A.auth=k.auth,A.hostname=k.hostname||k.host,A.port=k.port,(A.pathname||A.search)&&(A.path=(A.pathname||"")+(A.search||"")),A.slashes=A.slashes||k.slashes,A.href=A.format(),A}var Y=A.pathname&&"/"===A.pathname.charAt(0),m=k.host||k.pathname&&"/"===k.pathname.charAt(0),C=m||Y||A.host&&k.pathname,F=C,U=A.pathname&&A.pathname.split("/")||[],$=(z=k.pathname&&k.pathname.split("/")||[],A.protocol&&!P[A.protocol]);if($&&(A.hostname="",A.port=null,A.host&&(""===U[0]?U[0]=A.host:U.unshift(A.host)),A.host="",k.protocol&&(k.hostname=null,k.port=null,k.host&&(""===z[0]?z[0]=k.host:z.unshift(k.host)),k.host=null),C=C&&(""===z[0]||""===U[0])),m)A.host=k.host||""===k.host?k.host:A.host,A.hostname=k.hostname||""===k.hostname?k.hostname:A.hostname,A.search=k.search,A.query=k.query,U=z;else if(z.length)U||(U=[]),U.pop(),U=U.concat(z),A.search=k.search,A.query=k.query;else if(!v.isNullOrUndefined(k.search))return $&&(A.hostname=A.host=U.shift(),(d=!!(A.host&&A.host.indexOf("@")>0)&&A.host.split("@"))&&(A.auth=d.shift(),A.host=A.hostname=d.shift())),A.search=k.search,A.query=k.query,v.isNull(A.pathname)&&v.isNull(A.search)||(A.path=(A.pathname?A.pathname:"")+(A.search?A.search:"")),A.href=A.format(),A;if(!U.length)return A.pathname=null,A.path=A.search?"/"+A.search:null,A.href=A.format(),A;for(var te=U.slice(-1)[0],X=(A.host||k.host||U.length>1)&&("."===te||".."===te)||""===te,s=0,a=U.length;a>=0;a--)"."===(te=U[a])?U.splice(a,1):".."===te?(U.splice(a,1),s++):s&&(U.splice(a,1),s--);if(!C&&!F)for(;s--;s)U.unshift("..");!C||""===U[0]||U[0]&&"/"===U[0].charAt(0)||U.unshift(""),X&&"/"!==U.join("/").substr(-1)&&U.push("");var d,T=""===U[0]||U[0]&&"/"===U[0].charAt(0);return $&&(A.hostname=A.host=T?"":U.length?U.shift():"",(d=!!(A.host&&A.host.indexOf("@")>0)&&A.host.split("@"))&&(A.auth=d.shift(),A.host=A.hostname=d.shift())),(C=C||A.host&&U.length)&&!T&&U.unshift(""),U.length?A.pathname=U.join("/"):(A.pathname=null,A.path=null),v.isNull(A.pathname)&&v.isNull(A.search)||(A.path=(A.pathname?A.pathname:"")+(A.search?A.search:"")),A.auth=k.auth||A.auth,A.slashes=A.slashes||k.slashes,A.href=A.format(),A},_.prototype.parseHost=function(){var k=this.host,ne=h.exec(k);ne&&(":"!==(ne=ne[0])&&(this.port=ne.substr(1)),k=k.substr(0,k.length-ne.length)),k&&(this.hostname=k)}},{"./util":70,punycode:45,querystring:48}],70:[function(S,e,J){"use strict";e.exports={isString:function(O){return"string"==typeof O},isObject:function(O){return"object"==typeof O&&null!==O},isNull:function(O){return null===O},isNullOrUndefined:function(O){return null==O}}},{}],71:[function(S,e,J){(function(O){function v(_){try{if(!O.localStorage)return!1}catch{return!1}var c=O.localStorage[_];return null!=c&&"true"===String(c).toLowerCase()}e.exports=function(_,c){if(v("noDeprecation"))return _;var h=!1;return function(){if(!h){if(v("throwDeprecation"))throw new Error(c);v("traceDeprecation")?console.trace(c):console.warn(c),h=!0}return _.apply(this,arguments)}}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],72:[function(S,e,J){e.exports=function O(v,_){if(v&&_)return O(v)(_);if("function"!=typeof v)throw new TypeError("need wrapper function");return Object.keys(v).forEach(function(h){c[h]=v[h]}),c;function c(){for(var h=new Array(arguments.length),p=0;p<h.length;p++)h[p]=arguments[p];var b=v.apply(this,h),f=h[h.length-1];return"function"==typeof b&&b!==f&&Object.keys(f).forEach(function(w){b[w]=f[w]}),b}}},{}],73:[function(S,e,J){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}],74:[function(S,e,J){e.exports=function(){for(var v={},_=0;_<arguments.length;_++){var c=arguments[_];for(var h in c)O.call(c,h)&&(v[h]=c[h])}return v};var O=Object.prototype.hasOwnProperty},{}]},{},[9])(9)},6700:(ze,Ln,be)=>{var S={"./af":7088,"./af.js":7088,"./ar":7038,"./ar-dz":2502,"./ar-dz.js":2502,"./ar-kw":128,"./ar-kw.js":128,"./ar-ly":4519,"./ar-ly.js":4519,"./ar-ma":5443,"./ar-ma.js":5443,"./ar-sa":7642,"./ar-sa.js":7642,"./ar-tn":8592,"./ar-tn.js":8592,"./ar.js":7038,"./az":1213,"./az.js":1213,"./be":9191,"./be.js":9191,"./bg":322,"./bg.js":322,"./bm":8042,"./bm.js":8042,"./bn":9620,"./bn-bd":5903,"./bn-bd.js":5903,"./bn.js":9620,"./bo":9645,"./bo.js":9645,"./br":5020,"./br.js":5020,"./bs":4792,"./bs.js":4792,"./ca":7980,"./ca.js":7980,"./cs":7322,"./cs.js":7322,"./cv":365,"./cv.js":365,"./cy":2092,"./cy.js":2092,"./da":7387,"./da.js":7387,"./de":4307,"./de-at":9459,"./de-at.js":9459,"./de-ch":3694,"./de-ch.js":3694,"./de.js":4307,"./dv":9659,"./dv.js":9659,"./el":3460,"./el.js":3460,"./en-au":4369,"./en-au.js":4369,"./en-ca":530,"./en-ca.js":530,"./en-gb":9998,"./en-gb.js":9998,"./en-ie":3391,"./en-ie.js":3391,"./en-il":5414,"./en-il.js":5414,"./en-in":9615,"./en-in.js":9615,"./en-nz":1248,"./en-nz.js":1248,"./en-sg":3767,"./en-sg.js":3767,"./eo":4530,"./eo.js":4530,"./es":6866,"./es-do":8944,"./es-do.js":8944,"./es-mx":9116,"./es-mx.js":9116,"./es-us":3609,"./es-us.js":3609,"./es.js":6866,"./et":6725,"./et.js":6725,"./eu":7931,"./eu.js":7931,"./fa":6417,"./fa.js":6417,"./fi":944,"./fi.js":944,"./fil":1766,"./fil.js":1766,"./fo":5867,"./fo.js":5867,"./fr":1636,"./fr-ca":6848,"./fr-ca.js":6848,"./fr-ch":7773,"./fr-ch.js":7773,"./fr.js":1636,"./fy":4940,"./fy.js":4940,"./ga":1402,"./ga.js":1402,"./gd":6924,"./gd.js":6924,"./gl":6398,"./gl.js":6398,"./gom-deva":2457,"./gom-deva.js":2457,"./gom-latn":2545,"./gom-latn.js":2545,"./gu":2641,"./gu.js":2641,"./he":7536,"./he.js":7536,"./hi":6335,"./hi.js":6335,"./hr":7458,"./hr.js":7458,"./hu":6540,"./hu.js":6540,"./hy-am":5283,"./hy-am.js":5283,"./id":8780,"./id.js":8780,"./is":4205,"./is.js":4205,"./it":4211,"./it-ch":9985,"./it-ch.js":9985,"./it.js":4211,"./ja":1003,"./ja.js":1003,"./jv":420,"./jv.js":420,"./ka":851,"./ka.js":851,"./kk":6074,"./kk.js":6074,"./km":3343,"./km.js":3343,"./kn":4799,"./kn.js":4799,"./ko":3549,"./ko.js":3549,"./ku":1037,"./ku.js":1037,"./ky":3125,"./ky.js":3125,"./lb":9586,"./lb.js":9586,"./lo":2349,"./lo.js":2349,"./lt":2400,"./lt.js":2400,"./lv":9991,"./lv.js":9991,"./me":8477,"./me.js":8477,"./mi":5118,"./mi.js":5118,"./mk":5943,"./mk.js":5943,"./ml":3849,"./ml.js":3849,"./mn":1977,"./mn.js":1977,"./mr":6184,"./mr.js":6184,"./ms":485,"./ms-my":4524,"./ms-my.js":4524,"./ms.js":485,"./mt":6681,"./mt.js":6681,"./my":2024,"./my.js":2024,"./nb":2688,"./nb.js":2688,"./ne":8914,"./ne.js":8914,"./nl":1758,"./nl-be":2272,"./nl-be.js":2272,"./nl.js":1758,"./nn":1510,"./nn.js":1510,"./oc-lnc":2797,"./oc-lnc.js":2797,"./pa-in":7944,"./pa-in.js":7944,"./pl":1605,"./pl.js":1605,"./pt":4225,"./pt-br":3840,"./pt-br.js":3840,"./pt.js":4225,"./ro":5128,"./ro.js":5128,"./ru":5127,"./ru.js":5127,"./sd":2525,"./sd.js":2525,"./se":9893,"./se.js":9893,"./si":3123,"./si.js":3123,"./sk":9635,"./sk.js":9635,"./sl":8106,"./sl.js":8106,"./sq":8799,"./sq.js":8799,"./sr":7949,"./sr-cyrl":2872,"./sr-cyrl.js":2872,"./sr.js":7949,"./ss":6167,"./ss.js":6167,"./sv":9713,"./sv.js":9713,"./sw":1982,"./sw.js":1982,"./ta":2732,"./ta.js":2732,"./te":3636,"./te.js":3636,"./tet":2115,"./tet.js":2115,"./tg":9801,"./tg.js":9801,"./th":2868,"./th.js":2868,"./tk":1310,"./tk.js":1310,"./tl-ph":2360,"./tl-ph.js":2360,"./tlh":6645,"./tlh.js":6645,"./tr":8374,"./tr.js":8374,"./tzl":256,"./tzl.js":256,"./tzm":1595,"./tzm-latn":1631,"./tzm-latn.js":1631,"./tzm.js":1595,"./ug-cn":6050,"./ug-cn.js":6050,"./uk":5610,"./uk.js":5610,"./ur":6077,"./ur.js":6077,"./uz":2862,"./uz-latn":2207,"./uz-latn.js":2207,"./uz.js":2862,"./vi":8093,"./vi.js":8093,"./x-pseudo":5590,"./x-pseudo.js":5590,"./yo":9058,"./yo.js":9058,"./zh-cn":7908,"./zh-cn.js":7908,"./zh-hk":8867,"./zh-hk.js":8867,"./zh-mo":1133,"./zh-mo.js":1133,"./zh-tw":3291,"./zh-tw.js":3291};function e(O){var v=J(O);return be(v)}function J(O){if(!be.o(S,O)){var v=new Error("Cannot find module '"+O+"'");throw v.code="MODULE_NOT_FOUND",v}return S[O]}e.keys=function(){return Object.keys(S)},e.resolve=J,ze.exports=e,e.id=6700},4147:ze=>{"use strict";ze.exports={i8:"5.0.53-rc.1"}}},ze=>{ze.O(0,[736],()=>ze(ze.s=764)),ze.O()}]);