(self.webpackChunkwidget=self.webpackChunkwidget||[]).push([[179],{764:(He,gt,_e)=>{"use strict";var T=_e(1481),t=_e(9798);const Q="mqtt",b="native",g=200,F="text",W="image",E="file",q=230,te="direct",D="INFO",$="MINE",ne="OTHERS",ee="CHAT_REOPENED",s="CHAT_CLOSED",l="MEMBER_JOINED_GROUP",d="MEMBER_LEFT_GROUP",S="LEAD_UPDATED",U="TOUCHING_OPERATOR",Z="LIVE_PAGE",pe="tiledesk_widget_",xe={ERROR:0,WARN:1,INFO:2,DEBUG:3},Te={"show-delay":500,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},Ae={production:!0,version:_e(4147).i8,remoteConfig:!1,remoteConfigUrl:"/widget-config.json",remoteTranslationsUrl:"https://tiledesk-server-pre.herokuapp.com/",loadRemoteTranslations:!0,chatEngine:"firebase",uploadEngine:"firebase",fileUploadAccept:"*/*",logLevel:"DEBUG",firebaseConfig:{apiKey:"AIzaSyCoWXHNvP1-qOllCpTshhC6VjPXeRTK0T4",authDomain:"chat21-pre-01.firebaseapp.com",databaseURL:"https://chat21-pre-01.firebaseio.com",projectId:"chat21-pre-01",storageBucket:"chat21-pre-01.appspot.com",messagingSenderId:"269505353043",appId:"1:269505353043:web:b82af070572669e3707da6",tenant:"tilechat"},chat21Config:{appId:"tilechat",MQTTendpoint:"mqtt://localhost:15675/ws",APIendpoint:"http://localhost:8004/api"},apiUrl:"https://tiledesk-server-pre.herokuapp.com/",baseImageUrl:"https://firebasestorage.googleapis.com/v0/b/",dashboardUrl:"https://support-pre.tiledesk.com/dashboard/",defaultLang:"en",storage_prefix:"widget_sv5",authPersistence:"LOCAL",supportMode:!0,enbedJs:!0};var nt=_e(5439),pt=_e(1042),Pe=_e(7340);let ve=(()=>{class i{static getInstance(){return i.instance}static setInstance(e){i.instance=e}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var me=_e(591);class Yn{constructor(a,e,n,o,r,v,P,Y,X,ae,fe,Ce,de,we,ye,Se,Fe,Qe,We,Ye,Je,Qt){this.id=a,this.activeOperatingHours=e,this.channels=n,this.name=o,this.createdAt=r,this.createdBy=v,this.isActiveSubscription=P,this.profile=Y,this.agents=X,this.trialDays=ae,this.type=fe,this.status=Ce,this.trialDaysLeft=de,this.trialExpired=we,this.updatedAt=ye,this.versions=Se,this.widgetTitle=Fe,this.logoChat=Qe,this.avatar=We,this.color=Ye,this.welcomeTitle=Je,this.welcomeMsg=Qt}initialize(a,e,n,o,r,v,P,Y,X,ae,fe,Ce,de,we,ye,Se){this.id=a,this.activeOperatingHours=e,this.channels=n,this.name=o,this.createdAt=r,this.createdBy=v,this.isActiveSubscription=P,this.profile=Y,this.agents=X,this.trialDays=ae,this.type=fe,this.status=Ce,this.trialDaysLeft=de,this.trialExpired=we,this.updatedAt=ye,this.versions=Se}customization(a,e,n,o,r,v){this.widgetTitle=a,this.logoChat=e,this.avatar=n,this.color=o,this.welcomeTitle=r,this.welcomeMsg=v}}_e(4211),_e(1589);const ft="text",tn="support-group-",Ge=230;function Et(i){return i&&(i=function rn(i){return(i=(i=(i=(i=i.replace(/&/g,"&amp;")).replace(/>/g,"&gt;")).replace(/</g,"&lt;")).replace(/"/g,"&quot;")).replace(/'/g,"&#039;")}(i)),i}function on(i){try{const a=i.split("popup=")[1];return!!a&&!!a.startsWith("true")}catch{return!1}}function $n(i,a,e){const n=this.strip_tags(a),v=screen.width/2-300,P=screen.height/2-300,Y=i.open(n,"_blank","fullscreen=1, titlebar=0, toolbar=no, location=0, status=0, menubar=0, scrollbars=0, resizable=0, width=600, height=600, top="+P+", left="+v);i.focus&&Y.focus()}function Xn(i){return i.replace(/<.*?>/g,"").trim()}function St(i){let a="";return i&&i.split(" ").forEach(n=>{n.trim().length>1&&a.length<3&&(a+=n.substring(0,1).toUpperCase())}),a}function Tt(i){const a=["#fba76f","#80d066","#73cdd0","#ecd074","#6fb1e4","#f98bae"];let e=0;if(i){const n=i.charCodeAt(i.length-1);e=Math.round(n%a.length)}return a[e]}function sn(i){let a=!1;return a=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(i.navigator.userAgent),a}function Me(i,a){let e=i;if(i&&i.indexOf("#")>-1)i=i.replace("#",""),e="rgba("+parseInt(i.substring(0,2),16)+","+parseInt(i.substring(2,4),16)+","+parseInt(i.substring(4,6),16)+","+a/100+")";else if(i&&i.indexOf("rgba")>-1){const n=i.split(",");e="rgba("+n[0].substring(5)+","+n[1]+","+n[2]+","+a/100+")"}else if(i&&i.indexOf("rgb(")>-1){const n=i.split(",");e="rgba("+n[0].substring(4)+","+n[1]+","+n[2].substring(0,n[2].length-1)+","+a/100+")"}return e}function ce(i,a){const e=i.location.href;a=a.replace(/[\[\]]/g,"\\$&");const o=new RegExp("[?&]"+a+"(=([^&]*)|&|$)").exec(e);return o?o[2]?"false"===o[2]||"0"===o[2]?"false":decodeURIComponent(o[2].replace(/\+/g," ")):"true":null}function ge(i){let a=i;if("string"!=typeof i)return a;if(i)switch(a.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return a}}function mt(i,a){return"/apps/"+i+"/users/"+a+"/conversations"}function Pt(i,a){return"/apps/"+i+"/users/"+a+"/archived_conversations"}function Ke(){try{return"localStorage"in window&&null!==window.localStorage}catch(i){return console.log("supports_html5_storage > Error :"+i),!1}}function kt(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(i){return console.log("supports_html5_session > Error :"+i),!1}}function Le(i,a){return i.findIndex(e=>e.uid===a)}function no(i){try{const a=i.split("popup=")[1];return!!a&&!!a.startsWith("true")}catch{return!1}}function At(i,a,e){const n=function oo(i){return i.replace(/<.*?>/g,"").trim()}(a),v=screen.width/2-300,P=screen.height/2-300,Y=i.open(n,"_blank","fullscreen=1, titlebar=0, toolbar=no, location=0, status=0, menubar=0, scrollbars=0, resizable=0, width=600, height=600, top="+P+", left="+v);i.focus&&Y.focus()}function ke(i,a){let e=i;if(i&&i.indexOf("#")>-1)i=i.replace("#",""),e="rgba("+parseInt(i.substring(0,2),16)+","+parseInt(i.substring(2,4),16)+","+parseInt(i.substring(4,6),16)+","+a/100+")";else if(i&&i.indexOf("rgba")>-1){const n=i.split(",");e="rgba("+n[0].substring(5)+","+n[1]+","+n[2]+","+a/100+")"}else if(i&&i.indexOf("rgb(")>-1){const n=i.split(",");e="rgba("+n[0].substring(4)+","+n[1]+","+n[2].substring(0,n[2].length-1)+","+a/100+")"}return e}function $e(i,a="asc"){return function(e,n){if(!e.hasOwnProperty(i)||!n.hasOwnProperty(i))return 0;const o="string"==typeof e[i]?e[i].toUpperCase():e[i],r="string"==typeof n[i]?n[i].toUpperCase():n[i];let v=0;return o>r?v=1:o<r&&(v=-1),"desc"===a?-1*v:v}}function st(i){return nt.locale(window.navigator.language),nt.unix(i).fromNow()}function hn(i){return!(!i||!i.recipient||!i.recipient.startsWith("group-")&&!i.recipient.startsWith("support-group"))}function ze(i,a){let e,n,o;if(i.includes("rgb")&&(i=function ho(i){var e,v="";return(e=/^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/.exec(i))&&(v="#"+(16777216+(Rt(e[1],e[2])<<16)+(Rt(e[3],e[4])<<8)+Rt(e[5],e[6])).toString(16).slice(1)),v}(i)),0===i.indexOf("#")&&(i=i.slice(1)),3===i.length&&(i=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]),6!==i.length)throw new Error("Invalid HEX color.");return e=parseInt(i.slice(0,2),16),n=parseInt(i.slice(2,4),16),o=parseInt(i.slice(4,6),16),a?.299*e+.587*n+.114*o>186?"#000000":"#FFFFFF":(e=(255-e).toString(16),n=(255-n).toString(16),o=(255-o).toString(16),"#"+It(e,2)+It(n,2)+It(o,2))}function It(i,a){return a=a||2,(new Array(a).join("0")+i).slice(-a)}function Rt(i,a){var e=Math.max(0,parseInt(i,10));return a?Math.floor(255*Math.min(100,e)/100):Math.min(255,e)}let Ie=(()=>{class i{constructor(){this.obsObjChanged=new me.X(null),this.obsIsOpen=new me.X(null),this.BASE_LOCATION="https://widget.tiledesk.com/v2",this.POWERED_BY='<a tabindex="-1" target="_blank" href="http://www.tiledesk.com/"><img src="https://support-pre.tiledesk.com/dashboard/assets/img/logos/tiledesk-logo_new_gray.svg"/></a>',this.DEFAULT_LOGO_CHAT="/assets/images/tiledesk_logo_white_small.svg",this.WIDGET_TITLE="Tiledesk",this.convertColorToRGBA=ke,this.project=new Yn,this.availableAgents=[],this.isLogout=!1,this.availableAgentsStatus=!1,this.firstOpen=!0,this.departmentID=null,this.privacyApproved=!1,this.startedAt=new Date}initDefafultParameters(){this.globalsParameters={},this.filterSystemMsg=!0;let e=window;window.frameElement&&"parent"===window.frameElement.getAttribute("tiledesk_context")&&(e=window.parent);const n=ce(window,"windowcontext");null!==n&&"window.parent"===n&&(e=window.parent),this.windowContext=e,this.baseLocation=this.BASE_LOCATION,this.autoStart=!0,this.startHidden=!1,this.isShown=!0,this.isOpen=!1,this.startFromHome=!0,this.isOpenPrechatForm=!0,this.isOpenStartRating=!1,this.projectid="",this.preChatForm=!1,this.align="",this.calloutTimer=-1,this.calloutTitle="",this.calloutMsg="",this.calloutStaus=!0,this.userFullname="",this.userEmail="",this.widgetTitle="",this.dynamicWaitTimeReply=!0,this.hideHeaderCloseButton=!1,this.fullscreenMode=!1,this.themeColor=ke("#2a6ac1",100),this.themeColorOpacity=100,this.themeForegroundColor=ke("#ffffff",100),this.allowTranscriptDownload=!1,this.poweredBy=this.POWERED_BY,this.logoChat=this.BASE_LOCATION+this.DEFAULT_LOGO_CHAT,this.marginX="20px",this.marginY="20px",this.mobileMarginX="0px",this.mobileMarginY="0px",this.launcherWidth="60px",this.launcherHeight="60px",this.baloonImage="",this.baloonShape="50%",this.isLogEnabled=!1,this.openExternalLinkButton=!0,this.hideHeaderConversationOptionsMenu=!1,this.hideCloseConversationOptionMenu=!1,this.hideRestartConversationOptionsMenu=!1,this.hideSettings=!1,this.filterByRequester=!1,this.persistence="local",this.preChatFormJson=[{name:"userFullname",type:"text",mandatory:!0,label:"LABEL_FIELD_NAME"},{name:"userEmail",type:"text",mandatory:!0,regex:"/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)+$/",label:"LABEL_FIELD_EMAIL",errorLabel:"LABEL_ERROR_FIELD_EMAIL"}],this.bubbleSentBackground=ke("#2a6ac1",100),this.bubbleSentTextColor=ke("#ffffff",100),this.bubbleReceivedBackground=ke("#f0f2f7",100),this.bubbleReceivedTextColor=ke("#06132b",100),this.fontSize="1.4em",this.fontFamily="'Roboto','Google Sans', Helvetica, Arial, sans-serif'",this.buttonFontSize="15px",this.buttonBackgroundColor=ke("#ffffff",100),this.buttonTextColor=ke("#2a6ac1",100),this.buttonHoverBackgroundColor=ke("#2a6ac1",100),this.buttonHoverTextColor=ke("#ffffff",100),this.singleConversation=!1,this.restartConversation=!1,this.nativeRating=!0,this.showInfoMessage="MEMBER_JOINED_GROUP".split(",").map(o=>o.trim()),this.typingLocation="content",this.allowReopen=!1,this.continueConversationBeforeTime=48,this.participants=[],this.whatsappNumber="",this.messangerPageTitle="",this.telegramUsername="",this.showWaitTime=!0,this.showAvailableAgents=!0,this.showLogoutOption=!1,this.offline_msg=this.LABEL_FIRST_MSG_NO_AGENTS,this.online_msg=this.LABEL_FIRST_MSG,this.isOpenNewMessage=!1,this.showAttachmentButton=!0,this.showAllConversations=!0,this.tenant=Ae.firebaseConfig.tenant,this.channelType="group",this.default_settings={},this.isMobile=!1,this.isLogged=!1,this.BUILD_VERSION="v."+Ae.version,this.filterSystemMsg=!0,this.soundEnabled=!0,this.conversationsBadge=0,this.isOpenMenuOptions=!1,this.signInWithCustomToken=!1,this.displayEyeCatcherCard="none",this.supportMode=!0,this.newConversationStart=!0}initialize(){this.createDefaultSettingsObject(),this.setParameter("isMobile",sn(this.windowContext)),this.setParameter("attributes",this.attributes),this.setProjectParameters()}setProjectParameters(){let e=this.project.name;this.widgetTitle&&""!==this.widgetTitle&&(e=this.widgetTitle),this.project.customization(e,this.logoChat,St(e),Tt(e),this.welcomeTitle,this.welcomeMsg)}createDefaultSettingsObject(){this.default_settings={align:this.align,allowReopen:this.allowReopen,allowTranscriptDownload:this.allowTranscriptDownload,autoStart:this.autoStart,baloonShape:this.baloonShape,baloonImage:this.baloonImage,bubbleSentBackground:this.bubbleSentBackground,bubbleSentTextColor:this.bubbleSentTextColor,bubbleReceivedBackground:this.bubbleReceivedBackground,bubbleReceivedTextColor:this.bubbleReceivedTextColor,buttonBackgroundColor:this.buttonBackgroundColor,buttonTextColor:this.buttonTextColor,buttonFontSize:this.buttonFontSize,buttonHoverBackgroundColor:this.buttonHoverBackgroundColor,buttonHoverTextColor:this.buttonHoverTextColor,calloutTitle:this.calloutTitle,calloutMsg:this.calloutMsg,calloutTimer:this.calloutTimer,calloutStaus:this.calloutStaus,channelType:this.channelType,dynamicWaitTimeReply:this.dynamicWaitTimeReply,fontSize:this.fontSize,fontFamily:this.fontFamily,fullscreenMode:this.fullscreenMode,filterByRequester:this.filterByRequester,hideHeaderConversationOptionsMenu:this.hideHeaderConversationOptionsMenu,hideHeaderCloseButton:this.hideHeaderCloseButton,hideCloseConversationOptionMenu:this.hideCloseConversationOptionMenu,hideRestartConversationOptionsMenu:this.hideRestartConversationOptionsMenu,hideSettings:this.hideSettings,isLogEnabled:this.isLogEnabled,isOpen:this.isOpen,isShown:this.isShown,jwt:this.jwt,logLevel:this.logLevel,logoChat:this.logoChat,lang:this.lang,lancherWidth:this.launcherWidth,lancherHeight:this.launcherHeight,marginX:this.marginX,marginY:this.marginY,mobileMarginX:this.mobileMarginX,mobileMarginY:this.mobileMarginY,nativeRating:this.nativeRating,openExternalLinkButton:this.openExternalLinkButton,participants:this.participants,persistence:this.persistence,poweredBy:this.poweredBy,preChatForm:this.preChatForm,preChatFormJson:this.preChatFormJson,projectid:this.projectid,recipientId:this.recipientId,restartConversation:this.restartConversation,singleConversation:this.singleConversation,showInfoMessage:this.showInfoMessage,showAllConversations:this.showAllConversations,showWaitTime:this.showWaitTime,showAvailableAgents:this.showAvailableAgents,showLogoutOption:this.showLogoutOption,showAttachmentButton:this.showAttachmentButton,soundEnabled:this.soundEnabled,startHidden:this.startHidden,startFromHome:this.startFromHome,tenant:this.tenant,themeColor:this.themeColor,themeColorOpacity:this.themeColorOpacity,themeForegroundColor:this.themeForegroundColor,typingLocation:this.typingLocation,userEmail:this.userEmail,userFullname:this.userFullname,widgetTitle:this.widgetTitle,welcomeMsg:this.welcomeMsg,welcomeTitle:this.welcomeTitle}}setColorWithGradient(){this.colorGradient="linear-gradient("+this.themeColor+", "+ke(this.themeColor,this.themeColorOpacity)+")",this.colorGradient180="linear-gradient( 180grad, "+this.themeColor+", "+ke(this.themeColor,this.themeColorOpacity)+")",this.bubbleSentBackground="linear-gradient( 135grad, "+this.bubbleSentBackground+", "+ke(this.bubbleSentBackground,80)+")"}setParentBodyStyleMobile(e,n){e&&n?(window.parent.document.body.style.height="0",window.parent.document.body.style.width="100%",window.parent.document.body.style.overflowY="hidden",window.parent.document.body.style.position="fixed"):!e&&n&&(window.parent.document.body.style.removeProperty("height"),window.parent.document.body.style.removeProperty("width"),window.parent.document.body.style.removeProperty("overflow-y"),window.parent.document.body.style.removeProperty("position"))}setElementStyle(e){const n=this.windowContext.document.getElementById("tiledeskdiv"),o=document.getElementById("chat21-conversations");e&&n?setTimeout(()=>{n.classList.add("shadow"),o.classList.add("shadow")},1e3):!e&&n&&(n.classList.remove("shadow"),o.classList.remove("shadow")),e&&this.isMobile&&o?o.classList.add("isMobile"):!e&&o&&o.classList.remove("isMobile")}setIsOpen(e){this.isOpen=e,this.setParentBodyStyleMobile(e,this.isMobile),this.setElementStyle(e),this.obsIsOpen.next(e)}setParameter(e,n,o){this[e]=n,!0===o&&this.obsObjChanged.next({key:e,val:n})}setAttributeParameter(e,n){this.attributes[e]=n,this.setParameter("attributes",this.attributes,!0)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var ue=_e(6895);function uo(i,a){if(1&i&&(t.TgZ(0,"span",16),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.emoticon)}}function go(i,a){if(1&i&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.g.calloutMsg," ")}}function po(i,a){if(1&i&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.g.CALLOUT_MSG_PLACEHOLDER," ")}}const fo=function(i,a){return{"c21-align-left":i,"c21-align-right":a}},mo=function(i,a,e,n){return{display:i,bottom:a,left:e,right:n}};function _o(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",1),t.NdJ("mouseenter",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseEnter())})("mouseleave",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseLeave())}),t.TgZ(1,"div",2)(2,"div",3)(3,"div",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.closeEyeCatcherCard())}),t.O4$(),t.TgZ(4,"svg",5),t._UZ(5,"path",6)(6,"path",7),t.qZA()()(),t.kcU(),t.TgZ(7,"div",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openChatFromEyeCatcherCard())}),t.TgZ(8,"div",9),t.YNc(9,uo,2,1,"span",10),t.qZA()(),t.TgZ(10,"div",11),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openChatFromEyeCatcherCard())}),t.TgZ(11,"div",12)(12,"p",13),t._uU(13),t.qZA(),t.YNc(14,go,2,1,"p",14),t.YNc(15,po,2,1,"ng-template",null,15,t.W1O),t.qZA()()()()}if(2&i){const e=t.MAs(16),n=t.oxw();t.ekj("mobile",n.g.isMobile),t.Q6J("ngClass",t.WLB(9,fo,"left"===n.g.align,"left"!==n.g.align))("ngStyle",t.l5B(12,mo,n.g.displayEyeCatcherCard,n.g.marginY+"px","left"===n.g.align?n.g.marginX+"px":"","right"===n.g.align?n.g.marginX+"px":"")),t.xp6(8),t.Q6J("@rotatedState",n.state),t.xp6(1),t.Q6J("ngIf",n.emoticon),t.xp6(4),t.Oqu(n.title),t.xp6(1),t.Q6J("ngIf",""!==n.g.calloutMsg)("ngIfElse",e)}}let dn=(()=>{class i{constructor(e){this.g=e,this.onOpenChat=new t.vpe,this.onCloseEyeCatcherCard=new t.vpe,this.logger=ve.getInstance()}ngOnInit(){this.state="default",this.g.setParameter("displayEyeCatcherCard","none"),this.displayEyeCatcherCardCloseBtnWrapper="none",this.displayEyeCatcherCardCloseBtnIsMobileWrapper="none",this.displayEyeCatcherCardCloseBtn="none",this.openIfCallOutTimer()}openIfCallOutTimer(){const e=this,n=this.g.calloutTimer;n>=0&&setTimeout(function(){e.openEyeCatcher()},1e3*n)}openEyeCatcher(){this.checkIsEmoji();const e=this.g.isOpen;this.logger.debug("[EYEEYE-CATCHER-CARD] openEyeCatcher: calloutStaus ---------\x3e ",this.g.calloutStaus),!1===e&&this.g.calloutStaus?(this.onCloseEyeCatcherCard.emit(!0),this.g.setParameter("displayEyeCatcherCard","block"),this.displayEyeCatcherCardCloseBtnWrapper="block",this.displayEyeCatcherCardCloseBtnIsMobileWrapper="block"):this.logger.debug("[EYEEYE-CATCHER-CARD] openEyeCatcher: \xbb\xbb\xbb\xbb\xbb\xbb\xbb CALLING OPEN-EYE-CATCHER BUT NOT DISPLAY THE CARD BECAUSE THE CHAT IS ALREADY OPEN ")}checkIsEmoji(){let e=this.g.CALLOUT_TITLE_PLACEHOLDER.trim();this.g.calloutTitle&&""!==this.g.calloutTitle&&(e=this.g.calloutTitle.trim()),this.title=e;const o=_e(9747)();let r;for(;r=o.exec(e);){const v=r[0];this.logger.debug("[EYEEYE-CATCHER-CARD]--\x3e match",r),0===e.indexOf(v)&&(this.title=e.replace(v,""),this.emoticon=v);break}}openChatFromEyeCatcherCard(){this.g.setParameter("displayEyeCatcherCard","none"),this.onOpenChat.emit()}mouseEnter(){}mouseLeave(){}closeEyeCatcherCard(){this.onCloseEyeCatcherCard.emit(!1),this.g.setParameter("displayEyeCatcherCard","none"),this.g.setParameter("calloutStaus",!1,!0),this.displayEyeCatcherCardCloseBtnWrapper="none"}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-eyeeye-catcher-card"]],outputs:{onOpenChat:"onOpenChat",onCloseEyeCatcherCard:"onCloseEyeCatcherCard"},decls:1,vars:1,consts:[["class","eye-catcher-card scale-in-center",3,"mobile","ngClass","ngStyle","mouseenter","mouseleave",4,"ngIf"],[1,"eye-catcher-card","scale-in-center",3,"ngClass","ngStyle","mouseenter","mouseleave"],[1,"eye-catcher_row"],[1,"eye-catcher-card-close-btn-wrapper"],[1,"eye-catcher-card-close-btn",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","white","width","24px","height","24px",1,"eye-catcher-card-close-btn-img"],["d","M0 0h24v24H0V0z","fill","none"],["d","M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"],[1,"eye-catcher_column","ec_left",3,"click"],[1,"eye-catcher-card-emoticons-wrapper"],["class","chat21-card-emoticons",4,"ngIf"],[1,"eye-catcher_column","ec_right",3,"click"],[1,"eye-catcher-card-text-wrapper"],[1,"eye-catcher-card-title"],["class","eye-catcher-card-msg",4,"ngIf","ngIfElse"],["calloutMsg_placeholder",""],[1,"chat21-card-emoticons"],[1,"eye-catcher-card-msg"]],template:function(e,n){1&e&&t.YNc(0,_o,17,17,"div",0),2&e&&t.Q6J("ngIf",!n.g.isOpenNewMessage)},dependencies:[ue.mk,ue.O5,ue.PC],styles:['.eye-catcher_column[_ngcontent-%COMP%]{float:left}.ec_right[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.eye-catcher_row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}.eye-catcher-card-emoticons-wrapper[_ngcontent-%COMP%]{text-align:center}.eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{z-index:1;height:40px;width:40px;position:absolute;top:-14px;display:none}.eye-catcher-card-close-btn[_ngcontent-%COMP%]{z-index:2;background-color:#5d6c80;width:24px;height:24px;border-radius:50%;position:relative;left:0;right:0;cursor:pointer;float:right;margin:4px;box-shadow:0 2px 8px #232f351a}.eye-catcher-card-close-btn-img[_ngcontent-%COMP%]{fill:#fff;width:18px;height:18px;margin:calc(50% - 9px)}.eye-catcher-card-close-btn-img-is-mobile-wrapper[_ngcontent-%COMP%]{z-index:1;position:absolute;top:-39px;right:-14px;cursor:pointer}.eye-catcher-card-close-btn-img-is-mobile[_ngcontent-%COMP%]{width:40px;position:relative;max-width:none}.eye-catcher-card[_ngcontent-%COMP%]{position:absolute;z-index:1;bottom:0;cursor:pointer;background-color:#fff;border:0px solid #dedfde;box-shadow:#232f3517 0 2px 8px;width:300px;height:70px;border-radius:35px}.eye-catcher-card[_ngcontent-%COMP%]   .eye-catcher_row[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]{margin:16px 14px 15px 16px;padding-left:70px}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{right:0}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .ec_left[_ngcontent-%COMP%]{width:40px;height:auto;margin:20px 4px 16px 0;overflow:hidden;position:absolute;top:0;right:0}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .ec_right[_ngcontent-%COMP%]{overflow:hidden;width:calc(100% - 40px);height:100%;padding:0;vertical-align:middle;display:inline-table;position:absolute;top:0;left:0}.eye-catcher-card.c21-align-left[_ngcontent-%COMP%]   .eye-catcher_row[_ngcontent-%COMP%]{width:calc(100% - 70px)}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]{margin:16px 14px 15px 16px;padding-right:70px}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{left:-14px}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]   .ec_left[_ngcontent-%COMP%]{width:40px;height:auto;margin:18px 3px;overflow:hidden;position:absolute;top:0;left:0}.eye-catcher-card.c21-align-right[_ngcontent-%COMP%]   .ec_right[_ngcontent-%COMP%]{overflow:hidden;width:calc(100% - 115px);height:100%;padding:0;vertical-align:middle;display:inline-table;position:absolute;top:0;left:46px}.eye-catcher-card[_ngcontent-%COMP%]:hover   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{display:block}.eye-catcher-card-text-wrapper[_ngcontent-%COMP%]{width:100%;height:auto;vertical-align:middle;font-family:Helvetica Neue,"Apple Color Emoji",Helvetica,Arial,sans-serif;font-weight:400;word-wrap:break-word;margin:0;position:absolute;line-height:normal;top:50%;transform:translateY(-50%)}.eye-catcher-card-title[_ngcontent-%COMP%]{font-size:15px;color:#3b3c40;display:block;margin:0;padding:0 0 4px}.eye-catcher-card-msg[_ngcontent-%COMP%]{letter-spacing:1px;font-size:13px;color:#7b7b7b;display:block;padding:0;margin:0;line-height:normal;width:100%}.eye-catcher-card-img-wrapper[_ngcontent-%COMP%]{border:1px solid #dedfde;border-radius:100px;height:65px;width:65px}.eye-catcher-card[_ngcontent-%COMP%]   .chat21-card-img[_ngcontent-%COMP%]{position:relative;bottom:14px;right:15px;width:95px;max-width:none}.chat21-card-emoticons[_ngcontent-%COMP%]{font-size:26px}.eye-catcher-card.mobile[_ngcontent-%COMP%]{max-width:calc(100% - 100px)}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-img-wrapper[_ngcontent-%COMP%]{border:1px solid #dedfde;border-radius:100px;height:65px;width:65px}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-close-btn[_ngcontent-%COMP%]{background-color:#fcfcfc;width:30px;height:30px;margin:4px -4px;box-shadow:0 2px 8px #232f3533}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-wrapper[_ngcontent-%COMP%]{display:block}.eye-catcher-card.mobile[_ngcontent-%COMP%]   .eye-catcher-card-close-btn-img[_ngcontent-%COMP%]{fill:#5d6c80}'],data:{animation:[(0,Pe.X$)("rotatedState",[])]}}),i})();function Lt(i){return!!(i&&i.type&&i.metadata&&i.metadata.src&&"image"===i.type)}function un(i){return!!(i&&i.type&&i.metadata&&i.metadata.src&&"frame"===i.type)}function vo(i){return!!(i&&i.type&&i.metadata&&i.metadata.src&&"file"===i.type)}function _t(i){return!(!i||!i.attributes||"info"!==i.attributes.subtype&&"info/support"!==i.attributes.subtype)}function gn(i){return!!(i&&i.attributes&&"info"===i.attributes.subtype&&i.attributes.messagelabel&&"USER_BANNED"===i.attributes.messagelabel.key)}function Nt(i){return!(!i||!i.isSender)}function je(i,a){return i===D?_t(a):i===$?Nt(a):i===ne?!1===_t(a)&&!1===Nt(a):void 0}function bo(i){try{if(!i)return!1;const a=i.replace(new RegExp("[\0-\u1eeff]","g"),""),e=i.replace(new RegExp("[\n\rs]+|( )+","g"),""),n=i.replace(new RegExp("[\u4e00-\u9fa5]","g"),"");return""!==a&&""!=e&&""!=n&&a.length===e.length&&a.length<=2}catch{return!1}}function ot(i,a){return a>i}function pn(i,a){return!(!(i&&i.attributes&&i.attributes.messagelabel&&"MEMBER_JOINED_GROUP"===i.attributes.messagelabel.key&&i.attributes.messagelabel.parameters.member_id!==a.uid)||i.attributes.messagelabel.parameters.member_id.includes("bot")||i.attributes.messagelabel.parameters.member_id.includes("system"))||!!(i&&i.attributes&&i.attributes.messagelabel&&"MEMBER_JOINED_GROUP"!==i.attributes.messagelabel.key)}function vt(i,a){return!(i&&i.attributes&&i.attributes.messagelabel&&a.includes(i.attributes.messagelabel.key))}class fn{constructor(){this.url=window.location,this.logger=ve.getInstance()}initRules(){console.log("locationnnnnnn",this.url)}}let mn=(()=>{class i{constructor(){this.logger=ve.getInstance()}setElement(e){this.el=e}setWindowContext(e){this.windowContext=e}triggerBeforeSendMessageEvent(e){this.logger.debug(" ---------------- triggerBeforeSendMessageEvent ---------------- ",e);try{const n=new CustomEvent("onBeforeMessageSend",{detail:{message:e}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerAfterSendMessageEvent(e){this.logger.debug(" ---------------- triggerAfterSendMessageEvent ---------------- ",e);try{const n=new CustomEvent("onAfterMessageSend",{detail:{message:e}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerOnNewConversationInit(e){this.logger.debug(" ---------------- triggerOnNewConversationComponentInit ---------------- ",e);const n=new CustomEvent("onNewConversationComponentInit",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerBeforeMessageRender(e){try{const n=new CustomEvent("beforeMessageRender",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerAfterMessageRender(e){try{const n=new CustomEvent("afterMessageRender",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerOnMessageCreated(e){this.logger.debug(" ---------------- triggerOnMessageCreated ---------------- ",e);const n=new CustomEvent("onMessageCreated",{detail:{message:e}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnViewInit(e){this.logger.debug(" ---------------- triggerOnInit ---------------- ",e);const n=new CustomEvent("onInit",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnOpenEvent(e){this.logger.debug(" ---------------- triggerOnOpenEvent ---------------- ",e);const n=new CustomEvent("onOpen",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnCloseEvent(e){this.logger.debug(" ---------------- triggerOnCloseEvent ---------------- ",e);const n=new CustomEvent("onClose",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnOpenEyeCatcherEvent(e){this.logger.debug(" ---------------- triggerOnOpenEyeCatcherEvent ---------------- ",e);const n=new CustomEvent("onOpenEyeCatcher",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnClosedEyeCatcherEvent(){this.logger.debug(" ---------------- triggerOnClosedEyeCatcherEvent ---------------- ");const e=new CustomEvent("onClosedEyeCatcher",{detail:{}}),n=this.windowContext;n.tiledesk&&n.tiledesk.tiledeskroot?(n.tiledesk.tiledeskroot.dispatchEvent(e),this.windowContext=n):this.el.nativeElement.dispatchEvent(e)}triggerOnLoggedIn(e){this.logger.debug(" ---------------- triggerOnLoggedIn ---------------- ",e);const n=new CustomEvent("onLoggedIn",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnLoggedOut(e){this.logger.debug(" ---------------- triggerOnLoggedOut ---------------- ",e);const n=new CustomEvent("onLoggedOut",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnAuthStateChanged(e){this.logger.debug(" ---------------- triggerOnAuthStateChanged ---------------- ",e);const n=new CustomEvent("onAuthStateChanged",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerNewConversationEvent(e){this.logger.debug(" ---------------- triggerNewConversationEvent ---------------- ",e);const n=new CustomEvent("onNewConversation",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerLoadParamsEvent(e){this.logger.debug(" ---------------- triggerOnLoadParamsEvent ---------------- ",e);const n=new CustomEvent("onLoadParams",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnBeforeInit(e){this.logger.debug(" ---------------- triggerOnBeforeInitEvent ---------------- ",e);const n=new CustomEvent("onBeforeInit",{detail:e}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerOnConversationUpdated(e){this.logger.debug(" ---------------- triggerOnConversationUpdated ---------------- ",e);try{const n=new CustomEvent("onConversationUpdated",{detail:{conversation:e}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}triggerOnCloseMessagePreview(){this.logger.debug(" ---------------- triggerOnCloseMessagePreview ---------------- ");try{const e=new CustomEvent("onCloseMessagePreview",{detail:{}}),n=this.windowContext;n.tiledesk&&n.tiledesk.tiledeskroot?(n.tiledesk.tiledeskroot.dispatchEvent(e),this.windowContext=n):this.el.nativeElement.dispatchEvent(e)}catch(e){this.logger.error("[TRIGGER-HANDLER] > Error:"+e)}}triggerOnbeforeDepartmentsFormRender(e){this.logger.debug(" ---------------- triggerOnbeforeDepartmentsFormRender ---------------- ");const n=new CustomEvent("onBeforeDepartmentsFormRender",{detail:{departments:e}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot?(o.tiledesk.tiledeskroot.dispatchEvent(n),this.windowContext=o):this.el.nativeElement.dispatchEvent(n)}triggerGetImageUrlThumb(e){this.logger.debug(" ---------------- getImageUrlThumb ---------------- ");try{const n=new CustomEvent("getImageUrlThumb",{detail:{message:e}}),o=this.windowContext;o.tiledesk&&o.tiledesk.tiledeskroot&&o.tiledesk.tiledeskroot.dispatchEvent(n)}catch(n){this.logger.error("[TRIGGER-HANDLER] > Error:"+n)}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var Ee=_e(529),Co=_e(5732);let Ne=(()=>{class i{constructor(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Re=(()=>{class i{constructor(e,n){this.http=e,this.g=n,this.appConfig=Ae}loadAppConfig(){let e=this.appConfig.remoteConfigUrl;if(!this.appConfig.remoteConfigUrl.startsWith("http")){let o=window;window.frameElement&&"parent"===window.frameElement.getAttribute("tiledesk_context")&&(o=window.parent);const r=function so(i,a){const e=i.location.href;a=a.replace(/[\[\]]/g,"\\$&");const o=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)").exec(e);return o?o[2]?"false"===o[2]||"0"===o[2]?"false":decodeURIComponent(o[2].replace(/\+/g," ")):"true":null}(window,"windowcontext");if(null!==r&&"window.parent"===r&&(o=window.parent),!o.tiledesk)return;{const v=o.tiledesk.getBaseLocation();void 0!==v&&(this.g.baseLocation=v,e=this.g.baseLocation+this.appConfig.remoteConfigUrl)}}const n=this;return this.http.get(e).toPromise().then(o=>{n.appConfig=o}).catch(o=>{console.error("error loadAppConfig",o)})}getConfig(){return this.appConfig}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ie))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),_n=(()=>{class i{constructor(e,n,o){this.http=e,this.appStorageService=n,this.appConfigService=o,this.logger=ve.getInstance(),this.obsSettingsService=new me.X(null)}initWidgetParamiters(e,n){const o=this;let r;this.globals=e,this.el=n,this.globals.initDefafultParameters();try{r=this.setProjectId()}catch(v){return void this.logger.error("[GLOBAL-SET] > Error :"+v)}this.setMainParametersFromSettings(e),this.globals.tenant=this.appConfigService.getConfig().firebaseConfig.tenant,this.globals.logLevel=this.appConfigService.getConfig().logLevel,this.globals.persistence=this.appConfigService.getConfig().authPersistence,this.getProjectParametersById(r).subscribe(v=>{const P=v.project;P&&o.globals.project.initialize(P.id,P.activeOperatingHours,P.channels,P.name,P.createdAt,P.createdBy,P.isActiveSubscription,P.profile,P.agents,P.trialDays,P.type,P.status,P.trialDaysLeft,P.trialExpired,P.updatedAt,P.versions),o.setParameters(v)},v=>{o.setParameters(null)},()=>{})}setProjectId(){try{const e=this.globals.windowContext.tiledeskSettings.projectid;e&&(this.globals.projectid=e)}catch(e){this.logger.error("[GLOBAL-SET] setProjectId 1 > Error :"+e)}try{const e=this.el.nativeElement.getAttribute("projectid");e&&(this.globals.projectid=e)}catch(e){this.logger.error("[GLOBAL-SET] setProjectId 2 > Error :"+e)}try{const e=ce(this.globals.windowContext,"tiledesk_projectid");e&&(this.globals.projectid=e)}catch(e){this.logger.error("[GLOBAL-SET] setProjectId 3 > Error :"+e)}return this.globals.projectid}setMainParametersFromSettings(e){let n;try{const o=this.globals.windowContext.tiledesk.getBaseLocation();this.logger.debug("[GLOBAL-SET] 1 > baseLocation: ",o),typeof o<"u"&&(this.globals.baseLocation=o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings baseLocation > Error :",o)}try{n=this.globals.windowContext.tiledeskSettings}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings tiledeskSettings > Error :",o)}try{const o=n.persistence;typeof o<"u"&&(this.globals.persistence=o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings persistence > Error :",o)}try{const o=n.filterByRequester;this.logger.debug("[GLOBAL-SET] setMainParametersFromSettings  > filterByRequester: ",o),typeof o<"u"&&(this.globals.filterByRequester=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings filterByRequester > Error :",o)}try{const o=n.isLogEnabled;typeof o<"u"&&(this.globals.isLogEnabled=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings isLogEnabled > Error :",o)}try{const o=n.departmentID;typeof o<"u"&&(this.globals.departmentID=o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings departmentID > Error :",o)}try{const o=n.showAttachmentButton;typeof o<"u"&&(this.globals.showAttachmentButton=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings showAttachmentButton > Error :",o)}try{const o=n.showAllConversations;typeof o<"u"&&(this.globals.showAllConversations=!0===o)}catch(o){this.logger.error("[GLOBAL-SET] setMainParametersFromSettings showAllConversations > Error :",o)}}setParameters(e){this.logger.debug("[GLOBAL-SET] ***** setParameters ***** ",e),null!==e&&this.setVariablesFromService(this.globals,e),this.setVariableFromStorage(this.globals),this.setVariablesFromSettings(this.globals),this.setVariablesFromAttributeHtml(this.globals,this.el),this.setVariablesFromUrlParameters(this.globals),this.setDepartmentFromExternal(),this.globals.setColorWithGradient(),this.setCssIframe(),this.logger.debug("[GLOBAL-SET] ***** END SET PARAMETERS *****"),this.obsSettingsService.next(!0)}setCssIframe(){this.globals.setParameter("isMobile",sn(this.globals.windowContext));const e=this.globals.windowContext.document.getElementById("tiledeskdiv");if(!e)return;let n;"left"===this.globals.align?(e.classList.add("align-left"),n=this.globals.isMobile?this.globals.mobileMarginX:this.globals.marginX,e.style.left=n):(e.classList.add("align-right"),n=this.globals.isMobile?this.globals.mobileMarginX:this.globals.marginX,e.style.right=n),e.style.bottom=this.globals.isMobile?this.globals.mobileMarginY:this.globals.marginY,!0===this.globals.fullscreenMode&&(e.style.left=0,e.style.right=0,e.style.top=0,e.style.bottom=0,e.style.width="100%",e.style.height="100%",e.style.maxHeight="none",e.style.maxWidth="none")}setVariablesFromService(e,n){this.logger.debug("[GLOBAL-SET] > setVariablesFromService :",n),this.globals=e;try{const o=n.departments;typeof o<"u"&&this.initDepartments(o)}catch(o){this.initDepartments(null),this.logger.error("[GLOBAL-SET] setVariablesFromService > Error is departments: ",o)}try{const o=n.user_available;typeof o<"u"&&(this.logger.debug("[GLOBAL-SET] setVariablesFromService > user_available ::::",o),this.setAvailableAgentsStatus(o))}catch(o){this.setAvailableAgentsStatus(null),this.logger.error("[GLOBAL-SET] setVariablesFromService > Error is departments: ",o)}try{const o=n.project.widget;if(typeof o<"u")for(const r of Object.keys(o))"align"===r&&"left"===o[r]?(e.windowContext.document.getElementById("tiledeskdiv").style.left="0!important",e.align="left"):"align"===r&&"right"===o[r]&&(e.windowContext.document.getElementById("tiledeskdiv").style.right="0!important",e.align="right"),o.hasOwnProperty("calloutTimer")&&(e.calloutTimer=o.calloutTimer),o.hasOwnProperty("dynamicWaitTimeReply")&&(e.dynamicWaitTimeReply=ge(o.dynamicWaitTimeReply)),o.hasOwnProperty("logoChat")&&(e.logoChat=o.logoChat),o.hasOwnProperty("preChatForm")&&(e.preChatForm=o.preChatForm),o.hasOwnProperty("preChatFormCustomFieldsEnabled")&&o.hasOwnProperty("preChatFormJson")&&(e.preChatFormJson=o.preChatFormJson),o.hasOwnProperty("themeColor")&&(e.themeColor=o.themeColor,e.bubbleSentBackground=o.themeColor,e.bubbleSentTextColor=ze(o.themeColor,!0),e.buttonTextColor=o.themeColor,e.buttonHoverBackgroundColor=o.themeColor),o.hasOwnProperty("themeColorOpacity")&&(e.themeColorOpacity=o.themeColorOpacity),o.hasOwnProperty("themeForegroundColor")&&(e.themeForegroundColor=o.themeForegroundColor),o.hasOwnProperty("nativeRating")&&(e.nativeRating=o.nativeRating),o.hasOwnProperty("poweredBy")&&(e.poweredBy=o.poweredBy),o.hasOwnProperty("baloonImage")&&(e.baloonImage=o.baloonImage),o.hasOwnProperty("allowReopen")&&(e.allowReopen=o.allowReopen,e.allowReopen&&!e.showInfoMessage.includes("CHAT_CLOSED")&&e.showInfoMessage.push("CHAT_CLOSED")),o.hasOwnProperty("singleConversation")&&(e.singleConversation=o.singleConversation),o.hasOwnProperty("themeColorOpacity")&&(e.themeColorOpacity=o.themeColorOpacity)}catch(o){this.logger.error("[GLOBAL-SET] setVariablesFromService widget > Error :",o)}try{const r=n.ip.split(",").shift();this.globals.attributes||(this.globals.attributes={}),this.globals.attributes.ipAddress=r,this.globals.setAttributeParameter("ipAddress",r),this.logger.debug("[GLOBAL-SET] setVariablesFromService > ipAddress :",r)}catch(o){this.logger.error("[GLOBAL-SET] setVariablesFromService > ipAddress > Error :",o)}this.appStorageService.setItem("attributes",JSON.stringify(this.globals.attributes))}setVariablesFromSettings(e){const n=e.windowContext;if(!n.tiledesk)return;{const v=n.tiledesk.getBaseLocation();void 0!==v&&(e.baseLocation=v)}let o;const r=n.tiledeskSettings;o=r.tenant,void 0!==o&&(e.tenant=o),o=r.recipientId,void 0!==o&&(e.recipientId=o),o=r.widgetTitle,void 0!==o&&(e.widgetTitle=o),o=r.userEmail,void 0!==o&&(e.userEmail=o),o=r.userFullname,void 0!==o&&(e.userFullname=o),o=r.preChatForm,void 0!==o&&(e.preChatForm=!0===o),o=r.isOpen,void 0!==o&&(e.isOpen=!0===o),o=r.open,void 0!==o&&(e.isOpen=!0===o),o=r.channelType,void 0!==o&&(e.channelType=o),o=r.lang,Co.XAE&&(e.lang=o),o=r.align,void 0!==o&&(e.align=o),o=r.marginX,void 0!==o&&(e.marginX=o),o=r.marginY,void 0!==o&&(e.marginY=o),o=r.mobileMarginX,void 0!==o&&(e.mobileMarginX=o),o=r.mobileMarginY,void 0!==o&&(e.mobileMarginY=o),o=r.launcherWidth,void 0!==o&&(e.launcherWidth=o),o=r.launcherHeight,void 0!==o&&(e.launcherHeight=o),o=r.baloonImage,void 0!==o&&(e.baloonImage=o),o=r.baloonShape,void 0!==o&&(e.baloonShape=o),o=r.calloutTimer,void 0!==o&&(e.calloutTimer=o),o=r.calloutTitle,void 0!==o&&(e.calloutTitle=o),o=r.calloutMsg,void 0!==o&&(e.calloutMsg=o),o=r.fullscreenMode,void 0!==o&&(e.fullscreenMode=o),o=r.hideHeaderCloseButton,void 0!==o&&(e.hideHeaderCloseButton=o),o=r.themeColor,void 0!==o&&(e.themeColor=Me(o,100),e.bubbleSentBackground=Me(o,100),e.bubbleSentTextColor=ze(o,!0),e.buttonTextColor=Me(o,100),e.buttonHoverBackgroundColor=Me(o,100)),o=r.themeColorOpacity,void 0!==o&&(e.themeColorOpacity=+o),o=r.themeForegroundColor,void 0!==o&&(e.themeForegroundColor=Me(o,100)),o=r.allowTranscriptDownload,void 0!==o&&(e.allowTranscriptDownload=!0===o),o=r.startFromHome,void 0!==o&&(e.startFromHome=!0===o),o=r.logoChat,void 0!==o&&(e.logoChat=o),o=r.welcomeTitle,void 0!==o&&(e.welcomeTitle=o),o=r.welcomeMsg,void 0!==o&&(e.welcomeMsg=o),o=r.autoStart,void 0!==o&&(e.autoStart=!0===o),o=r.startHidden,void 0!==o&&(e.startHidden=!0===o),o=r.isShown,void 0!==o&&(e.isShown=!0===o),o=r.filterByRequester,void 0!==o&&(e.filterByRequester=!0===o),o=r.showWaitTime,void 0!==o&&(e.showWaitTime=!0===o),o=r.showAvailableAgents,void 0!==o&&(e.showAvailableAgents=!0===o),o=r.showLogoutOption,void 0!==o&&(e.showLogoutOption=!0===o),o=r.customAttributes,void 0!==o&&(e.customAttributes=o),o=r.showAttachmentButton,void 0!==o&&(e.showAttachmentButton=!0===o),o=r.showAllConversations,void 0!==o&&(e.showAllConversations=!0===o),o=r.dynamicWaitTimeReply,void 0!==o&&(e.dynamicWaitTimeReply=ge(o)),o=r.soundEnabled,void 0!==o&&(e.soundEnabled=o),o=r.openExternalLinkButton,void 0!==o&&(e.openExternalLinkButton=o),o=r.hideCloseConversationOptionMenu,void 0!==o&&(e.hideCloseConversationOptionMenu=!0===o),o=r.hideRestartConversationOptionsMenu,void 0!==o&&(e.hideRestartConversationOptionsMenu=!0===o),o=r.hideHeaderConversationOptionsMenu,void 0!==o&&(e.hideHeaderConversationOptionsMenu=!0===o),o=r.hideSettings,void 0!==o&&(e.hideSettings=!0===o),o=r.logLevel,void 0!==o&&(e.logLevel=o),o=r.preChatFormJson,void 0!==o&&function lo(i){var a=!0;return Array.isArray(i)&&i.forEach(function(e){if("object"!=typeof e)return a=!1}),a}(o)&&(e.preChatFormJson=o),o=r.bubbleSentBackground,void 0!==o&&(e.bubbleSentBackground=Me(o,100),e.bubbleSentTextColor=ze(o,!0),e.buttonTextColor=Me(o,100),e.buttonHoverBackgroundColor=Me(o,100)),o=r.bubbleSentTextColor,void 0!==o&&(e.bubbleSentTextColor=Me(o,100)),o=r.bubbleReceivedBackground,void 0!==o&&(e.bubbleReceivedBackground=Me(o,100),e.bubbleReceivedTextColor=ze(o,!0)),o=r.bubbleReceivedTextColor,void 0!==o&&(e.bubbleReceivedTextColor=Me(o,100)),o=r.fontSize,void 0!==o&&(e.fontSize=o),o=r.fontFamily,void 0!==o&&(e.fontFamily=o),o=r.buttonFontSize,void 0!==o&&(e.buttonFontSize=o),o=r.buttonBackgroundColor,void 0!==o&&(e.buttonBackgroundColor=Me(o,100),e.buttonTextColor=ze(o,!0),e.buttonHoverBackgroundColor=ze(o,!0),e.buttonHoverTextColor=Me(o,100)),o=r.buttonTextColor,void 0!==o&&(e.buttonTextColor=Me(o,100),e.buttonHoverBackgroundColor=Me(o,100)),o=r.buttonHoverBackgroundColor,void 0!==o&&(e.buttonHoverBackgroundColor=Me(o,100)),o=r.buttonHoverTextColor,void 0!==o&&(e.buttonHoverTextColor=Me(o,100)),o=r.singleConversation,void 0!==o&&(e.singleConversation=!0===o),o=r.restartConversation,void 0!==o&&(e.restartConversation=!0===o),o=r.nativeRating,void 0!==o&&(e.nativeRating=!0===o),o=r.showInfoMessage,void 0!==o&&(e.showInfoMessage=o.split(",").map(v=>v.trim())),o=r.typingLocation,void 0!==o&&(e.typingLocation=o),o=r.allowReopen,void 0!==o&&(e.allowReopen=!0===o,e.allowReopen&&!e.showInfoMessage.includes("CHAT_CLOSED")&&e.showInfoMessage.push("CHAT_CLOSED")),o=r.continueConversationBeforeTime,void 0!==o&&(e.continueConversationBeforeTime=+o),o=r.participants,void 0!==o&&(e.participants=o.split(",").map(v=>v.trim())),o=r.whatsappNumber,void 0!==o&&(e.whatsappNumber=o),o=r.messangerPageTitle,void 0!==o&&(e.messangerPageTitle=o),o=r.telegramUsername,void 0!==o&&(e.telegramUsername=o)}setVariablesFromAttributeHtml(e,n){let o;o=n.nativeElement.getAttribute("tenant"),null!==o&&(this.globals.tenant=o),o=n.nativeElement.getAttribute("recipientId"),null!==o&&(this.globals.recipientId=o),o=n.nativeElement.getAttribute("widgetTitle"),null!==o&&(this.globals.widgetTitle=o),o=n.nativeElement.getAttribute("userEmail"),null!==o&&(this.globals.userEmail=o),o=n.nativeElement.getAttribute("userFullname"),null!==o&&(this.globals.userFullname=o),o=n.nativeElement.getAttribute("preChatForm"),null!==o&&(this.globals.preChatForm=!0===o),o=n.nativeElement.getAttribute("isOpen"),null!==o&&(this.globals.isOpen=!0===o),o=n.nativeElement.getAttribute("open"),null!==o&&(this.globals.isOpen=!0===o),o=n.nativeElement.getAttribute("channelType"),null!==o&&(this.globals.channelType=o),o=n.nativeElement.getAttribute("lang"),null!==o&&(this.globals.lang=o),o=n.nativeElement.getAttribute("align"),null!==o&&(this.globals.align=o),o=n.nativeElement.getAttribute("marginX"),null!==o&&(this.globals.marginX=o),o=n.nativeElement.getAttribute("marginY"),null!==o&&(this.globals.marginY=o),o=n.nativeElement.getAttribute("mobileMarginX"),null!==o&&(this.globals.mobileMarginX=o),o=n.nativeElement.getAttribute("mobileMarginY"),null!==o&&(this.globals.mobileMarginY=o),o=n.nativeElement.getAttribute("launcherWidth"),null!==o&&(this.globals.launcherWidth=o),o=n.nativeElement.getAttribute("launcherHeight"),null!==o&&(this.globals.launcherHeight=o),o=n.nativeElement.getAttribute("baloonImage"),null!==o&&(this.globals.baloonImage=o),o=n.nativeElement.getAttribute("baloonShape"),null!==o&&(this.globals.baloonShape=o),o=n.nativeElement.getAttribute("calloutTimer"),null!==o&&(this.globals.calloutTimer=o),o=n.nativeElement.getAttribute("welcomeMsg"),null!==o&&(this.globals.welcomeMsg=o),o=n.nativeElement.getAttribute("welcomeTitle"),null!==o&&(this.globals.welcomeTitle=o),o=n.nativeElement.getAttribute("calloutTitle"),null!==o&&(this.globals.calloutTitle=o),o=n.nativeElement.getAttribute("calloutMsg"),null!==o&&(this.globals.calloutMsg=o),o=n.nativeElement.getAttribute("startFromHome"),null!==o&&(this.globals.startFromHome=!0===o),o=n.nativeElement.getAttribute("logoChat"),null!==o&&(this.globals.logoChat=o),o=n.nativeElement.getAttribute("autoStart"),null!==o&&(this.globals.autoStart=!0===o),o=n.nativeElement.getAttribute("startHidden"),null!==o&&(this.globals.startHidden=!0===o),o=n.nativeElement.getAttribute("isShown"),null!==o&&(this.globals.isShown=!0===o),o=n.nativeElement.getAttribute("isLogEnabled"),null!==o&&(this.globals.isLogEnabled=!0===o),o=n.nativeElement.getAttribute("filterByRequester"),null!==o&&(this.globals.filterByRequester=!0===o),o=n.nativeElement.getAttribute("showAttachmentButton"),null!==o&&(this.globals.showAttachmentButton=!0===o),o=n.nativeElement.getAttribute("departmentID"),null!==o&&(this.globals.departmentID=o),o=n.nativeElement.getAttribute("showAllConversations"),null!==o&&(this.globals.showAllConversations=!0===o),o=n.nativeElement.getAttribute("dynamicWaitTimeReply"),null!==o&&(this.globals.dynamicWaitTimeReply=ge(o)),o=n.nativeElement.getAttribute("soundEnabled"),null!==o&&(this.globals.soundEnabled=o),o=n.nativeElement.getAttribute("openExternalLinkButton"),null!==o&&(this.globals.openExternalLinkButton=o),o=n.nativeElement.getAttribute("hideHeaderConversationOptionsMenu"),null!==o&&(this.globals.hideHeaderConversationOptionsMenu=o),o=n.nativeElement.getAttribute("hideCloseConversationOptionMenu"),null!==o&&(this.globals.hideCloseConversationOptionMenu=o),o=n.nativeElement.getAttribute("hideRestartConversationOptionsMenu"),null!==o&&(this.globals.hideRestartConversationOptionsMenu=o),o=n.nativeElement.getAttribute("hideSettings"),null!==o&&(this.globals.hideSettings=o),o=n.nativeElement.getAttribute("logLevel"),null!==o&&(this.globals.logLevel=o),o=n.nativeElement.getAttribute("preChatFormJson"),null!==o&&(this.globals.preChatFormJson=o),o=n.nativeElement.getAttribute("fontSize"),null!==o&&(this.globals.fontSize=o),o=n.nativeElement.getAttribute("fontFamily"),null!==o&&(this.globals.fontFamily=o),o=n.nativeElement.getAttribute("buttonFontSize"),null!==o&&(this.globals.buttonFontSize=o),o=n.nativeElement.getAttribute("buttonBackgroundColor"),null!==o&&(this.globals.buttonBackgroundColor=o),o=n.nativeElement.getAttribute("buttonTextColor"),null!==o&&(this.globals.buttonTextColor=o),o=n.nativeElement.getAttribute("buttonHoverBackgroundColor"),null!==o&&(this.globals.buttonHoverBackgroundColor=o),o=n.nativeElement.getAttribute("buttonHoverTextColor"),null!==o&&(this.globals.buttonHoverTextColor=o),o=n.nativeElement.getAttribute("singleConversation"),null!==o&&(this.globals.singleConversation=!0===o),o=n.nativeElement.getAttribute("restartConversation"),null!==o&&(this.globals.restartConversation=!0===o),o=n.nativeElement.getAttribute("nativeRating"),null!==o&&(this.globals.nativeRating=!0===o),o=n.nativeElement.getAttribute("showInfoMessage"),null!==o&&(this.globals.showInfoMessage=o.split(",").map(r=>r.trim())),o=n.nativeElement.getAttribute("typingLocation"),null!==o&&(this.globals.typingLocation=o),o=n.nativeElement.getAttribute("allowReopen"),null!==o&&(this.globals.allowReopen=o,this.globals.allowReopen&&!this.globals.showInfoMessage.includes("CHAT_CLOSED")&&this.globals.showInfoMessage.push("CHAT_CLOSED")),o=n.nativeElement.getAttribute("continueConversationBeforeTime"),null!==o&&(this.globals.continueConversationBeforeTime=+o),o=n.nativeElement.getAttribute("participants"),null!==o&&(this.globals.participants=o.split(",").map(r=>r.trim()))}setVariablesFromUrlParameters(e){this.logger.debug("[GLOBAL-SET] setVariablesFromUrlParameters: ");const n=e.windowContext;let o;if(o=ce(n,"tiledesk_tenant"),o&&(e.tenant=ge(o)),o=ce(n,"tiledesk_recipientId"),o&&(e.recipientId=ge(o)),o=ce(n,"tiledesk_widgetTitle"),o&&(e.widgetTitle=ge(o)),o=ce(n,"tiledesk_userEmail"),o&&(e.userEmail=ge(o)),o=ce(n,"tiledesk_userFullname"),o&&(e.userFullname=ge(o)),o=ce(n,"tiledesk_channelType"),o&&(e.channelType=ge(o)),o=ce(n,"tiledesk_lang"),o&&(e.lang=ge(o)),o=ce(n,"tiledesk_calloutTimer"),o&&(e.calloutTimer=Number(o)),o=ce(n,"tiledesk_align"),o&&(e.align=ge(o)),o=ce(n,"tiledesk_marginX"),o&&(e.marginX=ge(o)),o=ce(n,"tiledesk_marginY"),o&&(e.marginY=ge(o)),o=ce(n,"tiledesk_mobileMarginX"),o&&(e.mobileMarginX=ge(o)),o=ce(n,"tiledesk_mobileMarginY"),o&&(e.mobileMarginY=ge(o)),o=ce(n,"tiledesk_launcherWidth"),o&&(e.launcherWidth=ge(o)),o=ce(n,"tiledesk_launcherHeight"),o&&(e.launcherHeight=ge(o)),o=ce(n,"tiledesk_baloonImage"),o&&(e.baloonImage=ge(o)),o=ce(n,"tiledesk_baloonShape"),o&&(e.baloonShape=ge(o)),o=ce(n,"tiledesk_welcomeMsg"),o&&(e.welcomeMsg=ge(o)),o=ce(n,"tiledesk_calloutTitle"),o&&(e.calloutTitle=ge(o)),o=ce(n,"tiledesk_calloutMsg"),o&&(e.calloutMsg=ge(o)),o=ce(n,"tiledesk_hideHeaderCloseButton"),o&&(e.hideHeaderCloseButton=ge(o)),o=ce(n,"tiledesk_themeColor"),o){const r=ge(o);e.themeColor=Me(r,100),e.bubbleSentBackground=Me(r,100),e.buttonTextColor=Me(r,100),e.buttonHoverBackgroundColor=Me(r,100)}if(o=ce(n,"tiledesk_themeColorOpacity"),o&&(e.themeColorOpacity=+o),o=ce(n,"tiledesk_themeForegroundColor"),o){const r=ge(o);e.themeForegroundColor=Me(r,100),e.bubbleSentTextColor=Me(r,100)}if(o=ce(n,"tiledesk_logoChat"),o&&(e.logoChat=ge(o)),o=ce(n,"tiledesk_welcomeTitle"),o&&(e.welcomeTitle=ge(o)),o=ce(n,"tiledesk_autoStart"),o&&(e.autoStart=ge(o)),o=ce(n,"tiledesk_startHidden"),o&&(e.startHidden=ge(o)),o=ce(n,"tiledesk_isShown"),o&&(e.isShown=ge(o)),o=ce(n,"tiledesk_isLogEnabled"),o&&(e.isLogEnabled=ge(o)),o=ce(n,"tiledesk_filterByRequester"),o&&(e.filterByRequester=ge(o)),o=ce(n,"tiledesk_showWaitTime"),o&&(e.showWaitTime=ge(o)),o=ce(n,"tiledesk_showAvailableAgents"),o&&(e.showAvailableAgents=ge(o)),o=ce(n,"tiledesk_showLogoutOption"),o&&(e.showLogoutOption=ge(o)),o=ce(n,"tiledesk_preChatForm"),o&&(e.preChatForm=ge(o)),o=ce(n,"tiledesk_isOpen"),o&&(e.isOpen=ge(o)),o=ce(n,"tiledesk_open"),o&&(e.isOpen=ge(o)),o=ce(n,"tiledesk_allowTranscriptDownload"),o&&(e.allowTranscriptDownload=ge(o)),o=ce(n,"tiledesk_startFromHome"),o&&(e.startFromHome=ge(o)),o=ce(n,"tiledesk_fullscreenMode"),o&&(e.fullscreenMode=ge(o)),o=ce(n,"tiledesk_customAttributes"),o&&(e.customAttributes=JSON.parse(o)),o=ce(n,"tiledesk_showAttachmentButton"),o&&(e.showAttachmentButton=ge(o)),o=ce(n,"tiledesk_departmentID"),o&&(e.departmentID=o),o=ce(n,"tiledesk_persistence"),o&&(e.persistence=o),o=ce(n,"tiledesk_showAllConversations"),o&&(e.showAllConversations=ge(o)),o=ce(n,"tiledesk_jwt"),o&&(e.jwt=o),o=ce(n,"tiledesk_dynamicWaitTimeReply"),o&&(e.dynamicWaitTimeReply=ge(o)),o=ce(n,"tiledesk_soundEnabled"),o&&(e.soundEnabled=ge(o)),o=ce(n,"tiledesk_openExternalLinkButton"),o&&(e.openExternalLinkButton=ge(o)),o=ce(n,"tiledesk_hideHeaderConversationOptionsMenu"),o&&(e.hideHeaderConversationOptionsMenu=ge(o)),o=ce(n,"tiledesk_hideCloseConversationOptionMenu"),o&&(e.hideCloseConversationOptionMenu=ge(o)),o=ce(n,"tiledesk_hideRestartConversationOptionsMenu"),o&&(e.hideRestartConversationOptionsMenu=ge(o)),o=ce(n,"tiledesk_hideSettings"),o&&(e.hideSettings=ge(o)),o=ce(n,"tiledesk_logLevel"),o&&(e.logLevel=o),o=ce(n,"tiledesk_preChatFormJson"),o&&(e.preChatFormJson=JSON.parse(o)),o=ce(n,"tiledesk_bubbleSentBackground"),o){const r=ge(o);e.bubbleSentBackground=Me(r,100),e.bubbleSentTextColor=ze(r,!0),e.buttonTextColor=Me(r,100),e.buttonHoverBackgroundColor=Me(r,100)}if(o=ce(n,"tiledesk_bubbleSentTextColor"),o){const r=ge(o);e.bubbleSentTextColor=Me(r,100)}if(o=ce(n,"tiledesk_bubbleReceivedBackground"),o){const r=ge(o);e.bubbleReceivedBackground=Me(r,100),e.bubbleReceivedTextColor=ze(o,!0)}if(o=ce(n,"tiledesk_bubbleReceivedTextColor"),o){const r=ge(o);e.bubbleReceivedTextColor=Me(r,100)}if(o=ce(n,"tiledesk_fontSize"),o&&(e.fontSize=o),o=ce(n,"tiledesk_fontFamily"),o&&(e.fontFamily=o),o=ce(n,"tiledesk_buttonFontSize"),o&&(e.buttonFontSize=o),o=ce(n,"tiledesk_buttonBackgroundColor"),o){const r=ge(o);e.buttonBackgroundColor=Me(r,100),e.buttonTextColor=ze(r,!0),e.buttonHoverBackgroundColor=ze(r,!0),e.buttonHoverTextColor=Me(r,100)}if(o=ce(n,"tiledesk_buttonTextColor"),o){const r=ge(o);e.buttonTextColor=Me(r,100)}if(o=ce(n,"tiledesk_buttonHoverBackgroundColor"),o){const r=ge(o);e.buttonHoverBackgroundColor=Me(r,100)}if(o=ce(n,"tiledesk_buttonHoverTextColor"),o){const r=ge(o);e.buttonHoverTextColor=Me(r,100)}o=ce(n,"tiledesk_singleConversation"),o&&(e.singleConversation=ge(o)),o=ce(n,"tiledesk_restartConversation"),o&&(e.restartConversation=ge(o)),o=ce(n,"tiledesk_nativeRating"),o&&(e.nativeRating=ge(o)),o=ce(n,"tiledesk_typingLocation"),o&&(e.typingLocation=o),o=ce(n,"tiledesk_showInfoMessage"),o&&(e.showInfoMessage=o.split(",").map(r=>r.trim())),o=ce(n,"tiledesk_allowReopen"),o&&(e.allowReopen=ge(o),e.allowReopen&&!e.showInfoMessage.includes("CHAT_CLOSED")&&e.showInfoMessage.push("CHAT_CLOSED")),o=ce(n,"tiledesk_continueConversationBeforeTime"),o&&(e.continueConversationBeforeTime=+o),o=ce(n,"tiledesk_participants"),o&&(e.participants=o.split(",").map(r=>r.trim()))}setVariableFromStorage(e){this.logger.debug("[GLOBAL-SET] setVariableFromStorage :::::::: SET VARIABLE ----------\x3e",Object.keys(e));for(const n of Object.keys(e)){const o=this.appStorageService.getItem(n);o&&null!==o&&(e[n]=ge(o))}}initDepartments(e){if(this.globals.setParameter("departmentSelected",null),this.globals.setParameter("departmentDefault",null),this.logger.info("[GLOBAL-SET] initDepartments departments ::::",e),null!==e)if(this.globals.departments=e,1===e.length){const n=e[0];this.logger.debug("[GLOBAL-SET] initDepartments DEPARTMENT FIRST ::::",e[0]),this.globals.setParameter("departmentDefault",e[0]),n&&n.online_msg&&""!==n.online_msg&&(this.globals.online_msg=n.online_msg),n&&n.offline_msg&&""!==n.offline_msg&&(this.globals.offline_msg=n.offline_msg),this.setDepartment(e[0])}else if(e.length>1){this.logger.debug("[GLOBAL-SET] initDepartments > MORE THAN 1 DEPARTMENT ::::",e[0]);let n=0;e.forEach(o=>{if(!0===o.default)return o&&o.online_msg&&""!==o.online_msg&&(this.globals.online_msg=o.online_msg),o&&o.offline_msg&&""!==o.offline_msg&&(this.globals.offline_msg=o.offline_msg),this.globals.setParameter("departmentDefault",e[n]),void this.setDepartment(e[n]);n++})}else this.logger.error("[GLOBAL-SET] initDepartments > DEPARTMENT DEFAULT NON RESTITUISCE RISULTATI ::::")}setDepartmentFromExternal(){let e=!1;this.globals.departmentID&&(this.globals.departments.forEach(n=>{if(n._id===this.globals.departmentID)return this.logger.debug("[GLOBAL-SET] setDepartmentFromExternal > EXTERNAL DEPARTMENT ::::"+n._id),this.globals.setParameter("departmentDefault",n),this.setDepartment(n),void(e=!0)}),!1===e&&(this.globals.departmentID=null),this.logger.debug("[GLOBAL-SET] setDepartmentFromExternal > END departmentID ::::"+this.globals.departmentID+e)),this.globals.departments=this.globals.departments.filter(n=>!0!==n.default),this.globals.departments&&1===this.globals.departments.length&&this.setDepartment(this.globals.departments[0])}setDepartment(e){this.logger.debug("[GLOBAL-SET] setDepartment: ",JSON.stringify(e)),this.globals.setParameter("departmentSelected",e);let n=JSON.parse(this.appStorageService.getItem("attributes"));n?(n.departmentId=e._id,n.departmentName=e.name):n={departmentId:e._id,departmentName:e.name},this.logger.debug("[GLOBAL-SET] setDepartment > setAttributes: ",JSON.stringify(n)),this.globals.setParameter("departmentSelected",e),this.globals.setParameter("attributes",n)}setAvailableAgentsStatus(e){if(this.globals.setParameter("availableAgentsStatus",!1),null!==e&&e.length>0){const n=[];e.forEach((o,r)=>{o.imageurl=function an(i){return"https://firebasestorage.googleapis.com/v0/b/"+Ae.firebaseConfig.storageBucket+"/o/profiles%2F"+i+"%2Fthumb_photo.jpg?alt=media"}(o.id),n.push(o)}),this.globals.availableAgents=n,this.globals.setParameter("availableAgentsStatus",!0)}}getProjectParametersById(e){if(e){const o=this.appConfigService.getConfig().apiUrl+e+"/widgets",r=new Ee.WM;return r.append("Content-Type","application/json"),this.http.get(o,{headers:r})}}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ne),t.LFG(Re))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),vn=(()=>{class i{constructor(e,n){this.g=e,this.appStorageService=n}initialize(){this.setGlobalsSubscription()}setGlobalsSubscription(){const e=this;this.g.obsObjChanged.subscribe(n=>{n&&e.setVariable(n.key,n.val)})}setVariable(e,n){JSON.stringify(n)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ie),t.LFG(Ne))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var wo=_e(1737),yo=_e(7221),Ft=_e(4065);let Bt=(()=>{class i{constructor(e,n,o,r){this._translate=e,this.http=n,this.g=o,this.appConfigService=r,this.defaultLanguage="en",this.logger=ve.getInstance();let v=window;window.frameElement&&"parent"===window.frameElement.getAttribute("tiledesk_context")&&(v=window.parent),v.tiledesk&&(this.baseLocation=v.tiledesk.getBaseLocation())}getLanguage(){return this.language}initializeTransaltorService(){this._translate.setDefaultLang("it");const e=this._translate.getBrowserLang();this.logger.debug("[TRANSLATOR-SERV] initializeTransaltorService--\x3e DEVICE LANG ",e),e&&("it"===e?(this._translate.use("it"),this.http.get(this.baseLocation+`/assets/i18n/${e}.json`).subscribe(n=>{this._translate.setTranslation("it",JSON.parse(n._body)),this._translate.get("LABEL_PREVIEW").subscribe(o=>{})})):this._translate.use("en"))}getTranslationFileUrl(e){this.remoteTranslationsUrl=Ae.remoteTranslationsUrl;const n=this.appConfigService.getConfig().remoteTranslationsUrl;return n&&(this.remoteTranslationsUrl=n),Ae.loadRemoteTranslations?this.remoteTranslationsUrl+this.g.projectid+"/labels/"+e.toUpperCase():this.baseLocation+`/assets/i18n/${e}.json`}initI18n(){this._translate.addLangs(["en","it"]),this.logger.debug("[TRANSLATOR-SERV]\xbb\xbb\xbb\xbb initI18n getLangs ",this._translate.getLangs());const e="en";this.logger.debug("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n setDefaultLang "),this._translate.setDefaultLang(e),this.language=e;let n=this._translate.getBrowserLang();return this.g.lang&&""!==this.g.lang?(n=this.g.lang,this.language=this.g.lang):this.g.lang=n,new Promise((o,r)=>{this.http.get(this.getTranslationFileUrl(n)).pipe((0,yo.K)(P=>(this._translate.use(e),this.http.get(this.getTranslationFileUrl(e)).subscribe(Y=>{this.translateWithBrowserLang(Y.data,e)},Y=>{this.logger.error("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n Get default language - ERROR ",Y),this.logger.error("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n - \xbb\xbb\xbb loadRemoteTranslations IN ERROR ?",Ae.loadRemoteTranslations)},()=>{o(!0)}),(0,wo._)(P)))).subscribe(P=>{this.logger.debug(`[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n Successfully initialized '${n}' language from URL'`,this.getTranslationFileUrl(n)),P.data&&void 0!==P.data&&""!==P.data?(this.language=P.lang.toLowerCase(),this.translateWithBrowserLang(P.data,this.language)):(n=e,this.language=e,this.g.lang=e,this._translate.use(e),this.http.get(this.getTranslationFileUrl(e)).subscribe(Y=>{this.translateWithBrowserLang(Y.data,n)}))},P=>{this.logger.error(`[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n Get '${n}' language - ERROR `,P)},()=>{o(!0)})})}translateWithBrowserLang(e,n){this._translate.use(n),this.logger.debug("[TRANSLATOR-SERV] \xbb\xbb\xbb\xbb initI18n - \xbb\xbb\xbb loadRemoteTranslations ?",Ae.loadRemoteTranslations),this._translate.setTranslation(n,e,!0)}translate(e){this._translate.get(["LABEL_TU","LABEL_PLACEHOLDER","LABEL_START_NW_CONV","LABEL_FIRST_MSG","LABEL_FIRST_MSG_NO_AGENTS","LABEL_SELECT_TOPIC","LABEL_COMPLETE_FORM","LABEL_FIELD_NAME","LABEL_ERROR_FIELD_NAME","LABEL_FIELD_EMAIL","LABEL_ERROR_FIELD_EMAIL","LABEL_ERROR_FIELD_REQUIRED","LABEL_WRITING","LABEL_SEND_NEW_MESSAGE","AGENT_NOT_AVAILABLE","AGENT_AVAILABLE","GUEST_LABEL","ALL_AGENTS_OFFLINE_LABEL","CALLOUT_TITLE_PLACEHOLDER","CALLOUT_MSG_PLACEHOLDER","ALERT_LEAVE_CHAT","YES","NO","BUTTON_CLOSE_TO_ICON","BUTTON_EDIT_PROFILE","DOWNLOAD_TRANSCRIPT","RATE_CHAT","WELLCOME_TITLE","WELLCOME_MSG","OPTIONS","SOUND_ON","SOUND_OFF","LOGOUT","CUSTOMER_SATISFACTION","YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE","YOUR_RATING","WRITE_YOUR_OPINION","SUBMIT","THANK_YOU_FOR_YOUR_EVALUATION","YOUR_RATING_HAS_BEEN_RECEIVED","CLOSE","PREV_CONVERSATIONS","YOU","SHOW_ALL_CONV","START_A_CONVERSATION","NO_CONVERSATION","SEE_PREVIOUS","WAITING_TIME_FOUND","WAITING_TIME_NOT_FOUND","CLOSED","LABEL_PREVIEW"]).subscribe(o=>{e.LABEL_TU=o.LABEL_TU,e.LABEL_PLACEHOLDER=o.LABEL_PLACEHOLDER,e.LABEL_START_NW_CONV=o.LABEL_START_NW_CONV,e.LABEL_FIRST_MSG=o.LABEL_FIRST_MSG,e.LABEL_FIRST_MSG_NO_AGENTS=o.LABEL_FIRST_MSG_NO_AGENTS,e.LABEL_SELECT_TOPIC=o.LABEL_SELECT_TOPIC,e.LABEL_COMPLETE_FORM=o.LABEL_COMPLETE_FORM,e.LABEL_FIELD_NAME=o.LABEL_FIELD_NAME,e.LABEL_ERROR_FIELD_NAME=o.LABEL_ERROR_FIELD_NAME,e.LABEL_FIELD_EMAIL=o.LABEL_FIELD_EMAIL,e.LABEL_ERROR_FIELD_EMAIL=o.LABEL_ERROR_FIELD_EMAIL,e.LABEL_WRITING=o.LABEL_WRITING,e.LABEL_SEND_NEW_MESSAGE=o.LABEL_SEND_NEW_MESSAGE,e.AGENT_NOT_AVAILABLE=o.AGENT_NOT_AVAILABLE,e.AGENT_AVAILABLE=o.AGENT_AVAILABLE,e.GUEST_LABEL=o.GUEST_LABEL,e.ALL_AGENTS_OFFLINE_LABEL=o.ALL_AGENTS_OFFLINE_LABEL,e.CALLOUT_TITLE_PLACEHOLDER=o.CALLOUT_TITLE_PLACEHOLDER,e.CALLOUT_MSG_PLACEHOLDER=o.CALLOUT_MSG_PLACEHOLDER,e.ALERT_LEAVE_CHAT=o.ALERT_LEAVE_CHAT,e.YES=o.YES,e.NO=o.NO,e.BUTTON_CLOSE_TO_ICON=o.BUTTON_CLOSE_TO_ICON,e.BUTTON_EDIT_PROFILE=o.BUTTON_EDIT_PROFILE,e.DOWNLOAD_TRANSCRIPT=o.DOWNLOAD_TRANSCRIPT,e.RATE_CHAT=o.RATE_CHAT,e.WELLCOME_TITLE=o.WELLCOME_TITLE,e.WELLCOME_MSG=o.WELLCOME_MSG,e.OPTIONS=o.OPTIONS,e.SOUND_ON=o.SOUND_ON,e.SOUND_OFF=o.SOUND_OFF,e.LOGOUT=o.LOGOUT,e.CUSTOMER_SATISFACTION=o.CUSTOMER_SATISFACTION,e.YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE=o.YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE,e.YOUR_RATING=o.YOUR_RATING,e.WRITE_YOUR_OPINION=o.WRITE_YOUR_OPINION,e.SUBMIT=o.SUBMIT,e.THANK_YOU_FOR_YOUR_EVALUATION=o.THANK_YOU_FOR_YOUR_EVALUATION,e.YOUR_RATING_HAS_BEEN_RECEIVED=o.YOUR_RATING_HAS_BEEN_RECEIVED,e.CLOSE=o.CLOSE,e.PREV_CONVERSATIONS=o.PREV_CONVERSATIONS,e.YOU=o.YOU,e.SHOW_ALL_CONV=o.SHOW_ALL_CONV,e.START_A_CONVERSATION=o.START_A_CONVERSATION,e.NO_CONVERSATION=o.NO_CONVERSATION,e.SEE_PREVIOUS=o.SEE_PREVIOUS,e.WAITING_TIME_FOUND=o.WAITING_TIME_FOUND,e.WAITING_TIME_NOT_FOUND=o.WAITING_TIME_NOT_FOUND,e.CLOSED=o.CLOSED,e.LABEL_PREVIEW=o.LABEL_PREVIEW,e.LABEL_ERROR_FIELD_REQUIRED=o.LABEL_ERROR_FIELD_REQUIRED,e.welcomeTitle||(e.welcomeTitle=e.WELLCOME_TITLE),e.welcomeMsg||(e.welcomeMsg=e.WELLCOME_MSG)},o=>{this.logger.error("[TRANSLATOR-SERV]\xbb\xbb\xbb\xbb\xbb\xbb \xbb\xbb\xbb\xbb\xbb\xbb GET TRANSLATED LABELS - ERROR ",o)},()=>{})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ft.sK),t.LFG(Ee.eN),t.LFG(Ie),t.LFG(Re))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();const bn=JSON.parse('{"LABEL_TU":"","LABEL_PLACEHOLDER":"type your message..","LABEL_START_NW_CONV":"New conversation","LABEL_WHATSAPP":"Message us","LABEL_FIRST_MSG":"Describe shortly your problem, you will be contacted by an agent.","LABEL_FIRST_MSG_NO_AGENTS":"\u{1f914} All operators are offline at the moment. You can anyway describe your problem. It will be assigned to the support team who will answer you as soon as possible.","LABEL_SELECT_TOPIC":"Select a topic","LABEL_COMPLETE_FORM":"Complete the form to start a conversation with the next available agent.","LABEL_FIELD_NAME":"Name","LABEL_ERROR_FIELD_NAME":"Required field (minimum 5 characters).","LABEL_FIELD_EMAIL":"Email","LABEL_ERROR_FIELD_EMAIL":"Enter a valid email address.","LABEL_ERROR_FIELD_REQUIRED":"Required field","LABEL_WRITING":"is writing...","LABEL_SEND_NEW_MESSAGE":"Send a new message","AGENT_NOT_AVAILABLE":" Offline","AGENT_AVAILABLE":" Online","GUEST_LABEL":"Guest","ALL_AGENTS_OFFLINE_LABEL":"All operators are offline at the moment","LABEL_LOADING":"Loading...","CALLOUT_TITLE_PLACEHOLDER":"Need Help?","CALLOUT_MSG_PLACEHOLDER":"Click here and start chatting with us!","CUSTOMER_SATISFACTION":"Customer satisfaction","YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE":"your opinion on our customer service","DOWNLOAD_TRANSCRIPT":"Download transcript","BACK":"Back","CONTINUE":"Continue","YOUR_RATING":"your rating","WRITE_YOUR_OPINION":"Write your opinion ... (optional)","SUBMIT":"Submit","THANK_YOU_FOR_YOUR_EVALUATION":"Thank you for your evaluation","YOUR_RATING_HAS_BEEN_RECEIVED":"your rating has been received","ALERT_LEAVE_CHAT":"Do you want to leave the chat?","YES":"Yes","NO":"No","BUTTON_CLOSE_TO_ICON":"Minimize chat","BUTTON_EDIT_PROFILE":"Update profile","RATE_CHAT":"Rate chat","WELLCOME_TITLE":"Hi, welcome to Tiledesk \u{1f44b}","WELLCOME_MSG":"How can we help?","OPTIONS":"options","SOUND_OFF":"Sound off","SOUND_ON":"Sound on","LOGOUT":"Logout","CLOSE":"Close","RESTART":"Restart","PREV_CONVERSATIONS":"Your conversations","YOU":"You","SHOW_ALL_CONV":"show all","START_A_CONVERSATION":"Start a conversation","NO_CONVERSATION":"No conversation","SEE_PREVIOUS":"see previous","WAITING_TIME_FOUND":"The team typically replies in $reply_time","WAITING_TIME_NOT_FOUND":"The team will reply as soon as possible","CLOSED":"CLOSED","CLOSE_CHAT":"Close chat","MINIMIZE":"Minimize","MAXIMIZE":"Maximize","INFO_SUPPORT_USER_ADDED_SUBJECT":"you","INFO_SUPPORT_USER_ADDED_YOU_VERB":"have been added to ","INFO_SUPPORT_USER_ADDED_COMPLEMENT":"joined","INFO_SUPPORT_USER_ADDED_VERB":"the chat","INFO_SUPPORT_CHAT_REOPENED":"Chat reopened","INFO_SUPPORT_CHAT_CLOSED":"Chat closed","INFO_SUPPORT_LEAD_UPDATED":"Lead updated","INFO_SUPPORT_MEMBER_LEFT_GROUP":"removed from group","INFO_SUPPORT_MEMBER_ABANDONED_GROUP":"has left the conversation","INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU":"A new support request has been assigned to you","LABEL_PRECHAT_USER_FULLNAME":"Full name","LABEL_PRECHAT_USER_EMAIL":"Email","LABEL_PRECHAT_USER_EMAIL_ERROR":"Invalid email address","LABEL_PRECHAT_USER_PHONE":"Phone","LABEL_PRECHAT_USER_PHONE_ERROR":"Phone is required","LABEL_PRECHAT_FIRST_MESSAGE":"Your message for the support team","LABEL_PRECHAT_STATIC_TERMS_PRIVACY":"Before proceeding in the conversation please agree to our <a href=\'https://tiledesk.com/termsofservice/\' target=\'_blank\'>Terms</a> and <a href=\'https://tiledesk.com/privacy.html\' target=\'_blank\'>Privacy Policy</a>","LABEL_PRECHAT_ACCEPT_TERMS_PRIVACY":"I agree","PRECHAT_REQUIRED_ERROR":"This field is required","LABEL_TODAY":"today","LABEL_TOMORROW":"yesterday","LABEL_LAST_ACCESS":"last access","LABEL_TO":"at","ARRAY_DAYS":["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],"SENT_AN_ATTACHMENT":"sent an attachment","SENT_AN_IMAGE":"sent an image","LABEL_PREVIEW":"Preview","SWITCH_TO":"Or switch to:"}');let Xe=(()=>{class i{constructor(e){this.translateService=e}translateLanguage(e,n){return this.initialiseTranslation(e)}initialiseTranslation(e){const n=new Map;return e.forEach(o=>{this.translateService.get(o).subscribe(r=>{o===r&&bn[o]&&(r=bn[o]),n.set(o,r)})}),n}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ft.sK))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),at=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),lt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),bt=(()=>{class i{constructor(e,n){this.conversationsHandlerService=e,this.archivedConversationsService=n,this.BSStart=new me.X(null),this.logger=ve.getInstance()}initialize(){this.handlers=[],this.openInfoConversation=!0,this.currentUser=null,this.logger.info("[CHAT MANAGER]**** init ****",this.handlers)}setTiledeskToken(e){this.tiledeskToken=e}getTiledeskToken(){return this.tiledeskToken}setCurrentUser(e){this.currentUser=e}getCurrentUser(){return this.currentUser}startApp(){this.BSStart.next(this.currentUser)}getOpenInfoConversation(){return this.openInfoConversation}dispose(){this.logger.debug("[CHAT MANAGER] 1 - setOffAllReferences"),this.handlers&&this.setOffAllReferences(),this.logger.debug("[CHAT MANAGER] 2 - disposeConversationsHandler"),this.conversationsHandlerService&&this.disposeConversationsHandler(),this.logger.debug("[CHAT MANAGER] 3 - disposeArchivedConversationsHandler"),this.archivedConversationsService&&this.disposeArchivedConversationsHandler(),this.logger.debug("[CHAT MANAGER] 4 - disposeContactsSynchronizer"),this.logger.debug("[CHAT MANAGER] OKK "),this.conversationsHandlerService=null,this.archivedConversationsService=null}goOffLine(){this.currentUser=null,this.logger.debug("[CHAT MANAGER] 1 - CANCELLO TUTTE LE REFERENCES"),this.dispose()}addConversationHandler(e){this.logger.debug("[CHAT MANAGER] -----\x3e addConversationHandler",this.handlers,e),this.handlers.push(e)}removeConversationHandler(e){this.logger.debug("[CHAT MANAGER] -----\x3e removeConversationHandler: ",e);const n=this.handlers.findIndex(o=>o.conversationWith===e);this.handlers.splice(n,1)}getConversationHandlerByConversationId(e){let n=null;return this.handlers.forEach(o=>{o.conversationWith!==e||(n=o)}),n}setOffAllReferences(){this.handlers.forEach(e=>{}),this.handlers=[]}setConversationsHandler(e){this.conversationsHandlerService=e}setArchivedConversationsHandler(e){this.archivedConversationsService=e}disposeConversationsHandler(){this.logger.debug("[CHAT MANAGER] 2 - this.conversationsHandler:: ",this.conversationsHandlerService),this.conversationsHandlerService.dispose()}disposeArchivedConversationsHandler(){this.logger.debug("[CHAT MANAGER] 3 - this.archivedConversationsService:: ",this.archivedConversationsService),this.archivedConversationsService.dispose()}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(at),t.LFG(lt))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Ut=(()=>{class i{constructor(e,n){this.http=e,this.appStorage=n,this.logger=ve.getInstance()}initialize(e,n){this.logger.debug("[TILEDESK-REQUEST-SERV] - initialize",n),this.SERVER_BASE_URL=e,this.URL_TILEDESK_CLOSE_REQUEST=this.SERVER_BASE_URL+n+"/requests/"}closeSupportGroup(e){this.tiledeskToken=this.appStorage.getItem("tiledeskToken"),this.logger.debug("[TILEDESK-REQUEST-SERV] - closeSupportGroup",e);const o={headers:new Ee.WM({Accept:"application/json","Content-Type":"application/json",Authorization:this.tiledeskToken})},v=this.URL_TILEDESK_CLOSE_REQUEST+e+"/closeg";return new Promise((P,Y)=>{this.logger.debug("[TILEDESK-REQUEST-SERV] - closeSupportGroup URLLLL",v,o),this.http.put(v,null,o).subscribe(X=>{this.logger.debug("[TILEDESK-REQUEST-SERV] - closeSupportGroup response",X),P("closed")},X=>{Y(X)})})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ne))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();class Oo{constructor(a,e,n,o,r,v,P,Y,X,ae,fe,Ce){this.uid=a,this.email=e,this.firstname=n,this.lastname=o,this.fullname=r,this.imageurl=v,this.avatar=P,this.color=Y,this.checked=X,this.online=ae,this.lastConnection=fe,this.decoded=Ce}}function ct(i){const a=["#E17076","#7BC862","#65aadd","#a695e7","#ee7aae","#6ec9cb","#faa774"];let e=0;if(i){const n=i.charCodeAt(i.length-1);e=Math.round(n%a.length)}return a[e]}function ht(i){let a="";return i&&i.split(" ").forEach(n=>{n.trim().length>1&&a.length<3&&(a+=n.substring(0,1).toUpperCase()),1==n.trim().length&&(a+=n.substring(0,1).toUpperCase())}),a}let Cn=(()=>{class i{constructor(e,n){this.http=e,this.appStorage=n,this.logger=ve.getInstance()}initialize(e){this.logger.log("[TILEDESK-AUTH-SERV] - initialize serverBaseUrl",e),this.SERVER_BASE_URL=e,this.URL_TILEDESK_SIGNIN=this.SERVER_BASE_URL+"auth/signin",this.URL_TILEDESK_SIGNIN_ANONYMOUSLY=this.SERVER_BASE_URL+"auth/signinAnonymously",this.URL_TILEDESK_SIGNIN_WITH_CUSTOM_TOKEN=this.SERVER_BASE_URL+"auth/signinWithCustomToken"}signInWithEmailAndPassword(e,n){this.logger.debug("[TILEDESK-AUTH]-SERV] - signInWithEmailAndPassword",e,n);const o=new Ee.WM;o.append("Accept","application/json"),o.append("Content-Type","application/json");const r={headers:o},v={email:e,password:n},P=this;return new Promise((Y,X)=>{this.http.post(this.URL_TILEDESK_SIGNIN,v,r).subscribe(ae=>{ae.success&&ae.token&&(P.tiledeskToken=ae.token,P.createCompleteUser(ae.user),P.appStorage.setItem("tiledeskToken",P.tiledeskToken),Y(P.tiledeskToken))},ae=>{X(ae)})})}signInAnonymously(e){this.logger.debug("[TILEDESK-AUTH] - signInAnonymously - projectID",e);const n=new Ee.WM;n.append("Accept","application/json"),n.append("Content-Type","application/json");const o={headers:n},r={id_project:e},v=this;return new Promise((P,Y)=>{this.http.post(this.URL_TILEDESK_SIGNIN_ANONYMOUSLY,r,o).subscribe(X=>{X.success&&X.token&&(v.tiledeskToken=X.token,v.createCompleteUser(X.user),v.appStorage.setItem("tiledeskToken",v.tiledeskToken),P(v.tiledeskToken))},X=>{Y(X)})})}signInWithCustomToken(e){const o={headers:new Ee.WM({"Content-type":"application/json",Authorization:e})},r=this;return new Promise((v,P)=>{this.http.post(this.URL_TILEDESK_SIGNIN_WITH_CUSTOM_TOKEN,null,o).subscribe(Y=>{Y.success&&Y.token&&(r.tiledeskToken=Y.token,r.createCompleteUser(Y.user),this.checkAndSetInStorageTiledeskToken(r.tiledeskToken),v(this.currentUser))},Y=>{P(Y)})})}logOut(){this.logger.debug("[TILEDESK-AUTH] logOut()"),this.appStorage.removeItem("tiledeskToken"),this.appStorage.removeItem("currentUser"),this.setCurrentUser(null)}createCompleteUser(e){const n=new Oo(e._id);try{const o=e._id,r=e.firstname?e.firstname:"",v=e.lastname?e.lastname:"",P=e.email?e.email:"",Y=(r+" "+v).trim(),X=ht(Y),ae=ct(Y);n.uid=o,n.email=P,n.firstname=r,n.lastname=v,n.fullname=Y,n.avatar=X,n.color=ae,this.currentUser=n,this.logger.debug("[TILEDESK-AUTH] - createCompleteUser member ",n),this.appStorage.setItem("currentUser",JSON.stringify(this.currentUser))}catch(o){this.logger.error("[TILEDESK-AUTH]- createCompleteUser ERR ",o)}}checkAndSetInStorageTiledeskToken(e){this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken tiledeskToken from request",e);const n=this.appStorage.getItem("tiledeskToken");this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken storedTiledeskToken ",n),n?n&&n!==e?(this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken STORED-TOKEN EXIST BUT IS != FROM TOKEN - RUN SET "),this.appStorage.setItem("tiledeskToken",e)):n&&n===e&&this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken STORED-TOKEN EXIST AND IS = TO TOKEN "):(this.logger.log("[TILEDESK-AUTH] - checkAndSetInStorageTiledeskToken TOKEN DOES NOT EXIST - RUN SET "),this.appStorage.setItem("tiledeskToken",e))}getCurrentUser(){return this.currentUser}setCurrentUser(e){this.currentUser=e}getTiledeskToken(){return this.tiledeskToken}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ne))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Ct=(()=>{class i{constructor(){this.DEFAULT_PERSISTENCE="NONE",this.DEFAULT_URL="https://api.tiledesk.com/v2/auth/"}setPersistence(e){this.persistence=e}getPersistence(){return this.persistence?this.persistence:this.DEFAULT_PERSISTENCE}setBaseUrl(e){this.baseUrl=e}getBaseUrl(){return this.baseUrl?this.baseUrl:this.DEFAULT_URL}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),dt=(()=>{class i{constructor(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),et=(()=>{class i{constructor(){this.DEFAULT_URL=Ae.baseImageUrl}setImageBaseUrl(e){this.baseImageUrl=e}getImageBaseUrl(){return this.baseImageUrl?this.baseImageUrl:this.DEFAULT_URL}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),it=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),wt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),rt=(()=>{class i{constructor(){this.DEFAULT_URL=Ae.apiUrl}setBaseUrl(e){this.baseUrl=e}getBaseUrl(){return this.baseUrl?this.baseUrl:this.DEFAULT_URL}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();function xo(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"chat-home",10),t.NdJ("onNewConversation",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onNewConversation())})("onConversationSelected",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onSelectedConversation(o))})("onOpenAllConvesations",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onOpenAllConversation())})("onCloseWidget",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onCloseWidget())})("onSignOut",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSignOut())})("onImageLoaded",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onImageLoaded(o))})("onConversationLoaded",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onConversationLoaded(o))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("listConversations",e.listConversations)("archivedConversations",e.archivedConversations)("hideSettings",e.g.hideSettings)("stylesMap",e.styleMapConversation)}}function Mo(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"chat-list-all-conversations",11),t.NdJ("onCloseWidget",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onCloseAllConversation())})("onConversationSelected",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onSelectedConversation(o))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("listConversations",e.listConversations)("archivedConversations",e.archivedConversations)("stylesMap",e.styleMapConversation)}}function Eo(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"chat-conversation",12),t.NdJ("onBackHome",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onBackConversation())})("onCloseWidget",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onCloseWidget())})("onSoundChange",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onSoundChange(o))})("onConversationClosed",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onConversationClosed(o))})("onSignOut",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onMenuOptionSignOut())})("onNewConversationButtonClicked",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onNewConversationButtonClicked(o))})("onBeforeMessageSent",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.triggerHandler.triggerBeforeSendMessageEvent(o))})("onAfterSendMessage",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.triggerHandler.triggerAfterSendMessageEvent(o))})("onNewMessageCreated",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.triggerHandler.triggerOnMessageCreated(o))})("onNewConversationInit",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.triggerHandler.triggerOnNewConversationInit(o))})("onBeforeMessageRender",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.triggerHandler.triggerBeforeMessageRender(o))})("onAfterMessageRender",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.triggerHandler.triggerAfterMessageRender(o))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("senderId",e.g.senderId)("conversationId",e.g.recipientId)("isOpen",e.g.isOpen)("isConversationArchived",e.isConversationArchived)("stylesMap",e.styleMapConversation)}}function So(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",13)(1,"chat-selection-department",14),t.NdJ("onBeforeDepartmentsFormRender",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.triggerHandler.triggerOnbeforeDepartmentsFormRender(o))})("onClose",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onCloseModalDepartment())})("onDepartmentSelected",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onDepartmentSelected(o))}),t.qZA()()}}function To(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",15)(1,"chat-prechat-form",16),t.NdJ("onClosePage",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onCloseModalPrechatForm())})("onCloseForm",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onPrechatFormComplete())}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("stylesMap",e.styleMapConversation)}}function Po(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",17)(1,"chat-star-rating-widget",18),t.NdJ("onClosePage",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onCloseModalRateChat())})("onCloseRate",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onRateChatComplete())}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("recipientId",e.g.recipientId)("stylesMap",e.styleMapConversation)}}function ko(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-eyeeye-catcher-card",19),t.NdJ("onOpenChat",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onOpenChatEyeEyeCatcherCard())})("onCloseEyeCatcherCard",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onCloseEyeCatcherCard(o))}),t.qZA()}}function Ao(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"chat-last-message",20),t.NdJ("onCloseMessagePreview",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.triggerHandler.triggerOnCloseMessagePreview())})("onSelectedConversation",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onSelectedConversation(o))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("conversation",e.lastConversation)("baseLocation",null==e.g||null==e.g.windowContext.tiledesk?null:e.g.windowContext.tiledesk.getBaseLocation())("stylesMap",e.styleMapConversation)}}function Io(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-launcher-button",21),t.NdJ("onButtonClicked",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onOpenCloseWidget(o))}),t.qZA()}}const Ro=function(i,a,e,n){return{"swing-in-bottom-fwd":i,"full-screen-mode":a,"c21-align-left":e,"c21-align-right":n}},Lo=function(i,a,e,n){return{display:i,bottom:a,left:e,right:n}};let Dt=(()=>{class i{constructor(e,n,o,r,v,P,Y,X,ae,fe,Ce,de,we,ye,Se,Fe,Qe,We,Ye,Je,Qt,yl){this.el=e,this.ngZone=n,this.g=o,this.rules=r,this.triggerHandler=v,this.globalSettingsService=P,this.settingsSaverService=Y,this.appConfigService=X,this.appStorageService=ae,this.translatorService=fe,this.translateService=Ce,this.chatManager=de,this.tiledeskRequestsService=we,this.tiledeskAuthService=ye,this.messagingAuthService=Se,this.conversationsHandlerService=Fe,this.archivedConversationsService=Qe,this.conversationHandlerBuilderService=We,this.imageRepoService=Ye,this.typingService=Je,this.presenceService=Qt,this.uploadService=yl,this.subscriptions=[],this.isTabVisible=!0,this.isOpenHome=!0,this.isOpenConversation=!1,this.isOpenAllConversation=!1,this.isOpenSelectionDepartment=!1,this.isOpenStartRating=!1,this.isConversationArchived=!1,this.isInitialized=!1,this.isSentMessage=!1,this.styleMapConversation=new Map,this.logger=ve.getInstance()}ngOnInit(){this.logger.info("[APP-CONF]---------------- ngOnInit: APP.COMPONENT ---------------- "),this.initWidgetParamiters()}ngAfterViewInit(){this.logger.info("[APP-CONF]---------------- ngAfterViewInit: APP.COMPONENT ---------------- "),this.ngZone.run(()=>{const e=this,n=this.conversationsHandlerService.conversationChanged.subscribe(P=>{if(P)if(this.onImageLoaded(P),this.onConversationLoaded(P),P.recipient===this.g.senderId&&gn(P))e.disposeWidget();else{if(P.is_new&&P.sender!==this.g.senderId&&!_t(P)&&e.manageTabNotification(),!0===e.g.isOpen){if(e.g.setParameter("displayEyeCatcherCard","none"),this.logger.debug("[APP-COMP] obsChangeConversation ::: ",P),P.attributes&&"info"===P.attributes.subtype)return}else{e.lastConversation=P,e.g.isOpenNewMessage=!0,e.logger.debug("[APP-COMP] lastconversationnn",e.lastConversation);let Y=e.conversationsHandlerService.countIsNew();e.g.setParameter("conversationsBadge",Y)}e.triggerOnConversationUpdated(P)}else this.logger.debug("[APP-COMP] oBSconversationChanged null: errorrr")});this.subscriptions.push(n);const o=this.conversationsHandlerService.conversationAdded.subscribe(P=>{if(!0===e.g.isOpen&&P){if(e.g.setParameter("displayEyeCatcherCard","none"),e.triggerOnConversationUpdated(P),e.logger.debug("[APP-COMP] obsAddedConversation ::: ",P),P.attributes&&"info"===P.attributes.subtype)return;P.is_new&&e.manageTabNotification(),!1===this.g.isOpen&&(e.lastConversation=P,e.g.isOpenNewMessage=!0)}else{let Y=e.conversationsHandlerService.countIsNew();e.g.setParameter("conversationsBadge",Y)}P&&(this.onImageLoaded(P),this.onConversationLoaded(P))});this.subscriptions.push(o);const r=this.archivedConversationsService.archivedConversationAdded.subscribe(P=>{P&&(e.triggerOnConversationUpdated(P),this.onImageLoaded(P),this.onConversationLoaded(P))});this.subscriptions.push(r);const v=this.archivedConversationsService.archivedConversationRemoved.subscribe(P=>{P&&(this.isConversationArchived=!1,e.triggerOnConversationUpdated(P))});this.subscriptions.push(v)}),this.appStorageService.initialize(Ae.storage_prefix,this.g.persistence,this.g.projectid),this.tiledeskAuthService.initialize(this.appConfigService.getConfig().apiUrl),this.tiledeskRequestsService.initialize(this.appConfigService.getConfig().apiUrl,this.g.projectid),this.messagingAuthService.initialize(),this.chatManager.initialize(),this.uploadService.initialize()}initWidgetParamiters(){const e=this,n=this.globalSettingsService.obsSettingsService.subscribe(o=>{o&&(this.logger.setLoggerConfig(this.g.isLogEnabled,this.g.logLevel),this.tabTitle=this.g.windowContext.window.document.title,this.appStorageService.initialize(Ae.storage_prefix,this.g.persistence,this.g.projectid),this.logger.debug("[APP-COMP] check if token is passed throw url: ",this.g.jwt),this.g.jwt&&(this.logger.debug("[APP-COMP]  ----------------  logging in with custom token from url ---------------- "),this.appStorageService.getItem("tiledeskToken")===this.g.jwt||this.appStorageService.setItem("tiledeskToken",this.g.jwt),this.g.tiledeskToken=this.g.jwt),this.translatorService.initI18n().then(r=>{this.logger.debug("[APP-COMP] \xbb\xbb\xbb\xbb APP-COMPONENT.TS initI18n result",r);const v=this.translatorService.getLanguage();nt.locale(v),this.translatorService.translate(this.g)}).then(()=>{e.initAll(),e.triggerOnBeforeInit(),e.setAuthSubscription()}))});this.subscriptions.push(n),this.globalSettingsService.initWidgetParamiters(this.g,this.el),this.audio=new Audio,this.audio.src=this.g.baseLocation+"/assets/sounds/pling.mp3",this.audio.load()}initAll(){this.addComponentToWindow(this.ngZone),this.triggerHandler.setElement(this.el),this.triggerHandler.setWindowContext(this.g.windowContext);const e=this.setAttributesFromStorageService();e&&(this.g.attributes=e),this.setStyleMap(),this.settingsSaverService.initialize(),this.g.initialize(),this.removeFirebasewebsocketFromLocalStorage(),this.initLauncherButton(),this.triggerLoadParamsEvent()}setAuthSubscription(){this.logger.debug("[APP-COMP] setLoginSubscription : ");const e=this,n=this.messagingAuthService.BSAuthStateChanged.subscribe(r=>{const v=this.appStorageService.getItem("tiledeskToken");v&&void 0!==v&&(e.g.tiledeskToken=v);const P=this.messagingAuthService.getToken();P&&void 0!==P&&(e.g.firebaseToken=P);const Y=this.g.autoStart;if(e.stateLoggedUser=r,r&&"online"===r){const X=e.tiledeskAuthService.getCurrentUser();e.logger.info("[APP-COMP] ONLINE - LOGGED SUCCESSFULLY",X),e.g.setParameter("senderId",X.uid),e.g.setParameter("isLogged",!0),e.g.setParameter("attributes",e.setAttributesFromStorageService()),this.initConversationsHandler(this.g.tenant,e.g.senderId),e.g.singleConversation||e.startUI(),e.triggerOnAuthStateChanged(e.stateLoggedUser),e.logger.debug("[APP-COMP]  1 - IMPOSTO STATO CONNESSO UTENTE ",Y),e.typingService.initialize(this.g.tenant),e.presenceService.initialize(this.g.tenant),e.presenceService.setPresence(X.uid),Y&&!e.g.singleConversation&&e.showWidget()}else r&&"offline"===r&&(e.logger.info("[APP-COMP] OFFLINE - NO CURRENT USER AUTENTICATE: "),e.g.setParameter("isLogged",!1),e.hideWidget(),e.triggerOnAuthStateChanged(e.stateLoggedUser),Y&&e.authenticate())});this.subscriptions.push(n);const o=this.messagingAuthService.BSSignOut.subscribe(r=>{!0===r&&(e.logger.debug("[APP-COMP] sono nel caso logout -1"),e.g.tiledeskToken=null,e.g.setParameter("isLogged",!1),e.g.setParameter("isOpenPrechatForm",!1),e.g.setParameter("userFullname",null),e.g.setParameter("userEmail",null),e.g.setAttributeParameter("userFullname",null),e.g.setAttributeParameter("userEmail",null),this.g.setAttributeParameter("preChatForm",null),this.g.setParameter("conversationsBadge",0),this.g.setParameter("recipientId",null,!1),e.hideWidget(),e.g.isLogout=!0,e.triggerOnAuthStateChanged("offline"))});this.subscriptions.push(o)}authenticate(){const e=this.g.tiledeskToken,n=this.appStorageService.getItem("currentUser");this.logger.debug("[APP-COMP] tiledesktokennn",e,n),e?(this.logger.debug("[APP-COMP]  ---------------- 13 ---------------- "),this.logger.debug("[APP-COMP]  ----------- sono gi\xe0 loggato ------- "),this.signInWithCustomToken(e)):(this.logger.debug("[APP-COMP]  ---------------- 14 ---------------- "),this.logger.debug("[APP-COMP]  authenticateFirebaseAnonymously"),this.tiledeskAuthService.signInAnonymously(this.g.projectid).then(o=>{this.messagingAuthService.createCustomToken(o);const r=this.tiledeskAuthService.getCurrentUser();if((r.firstname||r.lastname)&&!this.g.userFullname){const v=r.firstname+" "+r.lastname;this.g.setParameter("userFullname",v),this.g.setAttributeParameter("userFullname",v)}r.email&&!this.g.userEmail&&(this.g.setParameter("userEmail",r.email),this.g.setAttributeParameter("userEmail",r.email))}))}signInWithCustomToken(e){const n=this;return this.appStorageService.getItem("tiledeskToken")===e||this.appStorageService.removeItem("recipientId"),this.tiledeskAuthService.signInWithCustomToken(e).then(r=>{if(this.messagingAuthService.createCustomToken(e),this.logger.debug("[APP-COMP] signInWithCustomToken user::",r,this.g.userFullname),(r.firstname||r.lastname)&&!this.g.userFullname){const v=r.firstname+" "+r.lastname;this.g.setParameter("userFullname",v),this.g.setAttributeParameter("userFullname",v)}return r.email&&!this.g.userEmail&&(this.g.setParameter("userEmail",r.email),this.g.setAttributeParameter("userEmail",r.email)),Promise.resolve(r)}).catch(r=>(this.logger.debug("[APP-COMP] signInWithCustomToken ERR ",r),n.signOut(),Promise.reject(r)))}signInAnonymous(){return this.logger.debug("[APP-COMP] signInAnonymous"),this.tiledeskAuthService.signInAnonymously(this.g.projectid).then(e=>{this.messagingAuthService.createCustomToken(e);const n=this.tiledeskAuthService.getCurrentUser();if(n.firstname||n.lastname){const o=n.firstname+" "+n.lastname;this.g.setParameter("userFullname",o),this.g.setAttributeParameter("userFullname",o)}return n.email&&(this.g.setParameter("userEmail",n.email),this.g.setAttributeParameter("userEmail",n.email)),Promise.resolve(n)}).catch(e=>(this.logger.error("[APP-COMP] signInAnonymous ERR",e),Promise.reject(e)))}startUI(){this.logger.debug("[APP-COMP]  ============ startUI ===============");const e=this.g.departments,n=this.g.attributes,o=this.g.preChatForm;this.isOpenHome=!0,this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenSelectionDepartment=!1,this.isOpenAllConversation=!1;const r=this.appStorageService.getItem("recipientId");this.logger.debug("[APP-COMP]  ============ idConversation ===============",r,this.g.recipientId),this.logger.debug("[APP-COMP] singleConversation conv da ...",this.g.recipientId),this.g.restartConversation&&this.g.singleConversation?(this.logger.debug("[APP-COMP] RESTART-CONVERSARION::: start a new conversations...",this.g.restartConversation),this.onNewConversation()):this.g.recipientId&&this.g.singleConversation?(this.logger.debug("[APP-COMP] singleConversation conv da API",this.g.recipientId),this.isOpenHome=!1,this.isOpenConversation=!0,this.isOpenSelectionDepartment=!1):!this.g.recipientId&&this.g.singleConversation?(this.logger.debug("[APP-COMP] singleConversation start new conv ",this.g.recipientId),this.isOpenHome=!1,this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,this.onNewConversation()):this.g.recipientId?(this.logger.debug("[APP-COMP]  conv da urll",this.g.recipientId),this.g.isOpen&&(this.isOpenConversation=!0),this.g.setParameter("recipientId",this.g.recipientId),this.appStorageService.setItem("recipientId",this.g.recipientId)):r?(this.logger.debug("[APP-COMP]  conv da storagee",r),this.g.isOpen&&(this.isOpenConversation=!0),this.g.recipientId=r,this.g.setParameter("recipientId",r)):this.g.startFromHome?(this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenSelectionDepartment=!1):!o||n&&n.userFullname&&n.userEmail?(this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,e.length>1&&null==!this.g.departmentID?this.isOpenSelectionDepartment=!0:(this.isOpenConversation=!1,!this.g.recipientId&&this.g.isOpen&&this.onNewConversation())):(this.g.setParameter("isOpenPrechatForm",!0),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,e.length>1&&null==this.g.departmentID&&(this.isOpenSelectionDepartment=!0)),this.triggerOnViewInit(),this.g.setParentBodyStyleMobile(this.g.isOpen,this.g.isMobile),this.g.setElementStyle(this.g.isOpen)}generateNewUidConversation(){return this.logger.debug("[APP-COMP] generateUidConversation **************: senderId= ",this.g.senderId),tn+this.g.projectid+"-"+(0,pt.Z)().replace(/-/g,"")}startNewConversation(){this.logger.debug("[APP-COMP] AppComponent::startNewConversation");const e=this.generateNewUidConversation();this.g.setParameter("recipientId",e),this.appStorageService.setItem("recipientId",e),this.logger.debug("[APP-COMP]  recipientId: ",this.g.recipientId),this.isConversationArchived=!1,this.triggerNewConversationEvent(e)}setAttributesFromStorageService(){let e={};try{e=JSON.parse(this.appStorageService.getItem("attributes"))}catch(X){this.logger.debug("[APP-COMP] > Error  setAttributesFromStorageService:"+X)}const n=navigator.userAgent,o=this.g.projectid,r=this.g.userEmail,v=this.g.userFullname,P=this.g.senderId,Y=this.g.BUILD_VERSION;!e&&null===e&&(e=this.g.attributes?this.g.attributes:{}),n&&(e.client=n),location.href&&(e.sourcePage=location.href),document.title&&(e.sourceTitle=document.title),o&&(e.projectId=o),r&&(e.userEmail=r),v&&(e.userFullname=v),P&&(e.requester_id=P),Y&&(e.widgetVer=Y);try{e.payload=[],this.g.customAttributes&&(e.payload=this.g.customAttributes)}catch(X){this.logger.debug("[APP-COMP] > Error is handled payload: ",X)}try{const X=e.preChatForm;X&&X.userEmail&&(this.g.userEmail=X.userEmail),X&&X.userFullname&&(this.g.userFullname=X.userFullname)}catch(X){this.logger.debug("[APP-COMP] > Error is handled preChatForm: ",X)}return this.appStorageService.setItem("attributes",JSON.stringify(e)),e}initConversationsHandler(e,n){this.logger.debug("[APP-COMP] initialize: ListConversationsComponent");const r=this.translateService.translateLanguage(["YOU"]);this.listConversations=[],this.archivedConversations=[],this.logger.debug("[APP-COMP] senderId: ",n),this.logger.debug("[APP-COMP] tenant: ",e),this.conversationsHandlerService.initialize(e,n,r),this.archivedConversationsService.initialize(e,n,r),this.g.singleConversation&&this.g.isOpen?this.manageWidgetSingleConversation():this.g.singleConversation&&!this.g.isOpen&&this.showWidget(),this.conversationsHandlerService.subscribeToConversations(()=>{}),this.archivedConversationsService.subscribeToConversations(()=>{}),this.listConversations=this.conversationsHandlerService.conversations,this.archivedConversations=this.archivedConversationsService.archivedConversations,this.chatManager.setConversationsHandler(this.conversationsHandlerService),this.chatManager.setArchivedConversationsHandler(this.archivedConversationsService),this.logger.debug("[APP-COMP] this.listConversations.length",this.listConversations.length),this.logger.debug("[APP-COMP] this.listConversations appcomponent",this.listConversations,this.archivedConversations)}initConversationHandler(e){const n=this.g.tenant,r=this.translateService.translateLanguage(["INFO_SUPPORT_USER_ADDED_SUBJECT","INFO_SUPPORT_USER_ADDED_YOU_VERB","INFO_SUPPORT_USER_ADDED_COMPLEMENT","INFO_SUPPORT_USER_ADDED_VERB","INFO_SUPPORT_CHAT_REOPENED","INFO_SUPPORT_CHAT_CLOSED","INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU","INFO_SUPPORT_LEAD_UPDATED","INFO_SUPPORT_MEMBER_LEFT_GROUP","LABEL_TODAY","LABEL_TOMORROW","LABEL_LOADING","LABEL_TO","ARRAY_DAYS"]),v={uid:this.g.senderId},P=this.g.recipientFullname;let Y=this.chatManager.getConversationHandlerByConversationId(e);if(this.logger.debug("[APP-COMP] DETTAGLIO CONV - handler **************",Y,e),!Y){const X=this.conversationHandlerBuilderService.build();X.initialize(e,P,v,n,r),this.logger.debug("[APP-COMP] DETTAGLIO CONV - NEW handler **************",X),this.chatManager.addConversationHandler(X),Y=X}return Y}initLauncherButton(){this.isInitialized=!0,this.marginBottom=+this.g.marginY+70}manageWidgetSingleConversation(){if(this.g.recipientId)return this.appStorageService.setItem("recipientId",this.g.recipientId),void new Promise((e,n)=>{this.startUI(),e("ok")}).then(e=>{this.showWidget()});this.conversationsHandlerService.getLastConversation((e,n)=>{if(this.logger.debug("[APP-COMP] getConverationRESTApi: conversation from rest API --\x3e ",e),n&&this.logger.error("[APP-COMP] getConverationRESTApi: ERORR while retriving data",n),e){const o=e.uid;this.g.setParameter("recipientId",o),this.appStorageService.setItem("recipientId",o)}else this.logger.debug("[APP-COMP] getConverationRESTApi: NO active conversations");new Promise((o,r)=>{this.startUI(),o("ok")}).then(o=>{this.showWidget()})})}signOut(){if(this.logger.debug("[APP-COMP] SIGNOUT"),!0===this.g.isLogged)return this.logger.debug("[APP-COMP] prima ero loggato allora mi sloggo!"),this.g.setIsOpen(!1),this.appStorageService.clear(),this.presenceService.removePresence(),this.tiledeskAuthService.logOut(),this.messagingAuthService.logout()}showWidget(){this.logger.debug("[APP-COMP] show widget--\x3e autoStart:",this.g.autoStart,"startHidden",this.g.startHidden,"isShown",this.g.isShown);const e=this.g.startHidden,n=this.g.windowContext.document.getElementById("tiledesk-container");n&&!1===e?(n.style.display="block",this.g.setParameter("isShown",!0,!0)):(this.g.startHidden=!1,this.g.setParameter("isShown",!1,!0))}hideWidget(){const e=this.g.windowContext.document.getElementById("tiledesk-container");e&&(e.style.display="none"),this.g.setParameter("isShown",!1,!0)}disposeWidget(){const e=this.g.windowContext.document.getElementById("tiledesk-container");e&&e.remove()}sendMessage(e){const o=e.senderId,r=e.senderFullname,v=e.message,P=e.type,Y=e.metadata,X=e.recipientId,ae=e.recipientFullname,fe=e.attributes,de=e.channelType;this.logger.debug("[APP-COMP] sendMessage from window.tiledesk *********** ",e.tenant,o,r,v,P,Y,X,ae,fe,e.projectid,de),this.initConversationHandler(X).sendMessage(v,P,Y,X,ae,o,r,de,fe)}setPreChatForm(e){null!=e&&(this.g.setParameter("preChatForm",e),!0===e?this.appStorageService.setItem("preChatForm",e):this.appStorageService.removeItem("preChatForm"))}setPreChatFormJson(e){e&&this.g.setParameter("preChatFormJson",e),this.logger.debug("[APP-COMP] setPreChatFormJson from external",e)}getPreChatFormJson(){let e={};return this.g.preChatFormJson&&(e=this.g.preChatFormJson),this.logger.debug("[APP-COMP] getPreChatFormJson from external",e),e}setPrivacyPolicy(){this.g.privacyApproved=!0,this.g.setAttributeParameter("privacyApproved",this.g.privacyApproved),this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes)),this.g.setParameter("preChatForm",!1),this.appStorageService.removeItem("preChatForm")}reInit(){this.tiledeskAuthService.getCurrentUser()?(this.tiledeskAuthService.logOut(),this.messagingAuthService.logout(),this.logger.debug("[APP-COMP] sono nel caso reinit -2"),this.g.setParameter("isLogged",!1),this.hideWidget(),this.appStorageService.removeItem("tiledeskToken"),this.g.isLogout=!0,!1!==this.g.autoStart&&(this.authenticate(),this.initAll()),this.appStorageService.clear()):this.logger.debug("[APP-COMP] reInit ma NON SONO LOGGATO!");const e=this.g.windowContext.document.getElementsByTagName("chat-root")[0];this.g.windowContext.document.getElementById("tiledesk-container").remove(),e.remove(),this.g.windowContext.initWidget()}restart(){this.hideWidget(),!1!==this.g.autoStart&&(this.authenticate(),this.initAll());const e=this.g.windowContext.document.getElementsByTagName("chat-root")[0];this.g.windowContext.document.getElementById("tiledesk-container").remove(),e.remove(),this.g.windowContext.initWidget()}logout(){return this.signOut()}showCallout(){!1===this.g.isOpen&&(this.eyeeyeCatcherCardComponent.openEyeCatcher(),this.g.setParameter("displayEyeCatcherCard","block"),this.triggerOnOpenEyeCatcherEvent())}f21_open(){const e=this.g.senderId;this.logger.debug("[APP-COMP] f21_open senderId: ",e),e&&(this.g.setParameter("displayEyeCatcherCard","none"),this.g.setIsOpen(!0),this.isInitialized=!0,this.appStorageService.setItem("isOpen","true"),this.triggerOnOpenEvent())}f21_close(){this.g.setIsOpen(!1),this.g.isOpenNewMessage=!1,this.appStorageService.setItem("isOpen","false"),this.triggerOnCloseEvent()}_f21_open(){this.g.setParameter("displayEyeCatcherCard","none"),this.g.setIsOpen(!0),this.appStorageService.setItem("isOpen","true"),this.triggerOnOpenEvent()}setParameter(e){this.g.setParameter(e.key,e.value)}setAttributeParameter(e){this.g.setAttributeParameter(e.key,e.value)}removeFirebasewebsocketFromLocalStorage(){this.logger.debug("[APP-COMP]  ---------------- A1 ---------------- "),Ke()&&this.appStorageService.removeItem("firebase:previous_websocket_failure")}addComponentToWindow(e){const o=this.g.windowContext;o&&o.tiledesk&&(o.tiledesk.angularcomponent={component:this,ngZone:e},o.tiledesk.signInWithCustomToken=function(r){return e.run(()=>o.tiledesk.angularcomponent.component.signInWithCustomToken(r))},o.tiledesk.signInAnonymous=function(){return e.run(()=>o.tiledesk.angularcomponent.component.signInAnonymous())},o.tiledesk.show=function(){e.run(()=>{o.tiledesk.angularcomponent.component.showWidget()})},o.tiledesk.hide=function(){e.run(()=>{o.tiledesk.angularcomponent.component.hideWidget()})},o.tiledesk.dispose=function(){e.run(()=>{o.tiledesk.angularcomponent.component.disposeWidget()})},o.tiledesk.close=function(){e.run(()=>{o.tiledesk.angularcomponent.component.onCloseWidget()})},o.tiledesk.open=function(){e.run(()=>{o.tiledesk.angularcomponent.component.onOpenCloseWidget()})},o.tiledesk.setPreChatForm=function(r){e.run(()=>{o.tiledesk.angularcomponent.component.setPreChatForm(r)})},o.tiledesk.setPrivacyPolicy=function(){e.run(()=>{o.tiledesk.angularcomponent.component.setPrivacyPolicy()})},o.tiledesk.sendMessage=function(r){const v=o.tiledesk.angularcomponent.component.g;let P=r.tenant?r.tenant:null,Y=r.senderId?r.senderId:null,X=r.senderFullname?r.senderFullname:null,ae=r.message?r.message:null,fe=r.type?r.type:null,Ce=r.metadata?r.metadata:null,de=r.recipientId?r.recipientId:null,we=r.recipientFullname?r.recipientFullname:null,ye=r.attributes?r.attributes:null,Se=r.projectid?r.projectid:null,Fe=r.channelType?r.channelType:null;P||(P=v.tenant),Y||(Y=v.senderId),X||(X=v.senderFullname),ae||(ae="hello"),fe||(fe="text"),Ce||(Ce=""),de||(de=v.recipientId),we||(we=v.recipientFullname),Se||(Se=v.projectId),(!Fe||void 0===Fe)&&(Fe="group");const Qe=v.attributes,We={};if(Qe)for(const[Ye,Je]of Object.entries(Qe))We[Ye]=Je;if(ye)for(const[Ye,Je]of Object.entries(ye))We[Ye]=Je;e.run(()=>{o.tiledesk.angularcomponent.component.sendMessage({tenant:P,senderId:Y,senderFullname:X,message:ae,type:fe,metadata:Ce,recipientId:de,recipientFullname:we,attributes:We,projectid:Se,channel_type:Fe})})},o.tiledesk.sendSupportMessage=function(r){const v=o.tiledesk.angularcomponent.component.g;let P=r.message?r.message:null,Y=r.recipientId?r.recipientId:null,X=r.recipientFullname?r.recipientFullname:null,ae=r.type?r.type:null,fe=r.metadata?r.metadata:null,Ce=r.attributes?r.attributes:null;P||(P="hello"),Y||(Y=v.recipientId),ae||(ae="text"),fe||(fe={});const de=v.attributes,we={};if(de)for(const[ye,Se]of Object.entries(de))we[ye]=Se;if(Ce)for(const[ye,Se]of Object.entries(Ce))we[ye]=Se;e.run(()=>{o.tiledesk.angularcomponent.component.sendMessage({tenant:v.tenant,senderId:v.senderId,senderFullname:v.userFullname,message:P,type:ae,metadata:fe,recipientId:Y,recipientFullname:X,attributes:we,projectid:v.projectid,channelType:v.channelType})})},o.tiledesk.startConversation=function(){e.run(()=>{o.tiledesk.angularcomponent.component.onNewConversation()})},o.tiledesk.reInit=function(){e.run(()=>{o.tiledesk.angularcomponent.component.reInit()})},o.tiledesk.restart=function(){e.run(()=>{o.tiledesk.angularcomponent.component.restart()})},o.tiledesk.logout=function(){return e.run(()=>o.tiledesk.angularcomponent.component.logout())},o.tiledesk.showCallout=function(){e.run(()=>{o.tiledesk.angularcomponent.component.showCallout()})},o.tiledesk.setPreChatFormJson=function(r){e.run(()=>{o.tiledesk.angularcomponent.component.setPreChatFormJson(r)})},o.tiledesk.getPreChatFormJson=function(){let r={};return e.run(()=>{r=o.tiledesk.angularcomponent.component.getPreChatFormJson()}),r},o.tiledesk.setParameter=function(r){e.run(()=>{o.tiledesk.angularcomponent.component.setParameter(r)})},o.tiledesk.setAttributeParameter=function(r){e.run(()=>{o.tiledesk.angularcomponent.component.setAttributeParameter(r)})})}visibilitychange(){document.hidden?this.isTabVisible=!1:(clearInterval(this.setIntervalTime),this.setIntervalTime=null,this.isTabVisible=!0,this.g.windowContext.window.document.title=this.tabTitle)}manageTabNotification(){if(!this.isTabVisible){let e=this.conversationsHandlerService.countIsNew();this.logger.debug("[APP-COMP] badgeNewConverstionNumber::",e),e>0||(e=1),this.g.windowContext.window.document.title="("+e+") "+this.tabTitle,clearInterval(this.setIntervalTime);const n=this;this.setIntervalTime=window.setInterval(function(){n.g.windowContext.window.document.title="("===n.g.windowContext.window.document.title.charAt(0)?n.tabTitle:"("+e+") "+n.tabTitle},1e3)}this.soundMessage()}soundMessage(){const e=this;this.g.soundEnabled&&(this.logger.debug("[APP-COMP] ****** soundMessage *****",this.audio),this.audio.pause(),this.audio.currentTime=0,clearTimeout(this.setTimeoutSound),this.setTimeoutSound=setTimeout(()=>{e.audio.play().then(()=>{this.logger.debug("[APP-COMP] ****** soundMessage played *****")}).catch(o=>{this.logger.debug("[APP-COMP] ***soundMessage error*",o)})},1e3))}onCloseWidget(){this.isOpenConversation=!1;let e=this.conversationsHandlerService.countIsNew();this.g.setParameter("conversationsBadge",e),this.logger.debug("[APP-COMP] widgetclosed:::",this.g.conversationsBadge,this.conversationsHandlerService.countIsNew()),this.f21_close()}onOpenCloseWidget(e){this.g.setParameter("displayEyeCatcherCard","none");const n=this.appStorageService.getItem("recipientId");this.g.setParameter("recipientId",n),this.logger.debug("[APP-COMP] openCloseWidget",n,this.g.isOpen,this.g.startFromHome),!1===this.g.isOpen?(n?(this.isOpenHome=!1,this.isOpenConversation=!0,this.startUI()):this.g.singleConversation?(this.isOpenHome=!1,this.g.setParameter("isOpenPrechatForm",!1),this.manageWidgetSingleConversation()):this.g.startFromHome?(this.isOpenHome=!0,this.isOpenConversation=!1):(this.isOpenHome=!1,this.isOpenConversation=!0,this.onNewConversation()),this.triggerOnOpenEvent()):this.triggerOnCloseEvent(),this.g.setIsOpen(!this.g.isOpen),this.appStorageService.setItem("isOpen",this.g.isOpen)}onDepartmentSelected(e){e&&(this.logger.debug("[APP-COMP] onSelectDepartment: ",e),this.g.setParameter("departmentSelected",e),!1===this.g.isOpenPrechatForm&&(this.isOpenSelectionDepartment=!1,this.isOpenConversation=!0,setTimeout(()=>{this.isOpenHome=!1},0),this.startNewConversation()))}onCloseModalDepartment(){this.g.singleConversation?this.onCloseWidget():(this.logger.debug("[APP-COMP] returnCloseModalDepartment"),this.isOpenHome=!0,this.isOpenSelectionDepartment=!1,this.isOpenConversation=!1)}onPrechatFormComplete(){this.logger.debug("[APP-COMP] onPrechatFormComplete"),this.isOpenHome=!0,this.g.setParameter("isOpenPrechatForm",!1),!1===this.g.isOpenPrechatForm&&!1===this.isOpenSelectionDepartment&&(this.isOpenConversation=!0,this.startNewConversation())}onCloseModalPrechatForm(){this.logger.debug("[APP-COMP] onCloseModalPrechatForm"),this.g.singleConversation?this.onCloseWidget():(this.isOpenHome=!0,this.isOpenSelectionDepartment=!1,this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!1),this.g.newConversationStart=!1)}onSoundChange(e){this.g.setParameter("soundEnabled",e)}onMenuOptionSignOut(){this.logger.debug("[APP-COMP] onMenuOptionSignOut"),this.signOut(),this.isOpenConversation=!1}onSelectedConversation(e){e&&(!1===this.g.isOpen&&this._f21_open(),e.channel_type===te?(this.g.setParameter("recipientId",e.sender),this.appStorageService.setItem("recipientId",e.sender)):(this.g.setParameter("recipientId",e.recipient),this.appStorageService.setItem("recipientId",e.recipient)),this.isOpenConversation=!0,this.isConversationArchived=!!e.archived&&e.archived,this.logger.debug("[APP-COMP] onSelectConversation in APP COMPONENT: ",e))}onNewConversation(){this.logger.debug("[APP-COMP] returnNewConversation in APP COMPONENT"),this.g.newConversationStart=!0;const e=this.g.preChatForm,n=this.g.attributes,o=this.g.departments;this.logger.debug("[APP-COMP] attributesssss",this.g.attributes,this.g.preChatForm),!e||n&&n.userFullname&&n.userEmail?(this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,o&&o.length>1&&null==this.g.departmentID?this.isOpenSelectionDepartment=!0:this.isOpenConversation=!0):(this.isOpenConversation=!1,this.g.setParameter("isOpenPrechatForm",!0),this.isOpenSelectionDepartment=!1,o&&o.length>1&&null==this.g.departmentID&&(this.isOpenSelectionDepartment=!0)),this.logger.debug("[APP-COMP] isOpenPrechatForm",this.g.isOpenPrechatForm," isOpenSelectionDepartment:",this.isOpenSelectionDepartment),!1===this.g.isOpenPrechatForm&&!1===this.isOpenSelectionDepartment&&this.startNewConversation()}onOpenAllConversation(){this.isOpenHome=!0,this.isOpenConversation=!1,this.isOpenAllConversation=!0}onOpenChatEyeEyeCatcherCard(){this.f21_open()}onCloseEyeCatcherCard(e){!0===e?this.triggerOnOpenEyeCatcherEvent():this.triggerOnClosedEyeCatcherEvent()}onBackConversation(){this.logger.debug("[APP-COMP] onCloseConversation"),this.appStorageService.removeItem("recipientId"),this.g.setParameter("recipientId",null,!1),this.isOpenHome=!0,this.isOpenAllConversation=!1,this.isOpenConversation=!1}onConversationClosed(e){this.g.singleConversation||this.onBackConversation()}onNewConversationButtonClicked(e){this.logger.debug("[APP-COMP] onNewConversationButtonClicked"),this.isOpenConversation=!1,this.g.singleConversation&&(this.isOpenHome=!1),this.onNewConversation()}onCloseAllConversation(){this.logger.debug("[APP-COMP] Close all conversation");const e=this.isOpenHome,n=this.isOpenConversation;this.isOpenHome=!1,this.isOpenConversation=!1,setTimeout(()=>{this.isOpenHome=e,this.isOpenConversation=n,this.isOpenAllConversation=!1},200)}onAfterMessageSent(e){this.triggerHandler.triggerAfterSendMessageEvent(e),this.isSentMessage=!0}onImageLoaded(e){this.logger.debug("[APP-COMP] onLoadImage convvvv:::",e),e.image=this.imageRepoService.getImagePhotoUrl(e.sender)}onConversationLoaded(e){this.logger.debug("[APP-COMP] onConversationLoaded convvvv:::",e);const o=this.translateService.translateLanguage(["YOU","SENT_AN_IMAGE","SENT_AN_ATTACHMENT"]);if(e.sender===this.g.senderId){if(e.type===W){this.logger.log("[CONVS-LIST-PAGE] HAS SENT AN IMAGE");const r=e.last_message_text=o.get("SENT_AN_IMAGE");e.last_message_text=r}else if(e.type===E){this.logger.log("[CONVS-LIST-PAGE] HAS SENT FILE");const r=e.last_message_text=o.get("SENT_AN_ATTACHMENT");e.last_message_text=r}}else if(e.type===W){this.logger.log("[CONVS-LIST-PAGE] HAS SENT AN IMAGE");const r=e.last_message_text=o.get("SENT_AN_IMAGE");e.last_message_text=r}else if(e.type===E){this.logger.log("[CONVS-LIST-PAGE] HAS SENT FILE");const r=e.last_message_text=o.get("SENT_AN_ATTACHMENT");e.last_message_text=r}}onSignOut(){this.signOut()}onCloseModalRateChat(){!this.g.singleConversation&&this.g.nativeRating&&(this.isOpenHome=!0,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,this.g.setParameter("isOpenStartRating",!1),this.onBackConversation())}onRateChatComplete(){!this.g.singleConversation&&this.g.nativeRating&&(this.isOpenHome=!0,this.g.setParameter("isOpenPrechatForm",!1),this.isOpenConversation=!1,this.isOpenSelectionDepartment=!1,this.g.setParameter("isOpenStartRating",!1),this.onBackConversation())}triggerOnBeforeInit(){const e={global:this.g,default_settings:this.g.default_settings,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerOnBeforeInit(e)}triggerOnViewInit(){const e={global:this.g,default_settings:this.g.default_settings,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerOnViewInit(e)}triggerOnOpenEvent(){this.triggerHandler.triggerOnOpenEvent({default_settings:this.g.default_settings})}triggerOnCloseEvent(){this.triggerHandler.triggerOnCloseEvent({default_settings:this.g.default_settings})}triggerOnOpenEyeCatcherEvent(){this.triggerHandler.triggerOnOpenEyeCatcherEvent({default_settings:this.g.default_settings})}triggerOnClosedEyeCatcherEvent(){this.triggerHandler.triggerOnClosedEyeCatcherEvent()}triggerOnAuthStateChanged(e){const n={event:e,isLogged:this.g.isLogged,user_id:this.g.senderId,global:this.g,default_settings:this.g.default_settings,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerOnAuthStateChanged(n)}triggerNewConversationEvent(e){const n={global:this.g,default_settings:this.g.default_settings,newConvId:e,appConfigs:this.appConfigService.getConfig()};this.triggerHandler.triggerNewConversationEvent(n)}triggerLoadParamsEvent(){this.triggerHandler.triggerLoadParamsEvent({default_settings:this.g.default_settings})}triggerOnConversationUpdated(e){this.triggerHandler.triggerOnConversationUpdated(e)}triggerOnCloseMessagePreview(){this.triggerHandler.triggerOnCloseMessagePreview()}setStyleMap(){this.styleMapConversation.set("foregroundColor",this.g.themeForegroundColor),this.styleMapConversation.set("themeColor",this.g.themeColor),this.styleMapConversation.set("colorGradient",this.g.colorGradient180),this.styleMapConversation.set("bubbleSentBackground",this.g.bubbleSentBackground),this.styleMapConversation.set("bubbleSentTextColor",this.g.bubbleSentTextColor),this.styleMapConversation.set("bubbleReceivedBackground",this.g.bubbleReceivedBackground),this.styleMapConversation.set("bubbleReceivedTextColor",this.g.bubbleReceivedTextColor),this.styleMapConversation.set("fontSize",this.g.fontSize),this.styleMapConversation.set("fontFamily",this.g.fontFamily),this.styleMapConversation.set("buttonFontSize",this.g.buttonFontSize),this.styleMapConversation.set("buttonBackgroundColor",this.g.buttonBackgroundColor),this.styleMapConversation.set("buttonTextColor",this.g.buttonTextColor),this.styleMapConversation.set("buttonHoverBackgroundColor",this.g.buttonHoverBackgroundColor),this.styleMapConversation.set("buttonHoverTextColor",this.g.buttonHoverTextColor),this.styleMapConversation.set("iconColor","#5f6368"),this.el.nativeElement.style.setProperty("--button-in-msg-background-color",this.g.bubbleSentBackground),this.el.nativeElement.style.setProperty("--button-in-msg-font-size",this.g.buttonFontSize)}ngOnDestroy(){this.logger.debug("[APP-COMP] this.subscriptions",this.subscriptions);const e=this.g.windowContext;e&&e.tiledesk&&(e.tiledesk.angularcomponent=null,this.g.windowContext=e),this.unsubscribe()}unsubscribe(){this.subscriptions.forEach(function(e){e.unsubscribe()}),this.subscriptions=[],this.logger.debug("[APP-COMP] this.subscriptions",this.subscriptions)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq),t.Y36(t.R0b),t.Y36(Ie),t.Y36(fn),t.Y36(mn),t.Y36(_n),t.Y36(vn),t.Y36(Re),t.Y36(Ne),t.Y36(Bt),t.Y36(Xe),t.Y36(bt),t.Y36(Ut),t.Y36(Cn),t.Y36(Ct),t.Y36(at),t.Y36(lt),t.Y36(dt),t.Y36(et),t.Y36(it),t.Y36(wt),t.Y36(rt))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-root"]],viewQuery:function(e,n){if(1&e&&t.Gf(dn,5),2&e){let o;t.iGM(o=t.CRH())&&(n.eyeeyeCatcherCardComponent=o.first)}},hostBindings:function(e,n){1&e&&t.NdJ("visibilitychange",function(){return n.visibilitychange()},!1,t.evT)},decls:11,vars:23,consts:[["id","tiledesk-container","tabindex","9999"],["id","chat21-conversations",3,"ngClass","ngStyle"],["class","modal-page active",4,"ngIf"],["class","modal-page selection-department active",4,"ngIf"],["class","modal-page prechat-form active",4,"ngIf"],["class","modal-page star-rating-widget active",4,"ngIf"],[3,"onOpenChat","onCloseEyeCatcherCard",4,"ngIf"],[4,"ngIf"],[3,"onButtonClicked",4,"ngIf"],[1,"modal-page","active"],[3,"listConversations","archivedConversations","hideSettings","stylesMap","onNewConversation","onConversationSelected","onOpenAllConvesations","onCloseWidget","onSignOut","onImageLoaded","onConversationLoaded"],[3,"listConversations","archivedConversations","stylesMap","onCloseWidget","onConversationSelected"],[3,"senderId","conversationId","isOpen","isConversationArchived","stylesMap","onBackHome","onCloseWidget","onSoundChange","onConversationClosed","onSignOut","onNewConversationButtonClicked","onBeforeMessageSent","onAfterSendMessage","onNewMessageCreated","onNewConversationInit","onBeforeMessageRender","onAfterMessageRender"],[1,"modal-page","selection-department","active"],[3,"onBeforeDepartmentsFormRender","onClose","onDepartmentSelected"],[1,"modal-page","prechat-form","active"],[3,"stylesMap","onClosePage","onCloseForm"],[1,"modal-page","star-rating-widget","active"],[3,"recipientId","stylesMap","onClosePage","onCloseRate"],[3,"onOpenChat","onCloseEyeCatcherCard"],[3,"conversation","baseLocation","stylesMap","onCloseMessagePreview","onSelectedConversation"],[3,"onButtonClicked"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,xo,2,4,"div",2),t.YNc(3,Mo,2,3,"div",2),t.YNc(4,Eo,2,5,"div",2),t.YNc(5,So,2,0,"div",3),t.YNc(6,To,2,1,"div",4),t.YNc(7,Po,2,2,"div",5),t.qZA(),t.YNc(8,ko,1,0,"chat-eyeeye-catcher-card",6),t.YNc(9,Ao,2,3,"div",7),t.YNc(10,Io,1,0,"chat-launcher-button",8),t.qZA()),2&e&&(t.ekj("active",n.g.isShown),t.xp6(1),t.Q6J("ngClass",t.l5B(13,Ro,!0===n.g.isOpen,!0===n.g.fullscreenMode,"left"===n.g.align,"left"!==n.g.align))("ngStyle",t.l5B(18,Lo,1==n.g.isOpen?"block":"none",n.g.marginY+"px","left"===n.g.align?n.g.marginX+"px":"","right"===n.g.align?n.g.marginX+"px":"")),t.xp6(1),t.Q6J("ngIf",n.isOpenHome&&n.g.senderId),t.xp6(1),t.Q6J("ngIf",n.isOpenAllConversation&&n.g.senderId),t.xp6(1),t.Q6J("ngIf",n.isOpenConversation&&n.g.senderId),t.xp6(1),t.Q6J("ngIf",n.isOpenSelectionDepartment),t.xp6(1),t.Q6J("ngIf",n.g.isOpenPrechatForm&&n.g.senderId),t.xp6(1),t.Q6J("ngIf",n.g.isOpenStartRating),t.xp6(1),t.Q6J("ngIf",n.g.senderId),t.xp6(1),t.Q6J("ngIf",!n.g.isOpen),t.xp6(1),t.Q6J("ngIf",n.isInitialized))},styles:['@import"https://fonts.googleapis.com/css?family=Google+Sans:200,400,800";@import"https://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons";@import"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,400;0,700;1,300;1,400";/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */@keyframes modal-active-in{0%{left:100%;opacity:0}to{background-color:$trasp-black;opacity:1;left:0}}@keyframes modal-active-out{0%{opacity:1;left:0;display:block}99%{display:block}to{left:100%;opacity:0;display:none}}@keyframes slide-out-right{0%{transform:translate(0);opacity:1}99%{transform:translate(1000px);opacity:0}to{transform:translate(1000px);opacity:0}}@keyframes rotate-scale-up{0%{transform:scale(1) rotate(0)}50%{transform:scale(1.6) rotate(180deg)}to{transform:scale(1) rotate(360deg)}}@keyframes swirl-in-bck{0%{transform:rotate(540deg) scale(5);opacity:0}to{transform:rotate(0) scale(1);opacity:1}}@keyframes jello-horizontal{0%{transform:scaleZ(1)}30%{transform:scale3d(1.25,.75,1)}40%{transform:scale3d(.75,1.25,1)}50%{transform:scale3d(1.15,.85,1)}65%{transform:scale3d(.95,1.05,1)}75%{transform:scale3d(1.05,.95,1)}to{transform:scaleZ(1)}}@keyframes scale-in-center{0%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:1}}@keyframes rotate-center{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes swing-in-bottom-fwd{0%{transform:rotateX(100deg);transform-origin:bottom;opacity:0}to{transform:rotateX(0);transform-origin:bottom;opacity:1}}@keyframes fade{0%{transform:rotateX(0);transform-origin:bottom;opacity:0}50%{transform:rotateX(0);transform-origin:bottom;opacity:.5}to{transform:rotateX(0);transform-origin:bottom;opacity:1}}@keyframes heartbeat{0%{transform:scale(1);transform-origin:center center;animation-timing-function:ease-out}10%{transform:scale(.91);animation-timing-function:ease-in}17%{transform:scale(.98);animation-timing-function:ease-out}33%{transform:scale(.87);animation-timing-function:ease-in}45%{transform:scale(1);animation-timing-function:ease-out}}@keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes fade-in-top{0%{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes fade-in-bottom{0%{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes fade-in-dw-up{0%{display:none;transform:translateY(50px);opacity:0}1%{display:block;transform:translateY(50px);opacity:0}to{display:block;transform:translateY(0);opacity:1}}@keyframes slide-in-right{0%{transform:translate(1000px);opacity:0}99%{transform:translate(0);opacity:1}to{transform:translate(0);opacity:1}}@keyframes slide-in-left{0%{transform:translate(-1000px);opacity:0}99%{transform:translate(0);opacity:1}to{transform:translate(0);opacity:1}}@keyframes slideIn{0%{transform:translate(-900px)}to{transform:translate(0)}}/*!\n * Hover.css (http://ianlunn.github.io/Hover/)\n * Version: 2.3.2\n * Author: Ian Lunn @IanLunn\n * Author URL: http://ianlunn.co.uk/\n * Github: https://github.com/IanLunn/Hover\n\n * Hover.css Copyright Ian Lunn 2017. Generated with Sass.\n */.hvr-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-grow:hover,.hvr-grow:focus,.hvr-grow:active{transform:scale(1.1)}.hvr-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-shrink:hover,.hvr-shrink:focus,.hvr-shrink:active{transform:scale(.9)}@keyframes hvr-pulse{25%{transform:scale(1.1)}75%{transform:scale(.9)}}.hvr-pulse{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pulse:hover,.hvr-pulse:focus,.hvr-pulse:active{animation-name:hvr-pulse;animation-duration:1s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-pulse-grow{to{transform:scale(1.1)}}.hvr-pulse-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pulse-grow:hover,.hvr-pulse-grow:focus,.hvr-pulse-grow:active{animation-name:hvr-pulse-grow;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-pulse-shrink{to{transform:scale(.9)}}.hvr-pulse-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pulse-shrink:hover,.hvr-pulse-shrink:focus,.hvr-pulse-shrink:active{animation-name:hvr-pulse-shrink;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-push{50%{transform:scale(.8)}to{transform:scale(1)}}.hvr-push{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-push:hover,.hvr-push:focus,.hvr-push:active{animation-name:hvr-push;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}@keyframes hvr-pop{50%{transform:scale(1.2)}}.hvr-pop{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-pop:hover,.hvr-pop:focus,.hvr-pop:active{animation-name:hvr-pop;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}.hvr-bounce-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.5s}.hvr-bounce-in:hover,.hvr-bounce-in:focus,.hvr-bounce-in:active{transform:scale(1.2);transition-timing-function:cubic-bezier(.47,2.02,.31,-.36)}.hvr-bounce-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.5s}.hvr-bounce-out:hover,.hvr-bounce-out:focus,.hvr-bounce-out:active{transform:scale(.8);transition-timing-function:cubic-bezier(.47,2.02,.31,-.36)}.hvr-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-rotate:hover,.hvr-rotate:focus,.hvr-rotate:active{transform:rotate(4deg)}.hvr-grow-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-grow-rotate:hover,.hvr-grow-rotate:focus,.hvr-grow-rotate:active{transform:scale(1.1) rotate(4deg)}.hvr-float{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-float:hover,.hvr-float:focus,.hvr-float:active{transform:translateY(-8px)}.hvr-sink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-sink:hover,.hvr-sink:focus,.hvr-sink:active{transform:translateY(8px)}@keyframes hvr-bob{0%{transform:translateY(-8px)}50%{transform:translateY(-4px)}to{transform:translateY(-8px)}}@keyframes hvr-bob-float{to{transform:translateY(-8px)}}.hvr-bob{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-bob:hover,.hvr-bob:focus,.hvr-bob:active{animation-name:hvr-bob-float,hvr-bob;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}@keyframes hvr-hang{0%{transform:translateY(8px)}50%{transform:translateY(4px)}to{transform:translateY(8px)}}@keyframes hvr-hang-sink{to{transform:translateY(8px)}}.hvr-hang{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-hang:hover,.hvr-hang:focus,.hvr-hang:active{animation-name:hvr-hang-sink,hvr-hang;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}.hvr-skew{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-skew:hover,.hvr-skew:focus,.hvr-skew:active{transform:skew(-10deg)}.hvr-skew-forward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transform-origin:0 100%}.hvr-skew-forward:hover,.hvr-skew-forward:focus,.hvr-skew-forward:active{transform:skew(-10deg)}.hvr-skew-backward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform;transform-origin:0 100%}.hvr-skew-backward:hover,.hvr-skew-backward:focus,.hvr-skew-backward:active{transform:skew(10deg)}@keyframes hvr-wobble-vertical{16.65%{transform:translateY(8px)}33.3%{transform:translateY(-6px)}49.95%{transform:translateY(4px)}66.6%{transform:translateY(-2px)}83.25%{transform:translateY(1px)}to{transform:translateY(0)}}.hvr-wobble-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-vertical:hover,.hvr-wobble-vertical:focus,.hvr-wobble-vertical:active{animation-name:hvr-wobble-vertical;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-horizontal{16.65%{transform:translate(8px)}33.3%{transform:translate(-6px)}49.95%{transform:translate(4px)}66.6%{transform:translate(-2px)}83.25%{transform:translate(1px)}to{transform:translate(0)}}.hvr-wobble-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-horizontal:hover,.hvr-wobble-horizontal:focus,.hvr-wobble-horizontal:active{animation-name:hvr-wobble-horizontal;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-to-bottom-right{16.65%{transform:translate(8px,8px)}33.3%{transform:translate(-6px,-6px)}49.95%{transform:translate(4px,4px)}66.6%{transform:translate(-2px,-2px)}83.25%{transform:translate(1px,1px)}to{transform:translate(0)}}.hvr-wobble-to-bottom-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-to-bottom-right:hover,.hvr-wobble-to-bottom-right:focus,.hvr-wobble-to-bottom-right:active{animation-name:hvr-wobble-to-bottom-right;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-to-top-right{16.65%{transform:translate(8px,-8px)}33.3%{transform:translate(-6px,6px)}49.95%{transform:translate(4px,-4px)}66.6%{transform:translate(-2px,2px)}83.25%{transform:translate(1px,-1px)}to{transform:translate(0)}}.hvr-wobble-to-top-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-to-top-right:hover,.hvr-wobble-to-top-right:focus,.hvr-wobble-to-top-right:active{animation-name:hvr-wobble-to-top-right;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-top{16.65%{transform:skew(-12deg)}33.3%{transform:skew(10deg)}49.95%{transform:skew(-6deg)}66.6%{transform:skew(4deg)}83.25%{transform:skew(-2deg)}to{transform:skew(0)}}.hvr-wobble-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transform-origin:0 100%}.hvr-wobble-top:hover,.hvr-wobble-top:focus,.hvr-wobble-top:active{animation-name:hvr-wobble-top;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-bottom{16.65%{transform:skew(-12deg)}33.3%{transform:skew(10deg)}49.95%{transform:skew(-6deg)}66.6%{transform:skew(4deg)}83.25%{transform:skew(-2deg)}to{transform:skew(0)}}.hvr-wobble-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transform-origin:100% 0}.hvr-wobble-bottom:hover,.hvr-wobble-bottom:focus,.hvr-wobble-bottom:active{animation-name:hvr-wobble-bottom;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-wobble-skew{16.65%{transform:skew(-12deg)}33.3%{transform:skew(10deg)}49.95%{transform:skew(-6deg)}66.6%{transform:skew(4deg)}83.25%{transform:skew(-2deg)}to{transform:skew(0)}}.hvr-wobble-skew{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-wobble-skew:hover,.hvr-wobble-skew:focus,.hvr-wobble-skew:active{animation-name:hvr-wobble-skew;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-buzz{50%{transform:translate(3px) rotate(2deg)}to{transform:translate(-3px) rotate(-2deg)}}.hvr-buzz{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-buzz:hover,.hvr-buzz:focus,.hvr-buzz:active{animation-name:hvr-buzz;animation-duration:.15s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-buzz-out{10%{transform:translate(3px) rotate(2deg)}20%{transform:translate(-3px) rotate(-2deg)}30%{transform:translate(3px) rotate(2deg)}40%{transform:translate(-3px) rotate(-2deg)}50%{transform:translate(2px) rotate(1deg)}60%{transform:translate(-2px) rotate(-1deg)}70%{transform:translate(2px) rotate(1deg)}80%{transform:translate(-2px) rotate(-1deg)}90%{transform:translate(1px) rotate(0)}to{transform:translate(-1px) rotate(0)}}.hvr-buzz-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-buzz-out:hover,.hvr-buzz-out:focus,.hvr-buzz-out:active{animation-name:hvr-buzz-out;animation-duration:.75s;animation-timing-function:linear;animation-iteration-count:1}.hvr-forward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-forward:hover,.hvr-forward:focus,.hvr-forward:active{transform:translate(8px)}.hvr-backward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:transform}.hvr-backward:hover,.hvr-backward:focus,.hvr-backward:active{transform:translate(-8px)}.hvr-fade{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;overflow:hidden;transition-duration:.3s;transition-property:color,background-color}.hvr-fade:hover,.hvr-fade:focus,.hvr-fade:active{background-color:#2098d1;color:#fff}@keyframes hvr-back-pulse{50%{background-color:#2098d1bf}}.hvr-back-pulse{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;overflow:hidden;transition-duration:.5s;transition-property:color,background-color}.hvr-back-pulse:hover,.hvr-back-pulse:focus,.hvr-back-pulse:active{animation-name:hvr-back-pulse;animation-duration:1s;animation-delay:.5s;animation-timing-function:linear;animation-iteration-count:infinite;background-color:#2098d1;color:#fff}.hvr-sweep-to-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-right:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:0 50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-right:hover,.hvr-sweep-to-right:focus,.hvr-sweep-to-right:active{color:#fff}.hvr-sweep-to-right:hover:before,.hvr-sweep-to-right:focus:before,.hvr-sweep-to-right:active:before{transform:scaleX(1)}.hvr-sweep-to-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-left:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:100% 50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-left:hover,.hvr-sweep-to-left:focus,.hvr-sweep-to-left:active{color:#fff}.hvr-sweep-to-left:hover:before,.hvr-sweep-to-left:focus:before,.hvr-sweep-to-left:active:before{transform:scaleX(1)}.hvr-sweep-to-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-bottom:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 0;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-bottom:hover,.hvr-sweep-to-bottom:focus,.hvr-sweep-to-bottom:active{color:#fff}.hvr-sweep-to-bottom:hover:before,.hvr-sweep-to-bottom:focus:before,.hvr-sweep-to-bottom:active:before{transform:scaleY(1)}.hvr-sweep-to-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.3s}.hvr-sweep-to-top:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 100%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-sweep-to-top:hover,.hvr-sweep-to-top:focus,.hvr-sweep-to-top:active{color:#fff}.hvr-sweep-to-top:hover:before,.hvr-sweep-to-top:focus:before,.hvr-sweep-to-top:active:before{transform:scaleY(1)}.hvr-bounce-to-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-right:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:0 50%;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-right:hover,.hvr-bounce-to-right:focus,.hvr-bounce-to-right:active{color:#fff}.hvr-bounce-to-right:hover:before,.hvr-bounce-to-right:focus:before,.hvr-bounce-to-right:active:before{transform:scaleX(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-bounce-to-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-left:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:100% 50%;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-left:hover,.hvr-bounce-to-left:focus,.hvr-bounce-to-left:active{color:#fff}.hvr-bounce-to-left:hover:before,.hvr-bounce-to-left:focus:before,.hvr-bounce-to-left:active:before{transform:scaleX(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-bounce-to-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-bottom:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 0;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-bottom:hover,.hvr-bounce-to-bottom:focus,.hvr-bounce-to-bottom:active{color:#fff}.hvr-bounce-to-bottom:hover:before,.hvr-bounce-to-bottom:focus:before,.hvr-bounce-to-bottom:active:before{transform:scaleY(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-bounce-to-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-property:color;transition-duration:.5s}.hvr-bounce-to-top:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50% 100%;transition-property:transform;transition-duration:.5s;transition-timing-function:ease-out}.hvr-bounce-to-top:hover,.hvr-bounce-to-top:focus,.hvr-bounce-to-top:active{color:#fff}.hvr-bounce-to-top:hover:before,.hvr-bounce-to-top:focus:before,.hvr-bounce-to-top:active:before{transform:scaleY(1);transition-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-radial-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-radial-out:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;border-radius:100%;transform:scale(0);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-radial-out:hover,.hvr-radial-out:focus,.hvr-radial-out:active{color:#fff}.hvr-radial-out:hover:before,.hvr-radial-out:focus:before,.hvr-radial-out:active:before{transform:scale(2)}.hvr-radial-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-radial-in:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;border-radius:100%;transform:scale(2);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-radial-in:hover,.hvr-radial-in:focus,.hvr-radial-in:active{color:#fff}.hvr-radial-in:hover:before,.hvr-radial-in:focus:before,.hvr-radial-in:active:before{transform:scale(0)}.hvr-rectangle-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-rectangle-in:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;transform:scale(1);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-rectangle-in:hover,.hvr-rectangle-in:focus,.hvr-rectangle-in:active{color:#fff}.hvr-rectangle-in:hover:before,.hvr-rectangle-in:focus:before,.hvr-rectangle-in:active:before{transform:scale(0)}.hvr-rectangle-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-rectangle-out:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scale(0);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-rectangle-out:hover,.hvr-rectangle-out:focus,.hvr-rectangle-out:active{color:#fff}.hvr-rectangle-out:hover:before,.hvr-rectangle-out:focus:before,.hvr-rectangle-out:active:before{transform:scale(1)}.hvr-shutter-in-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-shutter-in-horizontal:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;transform:scaleX(1);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-in-horizontal:hover,.hvr-shutter-in-horizontal:focus,.hvr-shutter-in-horizontal:active{color:#fff}.hvr-shutter-in-horizontal:hover:before,.hvr-shutter-in-horizontal:focus:before,.hvr-shutter-in-horizontal:active:before{transform:scaleX(0)}.hvr-shutter-out-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-shutter-out-horizontal:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleX(0);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-out-horizontal:hover,.hvr-shutter-out-horizontal:focus,.hvr-shutter-out-horizontal:active{color:#fff}.hvr-shutter-out-horizontal:hover:before,.hvr-shutter-out-horizontal:focus:before,.hvr-shutter-out-horizontal:active:before{transform:scaleX(1)}.hvr-shutter-in-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#2098D1;transition-property:color;transition-duration:.3s}.hvr-shutter-in-vertical:before{content:"";position:absolute;z-index:-1;inset:0;background:#e1e1e1;transform:scaleY(1);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-in-vertical:hover,.hvr-shutter-in-vertical:focus,.hvr-shutter-in-vertical:active{color:#fff}.hvr-shutter-in-vertical:hover:before,.hvr-shutter-in-vertical:focus:before,.hvr-shutter-in-vertical:active:before{transform:scaleY(0)}.hvr-shutter-out-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;background:#e1e1e1;transition-property:color;transition-duration:.3s}.hvr-shutter-out-vertical:before{content:"";position:absolute;z-index:-1;inset:0;background:#2098D1;transform:scaleY(0);transform-origin:50%;transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-shutter-out-vertical:hover,.hvr-shutter-out-vertical:focus,.hvr-shutter-out-vertical:active{color:#fff}.hvr-shutter-out-vertical:hover:before,.hvr-shutter-out-vertical:focus:before,.hvr-shutter-out-vertical:active:before{transform:scaleY(1)}.hvr-border-fade{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow;box-shadow:inset 0 0 0 4px #e1e1e1,0 0 1px #0000}.hvr-border-fade:hover,.hvr-border-fade:focus,.hvr-border-fade:active{box-shadow:inset 0 0 0 4px #2098d1,0 0 1px #0000}.hvr-hollow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:background;box-shadow:inset 0 0 0 4px #e1e1e1,0 0 1px #0000}.hvr-hollow:hover,.hvr-hollow:focus,.hvr-hollow:active{background:none}.hvr-trim{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-trim:before{content:"";position:absolute;border:white solid 4px;inset:4px;opacity:0;transition-duration:.3s;transition-property:opacity}.hvr-trim:hover:before,.hvr-trim:focus:before,.hvr-trim:active:before{opacity:1}@keyframes hvr-ripple-out{to{inset:-12px;opacity:0}}.hvr-ripple-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-ripple-out:before{content:"";position:absolute;border:#e1e1e1 solid 6px;inset:0;animation-duration:1s}.hvr-ripple-out:hover:before,.hvr-ripple-out:focus:before,.hvr-ripple-out:active:before{animation-name:hvr-ripple-out}@keyframes hvr-ripple-in{to{inset:0;opacity:1}}.hvr-ripple-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-ripple-in:before{content:"";position:absolute;border:#e1e1e1 solid 4px;inset:-12px;opacity:0;animation-duration:1s}.hvr-ripple-in:hover:before,.hvr-ripple-in:focus:before,.hvr-ripple-in:active:before{animation-name:hvr-ripple-in}.hvr-outline-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-outline-out:before{content:"";position:absolute;border:#e1e1e1 solid 4px;inset:0;transition-duration:.3s;transition-property:top,right,bottom,left}.hvr-outline-out:hover:before,.hvr-outline-out:focus:before,.hvr-outline-out:active:before{inset:-8px}.hvr-outline-in{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-outline-in:before{pointer-events:none;content:"";position:absolute;border:#e1e1e1 solid 4px;inset:-16px;opacity:0;transition-duration:.3s;transition-property:top,right,bottom,left}.hvr-outline-in:hover:before,.hvr-outline-in:focus:before,.hvr-outline-in:active:before{inset:-8px;opacity:1}.hvr-round-corners{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:border-radius}.hvr-round-corners:hover,.hvr-round-corners:focus,.hvr-round-corners:active{border-radius:1em}.hvr-underline-from-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-from-left:before{content:"";position:absolute;z-index:-1;left:0;right:100%;bottom:0;background:#2098D1;height:4px;transition-property:right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-from-left:hover:before,.hvr-underline-from-left:focus:before,.hvr-underline-from-left:active:before{right:0}.hvr-underline-from-center{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-from-center:before{content:"";position:absolute;z-index:-1;left:51%;right:51%;bottom:0;background:#2098D1;height:4px;transition-property:left,right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-from-center:hover:before,.hvr-underline-from-center:focus:before,.hvr-underline-from-center:active:before{left:0;right:0}.hvr-underline-from-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-from-right:before{content:"";position:absolute;z-index:-1;left:100%;right:0;bottom:0;background:#2098D1;height:4px;transition-property:left;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-from-right:hover:before,.hvr-underline-from-right:focus:before,.hvr-underline-from-right:active:before{left:0}.hvr-overline-from-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-from-left:before{content:"";position:absolute;z-index:-1;left:0;right:100%;top:0;background:#2098D1;height:4px;transition-property:right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-from-left:hover:before,.hvr-overline-from-left:focus:before,.hvr-overline-from-left:active:before{right:0}.hvr-overline-from-center{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-from-center:before{content:"";position:absolute;z-index:-1;left:51%;right:51%;top:0;background:#2098D1;height:4px;transition-property:left,right;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-from-center:hover:before,.hvr-overline-from-center:focus:before,.hvr-overline-from-center:active:before{left:0;right:0}.hvr-overline-from-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-from-right:before{content:"";position:absolute;z-index:-1;left:100%;right:0;top:0;background:#2098D1;height:4px;transition-property:left;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-from-right:hover:before,.hvr-overline-from-right:focus:before,.hvr-overline-from-right:active:before{left:0}.hvr-reveal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-reveal:before{content:"";position:absolute;z-index:-1;inset:0;border-color:#2098d1;border-style:solid;border-width:0;transition-property:border-width;transition-duration:.1s;transition-timing-function:ease-out}.hvr-reveal:hover:before,.hvr-reveal:focus:before,.hvr-reveal:active:before{transform:translateY(0);border-width:4px}.hvr-underline-reveal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-underline-reveal:before{content:"";position:absolute;z-index:-1;left:0;right:0;bottom:0;background:#2098D1;height:4px;transform:translateY(4px);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-underline-reveal:hover:before,.hvr-underline-reveal:focus:before,.hvr-underline-reveal:active:before{transform:translateY(0)}.hvr-overline-reveal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;overflow:hidden}.hvr-overline-reveal:before{content:"";position:absolute;z-index:-1;left:0;right:0;top:0;background:#2098D1;height:4px;transform:translateY(-4px);transition-property:transform;transition-duration:.3s;transition-timing-function:ease-out}.hvr-overline-reveal:hover:before,.hvr-overline-reveal:focus:before,.hvr-overline-reveal:active:before{transform:translateY(0)}.hvr-glow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow}.hvr-glow:hover,.hvr-glow:focus,.hvr-glow:active{box-shadow:0 0 8px #0009}.hvr-shadow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow}.hvr-shadow:hover,.hvr-shadow:focus,.hvr-shadow:active{box-shadow:0 10px 10px -10px #00000080}.hvr-grow-shadow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow,transform}.hvr-grow-shadow:hover,.hvr-grow-shadow:focus,.hvr-grow-shadow:active{box-shadow:0 10px 10px -10px #00000080;transform:scale(1.1)}.hvr-box-shadow-outset{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow}.hvr-box-shadow-outset:hover,.hvr-box-shadow-outset:focus,.hvr-box-shadow-outset:active{box-shadow:2px 2px 2px #0009}.hvr-box-shadow-inset{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s;transition-property:box-shadow;box-shadow:inset 0 0 #0009,0 0 1px #0000}.hvr-box-shadow-inset:hover,.hvr-box-shadow-inset:focus,.hvr-box-shadow-inset:active{box-shadow:inset 2px 2px 2px #0009,0 0 1px #0000}.hvr-float-shadow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-float-shadow:before{pointer-events:none;position:absolute;z-index:-1;content:"";top:100%;left:5%;height:10px;width:90%;opacity:0;background:radial-gradient(ellipse at center,rgba(0,0,0,.35) 0%,rgba(0,0,0,0) 80%);transition-duration:.3s;transition-property:transform,opacity}.hvr-float-shadow:hover,.hvr-float-shadow:focus,.hvr-float-shadow:active{transform:translateY(-5px)}.hvr-float-shadow:hover:before,.hvr-float-shadow:focus:before,.hvr-float-shadow:active:before{opacity:1;transform:translateY(5px)}.hvr-shadow-radial{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-shadow-radial:before,.hvr-shadow-radial:after{pointer-events:none;position:absolute;content:"";left:0;width:100%;box-sizing:border-box;background-repeat:no-repeat;height:5px;opacity:0;transition-duration:.3s;transition-property:opacity}.hvr-shadow-radial:before{bottom:100%;background:radial-gradient(ellipse at 50% 150%,rgba(0,0,0,.6) 0%,rgba(0,0,0,0) 80%)}.hvr-shadow-radial:after{top:100%;background:radial-gradient(ellipse at 50% -50%,rgba(0,0,0,.6) 0%,rgba(0,0,0,0) 80%)}.hvr-shadow-radial:hover:before,.hvr-shadow-radial:focus:before,.hvr-shadow-radial:active:before,.hvr-shadow-radial:hover:after,.hvr-shadow-radial:focus:after,.hvr-shadow-radial:active:after{opacity:1}.hvr-bubble-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-top:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;left:calc(50% - 10px);top:0;border-width:0 10px 10px 10px;border-color:transparent transparent #e1e1e1 transparent}.hvr-bubble-top:hover:before,.hvr-bubble-top:focus:before,.hvr-bubble-top:active:before{transform:translateY(-10px)}.hvr-bubble-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-right:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;top:calc(50% - 10px);right:0;border-width:10px 0 10px 10px;border-color:transparent transparent transparent #e1e1e1}.hvr-bubble-right:hover:before,.hvr-bubble-right:focus:before,.hvr-bubble-right:active:before{transform:translate(10px)}.hvr-bubble-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-bottom:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;left:calc(50% - 10px);bottom:0;border-width:10px 10px 0 10px;border-color:#e1e1e1 transparent transparent transparent}.hvr-bubble-bottom:hover:before,.hvr-bubble-bottom:focus:before,.hvr-bubble-bottom:active:before{transform:translateY(10px)}.hvr-bubble-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-bubble-left:before{pointer-events:none;position:absolute;z-index:-1;content:"";border-style:solid;transition-duration:.3s;transition-property:transform;top:calc(50% - 10px);left:0;border-width:10px 10px 10px 0;border-color:transparent #e1e1e1 transparent transparent}.hvr-bubble-left:hover:before,.hvr-bubble-left:focus:before,.hvr-bubble-left:active:before{transform:translate(-10px)}.hvr-bubble-float-top{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-top:before{position:absolute;z-index:-1;content:"";left:calc(50% - 10px);top:0;border-style:solid;border-width:0 10px 10px 10px;border-color:transparent transparent #e1e1e1 transparent;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-top:hover,.hvr-bubble-float-top:focus,.hvr-bubble-float-top:active{transform:translateY(10px)}.hvr-bubble-float-top:hover:before,.hvr-bubble-float-top:focus:before,.hvr-bubble-float-top:active:before{transform:translateY(-10px)}.hvr-bubble-float-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-right:before{position:absolute;z-index:-1;top:calc(50% - 10px);right:0;content:"";border-style:solid;border-width:10px 0 10px 10px;border-color:transparent transparent transparent #e1e1e1;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-right:hover,.hvr-bubble-float-right:focus,.hvr-bubble-float-right:active{transform:translate(-10px)}.hvr-bubble-float-right:hover:before,.hvr-bubble-float-right:focus:before,.hvr-bubble-float-right:active:before{transform:translate(10px)}.hvr-bubble-float-bottom{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-bottom:before{position:absolute;z-index:-1;content:"";left:calc(50% - 10px);bottom:0;border-style:solid;border-width:10px 10px 0 10px;border-color:#e1e1e1 transparent transparent transparent;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-bottom:hover,.hvr-bubble-float-bottom:focus,.hvr-bubble-float-bottom:active{transform:translateY(-10px)}.hvr-bubble-float-bottom:hover:before,.hvr-bubble-float-bottom:focus:before,.hvr-bubble-float-bottom:active:before{transform:translateY(10px)}.hvr-bubble-float-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-left:before{position:absolute;z-index:-1;content:"";top:calc(50% - 10px);left:0;border-style:solid;border-width:10px 10px 10px 0;border-color:transparent #e1e1e1 transparent transparent;transition-duration:.3s;transition-property:transform}.hvr-bubble-float-left:hover,.hvr-bubble-float-left:focus,.hvr-bubble-float-left:active{transform:translate(10px)}.hvr-bubble-float-left:hover:before,.hvr-bubble-float-left:focus:before,.hvr-bubble-float-left:active:before{transform:translate(-10px)}.hvr-icon-back{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.1s}.hvr-icon-back .hvr-icon{transform:translateZ(0);transition-duration:.1s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-back:hover .hvr-icon,.hvr-icon-back:focus .hvr-icon,.hvr-icon-back:active .hvr-icon{transform:translate(-4px)}.hvr-icon-forward{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.1s}.hvr-icon-forward .hvr-icon{transform:translateZ(0);transition-duration:.1s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-forward:hover .hvr-icon,.hvr-icon-forward:focus .hvr-icon,.hvr-icon-forward:active .hvr-icon{transform:translate(4px)}@keyframes hvr-icon-down{0%,50%,to{transform:translateY(0)}25%,75%{transform:translateY(6px)}}.hvr-icon-down{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-down .hvr-icon{transform:translateZ(0)}.hvr-icon-down:hover .hvr-icon,.hvr-icon-down:focus .hvr-icon,.hvr-icon-down:active .hvr-icon{animation-name:hvr-icon-down;animation-duration:.75s;animation-timing-function:ease-out}@keyframes hvr-icon-up{0%,50%,to{transform:translateY(0)}25%,75%{transform:translateY(-6px)}}.hvr-icon-up{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-up .hvr-icon{transform:translateZ(0)}.hvr-icon-up:hover .hvr-icon,.hvr-icon-up:focus .hvr-icon,.hvr-icon-up:active .hvr-icon{animation-name:hvr-icon-up;animation-duration:.75s;animation-timing-function:ease-out}.hvr-icon-spin{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-spin .hvr-icon{transition-duration:1s;transition-property:transform;transition-timing-function:ease-in-out}.hvr-icon-spin:hover .hvr-icon,.hvr-icon-spin:focus .hvr-icon,.hvr-icon-spin:active .hvr-icon{transform:rotate(360deg)}@keyframes hvr-icon-drop{0%{opacity:0}50%{opacity:0;transform:translateY(-100%)}51%,to{opacity:1}}.hvr-icon-drop{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-drop .hvr-icon{transform:translateZ(0)}.hvr-icon-drop:hover .hvr-icon,.hvr-icon-drop:focus .hvr-icon,.hvr-icon-drop:active .hvr-icon{opacity:0;transition-duration:.3s;animation-name:hvr-icon-drop;animation-duration:.5s;animation-delay:.3s;animation-fill-mode:forwards;animation-timing-function:ease-in-out;animation-timing-function:cubic-bezier(.52,1.64,.37,.66)}.hvr-icon-fade{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-fade .hvr-icon{transform:translateZ(0);transition-duration:.5s;transition-property:color}.hvr-icon-fade:hover .hvr-icon,.hvr-icon-fade:focus .hvr-icon,.hvr-icon-fade:active .hvr-icon{color:#0f9e5e}@keyframes hvr-icon-float-away{0%{opacity:1}to{opacity:0;transform:translateY(-1em)}}.hvr-icon-float-away{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-float-away .hvr-icon{transform:translateZ(0);animation-duration:.5s;animation-fill-mode:forwards}.hvr-icon-float-away:hover .hvr-icon,.hvr-icon-float-away:focus .hvr-icon,.hvr-icon-float-away:active .hvr-icon{animation-name:hvr-icon-float-away;animation-timing-function:ease-out}@keyframes hvr-icon-sink-away{0%{opacity:1}to{opacity:0;transform:translateY(1em)}}.hvr-icon-sink-away{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-sink-away .hvr-icon{transform:translateZ(0);animation-duration:.5s;animation-fill-mode:forwards}.hvr-icon-sink-away:hover .hvr-icon,.hvr-icon-sink-away:focus .hvr-icon,.hvr-icon-sink-away:active .hvr-icon{animation-name:hvr-icon-sink-away;animation-timing-function:ease-out}.hvr-icon-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-grow .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-grow:hover .hvr-icon,.hvr-icon-grow:focus .hvr-icon,.hvr-icon-grow:active .hvr-icon{transform:scale(1.3) translateZ(0)}.hvr-icon-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-shrink .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-shrink:hover .hvr-icon,.hvr-icon-shrink:focus .hvr-icon,.hvr-icon-shrink:active .hvr-icon{transform:scale(.8)}@keyframes hvr-icon-pulse{25%{transform:scale(1.3)}75%{transform:scale(.8)}}.hvr-icon-pulse{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-pulse .hvr-icon{transform:translateZ(0);transition-timing-function:ease-out}.hvr-icon-pulse:hover .hvr-icon,.hvr-icon-pulse:focus .hvr-icon,.hvr-icon-pulse:active .hvr-icon{animation-name:hvr-icon-pulse;animation-duration:1s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-icon-pulse-grow{to{transform:scale(1.3)}}.hvr-icon-pulse-grow{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-pulse-grow .hvr-icon{transform:translateZ(0);transition-timing-function:ease-out}.hvr-icon-pulse-grow:hover .hvr-icon,.hvr-icon-pulse-grow:focus .hvr-icon,.hvr-icon-pulse-grow:active .hvr-icon{animation-name:hvr-icon-pulse-grow;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-icon-pulse-shrink{to{transform:scale(.8)}}.hvr-icon-pulse-shrink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-icon-pulse-shrink .hvr-icon{transform:translateZ(0);transition-timing-function:ease-out}.hvr-icon-pulse-shrink:hover .hvr-icon,.hvr-icon-pulse-shrink:focus .hvr-icon,.hvr-icon-pulse-shrink:active .hvr-icon{animation-name:hvr-icon-pulse-shrink;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate}@keyframes hvr-icon-push{50%{transform:scale(.5)}}.hvr-icon-push{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-push .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-push:hover .hvr-icon,.hvr-icon-push:focus .hvr-icon,.hvr-icon-push:active .hvr-icon{animation-name:hvr-icon-push;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}@keyframes hvr-icon-pop{50%{transform:scale(1.5)}}.hvr-icon-pop{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-pop .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-pop:hover .hvr-icon,.hvr-icon-pop:focus .hvr-icon,.hvr-icon-pop:active .hvr-icon{animation-name:hvr-icon-pop;animation-duration:.3s;animation-timing-function:linear;animation-iteration-count:1}.hvr-icon-bounce{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-bounce .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-bounce:hover .hvr-icon,.hvr-icon-bounce:focus .hvr-icon,.hvr-icon-bounce:active .hvr-icon{transform:scale(1.5);transition-timing-function:cubic-bezier(.47,2.02,.31,-.36)}.hvr-icon-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-rotate .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-rotate:hover .hvr-icon,.hvr-icon-rotate:focus .hvr-icon,.hvr-icon-rotate:active .hvr-icon{transform:rotate(20deg)}.hvr-icon-grow-rotate{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-grow-rotate .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-grow-rotate:hover .hvr-icon,.hvr-icon-grow-rotate:focus .hvr-icon,.hvr-icon-grow-rotate:active .hvr-icon{transform:scale(1.5) rotate(12deg)}.hvr-icon-float{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-float .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-float:hover .hvr-icon,.hvr-icon-float:focus .hvr-icon,.hvr-icon-float:active .hvr-icon{transform:translateY(-4px)}.hvr-icon-sink{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-sink .hvr-icon{transform:translateZ(0);transition-duration:.3s;transition-property:transform;transition-timing-function:ease-out}.hvr-icon-sink:hover .hvr-icon,.hvr-icon-sink:focus .hvr-icon,.hvr-icon-sink:active .hvr-icon{transform:translateY(4px)}@keyframes hvr-icon-bob{0%{transform:translateY(-6px)}50%{transform:translateY(-2px)}to{transform:translateY(-6px)}}@keyframes hvr-icon-bob-float{to{transform:translateY(-6px)}}.hvr-icon-bob{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-bob .hvr-icon{transform:translateZ(0)}.hvr-icon-bob:hover .hvr-icon,.hvr-icon-bob:focus .hvr-icon,.hvr-icon-bob:active .hvr-icon{animation-name:hvr-icon-bob-float,hvr-icon-bob;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}@keyframes hvr-icon-hang{0%{transform:translateY(6px)}50%{transform:translateY(2px)}to{transform:translateY(6px)}}@keyframes hvr-icon-hang-sink{to{transform:translateY(6px)}}.hvr-icon-hang{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-hang .hvr-icon{transform:translateZ(0)}.hvr-icon-hang:hover .hvr-icon,.hvr-icon-hang:focus .hvr-icon,.hvr-icon-hang:active .hvr-icon{animation-name:hvr-icon-hang-sink,hvr-icon-hang;animation-duration:.3s,1.5s;animation-delay:0s,.3s;animation-timing-function:ease-out,ease-in-out;animation-iteration-count:1,infinite;animation-fill-mode:forwards;animation-direction:normal,alternate}@keyframes hvr-icon-wobble-horizontal{16.65%{transform:translate(6px)}33.3%{transform:translate(-5px)}49.95%{transform:translate(4px)}66.6%{transform:translate(-2px)}83.25%{transform:translate(1px)}to{transform:translate(0)}}.hvr-icon-wobble-horizontal{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-wobble-horizontal .hvr-icon{transform:translateZ(0)}.hvr-icon-wobble-horizontal:hover .hvr-icon,.hvr-icon-wobble-horizontal:focus .hvr-icon,.hvr-icon-wobble-horizontal:active .hvr-icon{animation-name:hvr-icon-wobble-horizontal;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-icon-wobble-vertical{16.65%{transform:translateY(6px)}33.3%{transform:translateY(-5px)}49.95%{transform:translateY(4px)}66.6%{transform:translateY(-2px)}83.25%{transform:translateY(1px)}to{transform:translateY(0)}}.hvr-icon-wobble-vertical{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-wobble-vertical .hvr-icon{transform:translateZ(0)}.hvr-icon-wobble-vertical:hover .hvr-icon,.hvr-icon-wobble-vertical:focus .hvr-icon,.hvr-icon-wobble-vertical:active .hvr-icon{animation-name:hvr-icon-wobble-vertical;animation-duration:1s;animation-timing-function:ease-in-out;animation-iteration-count:1}@keyframes hvr-icon-buzz{50%{transform:translate(3px) rotate(2deg)}to{transform:translate(-3px) rotate(-2deg)}}.hvr-icon-buzz{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-buzz .hvr-icon{transform:translateZ(0)}.hvr-icon-buzz:hover .hvr-icon,.hvr-icon-buzz:focus .hvr-icon,.hvr-icon-buzz:active .hvr-icon{animation-name:hvr-icon-buzz;animation-duration:.15s;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes hvr-icon-buzz-out{10%{transform:translate(3px) rotate(2deg)}20%{transform:translate(-3px) rotate(-2deg)}30%{transform:translate(3px) rotate(2deg)}40%{transform:translate(-3px) rotate(-2deg)}50%{transform:translate(2px) rotate(1deg)}60%{transform:translate(-2px) rotate(-1deg)}70%{transform:translate(2px) rotate(1deg)}80%{transform:translate(-2px) rotate(-1deg)}90%{transform:translate(1px) rotate(0)}to{transform:translate(-1px) rotate(0)}}.hvr-icon-buzz-out{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;transition-duration:.3s}.hvr-icon-buzz-out .hvr-icon{transform:translateZ(0)}.hvr-icon-buzz-out:hover .hvr-icon,.hvr-icon-buzz-out:focus .hvr-icon,.hvr-icon-buzz-out:active .hvr-icon{animation-name:hvr-icon-buzz-out;animation-duration:.75s;animation-timing-function:linear;animation-iteration-count:1}.hvr-curl-top-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-top-left:before{pointer-events:none;position:absolute;content:"";height:0;width:0;top:0;left:0;background:white;background:linear-gradient(135deg,white 45%,#aaa 50%,#ccc 56%,white 80%);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="#ffffff",endColorstr="#000000");z-index:1000;box-shadow:1px 1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-top-left:hover:before,.hvr-curl-top-left:focus:before,.hvr-curl-top-left:active:before{width:25px;height:25px}.hvr-curl-top-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-top-right:before{pointer-events:none;position:absolute;content:"";height:0;width:0;top:0;right:0;background:white;background:linear-gradient(225deg,white 45%,#aaa 50%,#ccc 56%,white 80%);box-shadow:-1px 1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-top-right:hover:before,.hvr-curl-top-right:focus:before,.hvr-curl-top-right:active:before{width:25px;height:25px}.hvr-curl-bottom-right{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-bottom-right:before{pointer-events:none;position:absolute;content:"";height:0;width:0;bottom:0;right:0;background:white;background:linear-gradient(315deg,white 45%,#aaa 50%,#ccc 56%,white 80%);box-shadow:-1px -1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-bottom-right:hover:before,.hvr-curl-bottom-right:focus:before,.hvr-curl-bottom-right:active:before{width:25px;height:25px}.hvr-curl-bottom-left{display:inline-block;vertical-align:middle;transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000;position:relative}.hvr-curl-bottom-left:before{pointer-events:none;position:absolute;content:"";height:0;width:0;bottom:0;left:0;background:white;background:linear-gradient(45deg,white 45%,#aaa 50%,#ccc 56%,white 80%);box-shadow:1px -1px 1px #0006;transition-duration:.3s;transition-property:width,height}.hvr-curl-bottom-left:hover:before,.hvr-curl-bottom-left:focus:before,.hvr-curl-bottom-left:active:before{width:25px;height:25px}#tiledesk-container html{line-height:1.15;-webkit-text-size-adjust:100%}#tiledesk-container body{margin:0}#tiledesk-container main{display:block}#tiledesk-container h1{font-size:2em;margin:.67em 0}#tiledesk-container hr{box-sizing:content-box;height:0;overflow:visible}#tiledesk-container pre{font-family:monospace,monospace;font-size:1em}#tiledesk-container a{background-color:transparent}#tiledesk-container abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}#tiledesk-container b,#tiledesk-container strong{font-weight:bolder}#tiledesk-container code,#tiledesk-container kbd,#tiledesk-container samp{font-family:monospace,monospace;font-size:1em}#tiledesk-container small{font-size:80%}#tiledesk-container sub,#tiledesk-container sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}#tiledesk-container sub{bottom:-.25em}#tiledesk-container sup{top:-.5em}#tiledesk-container img{border-style:none;max-width:100%}#tiledesk-container button,#tiledesk-container input,#tiledesk-container optgroup,#tiledesk-container select,#tiledesk-container textarea{font-family:inherit;font-size:100%;line-height:1.15}#tiledesk-container button,#tiledesk-container input{overflow:visible}#tiledesk-container button,#tiledesk-container select{text-transform:none}#tiledesk-container button,#tiledesk-container [type=button],#tiledesk-container [type=reset],#tiledesk-container [type=submit]{-webkit-appearance:button}#tiledesk-container button::-moz-focus-inner,#tiledesk-container [type=button]::-moz-focus-inner,#tiledesk-container [type=reset]::-moz-focus-inner,#tiledesk-container [type=submit]::-moz-focus-inner{border-style:none;padding:0}#tiledesk-container button:-moz-focusring,#tiledesk-container [type=button]:-moz-focusring,#tiledesk-container [type=reset]:-moz-focusring,#tiledesk-container [type=submit]:-moz-focusring{outline:1px dotted ButtonText}#tiledesk-container fieldset{padding:.35em .75em .625em}#tiledesk-container legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}#tiledesk-container progress{vertical-align:baseline}#tiledesk-container textarea{overflow:auto}#tiledesk-container [type=checkbox],#tiledesk-container [type=radio]{box-sizing:border-box;padding:0}#tiledesk-container [type=number]::-webkit-inner-spin-button,#tiledesk-container [type=number]::-webkit-outer-spin-button{height:auto}#tiledesk-container [type=search]{-webkit-appearance:textfield;outline-offset:-2px}#tiledesk-container [type=search]::-webkit-search-decoration{-webkit-appearance:none}#tiledesk-container ::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}#tiledesk-container details{display:block}#tiledesk-container summary{display:list-item}#tiledesk-container template{display:none}#tiledesk-container [hidden]{display:none}.emoji-mart,.emoji-mart *{box-sizing:border-box;line-height:1.15}.emoji-mart{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,sans-serif;font-size:16px;display:inline-block;color:#222427;border:1px solid #d9d9d9;border-radius:5px;background:#fff}.emoji-mart .emoji-mart-emoji{padding:6px}.emoji-mart-bar{border:0 solid #d9d9d9}.emoji-mart-bar:first-child{border-bottom-width:1px;border-top-left-radius:5px;border-top-right-radius:5px}.emoji-mart-bar:last-child{border-top-width:1px;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.emoji-mart-anchors{display:flex;flex-direction:row;justify-content:space-between;padding:0 6px;line-height:0}.emoji-mart-anchor{position:relative;display:block;flex:1 1 auto;color:#858585;text-align:center;padding:12px 4px;overflow:hidden;transition:color .1s ease-out;margin:0;box-shadow:none;background:none;border:none}.emoji-mart-anchor:focus{outline:0}.emoji-mart-anchor:hover,.emoji-mart-anchor:focus,.emoji-mart-anchor-selected{color:#464646}.emoji-mart-anchor-selected .emoji-mart-anchor-bar{bottom:0}.emoji-mart-anchor-bar{position:absolute;bottom:-3px;left:0;width:100%;height:3px;background-color:#464646}.emoji-mart-anchors i{display:inline-block;width:100%;max-width:22px}.emoji-mart-anchors svg,.emoji-mart-anchors img{fill:currentColor;height:18px;width:18px}.emoji-mart-scroll{overflow-y:scroll;height:270px;padding:0 6px 6px;will-change:transform}.emoji-mart-search{margin-top:6px;padding:0 6px;position:relative}.emoji-mart-search input{font-size:16px;display:block;width:100%;padding:5px 25px 6px 10px;border-radius:5px;border:1px solid #d9d9d9;outline:0}.emoji-mart-search input,.emoji-mart-search input::-webkit-search-decoration,.emoji-mart-search input::-webkit-search-cancel-button,.emoji-mart-search input::-webkit-search-results-button,.emoji-mart-search input::-webkit-search-results-decoration{-webkit-appearance:none}.emoji-mart-search-icon{position:absolute;top:3px;right:11px;z-index:2;padding:2px 5px 1px;border:none;background:none}.emoji-mart-category .emoji-mart-emoji span{z-index:1;position:relative;text-align:center;cursor:default}.emoji-mart-category .emoji-mart-emoji:hover:before{z-index:0;content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#f4f4f4;border-radius:100%}.emoji-mart-category-label{z-index:2;position:relative;position:sticky;top:0}.emoji-mart-category-label span{display:block;width:100%;font-weight:500;padding:5px 6px;background-color:#fff;background-color:#fffffff2}.emoji-mart-category-list{margin:0;padding:0}.emoji-mart-category-list li{list-style:none;margin:0;padding:0;display:inline-block}.emoji-mart-emoji{position:relative;display:inline-block;font-size:0;margin:0;padding:0;border:none;background:none;box-shadow:none}.emoji-mart-emoji-native{font-family:"Segoe UI Emoji",Segoe UI Symbol,Segoe UI,"Apple Color Emoji",Twemoji Mozilla,"Noto Color Emoji","Android Emoji"}.emoji-mart-no-results{font-size:14px;text-align:center;padding-top:70px;color:#858585}.emoji-mart-no-results .emoji-mart-category-label{display:none}.emoji-mart-no-results .emoji-mart-no-results-label{margin-top:.2em}.emoji-mart-no-results .emoji-mart-emoji:hover:before{content:none}.emoji-mart-preview{position:relative;height:70px}.emoji-mart-preview-emoji,.emoji-mart-preview-data,.emoji-mart-preview-skins{position:absolute;top:50%;transform:translateY(-50%)}.emoji-mart-preview-emoji{left:12px}.emoji-mart-preview-data{left:68px;right:12px;word-break:break-all}.emoji-mart-preview-skins{right:30px;text-align:right}.emoji-mart-preview-skins.custom{right:10px;text-align:right}.emoji-mart-preview-name{font-size:14px}.emoji-mart-preview-shortname{font-size:12px;color:#888}.emoji-mart-preview-shortname+.emoji-mart-preview-shortname,.emoji-mart-preview-shortname+.emoji-mart-preview-emoticon,.emoji-mart-preview-emoticon+.emoji-mart-preview-emoticon{margin-left:.5em}.emoji-mart-preview-emoticon{font-size:11px;color:#bbb}.emoji-mart-title span{display:inline-block;vertical-align:middle}.emoji-mart-title .emoji-mart-emoji{padding:0}.emoji-mart-title-label{color:#999a9c;font-size:26px;font-weight:300}.emoji-mart-skin-swatches{font-size:0;padding:2px 0;border:1px solid #d9d9d9;border-radius:12px;background-color:#fff}.emoji-mart-skin-swatches.custom{font-size:0;border:none;background-color:#fff}.emoji-mart-skin-swatches.opened .emoji-mart-skin-swatch{width:16px;padding:0 2px}.emoji-mart-skin-swatches.opened .emoji-mart-skin-swatch.selected:after{opacity:.75}.emoji-mart-skin-swatch{display:inline-block;width:0;vertical-align:middle;transition-property:width,padding;transition-duration:.125s;transition-timing-function:ease-out}.emoji-mart-skin-swatch:nth-child(1){transition-delay:0s}.emoji-mart-skin-swatch:nth-child(2){transition-delay:.03s}.emoji-mart-skin-swatch:nth-child(3){transition-delay:.06s}.emoji-mart-skin-swatch:nth-child(4){transition-delay:.09s}.emoji-mart-skin-swatch:nth-child(5){transition-delay:.12s}.emoji-mart-skin-swatch:nth-child(6){transition-delay:.15s}.emoji-mart-skin-swatch.selected{position:relative;width:16px;padding:0 2px}.emoji-mart-skin-swatch.selected:after{content:"";position:absolute;top:50%;left:50%;width:4px;height:4px;margin:-2px 0 0 -2px;background-color:#fff;border-radius:100%;pointer-events:none;opacity:0;transition:opacity .2s ease-out}.emoji-mart-skin-swatch.custom{display:inline-block;width:0;height:38px;overflow:hidden;vertical-align:middle;transition-property:width,height;transition-duration:.125s;transition-timing-function:ease-out;cursor:default}.emoji-mart-skin-swatch.custom.selected{position:relative;width:36px;height:38px;padding:0 2px 0 0}.emoji-mart-skin-swatch.custom.selected:after{content:"";width:0;height:0}.emoji-mart-skin-swatches.custom .emoji-mart-skin-swatch.custom:hover{background-color:#f4f4f4;border-radius:10%}.emoji-mart-skin-swatches.custom.opened .emoji-mart-skin-swatch.custom{width:36px;height:38px;padding:0 2px 0 0}.emoji-mart-skin-swatches.custom.opened .emoji-mart-skin-swatch.custom.selected:after{opacity:.75}.emoji-mart-skin-text.opened{display:inline-block;vertical-align:middle;text-align:left;color:#888;font-size:11px;padding:5px 2px;width:95px;height:40px;border-radius:10%;background-color:#fff}.emoji-mart-skin{display:inline-block;width:100%;padding-top:100%;max-width:12px;border-radius:100%}.emoji-mart-skin-tone-1{background-color:#ffc93a}.emoji-mart-skin-tone-2{background-color:#fadcbc}.emoji-mart-skin-tone-3{background-color:#e0bb95}.emoji-mart-skin-tone-4{background-color:#bf8f68}.emoji-mart-skin-tone-5{background-color:#9b643d}.emoji-mart-skin-tone-6{background-color:#594539}.emoji-mart-sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.emoji-mart-dark{color:#fff;border-color:#555453;background-color:#222}.emoji-mart-dark .emoji-mart-bar{border-color:#555453}.emoji-mart-dark .emoji-mart-search input{color:#fff;border-color:#555453;background-color:#2f2f2f}.emoji-mart-dark .emoji-mart-search-icon svg{fill:#fff}.emoji-mart-dark .emoji-mart-category .emoji-mart-emoji:hover:before{background-color:#444}.emoji-mart-dark .emoji-mart-category-label span{background-color:#222;color:#fff}.emoji-mart-dark .emoji-mart-skin-swatches{border-color:#555453;background-color:#222}.emoji-mart-dark .emoji-mart-anchor:hover,.emoji-mart-dark .emoji-mart-anchor:focus,.emoji-mart-dark .emoji-mart-anchor-selected{color:#bfbfbf}input,select:focus,textarea{font-size:16px!important}:root{--button-in-msg-background-color: rgb(42, 106, 193);--button-in-msg-font-size: 15px}.chat-tooltip{font-family:Roboto,Google Sans,Helvetica,Arial,sans-serif;font-size:12px;font-style:normal;letter-spacing:normal;font-stretch:normal;font-feature-settings:normal;font-variant:normal;font-weight:300}body{margin:0}:focus{outline:none!important}::-moz-focus-inner{border:0}.slide-in-right{animation:slide-in-right .5s cubic-bezier(.895,.03,.685,.22) 0s both}.slide-in-left{animation:slideIn .5s cubic-bezier(.895,.03,.685,.22) 0s}.scale-in-center{display:block;opacity:1;animation:scale-in-center .5s both}.jello-horizontal{animation:jello-horizontal .9s 3s both}.swirl-in-bck{animation:swirl-in-bck .65s ease-in .5s both}.rotate-scale-up{animation:rotate-scale-up .65s linear both}.rotate-center:hover{animation:rotate-center .6s ease-in-out both}.swing-in-bottom-fwd{animation:fade .5s both}.heartbeat:hover{animation:heartbeat 1.5s ease-in-out infinite both}.avatar-project{position:relative;padding:0;margin:0;height:70px;width:80px;line-height:52px}.avatar-project .avatar-placeholder{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;max-width:52px;text-align:center;font-size:20px;color:#fff;font-weight:500}.avatar-project .avatar-image{position:absolute;top:0;bottom:0;margin:0;left:0;width:100%;height:100%;max-height:100%;text-align:left;background-color:transparent;background-repeat:no-repeat;background-size:contain;background-attachment:initial;background-position:left;background-origin:content-box}textarea::placeholder{color:#aaa;font-weight:300}.msg_container .button-in-msg{color:#fff!important;background:var(--button-in-msg-background-color)!important;position:relative;max-width:300px;min-width:inherit;padding:8px 16px;cursor:auto;border:1px solid rgb(255,255,255);border-radius:20px!important;margin:3px;overflow:hidden;font-family:Muli,sans-serif;font-size:15px;text-overflow:ellipsis;white-space:normal;letter-spacing:-.24px;-webkit-font-smoothing:antialiased}.msg_container .button-in-msg p{font-size:var(--button-in-msg-font-size)!important;font-family:Muli,sans-serif!important;font-weight:400!important}chat-root{position:absolute;display:block;width:100%;height:100%}chat-root *:focus{outline:none}chat-root button{cursor:pointer}chat-root textarea,chat-root textarea:visited,chat-root textarea:focus,chat-root textarea:hover,chat-root textarea:active{line-height:20px!important;outline:none!important;box-shadow:none!important;border:0px solid rgba(0,0,0,.2)!important}chat-root .c21-button-clean{-webkit-appearance:initial;border:none;background-color:transparent;padding:0;margin:0}chat-root #tiledesk-container{position:absolute;width:100%;height:100%;font-family:Roboto,Google Sans,Helvetica,Arial,sans-serif;font-size:10px;text-align:left;background-color:transparent;display:none;overflow:hidden}chat-root #tiledesk-container.active{display:block}chat-root #tiledesk-container a:link{color:#fff}chat-root #tiledesk-container a:visited{color:#fff}chat-root #tiledesk-container a:hover{color:#fff}chat-root #tiledesk-container a:active{color:#fff}chat-root #tiledesk-container #c21-app-list-conversations a:link,chat-root #tiledesk-container #c21-app-list-all-conversations a:link,chat-root #tiledesk-container #chat21-star-rating-widget a:link,chat-root #tiledesk-container #chat21-prechat-form a:link{color:#3a3c4c}chat-root #tiledesk-container #c21-app-list-conversations a:visited,chat-root #tiledesk-container #c21-app-list-all-conversations a:visited,chat-root #tiledesk-container #chat21-star-rating-widget a:visited,chat-root #tiledesk-container #chat21-prechat-form a:visited{color:#3a3c4c}chat-root #tiledesk-container #c21-app-list-conversations a:hover,chat-root #tiledesk-container #c21-app-list-all-conversations a:hover,chat-root #tiledesk-container #chat21-star-rating-widget a:hover,chat-root #tiledesk-container #chat21-prechat-form a:hover{color:#3a3c4c}chat-root #tiledesk-container #c21-app-list-conversations a:active,chat-root #tiledesk-container #c21-app-list-all-conversations a:active,chat-root #tiledesk-container #chat21-star-rating-widget a:active,chat-root #tiledesk-container #chat21-prechat-form a:active{color:#3a3c4c}chat-root #tiledesk-container div.clear{all:unset;clear:both}chat-root #tiledesk-container .truncate{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}chat-root #tiledesk-container .truncate p{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin-block-start:0em;margin-block-end:0em}chat-root #tiledesk-container .v-align-center{display:inline-flex;align-items:center;height:100%;float:left}chat-root #tiledesk-container .c21-align-left{left:0}chat-root #tiledesk-container .c21-align-right{right:0}chat-root #tiledesk-container .time{display:none;font-size:1em;color:#aaa;text-align:left;margin:-2px 0 0;padding:0 40px;background-color:transparent}chat-root #tiledesk-container .time.sender{text-align:right;margin-right:24px;padding:0}chat-root #tiledesk-container .msg_receive a{color:#62a8ea}chat-root #tiledesk-container img{max-width:230px}chat-root #tiledesk-container button.c21-button-primary{width:auto;height:40px;line-height:40px;margin:25px 0;padding:0 24px;opacity:1;text-align:center;font-size:1em;border-radius:40px;background-color:#2a6ac1;color:#fff;border:0px;cursor:pointer}chat-root #tiledesk-container button.c21-button-primary .c21-label-button{margin-left:8px;font-weight:400;font-size:.9em}chat-root #tiledesk-container button.c21-button-primary:hover,chat-root #tiledesk-container button.c21-button-primary:focus,chat-root #tiledesk-container button.c21-button-primary:active{opacity:.8}chat-root #tiledesk-container button.c21-button-link{font-weight:400;font-size:14px;color:#2a6ac1;text-decoration:none;background-color:transparent;border:1px solid transparent;cursor:pointer}chat-root #tiledesk-container button.c21-button-link:hover,chat-root #tiledesk-container button.c21-button-link:focus,chat-root #tiledesk-container button.c21-button-link:active{text-decoration:underline;outline:none}chat-root #tiledesk-container .c21-divBudge{position:absolute;top:0;width:auto;height:12px;min-width:12px;font-size:1em;line-height:1.2em;border-radius:50%;background-color:red;color:#fff;text-align:center;margin-top:-10px;display:inline-block;box-sizing:initial;padding:5px;left:0}chat-root #tiledesk-container .c21-button{display:flex;cursor:pointer}chat-root #tiledesk-container .c21-close-button{position:absolute;width:35px;height:35px;top:0;right:0;margin:10px;z-index:10}chat-root #tiledesk-container .c21-close-button .c21-close-button-body{cursor:pointer;width:35px;height:35px;border-radius:8px;padding:0;margin:0;display:flex;align-items:center;-webkit-appearance:initial;border:none;background-color:#0000}chat-root #tiledesk-container .c21-close-button .c21-close-button-body:hover{background-color:#0006}chat-root #tiledesk-container .c21-close-button .c21-close-button-body svg{margin:0 auto;fill:#fff}chat-root #tiledesk-container #chat21-spinner{display:none;width:70px;min-height:20px;margin:20px auto 0;text-align:center}chat-root #tiledesk-container #chat21-spinner.active{display:block}chat-root #tiledesk-container #chat21-spinner>div{width:12px;height:12px;background-color:#2a6ac1;border-radius:100%;display:inline-block;animation:sk-bouncedelay 1.4s infinite ease-in-out both}chat-root #tiledesk-container #chat21-spinner .chat21-bounce1{animation-delay:-.32s}chat-root #tiledesk-container #chat21-spinner .chat21-bounce2{animation-delay:-.16s}chat-root #tiledesk-container #chat21-spinner span{display:block;margin:.5em 0 0;color:#1a1a1a;font-family:Roboto,sans-serif;animation:pulse 2s linear infinite;text-align:center}@keyframes sk-bouncedelay{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}chat-root #tiledesk-container #chat21-conversations{position:absolute;inset:1px;border-radius:16px;overflow:hidden;background-color:transparent;margin:0;padding:0}chat-root #tiledesk-container #chat21-conversations.full-screen-mode{width:100%;height:100%;inset:0;border-radius:0;max-height:none}chat-root #tiledesk-container #chat21-conversations.isMobile{border-radius:0}chat-root #tiledesk-container #chat21-conversations.shadow{transition:box-shadow .8s ease-in;box-shadow:#00000029 0 8px 36px}chat-root #tiledesk-container .chat21-fullscreen{width:100%;height:100%;right:0;left:0;bottom:0;border-radius:0;max-height:none}chat-root #tiledesk-container .modal-page{position:absolute;height:100%;width:100%;z-index:1;background-color:transparent;opacity:0;display:none}chat-root #tiledesk-container .modal-page.active{display:inline-block;opacity:1}chat-root #tiledesk-container .modal-page.modal-slide-in-right{position:absolute;left:0;opacity:1;display:inline-block;-webkit-animation-name:modal-active-in;-webkit-animation-duration:.3s;animation-name:modal-active-in;animation-duration:.3s}chat-root #tiledesk-container .modal-page.modal-slide-out-right{position:absolute;opacity:1;display:inline-block;animation:slide-out-right .3s cubic-bezier(.55,.085,.68,.53) both}chat-root .c21-header{overflow:hidden;width:100%;height:52px;position:relative;margin:0;padding:0;color:#fff;z-index:10}chat-root .c21-header button:hover{background:rgba(240,240,240,.4)!important;opacity:1!important;transition:all .45s ease-in-out 0s!important;-moz-transition:all .45s ease-in-out 0s!important;-webkit-transition:all .45s ease-in-out 0s!important;padding:0;margin:0;border-radius:10%}chat-root .c21-header .c21-header-container{position:relative;height:52px;width:100%;margin:0 auto}chat-root .c21-header .c21-header-container .c21-header-content{position:absolute;top:0;left:0;width:100%;height:100%}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button{display:block;align-items:center;justify-content:center;text-align:center;width:35px;height:35px;margin:9px;padding:0;border-radius:8px;cursor:pointer}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button.c21-right{float:right}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button.c21-left{float:left}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button.c21-close{display:none}chat-root .c21-header .c21-header-container .c21-header-content .c21-header-button svg{height:20px;width:20px}chat-root .c21-header .c21-header-container .c21-header-content .c21-title{position:absolute;left:0;display:flex;align-items:center;width:calc(100% - 200px);height:1.6em;line-height:1.6em;padding:0;margin:10px 100px;text-align:center;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}chat-root .c21-body::-webkit-scrollbar{display:none}chat-root .c21-body{position:absolute;inset:52px 0 0;padding:0;margin:0 auto;overflow:auto}chat-root .c21-body .c21-body-container{position:absolute;inset:0;height:auto;width:auto}chat-root .c21-body .c21-body-container .c21-body-header{position:absolute;top:0;left:30px;right:30px;padding:10px 0;margin:0 auto;width:auto;height:auto;z-index:2}chat-root .c21-body .c21-body-container .c21-body-content{position:absolute;inset:0;padding:0;margin:0 auto;height:auto}@media (max-width: 451px){chat-root #tiledesk-container .header-button.close{display:flex}}\n'],encapsulation:2}),i})();var wn=_e(6120),yn=_e(4850);let On=(()=>{class i{constructor(e,n,o){this.http=e,this.g=n,this.appConfigService=o,this.API_URL=o.getConfig().apiUrl}getCurrent(e){const n=this.API_URL+e+"/publicanalytics/waiting/current",o=new Ee.WM;return o.append("Content-Type","application/json"),this.http.get(n,{headers:o}).pipe((0,yn.U)(r=>r))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ie),t.LFG(Re))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var Ve=_e(2031);function No(i,a){if(1&i&&t._UZ(0,"div",16,17),2&i){const e=t.oxw().$implicit;t.Udp("background-image","url("+e.image+")")}}function Fo(i,a){if(1&i&&(t.TgZ(0,"div",18),t.O4$(),t.TgZ(1,"svg",19),t._UZ(2,"path",20)(3,"path",21),t.qZA()()),2&i){const e=t.oxw().$implicit;t.ekj("not-read",null==e?null:e.is_new)}}function Bo(i,a){if(1&i&&(t.TgZ(0,"div",18),t.O4$(),t.TgZ(1,"svg",22),t._UZ(2,"path",23),t.qZA()()),2&i){const e=t.oxw().$implicit;t.ekj("not-read",e.is_new)}}const Uo=function(i){return{"background-color":i}};function Do(i,a){if(1&i&&(t.TgZ(0,"div",24),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("ngStyle",t.VKq(2,Uo,n.stylesMap.get("themeColor"))),t.xp6(1),t.Oqu(e.badge)}}function Ho(i,a){if(1&i&&(t.TgZ(0,"div",25)(1,"button",26),t.O4$(),t.TgZ(2,"svg",27),t._UZ(3,"path",28)(4,"path",29),t.TgZ(5,"title",30),t._uU(6),t.qZA()()()()),2&i){const e=t.oxw(2);t.xp6(6),t.Oqu(e.translationMap.get("CLOSED"))}}const Zo=function(i){return{background:i}};function zo(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",2),t.NdJ("click",function(){const r=t.CHM(e).$implicit,v=t.oxw();return t.KtG(v.openConversationByID(r))}),t.TgZ(2,"div",3)(3,"div",4)(4,"div",5)(5,"span",6),t._uU(6),t.qZA(),t.YNc(7,No,2,2,"div",7),t.qZA()(),t.TgZ(8,"div",8)(9,"div",9),t._uU(10),t.ALo(11,"amTimeAgo"),t.qZA(),t.TgZ(12,"div",10),t._uU(13),t.qZA(),t.YNc(14,Fo,4,2,"div",11),t.YNc(15,Bo,3,2,"div",11),t.TgZ(16,"div",12),t._uU(17),t.qZA()(),t.YNc(18,Do,2,4,"div",13),t.YNc(19,Ho,7,1,"div",14),t.qZA(),t._UZ(20,"div",15),t.qZA()()}if(2&i){const e=a.$implicit;t.xp6(4),t.Q6J("ngStyle",t.VKq(16,Zo,"linear-gradient(rgb(255,255,255) -125%, "+e.color+")")),t.xp6(2),t.Oqu(null==e?null:e.avatar),t.xp6(1),t.Q6J("ngIf",null==e?null:e.image),t.xp6(3),t.Oqu(t.lcZ(11,14,null==e?null:e.timestamp)),t.xp6(3),t.Oqu(null==e?null:e.sender_fullname),t.xp6(1),t.Q6J("ngIf","image"===(null==e?null:e.type)),t.xp6(1),t.Q6J("ngIf","image"!==e.type&&"text"!==e.type),t.xp6(1),t.ekj("not-read",e.is_new)("archived",e.archived),t.xp6(1),t.Oqu(e.last_message_text),t.xp6(1),t.Q6J("ngIf",e.is_new),t.xp6(1),t.Q6J("ngIf",e.archived)}}let xn=(()=>{class i{constructor(e){this.iterableDiffers=e,this.onConversationSelected=new t.vpe,this.onImageLoaded=new t.vpe,this.onConversationLoaded=new t.vpe,this.convertMessage=Et,this.setColorFromString=Tt,this.avatarPlaceholder=St,this.logger=ve.getInstance(),this.empDifferMap=new Map,this.empMap=new Map,this.iterableDifferListConv=this.iterableDiffers.find([]).create(null)}ngOnInit(){this.logger.debug("[LISTCONVERSATIONS] ngOnInit",this.listConversations)}ngOnChanges(e){}openConversationByID(e){this.logger.debug("[LISTCONVERSATIONS] openConversationByID: ",e),e&&(this.uidConvSelected=e.uid,this.onConversationSelected.emit(e))}ngAfterViewInit(){this.logger.debug("[LISTCONVERSATIONS] ---ngAfterViewInit---: listConversations ",this.listConversations)}ngDoCheck(){this.iterableDifferListConv.diff(this.listConversations)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.ZZ4))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-list-conversations"]],inputs:{listConversations:"listConversations",limit:"limit",stylesMap:"stylesMap",translationMap:"translationMap"},outputs:{onConversationSelected:"onConversationSelected",onImageLoaded:"onImageLoaded",onConversationLoaded:"onConversationLoaded"},features:[t.TTD],decls:3,vars:5,consts:[["id","c21-app-list-conversations"],[4,"ngFor","ngForOf"],["tabindex","1103",1,"c21-item-conversation",3,"click"],[1,"c21-body-conv"],[1,"c21-left-conv"],[1,"c21-ball",3,"ngStyle"],[1,"c21-ball-label"],["class","c21-avatar-image",3,"background-image",4,"ngIf"],[1,"c21-right-conv"],[1,"c21-last-time"],[1,"truncate","c21-name"],["class","c21-msg","style","float: left; margin-right: 5px;",3,"not-read",4,"ngIf"],[1,"truncate","c21-msg"],["class","c21-divBudge",3,"ngStyle",4,"ngIf"],["class","c21-icon-archived-chat",4,"ngIf"],[1,"clear"],[1,"c21-avatar-image"],["avatarImage",""],[1,"c21-msg",2,"float","left","margin-right","5px"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","fill","#000000","width","20px","height","20px","viewBox","0 0 24 24"],["d","M0 0h24v24H0V0z","fill","none"],["d","M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","fill","#000000","width","20px","height","20px","viewBox","0 0 24 24","transform","rotate(45)"],["d","M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"],[1,"c21-divBudge",3,"ngStyle"],[1,"c21-icon-archived-chat"],["tabindex","-1",1,"c21-header-button","c21-right","c21-close","c21-button-clean"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","fill","#aaaaaa","width","24px","height","24px","viewBox","0 0 24 24"],["fill","none","d","M0 0h24v24H0z"],["d","M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"],["id","altIconTitle"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,zo,21,18,"div",1),t.ALo(2,"slice"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",t.Dn7(2,1,n.listConversations,0,n.limit)))},dependencies:[ue.sg,ue.O5,ue.PC,ue.OU,Ve.eG],styles:["[_nghost-%COMP%]   .c21-msg[_ngcontent-%COMP%]    >a>img{max-width:24%!important;vertical-align:middle}#c21-app-list-conversations[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:auto;font-size:10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]{width:100%;min-width:325;height:auto;position:relative;margin:auto;padding:0;cursor:pointer;-webkit-appearance:initial;border:none;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]{border-bottom:1px solid #eee;width:auto;text-align:left;padding:0 15px;position:relative;display:flex;align-items:center;height:60px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]{width:auto;height:100%;float:left;display:flex;align-items:center}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]{width:calc(100% - 65px);margin-left:15px;height:auto;float:left;padding:17px 0;text-align:left}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-last-time[_ngcontent-%COMP%]{font-size:.8em;color:#aaa;float:right;display:block;padding:0;margin:0;width:auto;height:auto}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-name[_ngcontent-%COMP%]{font-weight:300;color:#8b8ea6;font-size:1.3em;line-height:1.7;min-height:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-msg[_ngcontent-%COMP%]{font-weight:400;color:#3a3c4c;font-size:1.3em;line-height:1.7;max-height:21px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .not-read.c21-msg[_ngcontent-%COMP%]{font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .archived.c21-msg[_ngcontent-%COMP%]{margin-right:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:hover, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:focus, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:active{background-color:#fafafa}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]{position:relative;width:40px;height:40px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:45px;left:inherit;right:10px;width:10px;height:10px;min-width:10px;font-size:1.2em;line-height:10px;border-radius:50%;background-color:#2a6ac1;color:#fff;font-weight:700;padding:0;text-align:center;margin-right:0;display:inline-block}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-icon-archived-chat[_ngcontent-%COMP%]{border-radius:4px;position:absolute;right:0;bottom:20px;margin-right:-5px;color:#858585;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{padding:6px 10px;display:flex;align-items:center;color:#777}"]}),i})();function jo(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.returnOpenAllConversation())}),t.TgZ(1,"div",11),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.returnOpenAllConversation())}),t._uU(2),t.qZA(),t.TgZ(3,"button",12),t.O4$(),t.TgZ(4,"svg",13),t._UZ(5,"path",14),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.hij("",e.g.SHOW_ALL_CONV," ")}}function Vo(i,a){if(1&i&&(t.TgZ(0,"div")(1,"div",8),t._uU(2),t.qZA(),t.YNc(3,jo,6,1,"div",9),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.g.PREV_CONVERSATIONS),t.xp6(1),t.Q6J("ngIf",1==e.g.showAllConversations)}}function Go(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.returnOpenAllConversation())}),t.TgZ(1,"div",15),t._uU(2),t.qZA(),t.O4$(),t.TgZ(3,"svg",16),t._UZ(4,"path",17)(5,"path",18),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.g.SHOW_ALL_CONV)}}function qo(i,a){if(1&i&&(t.TgZ(0,"div")(1,"div",8),t._uU(2),t.qZA(),t.YNc(3,Go,6,1,"div",9),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.g.NO_CONVERSATION),t.xp6(1),t.Q6J("ngIf",e.listConversations&&e.listConversations.length>0)}}function Wo(i,a){if(1&i&&t._UZ(0,"div",25,26),2&i){const e=t.oxw().$implicit;t.Udp("background-image","url("+e.imageurl+")")}}const Mn=function(i){return{"background-color":i}};function Yo(i,a){if(1&i&&(t.TgZ(0,"div",21)(1,"div",22)(2,"span",23),t._uU(3),t.qZA(),t.YNc(4,Wo,2,2,"div",24),t.qZA()()),2&i){const e=a.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(3,Mn,n.setColorFromString(e.firstname))),t.xp6(2),t.Oqu(n.avatarPlaceholder(e.firstname)),t.xp6(1),t.Q6J("ngIf",e.imageurl)}}function Jo(i,a){if(1&i&&(t.TgZ(0,"div",19),t.YNc(1,Yo,5,5,"div",20),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.availableAgents)}}function Qo(i,a){if(1&i&&t._UZ(0,"div",25,26),2&i){const e=t.oxw().$implicit;t.Udp("background-image","url("+e.imageurl+")")}}function Ko(i,a){if(1&i&&(t.TgZ(0,"div",35)(1,"div",22)(2,"span",23),t._uU(3),t.qZA(),t.YNc(4,Qo,2,2,"div",24),t.qZA()()),2&i){const e=a.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.VKq(3,Mn,n.setColorFromString(e.firstname))),t.xp6(2),t.Oqu(n.avatarPlaceholder(e.firstname)),t.xp6(1),t.Q6J("ngIf",e.imageurl)}}const En=function(i,a,e){return{"background-color":i,"border-color":a,color:e}},Sn=function(){return{fill:"yellow"}},Tn=function(i){return{fill:i}};function $o(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",27),t.YNc(1,Ko,5,5,"div",28),t.TgZ(2,"button",29,30),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openNewConversation())}),t.TgZ(4,"span",31),t.O4$(),t.TgZ(5,"svg",32),t._UZ(6,"path",33),t.qZA()(),t.kcU(),t.TgZ(7,"span",34),t._uU(8),t.qZA(),t._UZ(9,"div",3),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.availableAgents),t.xp6(1),t.Q6J("ngStyle",t.kEZ(5,En,e.g.themeColor,e.g.themeColor,e.g.themeForegroundColor)),t.xp6(3),t.Q6J("ngStyle",t.DdM(9,Sn)),t.xp6(1),t.Q6J("ngStyle",t.VKq(10,Tn,e.g.themeForegroundColor)),t.xp6(2),t.hij(" ",e.g.LABEL_START_NW_CONV," ")}}function Xo(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-list-conversations",38),t.NdJ("onConversationSelected",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onConversationSelectedFN(o))})("onImageLoaded",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onImageLoadedFN(o))})("onConversationLoaded",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onConversationLoadedFN(o))}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("listConversations",e.listConversations)("limit",3)("stylesMap",e.stylesMap)("translationMap",e.translationMapConversation)}}function ei(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div"),t.YNc(1,Xo,1,4,"chat-list-conversations",36),t.TgZ(2,"div",37)(3,"button",29,30),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openNewConversation())}),t.TgZ(5,"span",31),t.O4$(),t.TgZ(6,"svg",32),t._UZ(7,"path",33),t.qZA()(),t.kcU(),t.TgZ(8,"span",34),t._uU(9),t.qZA(),t._UZ(10,"div",3),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.listConversations&&e.listConversations.length>0),t.xp6(2),t.Q6J("ngStyle",t.kEZ(5,En,e.g.themeColor,e.g.themeColor,e.g.themeForegroundColor)),t.xp6(3),t.Q6J("ngStyle",t.DdM(9,Sn)),t.xp6(1),t.Q6J("ngStyle",t.VKq(10,Tn,e.g.themeForegroundColor)),t.xp6(2),t.hij(" ",e.g.LABEL_START_NW_CONV," ")}}function ti(i,a){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.WAITING_TIME_FOUND_WITH_REPLYTIME_PLACEHOLDER," ")}}function ni(i,a){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.g.WAITING_TIME_NOT_FOUND," ")}}function oi(i,a){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.g.WAITING_TIME_NOT_FOUND)}}function ii(i,a){if(1&i&&(t.TgZ(0,"div",39)(1,"div",40),t.YNc(2,ti,2,1,"div",2),t.YNc(3,ni,2,1,"div",2),t.YNc(4,oi,2,1,"div",2),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.waitingTime>=0&&!0===e.g.dynamicWaitTimeReply),t.xp6(1),t.Q6J("ngIf",e.waitingTime>=0&&!1===e.g.dynamicWaitTimeReply),t.xp6(1),t.Q6J("ngIf",-1==e.waitingTime)}}let ri=(()=>{class i{constructor(e,n,o,r,v,P){this.g=e,this.imageRepoService=n,this.chatManager=o,this.waitingService=r,this.translatorService=v,this.customTranslateService=P,this.onNewConversation=new t.vpe,this.onConversationSelected=new t.vpe,this.onOpenAllConvesations=new t.vpe,this.onImageLoaded=new t.vpe,this.onConversationLoaded=new t.vpe,this.subscriptions=[],this.convertMessage=Et,this.setColorFromString=Tt,this.avatarPlaceholder=St,this.tenant="",this.themeColor="",this.themeForegroundColor="",this.availableAgents=[],this.langService=new wn.b,this.logger=ve.getInstance(),this.humanizer=new wn.f(this.langService),this.humanizer.setOptions({round:!0}),this.initialize()}ngOnInit(){this.logger.debug("[HOMECONVERSATIONS]---ngOnInit--- ",this.listConversations)}initTranslations(){this.translationMapConversation=this.customTranslateService.translateLanguage(["CLOSED"])}onConversationSelectedFN(e){e&&this.onConversationSelected.emit(e)}initialize(){this.logger.debug("initialize: ListConversationsComponent"),this.initTranslations(),this.tenant=this.g.tenant,this.LABEL_START_NW_CONV=this.g.LABEL_START_NW_CONV,this.listConversations=[],this.archivedConversations=[],this.waitingTime=-1,this.availableAgents=this.g.availableAgents.slice(0,5),this.availableAgents.forEach(e=>{e.imageurl=this.imageRepoService.getImagePhotoUrl(e.id)}),this.logger.debug("[HOMECONVERSATIONS] tenant: ",this.tenant,this.availableAgents),this.logger.debug("[HOMECONVERSATIONS] this.listConversations.length",this.listConversations.length),this.logger.debug("[HOMECONVERSATIONS] this.listConversations",this.listConversations),this.showWaitingTime()}showWaitingTime(){const e=this,n=this.g.projectid;n&&this.waitingService.getCurrent(n).subscribe(o=>{if(e.logger.debug("[HOMECONVERSATIONS] response waiting",o),o&&o.length>0&&o[0].waiting_time_avg){const r=o[0].waiting_time_avg;e.waitingTime=r,e.logger.debug("[HOMECONVERSATIONS] that.waitingTime",e.waitingTime);const v=e.translatorService.getLanguage();e.humanWaitingTime=this.humanizer.humanize(r,{language:v}),this.g.WAITING_TIME_FOUND.includes("$reply_time")&&(this.WAITING_TIME_FOUND_WITH_REPLYTIME_PLACEHOLDER=this.g.WAITING_TIME_FOUND.replace("$reply_time",e.humanWaitingTime))}})}checkShowAllConversation(){return!!(this.archivedConversations&&this.archivedConversations.length>0)||!!(this.listConversations&&this.listConversations.length>0)}openNewConversation(){this.onNewConversation.emit()}returnOpenAllConversation(){this.onOpenAllConvesations.emit()}onImageLoadedFN(e){this.onImageLoaded.emit(e)}onConversationLoadedFN(e){this.onConversationLoaded.emit(e)}openConversationByID(e){this.logger.debug("[HOMECONVERSATIONS] openConversationByID: ",e),e&&this.onConversationSelected.emit(e)}ngOnDestroy(){this.logger.debug("[HOMECONVERSATIONS] ngOnDestroy list conv subscriptions",this.subscriptions),this.unsubscribe()}unsubscribe(){this.subscriptions.forEach(function(e){e.unsubscribe()}),this.subscriptions=[],this.subListConversations=null,this.subArchivedConversations=null,this.logger.debug("[HOMECONVERSATIONS] this.subscriptions",this.subscriptions)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(et),t.Y36(bt),t.Y36(On),t.Y36(Bt),t.Y36(Xe))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-home-conversations"]],inputs:{listConversations:"listConversations",archivedConversations:"archivedConversations",hideNewConversationButton:"hideNewConversationButton",stylesMap:"stylesMap"},outputs:{onNewConversation:"onNewConversation",onConversationSelected:"onConversationSelected",onOpenAllConvesations:"onOpenAllConvesations",onImageLoaded:"onImageLoaded",onConversationLoaded:"onConversationLoaded"},decls:10,vars:6,consts:[["id","c21-app-list-conversations"],[1,"c21-header"],[4,"ngIf"],[1,"clear"],[1,"c21-body"],["style","margin: 20px 30px;",4,"ngIf"],["class","flex-container",4,"ngIf"],["class","c21-footer",4,"ngIf"],[1,"c21-title"],["class","c21-button",3,"click",4,"ngIf"],[1,"c21-button",3,"click"],[2,"display","inline-block","line-height","40px","margin-right","10px",3,"click"],["tabindex","1101","aria-label"," tutte le conversazioni",1,"c21-button-clean"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","20","height","20","viewBox","0 0 20 20",0,"xml","space","preserve",2,"enable-background","new 0 0 20 20"],["d","M1.9,15.4h16.2v-1.8H1.9V15.4z M1.9,10.9h16.2V9.1H1.9V10.9z M1.9,4.6v1.8h16.2V4.6H1.9z"],[2,"display","inline-block","line-height","40px","margin-right","10px"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24"],["fill","none","d","M0 0h24v24H0V0z"],["d","M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7zm-4 6h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"],[2,"margin","20px 30px"],["class","c21-pallozzo",4,"ngFor","ngForOf"],[1,"c21-pallozzo"],[1,"c21-ball",3,"ngStyle"],[1,"c21-ball-label"],["class","c21-avatar-image",3,"background-image",4,"ngIf"],[1,"c21-avatar-image"],["avatarImage",""],[1,"flex-container"],["class","c21-pallozzo flex-inline-agent ",4,"ngFor","ngForOf"],["tabindex","1040","aflistconv","",1,"c21-button-primary",3,"ngStyle","click"],["aflistconv",""],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",3,"ngStyle"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",3,"ngStyle"],[1,"v-align-center","c21-label-button"],[1,"c21-pallozzo","flex-inline-agent"],[3,"listConversations","limit","stylesMap","translationMap","onConversationSelected","onImageLoaded","onConversationLoaded",4,"ngIf"],[1,"c21-new-conversation"],[3,"listConversations","limit","stylesMap","translationMap","onConversationSelected","onImageLoaded","onConversationLoaded"],[1,"c21-footer"],[1,"c21-waiting-time"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Vo,4,2,"div",2),t.YNc(3,qo,4,2,"div",2),t.qZA(),t._UZ(4,"div",3),t.TgZ(5,"div",4),t.YNc(6,Jo,2,1,"div",5),t.YNc(7,$o,10,12,"div",6),t.YNc(8,ei,11,12,"div",2),t.qZA(),t.YNc(9,ii,5,3,"div",7),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngIf",n.checkShowAllConversation()),t.xp6(1),t.Q6J("ngIf",!n.checkShowAllConversation()),t.xp6(3),t.Q6J("ngIf",(!n.listConversations||0==n.listConversations.length)&&!0===n.g.showAvailableAgents&&n.availableAgents&&n.availableAgents.length>1),t.xp6(1),t.Q6J("ngIf",(!n.listConversations||0==n.listConversations.length)&&n.availableAgents&&1===n.availableAgents.length&&!0===n.g.showAvailableAgents),t.xp6(1),t.Q6J("ngIf",n.availableAgents&&n.availableAgents.length>1||n.listConversations&&n.listConversations.length>0||n.availableAgents&&0===n.availableAgents.length),t.xp6(1),t.Q6J("ngIf",!0===n.g.showWaitTime))},dependencies:[ue.sg,ue.O5,ue.PC,xn],styles:["#c21-app-list-conversations[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:auto;font-size:10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{color:#5f6368;height:auto;position:relative;min-height:40px;display:block;font-weight:300;border-bottom:1px solid rgb(241,241,241);border-radius:0}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{font-size:1.4em;max-width:230px;line-height:normal;padding:14px 0 10px 24px;float:left}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]{font-size:1.4em;margin:0;line-height:normal;padding:0 5px;float:right;fill:#2a6ac1}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:40px;height:40px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#5f6368}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:rgba(220,220,220,.4)!important}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%;height:auto;top:0;font-size:1em;box-shadow:none;overflow:hidden;margin:0}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .flex-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-content:center;margin:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]{width:100%;min-width:344px;height:auto;position:relative;margin:auto;padding:0;cursor:pointer;-webkit-appearance:initial;border:none;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]{border-top:1px solid #eee;width:auto;text-align:left;margin:0 20px;position:relative;display:flex;align-items:center;height:80px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]{width:auto;height:100%;float:left;display:flex;align-items:center}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]{width:calc(100% - 65px);margin-left:15px;height:auto;float:left;padding:17px 0;text-align:left}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-last-time[_ngcontent-%COMP%]{font-size:.8em;color:#aaa;float:right;display:block;padding:0;margin:0;width:auto;height:auto}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-name[_ngcontent-%COMP%]{font-weight:700;color:#3a3c4c;font-size:1.3em;line-height:1.7;min-height:20px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-msg[_ngcontent-%COMP%]{font-weight:200;color:#3a3c4c;font-size:1.3em;line-height:1.7;max-height:21px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .not-read.c21-msg[_ngcontent-%COMP%]{font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:hover, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:focus, #c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:active{background-color:#fafafa}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-pallozzo[_ngcontent-%COMP%]{display:inline}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-pallozzo.flex-inline-agent[_ngcontent-%COMP%]{margin:auto 15px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]{position:relative;width:52px;height:52px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-new-conversation[_ngcontent-%COMP%]{width:auto;height:auto;position:relative;border-top:0px solid #eeeeee;display:flex;align-items:center;justify-content:center;box-shadow:none;vertical-align:top}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-footer[_ngcontent-%COMP%]{width:auto;height:auto;position:relative;display:flex;align-items:center}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-footer[_ngcontent-%COMP%]   .c21-waiting-time[_ngcontent-%COMP%]{font-size:1.3em;font-weight:200;padding:0 24px 10px}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:40px;left:inherit;right:10px;width:10px;height:10px;min-width:10px;font-size:1.2em;line-height:10px;border-radius:50%;background-color:#2a6ac1;color:#fff;font-weight:700;padding:0;text-align:center;margin-right:0;display:inline-block}#c21-app-list-conversations[_ngcontent-%COMP%]   .c21-label-button[_ngcontent-%COMP%]{margin-left:8px;font-weight:400;font-size:1.2em}"]}),i})();function si(i,a){if(1&i&&(t.TgZ(0,"div",15),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.g.userFullname)}}function ai(i,a){if(1&i&&(t.O4$(),t.TgZ(0,"svg",16),t._UZ(1,"path",17)(2,"path",18),t.TgZ(3,"title",19),t._uU(4),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(e.g.SOUND_OFF)}}function li(i,a){if(1&i&&(t.O4$(),t.TgZ(0,"svg",16),t._UZ(1,"path",17)(2,"path",20),t.TgZ(3,"title",19),t._uU(4),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(e.g.SOUND_ON)}}function ci(i,a){if(1&i&&(t.TgZ(0,"span",14),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.g.SOUND_OFF,"")}}function hi(i,a){if(1&i&&(t.TgZ(0,"span",14),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.g.SOUND_ON,"")}}function di(i,a){if(1&i&&(t.O4$(),t.kcU(),t.TgZ(0,"span",14),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.g.LOGOUT,"")}}function ui(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.signOut())}),t.O4$(),t.TgZ(1,"svg",21),t._UZ(2,"path",17)(3,"path",22),t.TgZ(4,"title",19),t._uU(5),t.qZA()(),t.YNc(6,di,2,1,"span",11),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(5),t.Oqu(e.g.LOGOUT),t.xp6(1),t.Q6J("ngIf",e.g.isLogged&&e.g.showLogoutOption)}}function gi(i,a){if(1&i){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div",6)(1,"div",7),t.YNc(2,si,2,1,"div",8),t.TgZ(3,"div",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.toggleSound())}),t.YNc(4,ai,5,1,"svg",10),t.YNc(5,li,5,1,"svg",10),t.YNc(6,ci,2,1,"span",11),t.YNc(7,hi,2,1,"span",11),t.qZA(),t.YNc(8,ui,7,2,"div",12),t.TgZ(9,"div",13)(10,"span",14),t._uU(11),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.g.signInWithCustomToken&&e.g.userFullname),t.xp6(2),t.Q6J("ngIf",!e.g.soundEnabled),t.xp6(1),t.Q6J("ngIf",e.g.soundEnabled),t.xp6(1),t.Q6J("ngIf",!e.g.soundEnabled),t.xp6(1),t.Q6J("ngIf",e.g.soundEnabled),t.xp6(1),t.Q6J("ngIf",e.g.isLogged&&e.g.showLogoutOption),t.xp6(3),t.hij(" ",e.g.BUILD_VERSION,"")}}const pi=function(i){return{display:i}};let fi=(()=>{class i{constructor(e){this.g=e,this.isHover=!1,this.onSignOut=new t.vpe}ngOnInit(){this.themeColor50=ke(this.g.themeColor,50)}f21_toggle_options(){this.g.setParameter("isOpenMenuOptions",!this.g.isOpenMenuOptions,!0)}toggleSound(){this.g.setParameter("soundEnabled",!this.g.soundEnabled,!0),this.g.setParameter("isOpenMenuOptions",!1,!0)}signOut(){this.g.setParameter("isOpenMenuOptions",!1,!0),this.onSignOut.emit()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-menu-options"]],inputs:{isHover:"isHover"},outputs:{onSignOut:"onSignOut"},decls:7,vars:4,consts:[["id","c21-menu-options"],[1,"button-menu-options",3,"click","mouseover","mouseleave"],["xmlns","http://www.w3.org/2000/svg","enable-background","new 0 0 24 24","height","24px","width","24px","viewBox","0 0 24 24",3,"ngStyle"],["d","M0,0h24v24H0V0z","fill","none"],["d","M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"],["class","modal-menu-options",4,"ngIf"],[1,"modal-menu-options"],[1,""],["class","label-menu-welcome",4,"ngIf"],[1,"c21-button",3,"click"],["aria-labelledby","altIconTitle","class","icon-menu","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",4,"ngIf"],["class","label-menu-item",4,"ngIf"],["class","c21-button",3,"click",4,"ngIf"],[1,"c21-button","build_version_menu"],[1,"label-menu-item"],[1,"label-menu-welcome"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",1,"icon-menu"],["fill","none","d","M0 0h24v24H0V0z"],["d","M4.34 2.93L2.93 4.34 7.29 8.7 7 9H3v6h4l5 5v-6.59l4.18 4.18c-.65.49-1.38.88-2.18 1.11v2.06c1.34-.3 2.57-.92 3.61-1.75l2.05 2.05 1.41-1.41L4.34 2.93zM10 15.17L7.83 13H5v-2h2.83l.88-.88L10 11.41v3.76zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zm-7-8l-1.88 1.88L12 7.76zm4.5 8c0-1.77-1.02-3.29-2.5-4.03v1.79l2.48 2.48c.01-.08.02-.16.02-.24z"],["id","altIconTitle"],["d","M3 9v6h4l5 5V4L7 9H3zm7-.17v6.34L7.83 13H5v-2h2.83L10 8.83zM16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77 0-4.28-2.99-7.86-7-8.77z"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","aria-labelledby","altIconTitle",1,"icon-menu"],["d","M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return n.f21_toggle_options()})("mouseover",function(){return n.isHover=!0})("mouseleave",function(){return n.isHover=!1}),t.O4$(),t.TgZ(2,"svg",2)(3,"g"),t._UZ(4,"path",3)(5,"path",4),t.qZA()()(),t.YNc(6,gi,12,7,"div",5),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngStyle",t.VKq(2,pi,n.isHover||n.g.isOpenMenuOptions?"block":"none")),t.xp6(4),t.Q6J("ngIf",n.g.isOpenMenuOptions))},dependencies:[ue.O5,ue.PC],styles:["#c21-menu-options[_ngcontent-%COMP%]   .modal-menu-options[_ngcontent-%COMP%]{width:auto;height:auto;min-height:40px;min-width:100px;max-width:80%;position:absolute;bottom:40px;right:10px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;background-color:#fff;z-index:25;box-shadow:0 4px 15px #0003,0 1px 2px #0003}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]{position:absolute;width:auto;line-height:12px;font-size:1em;font-weight:700;color:#777;display:inline-block;align-items:center;margin:4px 20px;padding:0;cursor:pointer;width:22px;height:22px;right:0}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#5f6368;display:none}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]:hover{border-radius:50%}#c21-menu-options[_ngcontent-%COMP%]   .button-menu-options[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{display:block}.c21-button[_ngcontent-%COMP%]{cursor:pointer;margin:5px;padding:5px 10px;color:#777;display:flex}.c21-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;border-radius:6px;cursor:pointer}.build_version_menu[_ngcontent-%COMP%]{color:#aaa;justify-content:center;font-size:1em}.build_version_menu[_ngcontent-%COMP%]:hover{cursor:default;background-color:unset}.label-menu-welcome[_ngcontent-%COMP%]{cursor:default;font-weight:500;margin:10px 0;padding:0 10px}#c21-options-menu[_ngcontent-%COMP%]{width:auto;height:auto;min-height:40px;min-width:100px;max-width:80%;position:absolute;z-index:10;top:40px;right:15px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;border:1px solid #d7d7d7;background-color:#fff;padding:10px 0}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{padding:6px 10px;display:flex;align-items:center}.label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}.icon-menu[_ngcontent-%COMP%]{fill:#5f6368}#c21-options-menu[_ngcontent-%COMP%]   .label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}"]}),i})();const mi=["homeComponent"],_i=["aflistconv"];function vi(i,a){if(1&i&&(t.TgZ(0,"div",27),t._UZ(1,"div",28,29),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Udp("background-image","url("+e.g.project.logoChat+")")}}function bi(i,a){if(1&i&&(t.TgZ(0,"div",30),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(e.g.welcomeMsg)}}function Ci(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",36)(1,"button",37,38),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openConversationOnPlatform("whatsapp"))}),t.TgZ(3,"span",39),t.O4$(),t.TgZ(4,"svg",40),t._UZ(5,"path",41),t.TgZ(6,"linearGradient",42),t._UZ(7,"stop",43)(8,"stop",44),t.qZA(),t._UZ(9,"path",45)(10,"image",46)(11,"path",47)(12,"path",48),t.TgZ(13,"title",10),t._uU(14,"Whatsapp"),t.qZA()()(),t.kcU(),t._UZ(15,"div",49),t.qZA()()}}function wi(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",50)(1,"button",37,38),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openConversationOnPlatform("telegram"))}),t.TgZ(3,"span",39),t.O4$(),t.TgZ(4,"svg",51)(5,"g",52)(6,"linearGradient",53),t._UZ(7,"stop",54)(8,"stop",55),t.qZA(),t._UZ(9,"circle",56)(10,"path",57)(11,"path",58),t.TgZ(12,"linearGradient",59),t._UZ(13,"stop",60)(14,"stop",61),t.qZA(),t._UZ(15,"path",62),t.qZA(),t.TgZ(16,"title",10),t._uU(17,"Telegram"),t.qZA()()(),t.kcU(),t._UZ(18,"div",49),t.qZA()()}}function yi(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",63)(1,"button",37,38),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openConversationOnPlatform("messanger"))}),t.TgZ(3,"span",39),t.O4$(),t.TgZ(4,"svg",64)(5,"radialGradient",65),t._UZ(6,"stop",66)(7,"stop",67)(8,"stop",68)(9,"stop",69),t.qZA(),t._UZ(10,"path",70)(11,"path",71),t.TgZ(12,"title",10),t._uU(13,"Facebook Messanger"),t.qZA()()(),t.kcU(),t._UZ(14,"div",49),t.qZA()()}}function Oi(i,a){if(1&i&&(t.TgZ(0,"div",31)(1,"div",32),t._uU(2),t.qZA(),t.YNc(3,Ci,16,0,"div",33),t.YNc(4,wi,19,0,"div",34),t.YNc(5,yi,15,0,"div",35),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.Oqu(null==e.translationMapFooter?null:e.translationMapFooter.get("SWITCH_TO")),t.xp6(1),t.Q6J("ngIf",(null==e.g?null:e.g.whatsappNumber)&&""!==(null==e.g?null:e.g.whatsappNumber.trim())),t.xp6(1),t.Q6J("ngIf",(null==e.g?null:e.g.telegramUsername)&&""!==(null==e.g?null:e.g.telegramUsername.trim())),t.xp6(1),t.Q6J("ngIf",(null==e.g?null:e.g.messangerPageTitle)&&""!==(null==e.g?null:e.g.messangerPageTitle.trim()))}}function xi(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-menu-options",72),t.NdJ("onSignOut",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSignOutFN())}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("isHover",e.hover)}}const Mi=function(i,a){return{color:i,"background-image":a}},Ei=function(i){return{display:i}},Si=function(i){return{fill:i}};let Ti=(()=>{class i{constructor(e,n){this.g=e,this.customTranslateService=n,this.onNewConversation=new t.vpe,this.onConversationSelected=new t.vpe,this.onOpenAllConvesations=new t.vpe,this.onCloseWidget=new t.vpe,this.onSignOut=new t.vpe,this.onImageLoaded=new t.vpe,this.onConversationLoaded=new t.vpe,this.hover=!1,this.convertColorToRGBA=ke,this.logger=ve.getInstance()}ngOnInit(){this.logger.debug("[HOME-COMP] ngOnInit"),this.initiTranslations()}initiTranslations(){this.translationMapFooter=this.customTranslateService.translateLanguage(["SWITCH_TO"]),this.translationMapHeader=this.customTranslateService.translateLanguage(["BUTTON_CLOSE_TO_ICON"])}ngAfterViewInit(){this.logger.debug("[HOME-COMP]---ngAfterViewInit--- "),!0===this.g.firstOpen&&(this.addAnimation(),this.g.firstOpen=!1),setTimeout(()=>{this.aflistconv&&this.aflistconv.nativeElement.focus()},1e3)}onNewConversationFN(){this.removeAnimation(),this.onNewConversation.emit()}onOpenAllConversation(){this.removeAnimation(),this.onOpenAllConvesations.emit()}openConversationOnPlatform(e){"telegram"===e?window.open("https://telegram.me/"+this.g.telegramUsername,"_blank"):"whatsapp"===e?window.open("https://wa.me/"+this.g.whatsappNumber+"?text=/start","_blank"):"messanger"===e&&window.open("https://m.me/"+this.g.messangerPageTitle,"_blank")}onConversationSelectedFN(e){e&&(this.removeAnimation(),this.onConversationSelected.emit(e))}onImageLoadedFN(e){this.onImageLoaded.emit(e)}onConversationLoadedFN(e){this.onConversationLoaded.emit(e)}f21_close(){this.addAnimation(),this.onCloseWidget.emit()}hideMenuOptions(){this.logger.debug("[HOME-COMP] hideMenuOptions"),this.g.setParameter("isOpenMenuOptions",!1,!0)}onSignOutFN(){this.onSignOut.emit()}addAnimation(){try{const e=this.element.nativeElement;e&&e.classList.add("start-animation")}catch(e){this.logger.error("[HOME-COMP] addAnimation > Error :"+e)}}removeAnimation(){try{const e=this.element.nativeElement;e&&e.classList.remove("start-animation")}catch(e){this.logger.error("[HOME-COMP] removeAnimation > Error :"+e)}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(Xe))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-home"]],viewQuery:function(e,n){if(1&e&&(t.Gf(mi,5),t.Gf(_i,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.element=o.first),t.iGM(o=t.CRH())&&(n.aflistconv=o.first)}},inputs:{listConversations:"listConversations",archivedConversations:"archivedConversations",hideSettings:"hideSettings",hideNewConversationButton:"hideNewConversationButton",stylesMap:"stylesMap"},outputs:{onNewConversation:"onNewConversation",onConversationSelected:"onConversationSelected",onOpenAllConvesations:"onOpenAllConvesations",onCloseWidget:"onCloseWidget",onSignOut:"onSignOut",onImageLoaded:"onImageLoaded",onConversationLoaded:"onConversationLoaded"},decls:29,vars:23,consts:[["id","chat21-home-component","tabindex","2002","onFocus","document.querySelector('[aflistconv]').focus()"],["homeComponent",""],[1,"c21-header",3,"ngStyle","click"],[1,"c21-header-container"],[1,"c21-header-button",3,"ngStyle"],[1,"c21-close-button"],["tabindex","2001","aria-label","    chiudi chat",1,"c21-close-button-body",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],[1,"c21-header-content"],["class","avatar-project","item-start","",4,"ngIf"],[1,"c21-text","fade-in-bottom"],[1,"c21-text-welcome"],["class","c21-text-intro",4,"ngIf"],[1,"c21-body",3,"click"],[1,"c21-body-content"],[1,"c21-cards"],[1,"c21-card-blank","fade-in-top"],[1,"c21-card","fade-in-top"],[3,"listConversations","archivedConversations","hideNewConversationButton","stylesMap","onNewConversation","onConversationSelected","onOpenAllConvesations","onImageLoaded","onConversationLoaded"],["class","c21-footer-content fade-in-bottom-footer",4,"ngIf"],[1,"c21-footer","fade-in-bottom-footer"],["id","c21-powered-by",3,"mouseover","mouseleave"],["tabindex","-1",1,"c21-powered-by",3,"innerHTML"],[3,"isHover","onSignOut",4,"ngIf"],["item-start","",1,"avatar-project"],[1,"avatar-image"],["avatarImage",""],[1,"c21-text-intro"],[1,"c21-footer-content","fade-in-bottom-footer"],[1,"label-item"],["id","c21-whatsapp",4,"ngIf"],["id","c21-telegram",4,"ngIf"],["id","c21-messanger",4,"ngIf"],["id","c21-whatsapp"],["tabindex","1040","aflistconv","",1,"c21-button-primary",3,"click"],["aflistconv",""],[1,"v-align-center"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","28","height","28","viewBox","0 0 1219.547 1225.016"],["fill","#E0E0E0","d","M1041.858 178.02C927.206 63.289 774.753.07 612.325 0 277.617 0 5.232 272.298 5.098 606.991c-.039 106.986 27.915 211.42 81.048 303.476L0 1225.016l321.898-84.406c88.689 48.368 188.547 73.855 290.166 73.896h.258.003c334.654 0 607.08-272.346 607.222-607.023.056-162.208-63.052-314.724-177.689-429.463zm-429.533 933.963h-.197c-90.578-.048-179.402-24.366-256.878-70.339l-18.438-10.93-191.021 50.083 51-186.176-12.013-19.087c-50.525-80.336-77.198-173.175-77.16-268.504.111-278.186 226.507-504.503 504.898-504.503 134.812.056 261.519 52.604 356.814 147.965 95.289 95.36 147.728 222.128 147.688 356.948-.118 278.195-226.522 504.543-504.693 504.543z"],["id","a","gradientUnits","userSpaceOnUse","x1","609.77","y1","1190.114","x2","609.77","y2","21.084"],["offset","0","stop-color","#20b038"],["offset","1","stop-color","#60d66a"],["fill","url(#a)","d","M27.875 1190.114l82.211-300.18c-50.719-87.852-77.391-187.523-77.359-289.602.133-319.398 260.078-579.25 579.469-579.25 155.016.07 300.508 60.398 409.898 169.891 109.414 109.492 169.633 255.031 169.57 409.812-.133 319.406-260.094 579.281-579.445 579.281-.023 0 .016 0 0 0h-.258c-96.977-.031-192.266-24.375-276.898-70.5l-307.188 80.548z"],["overflow","visible","opacity",".08","width","20","height","20",0,"xlink","href","FCC0802E2AF8A915.png","transform","translate(270.984 291.372)"],["fill-rule","evenodd","clip-rule","evenodd","fill","#FFF","d","M462.273 349.294c-11.234-24.977-23.062-25.477-33.75-25.914-8.742-.375-18.75-.352-28.742-.352-10 0-26.25 3.758-39.992 18.766-13.75 15.008-52.5 51.289-52.5 125.078 0 73.797 53.75 145.102 61.242 155.117 7.5 10 103.758 166.266 256.203 226.383 126.695 49.961 152.477 40.023 179.977 37.523s88.734-36.273 101.234-71.297c12.5-35.016 12.5-65.031 8.75-71.305-3.75-6.25-13.75-10-28.75-17.5s-88.734-43.789-102.484-48.789-23.75-7.5-33.75 7.516c-10 15-38.727 48.773-47.477 58.773-8.75 10.023-17.5 11.273-32.5 3.773-15-7.523-63.305-23.344-120.609-74.438-44.586-39.75-74.688-88.844-83.438-103.859-8.75-15-.938-23.125 6.586-30.602 6.734-6.719 15-17.508 22.5-26.266 7.484-8.758 9.984-15.008 14.984-25.008 5-10.016 2.5-18.773-1.25-26.273s-32.898-81.67-46.234-111.326z"],["fill","#FFF","d","M1036.898 176.091C923.562 62.677 772.859.185 612.297.114 281.43.114 12.172 269.286 12.039 600.137 12 705.896 39.633 809.13 92.156 900.13L7 1211.067l318.203-83.438c87.672 47.812 186.383 73.008 286.836 73.047h.255.003c330.812 0 600.109-269.219 600.25-600.055.055-160.343-62.328-311.108-175.649-424.53zm-424.601 923.242h-.195c-89.539-.047-177.344-24.086-253.93-69.531l-18.227-10.805-188.828 49.508 50.414-184.039-11.875-18.867c-49.945-79.414-76.312-171.188-76.273-265.422.109-274.992 223.906-498.711 499.102-498.711 133.266.055 258.516 52 352.719 146.266 94.195 94.266 146.031 219.578 145.992 352.852-.118 274.999-223.923 498.749-498.899 498.749z"],[1,"clear"],["id","c21-telegram"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","26","height","26","viewBox","0 0 368 368",0,"xml","space","preserve",2,"enable-background","new 0 0 368 368"],["id","XMLID_1_"],["id","XMLID_7_","gradientUnits","userSpaceOnUse","x1","-66.831","y1","-68.1757","x2","-65.3102","y2","-68.1757","gradientTransform","matrix(-60 139.992 -139.992 -60 -13316.416 5324.4634)"],["offset","0",2,"stop-color","#37AEE2"],["offset","1",2,"stop-color","#1E96C8"],["id","XMLID_3_","fill","url(#XMLID_7_)","cx","184","cy","184","r","182.5"],["id","XMLID_4_","fill","#C8DAEA","d","M150.5,267.6c-5.9,0-4.9-2.2-6.9-7.9l-17.4-57.2L260,123.2"],["id","XMLID_5_","fill","#A9C9DD","d","M150.5,267.6c4.6,0,6.6-2.1,9.1-4.6l24.3-23.7l-30.4-18.3"],["id","XMLID_8_","gradientUnits","userSpaceOnUse","x1","-61.9167","y1","-70.9915","x2","-60.3959","y2","-70.9915","gradientTransform","matrix(24.9894 40.0038 -47.6951 20.9596 -1641.849 4153.2417)"],["offset","0",2,"stop-color","#EFF7FC"],["offset","1",2,"stop-color","#FFFFFF"],["id","XMLID_6_","fill","url(#XMLID_8_)","d","M153.6,221.1l73.5,54.3c8.4,4.6,14.4,2.2,16.5-7.8l29.9-141.1c3.1-12.3-4.7-17.9-12.7-14.2   L85.2,180.2c-12,4.8-11.9,11.5-2.2,14.5l45.1,14.1l104.4-65.9c4.9-3,9.5-1.4,5.7,1.9"],["id","c21-messanger"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","26","height","26",0,"xmlns","xlink","http://www.w3.org/1999/xlink","version","1.1","viewBox","0 0 800 800"],["id","Gradient","cx","101.925","cy","809.0079","r","1.0896","gradientTransform","matrix(800 0 0 -799.9985 -81386 648000.75)","gradientUnits","userSpaceOnUse"],["offset","0",2,"stop-color","#0099FF"],["offset","0.6098",2,"stop-color","#A033FF"],["offset","0.9348",2,"stop-color","#FF5280"],["offset","1",2,"stop-color","#FF7061"],["fill","url(#Gradient)","d","M400,0C174.7,0,0,165.1,0,388c0,116.6,47.8,217.4,125.6,287c6.5,5.8,10.5,14,10.7,22.8l2.2,71.2  c0.7,22.7,24.1,37.5,44.9,28.3l79.4-35c6.7-3,14.3-3.5,21.4-1.6c36.5,10,75.3,15.4,115.8,15.4c225.3,0,400-165.1,400-388  S625.3,0,400,0z"],["fill","#FFFFFF","d","M159.8,501.5l117.5-186.4c18.7-29.7,58.7-37,86.8-16l93.5,70.1c8.6,6.4,20.4,6.4,28.9-0.1    l126.2-95.8c16.8-12.8,38.8,7.4,27.6,25.3L522.7,484.9c-18.7,29.7-58.7,37-86.8,16l-93.5-70.1c-8.6-6.4-20.4-6.4-28.9,0.1    l-126.2,95.8C170.5,539.5,148.5,519.4,159.8,501.5z"],[3,"isHover","onSignOut"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0,1)(2,"div",2),t.NdJ("click",function(){return n.hideMenuOptions()}),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),t.NdJ("click",function(){return n.f21_close()}),t.O4$(),t.TgZ(7,"svg",7),t._UZ(8,"path",8)(9,"path",9),t.TgZ(10,"title",10),t._uU(11),t.qZA()()()()(),t.kcU(),t.TgZ(12,"div",11),t.YNc(13,vi,3,2,"div",12),t.TgZ(14,"div",13)(15,"div",14),t._uU(16),t.qZA(),t.YNc(17,bi,2,1,"div",15),t.qZA()()()(),t.TgZ(18,"div",16),t.NdJ("click",function(){return n.hideMenuOptions()}),t.TgZ(19,"div",17)(20,"div",18),t._UZ(21,"div",19),t.TgZ(22,"div",20)(23,"chat-home-conversations",21),t.NdJ("onNewConversation",function(){return n.onNewConversationFN()})("onConversationSelected",function(r){return n.onConversationSelectedFN(r)})("onOpenAllConvesations",function(){return n.onOpenAllConversation()})("onImageLoaded",function(r){return n.onImageLoadedFN(r)})("onConversationLoaded",function(r){return n.onConversationLoadedFN(r)}),t.qZA()()()()(),t.YNc(24,Oi,6,4,"div",22),t.TgZ(25,"div",23)(26,"div",24),t.NdJ("mouseover",function(){return n.hover=!0})("mouseleave",function(){return n.hover=!1}),t._UZ(27,"div",25),t.qZA(),t.YNc(28,xi,1,1,"chat-menu-options",26),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngStyle",t.WLB(16,Mi,n.g.themeForegroundColor,n.g.colorGradient)),t.xp6(2),t.Q6J("ngStyle",t.VKq(19,Ei,n.g.hideHeaderCloseButton?"none":"block")),t.xp6(3),t.Q6J("ngStyle",t.VKq(21,Si,n.g.themeForegroundColor)),t.xp6(4),t.Oqu(null==n.translationMapHeader?null:n.translationMapHeader.get("BUTTON_CLOSE_TO_ICON")),t.xp6(2),t.Q6J("ngIf","nologo"!==n.g.project.logoChat),t.xp6(3),t.Oqu(null==n.g?null:n.g.welcomeTitle),t.xp6(1),t.Q6J("ngIf",n.g.welcomeMsg),t.xp6(2),t.ekj("nologo","nologo"===n.g.project.logoChat),t.xp6(4),t.Q6J("listConversations",n.listConversations)("archivedConversations",n.archivedConversations)("hideNewConversationButton",n.hideNewConversationButton)("stylesMap",n.stylesMap),t.xp6(1),t.Q6J("ngIf",(null==n.g?null:n.g.whatsappNumber)||(null==n.g?null:n.g.telegramUsername)||(null==n.g?null:n.g.messangerPageTitle)),t.xp6(3),t.Q6J("innerHTML",n.g.poweredBy,t.oJD),t.xp6(1),t.Q6J("ngIf",!n.hideSettings))},dependencies:[ue.O5,ue.PC,ri,fi],styles:["#chat21-home-component{position:absolute;width:100%;height:100%}#chat21-home-component.start-animation .fade-in-top{animation:fade-in-top .5s cubic-bezier(.39,.575,.565,1) .3s both}#chat21-home-component.start-animation .fade-in-bottom{animation:fade-in-bottom .5s cubic-bezier(.6,-.28,.735,.045) 0s}#chat21-home-component .c21-header{position:absolute;width:100%;height:500px;border-radius:0 0 16px 16px;overflow:hidden;margin:0;padding:0}#chat21-home-component .c21-header .c21-header-container{padding:0;margin:0;width:100%;height:100%;position:absolute}#chat21-home-component .c21-header .c21-header-container .c21-header-button{display:block;width:100%;height:70px;position:absolute;margin:0}#chat21-home-component .c21-header .c21-header-container .flex-container{display:flex;align-items:stretch;margin:30px 40px 0;width:auto;height:auto}#chat21-home-component .c21-header .c21-header-container .flex-container .avatar-project{width:22%}#chat21-home-component .c21-header .c21-header-container .flex-container .c21-text{font-family:Google Sans}#chat21-home-component .c21-header .c21-header-container .flex-container .c21-text .c21-text-welcome{overflow:hidden;line-height:1.2em;max-height:2.4em;font-weight:400;font-size:3em;margin-bottom:10px}#chat21-home-component .c21-header .c21-header-container .flex-container .c21-text .c21-text-intro{display:inline-block;font-size:1.4em;font-weight:300;line-height:1.2em;max-height:2.4em}#chat21-home-component .c21-header .c21-header-container .c21-header-content{margin:55px 40px 0;width:auto;height:auto;display:flex;align-items:stretch}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-logo{position:relative;width:auto;height:70px;margin-bottom:20px}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-logo img{max-width:100%;max-height:100%;margin:auto 0;display:block}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-text{font-family:Roboto;margin:0 0 0 15px}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-text .c21-text-welcome{overflow:hidden;line-height:1.4em;max-height:3em;font-weight:200;font-size:2.5em;margin-bottom:15px}#chat21-home-component .c21-header .c21-header-container .c21-header-content .c21-text .c21-text-intro{display:inline-block;font-size:1.7em;font-weight:600;line-height:1.2em;max-height:2.4em}#chat21-home-component .c21-body{position:absolute;width:100%;height:calc(100% - 30px);padding:0;margin:0;overflow:auto;background-color:#fff;top:0;box-shadow:none}#chat21-home-component .c21-body .c21-body-content{position:relative;padding:180px 25px 20px;margin:0}#chat21-home-component .c21-body .c21-body-content.nologo{padding:180px 10px 20px}#chat21-home-component .c21-body .c21-body-content .c21-cards .c21-card-blank{width:0;height:0;position:absolute;margin:-8px 16px;border-radius:0;z-index:40;border-style:solid;border-width:0px 15px 15px 15px;border-color:transparent transparent #ffffff transparent}#chat21-home-component .c21-body .c21-body-content .c21-cards .c21-card{position:relative;margin-bottom:20px;background-color:#fff;border-radius:16px;font-size:1.4em;line-height:1.4;color:#1a1a1a;overflow:hidden;-webkit-box-shadow:0 4px 15px 0 rgba(0,0,0,.2),0 1px 2px 0 rgba(0,0,0,.2);z-index:20;text-align:left}#chat21-home-component .c21-footer-content{position:absolute;width:100%;height:40px;bottom:40px;display:flex;align-items:center;justify-content:center;background-color:#fff;z-index:20;gap:10px}#chat21-home-component .c21-footer-content .label-item{line-height:20px;position:relative;margin:0 10px;color:#777;font-size:1.2em}#chat21-home-component .c21-footer-content #c21-whatsapp .c21-button-primary,#chat21-home-component .c21-footer-content #c21-telegram .c21-button-primary,#chat21-home-component .c21-footer-content #c21-messanger .c21-button-primary{background-color:transparent;color:#fff;margin:0;padding:5px;height:35px;width:35px;display:flex;justify-content:center}#chat21-home-component .c21-footer-content #c21-whatsapp:hover svg,#chat21-home-component .c21-footer-content #c21-telegram:hover svg,#chat21-home-component .c21-footer-content #c21-messanger:hover svg{transform:scale(1.2)}#chat21-home-component .c21-footer{position:absolute;width:100%;height:40px;bottom:0;display:flex;background-color:#fff;z-index:20}#chat21-home-component .c21-footer#c21-powered-by{display:block!important}#chat21-home-component .c21-footer .c21-powered-by{height:40px;text-align:center;padding:0;position:absolute;color:#aaa;top:0;left:20px;display:flex;align-items:center}#chat21-home-component .c21-footer .c21-powered-by a{text-decoration:none;cursor:pointer;display:inline-block;color:#aaa;font-size:1.1em;font-weight:500;line-height:22px;font-family:Mulish,sans-serif;letter-spacing:-.24px;-webkit-font-smoothing:antialiased}#chat21-home-component .c21-footer .c21-powered-by a span{display:inline-block;position:relative;top:2px}#chat21-home-component .c21-footer .c21-powered-by a img{width:80px;height:auto;max-height:40px;position:relative;vertical-align:middle;object-fit:contain}#chat21-home-component .c21-footer .c21-powered-by b{font-weight:bolder}#chat21-home-component .c21-footer .build_version{display:none;font-size:1em;color:#aaa;position:absolute;bottom:0;right:40px;line-height:30px}#chat21-home-component .c21-footer #c21-powered-by{width:calc(100% - 40px)}#chat21-home-component .c21-footer #c21-powered-by:hover div.build_version{display:block}@media (max-width: 451px){#tiledesk-container .c21-header-button.close{display:flex}}\n"],encapsulation:2}),i})();const Pi=["afallconv"],ki=function(i,a){return{color:i,"background-image":a}},Pn=function(i){return{fill:i}},Ai=function(i){return{color:i}};let Ii=(()=>{class i{constructor(e,n,o){this.g=e,this.iterableDiffers=n,this.customTranslateService=o,this.onConversationSelected=new t.vpe,this.onCloseWidget=new t.vpe,this.convertMessage=Et,this.subscriptions=[],this.logger=ve.getInstance(),this.iterableDifferListConv=this.iterableDiffers.find([]).create(null),this.iterableDifferListArchivedConv=this.iterableDiffers.find([]).create(null)}ngOnInit(){this.initialize()}ngAfterViewInit(){setTimeout(()=>{this.afallconv&&this.afallconv.nativeElement.focus()},1e3)}ngDoCheck(){let e=this.iterableDifferListConv.diff(this.listConversations),n=this.iterableDifferListArchivedConv.diff(this.archivedConversations);(e||n)&&this.concatAndOrderArray()}initTranslations(){this.translationMapConversation=this.customTranslateService.translateLanguage(["CLOSED"])}initialize(){this.logger.debug("[LISTALLCONVERSATIONS] initialize"),this.initTranslations(),this.LABEL_START_NW_CONV=this.g.LABEL_START_NW_CONV,this.allConversations=[],this.logger.debug("[LISTALLCONVERSATIONS] listconversations",this.listConversations,this.archivedConversations),this.concatAndOrderArray()}concatAndOrderArray(){let e;if(this.listConversations&&this.listConversations.length>0?e=this.archivedConversations&&this.archivedConversations.length>0?this.listConversations.concat(this.archivedConversations):this.listConversations:this.archivedConversations&&this.archivedConversations.length>0&&(e=this.archivedConversations),!e)return;const n=[],o=new Map;for(const r of e)o.has(r.uid)||(o.set(r.uid,!0),n.push(r));this.allConversations=n,this.allConversations.sort(function eo(i,a="asc"){return function(e,n){if(!e.hasOwnProperty(i)||!n.hasOwnProperty(i))return 0;const o="string"==typeof e[i]?e[i].toUpperCase():e[i],r="string"==typeof n[i]?n[i].toUpperCase():n[i];let v=0;return o>r?v=1:o<r&&(v=-1),"desc"===a?-1*v:v}}("timestamp","desc")),this.logger.debug("[LISTALLCONVERSATIONS] concatAndOrderArray ",this.allConversations)}returnClosePage(){this.onCloseWidget.emit()}onConversationSelectedFN(e){this.logger.debug("[LISTALLCONVERSATIONS] openConversationByID: ",e),e&&this.onConversationSelected.emit(e)}onImageLoadedFN(e){this.logger.debug("[LISTALLCONVERSATIONS] onImageLoadedFN",e)}onConversationLoadedFN(e){this.logger.debug("[LISTALLCONVERSATIONS] onImageLoadedFN",e)}ngOnDestroy(){this.logger.debug("[LISTALLCONVERSATIONS] ngOnDestroy ->list conv subscriptions",this.subscriptions)}unsubscribe(){this.subscriptions.forEach(function(e){e.unsubscribe()}),this.subscriptions=[],this.allConversations=[],this.listConversations=[],this.archivedConversations=[]}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(t.ZZ4),t.Y36(Xe))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-list-all-conversations"]],viewQuery:function(e,n){if(1&e&&t.Gf(Pi,5),2&e){let o;t.iGM(o=t.CRH())&&(n.afallconv=o.first)}},inputs:{listConversations:"listConversations",archivedConversations:"archivedConversations",stylesMap:"stylesMap"},outputs:{onConversationSelected:"onConversationSelected",onCloseWidget:"onCloseWidget"},decls:21,vars:19,consts:[["id","c21-app-list-all-conversations"],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-content"],[1,"c21-header-button","c21-right","c21-close"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],["tabindex","1310","aria-label","indietro",1,"c21-header-button","c21-left","c21-button-clean",3,"click"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],[1,"c21-title",3,"ngStyle"],[1,"titleText"],["tabindex","1311","onFocus","document.querySelector('[start-focus]').focus()",1,"c21-body"],[3,"listConversations","stylesMap","translationMap","onConversationSelected","onImageLoaded","onConversationLoaded"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t.O4$(),t.TgZ(5,"svg",5),t._UZ(6,"path",6)(7,"path",7),t.TgZ(8,"title",8),t._uU(9),t.qZA()()(),t.kcU(),t.TgZ(10,"button",9),t.NdJ("click",function(){return n.returnClosePage()}),t.O4$(),t.TgZ(11,"svg",5),t._UZ(12,"path",6)(13,"path",10),t.TgZ(14,"title",8),t._uU(15),t.qZA()()(),t.kcU(),t.TgZ(16,"div",11)(17,"div",12),t._uU(18),t.qZA()()()()(),t.TgZ(19,"div",13)(20,"chat-list-conversations",14),t.NdJ("onConversationSelected",function(r){return n.onConversationSelectedFN(r)})("onImageLoaded",function(r){return n.onImageLoadedFN(r)})("onConversationLoaded",function(r){return n.onConversationLoadedFN(r)}),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngStyle",t.WLB(10,ki,n.g.themeForegroundColor,n.g.colorGradient180)),t.xp6(4),t.Q6J("ngStyle",t.VKq(13,Pn,n.g.themeForegroundColor)),t.xp6(4),t.Oqu(n.g.BUTTON_CLOSE_TO_ICON),t.xp6(2),t.Q6J("ngStyle",t.VKq(15,Pn,n.g.themeForegroundColor)),t.xp6(4),t.Oqu(n.g.PREV_CONVERSATIONS),t.xp6(1),t.Q6J("ngStyle",t.VKq(17,Ai,n.g.themeForegroundColor)),t.xp6(2),t.Oqu(n.g.project.widgetTitle),t.xp6(2),t.Q6J("listConversations",n.allConversations)("stylesMap",n.stylesMap)("translationMap",n.translationMapConversation))},dependencies:[ue.PC,xn],styles:["#c21-app-list-all-conversations[_ngcontent-%COMP%]{display:block;height:auto;font-size:10px;background-color:#fff;width:100%;height:100%;position:relative;margin:0;padding:0}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{overflow:hidden;width:100%;height:52px;position:relative;margin:0;padding:0}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;font-size:1em;line-height:40px;text-align:left}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .avatar-project[_ngcontent-%COMP%]{position:relative;padding:0;margin:0 10px 0 0;float:left;height:42px;width:42px;line-height:42px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{font-size:16px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{max-width:30px;max-height:30px;margin:6px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{position:relative;height:52px;width:100%;margin:0 auto}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-writing[_ngcontent-%COMP%]{position:absolute;bottom:3px;width:100%;text-align:center;margin:0;padding:0;font-size:1.1em;color:#fff}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-pallozzo[_ngcontent-%COMP%]{display:inline}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]{position:relative;width:52px;height:52px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:calc(100% - 52px);top:0;font-size:1em;box-shadow:none;overflow:auto}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]{width:100%;height:auto;position:relative;margin:auto;padding:0;cursor:pointer;-webkit-appearance:initial;border:none;border-bottom:1px solid #eeeeee;background-color:#fff;text-align:left}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]{width:auto;margin:0 24px;position:relative;display:flex;align-items:center;height:80px;text-align:left}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]{width:auto;height:100%;float:left;display:flex;align-items:center}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:14px;color:#fff;font-weight:500}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-left-conv[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:2px 0 0;background-repeat:no-repeat;background-position:center;background-size:cover}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]{width:calc(100% - 65px);margin-left:15px;height:auto;float:left;padding:17px 0}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-last-time[_ngcontent-%COMP%]{font-size:.8em;color:#aaa;float:right;display:block;padding:0;margin:0;width:auto;height:auto}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-name[_ngcontent-%COMP%]{font-weight:700;color:#3a3c4c;font-size:1.3em;line-height:1.7;min-height:20px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .c21-msg[_ngcontent-%COMP%]{font-weight:200;color:#3a3c4c;font-size:1.3em;line-height:1.7;max-height:21px}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]   .c21-body-conv[_ngcontent-%COMP%]   .c21-right-conv[_ngcontent-%COMP%]   .not-read.c21-msg[_ngcontent-%COMP%]{font-weight:500}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:hover, #c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:focus, #c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-item-conversation[_ngcontent-%COMP%]:active{background-color:#fafafa}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:40px;left:inherit;right:10px;width:10px;height:10px;min-width:10px;font-size:1.2em;line-height:10px;border-radius:50%;background-color:red;color:#fff;font-weight:700;padding:0;text-align:center;margin-right:0;display:inline-block}#c21-app-list-all-conversations[_ngcontent-%COMP%]   .c21-lablel-close[_ngcontent-%COMP%]{border:1px solid #e2e2e2;background-color:#ececec;padding:4px;border-radius:4px;position:absolute;right:0;bottom:2px;margin-right:-10px;color:#858585;font-weight:500}"]}),i})();class Ri{constructor(a){this.createdAt=new Date,this.file=a}}var be=_e(4006),kn=_e(5183);const Li=["chat21_file"],An=function(i,a,e){return{"background-color":i,"border-color":a,color:e}};function Ni(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.onContinueConversation())}),t.TgZ(1,"span",11),t._uU(2),t.qZA(),t._UZ(3,"div",12),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("ngStyle",t.kEZ(2,An,e.stylesMap.get("themeColor"),e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(2),t.hij(" ",null==e.translationMap?null:e.translationMap.get("CONTINUE")," ")}}const Fi=function(){return{fill:"yellow"}},Bi=function(i){return{fill:i}};function Ui(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",5)(1,"button",6,7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openNewConversation())}),t.TgZ(3,"span",8),t.O4$(),t.TgZ(4,"svg",9),t._UZ(5,"path",10),t.qZA()(),t.kcU(),t.TgZ(6,"span",11),t._uU(7),t.qZA(),t._UZ(8,"div",12),t.qZA(),t.YNc(9,Ni,4,6,"button",13),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.kEZ(5,An,e.stylesMap.get("themeColor"),e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(3),t.Q6J("ngStyle",t.DdM(9,Fi)),t.xp6(1),t.Q6J("ngStyle",t.VKq(10,Bi,null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(2),t.hij(" ",null==e.translationMap?null:e.translationMap.get("LABEL_START_NW_CONV")," "),t.xp6(2),t.Q6J("ngIf",e.showContinueConversationButton)}}function Di(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",15)(1,"textarea",16,17),t.NdJ("ngModelChange",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.textInputTextArea=o)})("ngModelChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onTextAreaChange())})("keypress",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onkeypress(o))})("keydown",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onkeydown(o))})("paste",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onPaste(o))}),t._uU(3),t.qZA()()}if(2&i){const e=t.oxw();t.ekj("disabled",!(!e.isConversationArchived&&!e.hideTextReply)||null),t.xp6(1),t.Q6J("ngModel",e.textInputTextArea),t.uIk("disabled",!!e.hideTextReply||null)("placeholder",e.footerMessagePlaceholder?e.footerMessagePlaceholder:null==e.translationMap?null:e.translationMap.get("LABEL_PLACEHOLDER")),t.xp6(2),t.hij('    \x3c!-- placeholder="',null==e.translationMap?null:e.translationMap.get("LABEL_PLACEHOLDER"),'"> --\x3e\n  ')}}const Hi=function(){return{display:"block",height:"1px",width:"1px",overflow:"hidden"}};function Zi(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"label",29)(1,"span",8),t.O4$(),t.TgZ(2,"svg",30),t._UZ(3,"path",31),t.qZA()(),t.kcU(),t.TgZ(4,"input",32,33),t.NdJ("change",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.detectFiles(o))}),t.qZA()()}if(2&i){const e=t.oxw(2);t.ekj("active",!e.isFilePendingToUpload&&!e.hideTextReply),t.xp6(4),t.Q6J("accept",e.fileUploadAccept)("ngStyle",t.DdM(5,Hi)),t.uIk("disabled",!!(e.isFilePendingToUpload||e.isConversationArchived||e.hideTextReply)||null)}}function zi(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",null,18),t.YNc(2,Zi,6,6,"label",19),t.TgZ(3,"div",20),t.NdJ("click",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onSendPressed(o))}),t.TgZ(4,"span",8),t.O4$(),t.TgZ(5,"svg",21),t._UZ(6,"path",22),t.qZA()()(),t.kcU(),t.TgZ(7,"label",23),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onEmojiiPickerClicked())}),t.TgZ(8,"span",8),t.O4$(),t.TgZ(9,"svg",24),t._UZ(10,"path",25)(11,"circle",26)(12,"circle",27)(13,"path",28),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",1==e.showAttachmentButton),t.xp6(1),t.ekj("active",e.textInputTextArea&&!e.hideTextReply),t.xp6(4),t.ekj("active",!e.isFilePendingToUpload&&!e.hideTextReply)}}function ji(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"emoji-mart",34),t.NdJ("emojiSelect",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.addEmoji(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("showPreview",e.emojiiOptions.showPreview)("color",null==e.stylesMap?null:e.stylesMap.get("themeColor"))("perLine",e.emojiiOptions.emojiPerLine)("totalFrequentLines",e.emojiiOptions.totalFrequentLines)("enableSearch",e.emojiiOptions.enableSearch)("darkMode",e.emojiiOptions.darkMode)("include",e.emojiiOptions.include)}}let In=(()=>{class i{constructor(e,n,o,r){this.g=e,this.chatManager=n,this.typingService=o,this.uploadService=r,this.onEmojiiPickerShow=new t.vpe,this.onBeforeMessageSent=new t.vpe,this.onAfterSendMessage=new t.vpe,this.onChangeTextArea=new t.vpe,this.onAttachmentFileButtonClicked=new t.vpe,this.onNewConversationButtonClicked=new t.vpe,this.onBackButton=new t.vpe,this.isFilePendingToUpload=!1,this.arrayFilesLoad=[],this.isFileSelected=!1,this.HEIGHT_DEFAULT="20px",this.showEmojiPicker=!1,this.emojiiOptions={emojiPerLine:9,totalFrequentLines:1,showPreview:!1,darkMode:!1,enableSearch:!1,include:["recent","people","nature","activity"]},this.convertColorToRGBA=ke,this.logger=ve.getInstance()}ngOnInit(){}ngOnChanges(e){e.conversationWith&&void 0!==e.conversationWith.currentValue&&(this.conversationHandlerService=this.chatManager.getConversationHandlerByConversationId(this.conversationWith)),e.hideTextReply&&void 0!==e.hideTextReply.currentValue&&this.restoreTextArea(),e.dropEvent&&void 0!==e.dropEvent.currentValue&&this.onDrop(this.dropEvent)}ngAfterViewInit(){this.logger.debug("[CONV-FOOTER] --------ngAfterViewInit: conversation-footer-------- "),this.showEmojiPicker=!0}detectFiles(e){if(this.logger.debug("[CONV-FOOTER] detectFiles: ",e),e){this.selectedFiles=e.target.files,this.logger.debug("[CONV-FOOTER] AppComponent:detectFiles::selectedFiles",this.selectedFiles),this.isFilePendingToUpload=null!=this.selectedFiles,this.logger.debug("[CONV-FOOTER] AppComponent:detectFiles::selectedFiles::isFilePendingToUpload",this.isFilePendingToUpload),this.logger.debug("[CONV-FOOTER] fileChange: ",e.target.files),this.isFilePendingToUpload=!(e.target.files.length<=0);const n=this;if(e.target.files&&e.target.files[0]){const o=e.target.files[0].name,r=e.target.files[0].type,v=new FileReader;n.logger.debug("[CONV-FOOTER] OK preload: ",o,r,v),v.addEventListener("load",function(){if(n.logger.debug("[CONV-FOOTER] addEventListener load",v.result),n.isFileSelected=!0,r.startsWith("image")&&!r.includes("svg")){const P=new Image;n.logger.debug("[CONV-FOOTER] onload ",P),P.src=v.result.toString(),P.title=o,P.onload=function(){n.logger.debug("[CONV-FOOTER] onload image");const Y=(new Date).getTime().toString(36);n.arrayFilesLoad[0]={uid:Y,file:P,type:r},n.logger.debug("[CONV-FOOTER] OK: ",n.arrayFilesLoad[0]),n.loadFile()}}else{n.logger.debug("[CONV-FOOTER] onload file");const P={src:v.result.toString(),title:o},Y=(new Date).getTime().toString(36);n.arrayFilesLoad[0]={uid:Y,file:P,type:r},n.logger.debug("[CONV-FOOTER] OK: ",n.arrayFilesLoad[0]),n.loadFile()}},!1),e.target.files[0]&&(v.readAsDataURL(e.target.files[0]),n.logger.debug("[CONV-FOOTER] reader-result: ",e.target.files[0]))}}}loadFile(){if(this.logger.debug("[CONV-FOOTER] that.fileXLoad: ",this.arrayFilesLoad),this.arrayFilesLoad[0]&&this.arrayFilesLoad[0].file){const e=this.arrayFilesLoad[0].file,n=this.arrayFilesLoad[0].uid,o=this.arrayFilesLoad[0].type;let r;this.logger.debug("[CONV-FOOTER] that.fileXLoad: ",o),r=o.startsWith("image")&&!o.includes("svg")?{name:e.title,src:e.src,width:e.width,height:e.height,type:o,uid:n}:{name:e.title,src:e.src,type:o,uid:n},this.logger.debug("[CONV-FOOTER] metadata -------\x3e ",r);const v=this.selectedFiles.item(0);this.onAttachmentFileButtonClicked.emit({attachments:[{metadata:r,file:v}],message:this.textInputTextArea}),this.restoreTextArea(),this.chat21_file.nativeElement.value=""}}uploadSingle(e,n,o){const r=this;document.getElementById("chat21-start-upload-doc").disabled=!0,r.logger.debug("[CONV-FOOTER] AppComponent::uploadSingle::",e,n);const P=new Ri(n);this.uploadService.upload(this.senderId,P).then(Y=>{r.logger.debug("[CONV-FOOTER] AppComponent::uploadSingle:: downloadURL",Y),r.logger.debug(`[CONV-FOOTER] Successfully uploaded file and got download link - ${Y}`),e.src=Y;let X=F,ae=`[${e.name}](${e.src})`;e.type.startsWith("image")&&!e.type.includes("svg")?(X=W,ae=o):e.type.startsWith("image")&&e.type.includes("svg")||!e.type.startsWith("image")?(X=E,ae=ae+"\n"+o):e.type.startsWith("image")||(X=E,ae=ae+"\n"+o),r.sendMessage(ae,X,e),r.chat21_file.nativeElement.value="",r.isFilePendingToUpload=!1}).catch(Y=>{r.logger.error(`[CONV-FOOTER] uploadSingle:: Failed to upload file and get link - ${Y}`),r.isFilePendingToUpload=!1}),r.logger.debug("[CONV-FOOTER] reader-result: ",n)}sendMessage(e,n,o,r){if(o||(o=""),this.onEmojiiPickerShow.emit(!1),this.logger.debug("[CONV-FOOTER] SEND MESSAGE: ",e,n,o,r),e&&""!==e.trim()||n===W||n===E){let v=this.translationMap.get("GUEST_LABEL");const P=this.attributes,Y={};if(P)for(const[Se,Fe]of Object.entries(P))Y[Se]=Fe;if(r)for(const[Se,Fe]of Object.entries(r))Y[Se]=Fe;const X=this.senderId,ae=this.projectid,fe=this.channelType,de=this.userEmail,we=this.conversationWith;v=this.userFullname||de||(Y&&Y.userFullname?Y.userFullname:this.translationMap.get("GUEST_LABEL")),this.onBeforeMessageSent.emit({senderFullname:v,text:e,type:n,metadata:o,conversationWith:we,recipientFullname:v,attributes:Y,projectid:ae,channelType:fe});const ye=this.conversationHandlerService.sendMessage(e,n,o,we,v,X,v,fe,Y);this.onAfterSendMessage.emit(ye);try{const Se=document.getElementById("chat21-main-message-context");Se.value="",Se.style.height=this.HEIGHT_DEFAULT}catch(Se){this.logger.error("[CONV-FOOTER] > Error :"+Se)}this.restoreTextArea()}}restoreTextArea(){this.resizeInputField();const e=document.getElementById("chat21-main-message-context");this.textInputTextArea="",e&&(e.value="",e.placeholder=this.translationMap.get("LABEL_PLACEHOLDER"),e.style.height>this.HEIGHT_DEFAULT&&document.getElementById("chat21-button-send").style.removeProperty("right"),this.logger.debug("[CONV-FOOTER] AppComponent:restoreTextArea::restoreTextArea::textArea:","restored")),this.setFocusOnId("chat21-main-message-context")}resizeInputField(){try{const e=document.getElementById("chat21-main-message-context");e&&(e.style.height="100%"),e&&"\n"===e.value?(e.value="",e.style.height=this.HEIGHT_DEFAULT):e&&e.scrollHeight>e.offsetHeight?(e.style.height=e.scrollHeight+2+"px",e.style.minHeight=this.HEIGHT_DEFAULT):e&&(e.style.height=this.HEIGHT_DEFAULT),this.onChangeTextArea.emit({textAreaEl:e,minHeightDefault:this.HEIGHT_DEFAULT})}catch(e){this.logger.error("[CONV-FOOTER] > Error :"+e)}}onTextAreaChange(){this.resizeInputField(),this.setWritingMessages(this.textInputTextArea)}onSendPressed(e){this.logger.debug("[CONV-FOOTER] onSendPressed:event",e),e.preventDefault(),this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed::isFilePendingToUpload:",this.isFilePendingToUpload),this.isFilePendingToUpload?(this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed","is a file"),this.loadFile(),this.isFilePendingToUpload=!1,this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed::isFilePendingToUpload:",this.isFilePendingToUpload)):this.textInputTextArea&&this.textInputTextArea.length>0&&(this.logger.debug("[CONV-FOOTER] AppComponent::onSendPressed","is a message"),""!==this.textInputTextArea.trim()&&this.sendMessage(this.textInputTextArea,F))}onEmojiiPickerClicked(){this.onEmojiiPickerShow.emit(!this.isEmojiiPickerShow)}addEmoji(e){this.onEmojiiPickerShow.emit(!1),this.textInputTextArea=this.textInputTextArea.trimStart()+e.emoji.native+" ",this.setFocusOnId("chat21-main-message-context")}openNewConversation(){this.onNewConversationButtonClicked.emit()}onContinueConversation(){this.hideTextAreaContent=!1,this.onBackButton.emit(!1),this.restoreTextArea()}onBackButtonFN(){this.onBackButton.emit(!1)}setFocusOnId(e){this.isMobile||setTimeout(function(){const n=document.getElementById(e);n&&(n.setAttribute("value"," "),n.focus())},500)}removeFocusOnId(e){const n=document.getElementById(e);n&&n.blur()}setWritingMessages(e){this.typingService.setTyping(this.conversationWith,e,this.senderId,this.userFullname)}onkeypress(e){const n=e.which||e.keyCode;this.textInputTextArea=document.getElementById("chat21-main-message-context").value,13===n?this.textInputTextArea&&""!==this.textInputTextArea.trim()&&this.sendMessage(this.textInputTextArea,F):9===n&&e.preventDefault()}onkeydown(e){(e.metaKey||e.shiftKey||e.altKey||e.ctrlKey)&&13===(e.which||e.keyCode)&&(e.preventDefault(),this.textInputTextArea+="\r\n",this.resizeInputField())}onPaste(e){this.resizeInputField();const n=(e.clipboardData||e.originalEvent.clipboardData).items;let o=null;this.logger.debug("[CONV-FOOTER] onPaste items ",n);for(const r of n)if(this.logger.debug("[CONV-FOOTER] onPaste item ",r),this.logger.debug("[CONV-FOOTER] onPaste item.type ",r.type),r.type.startsWith("image")){try{this.restoreTextArea()}catch(P){this.logger.error("[CONV-FOOTER] onPaste - error while restoring textArea:",P)}this.logger.debug("[CONV-FOOTER] onPaste item.type",r.type),o=r.getAsFile();const v={target:new ClipboardEvent("").clipboardData||new DataTransfer};v.target.items.add(new File([o],o.name,{type:o.type})),this.logger.debug("[CONV-FOOTER] onPaste data",v),this.logger.debug("[CONV-FOOTER] onPaste file ",o),this.detectFiles(v)}}onDrop(e){const n=e.dataTransfer.files;this.logger.debug("[CONV-FOOTER] onDrop items ",n);for(const r of n){this.logger.debug("[CONV-FOOTER] onDrop item ",r),this.logger.debug("[CONV-FOOTER] onDrop item.type ",r.type);const v={target:{files:new DataTransfer}};v.target.files=n,this.logger.debug("[CONV-FOOTER] onDrop data",v),this.logger.debug("[CONV-FOOTER] onDrop file ",null),this.detectFiles(v)}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(bt),t.Y36(it),t.Y36(rt))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-conversation-footer"]],viewQuery:function(e,n){if(1&e&&t.Gf(Li,5),2&e){let o;t.iGM(o=t.CRH())&&(n.chat21_file=o.first)}},inputs:{conversationWith:"conversationWith",attributes:"attributes",senderId:"senderId",tenant:"tenant",projectid:"projectid",channelType:"channelType",userFullname:"userFullname",userEmail:"userEmail",showAttachmentButton:"showAttachmentButton",showContinueConversationButton:"showContinueConversationButton",isConversationArchived:"isConversationArchived",hideTextAreaContent:"hideTextAreaContent",hideTextReply:"hideTextReply",isMobile:"isMobile",isEmojiiPickerShow:"isEmojiiPickerShow",footerMessagePlaceholder:"footerMessagePlaceholder",fileUploadAccept:"fileUploadAccept",stylesMap:"stylesMap",translationMap:"translationMap",dropEvent:"dropEvent"},outputs:{onEmojiiPickerShow:"onEmojiiPickerShow",onBeforeMessageSent:"onBeforeMessageSent",onAfterSendMessage:"onAfterSendMessage",onChangeTextArea:"onChangeTextArea",onAttachmentFileButtonClicked:"onAttachmentFileButtonClicked",onNewConversationButtonClicked:"onNewConversationButtonClicked",onBackButton:"onBackButton"},features:[t.TTD],decls:5,vars:6,consts:[["id","floating-container","class","fade-in-bottom","start-focus-chat21-conversation-component","",4,"ngIf"],["class","visible-text-area",3,"disabled",4,"ngIf"],[4,"ngIf"],[1,"emoji-container"],["id","emoji-mart","class","emoji-mart",3,"showPreview","color","perLine","totalFrequentLines","enableSearch","darkMode","include","emojiSelect",4,"ngIf"],["id","floating-container","start-focus-chat21-conversation-component","",1,"fade-in-bottom"],["tabindex","1040","aflistconv","",1,"c21-button-primary",3,"ngStyle","click"],["aflistconv",""],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",3,"ngStyle"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",3,"ngStyle"],[1,"v-align-center","c21-label-button"],[1,"clear"],["tabindex","1040","class","c21-button-primary",3,"ngStyle","click",4,"ngIf"],["tabindex","1040",1,"c21-button-primary",3,"ngStyle","click"],[1,"visible-text-area"],["start-focus-chat21-conversation-component","","inputTextArea","","tabindex","1501","aria-labelledby","altTextArea","rows","1","id","chat21-main-message-context",1,"f21textarea","c21-button-clean",3,"ngModel","ngModelChange","keypress","keydown","paste"],["textbox",""],["div_attached",""],["tabindex","1502","aria-label","allegati","for","chat21-file","class","chat21-textarea-button","id","chat21-start-upload-doc",3,"active",4,"ngIf"],["tabindex","-1","id","chat21-button-send",1,"chat21-textarea-button",3,"click"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","height","24","width","24","viewBox","0 0 24 24",0,"xml","space","preserve",2,"enable-background","new 0 0 24 24"],["d","M1.8,18.9V1.7L22,10.3L1.8,18.9z M3.9,15.6l12.6-5.4L3.9,4.9v3.7l6.4,1.6l-6.4,1.6V15.6z M3.9,15.6V4.9v7V15.6z"],["tabindex","1504","aria-label","emojii","for","chat21-emojii","id","chat21-emoticon-picker",1,"chat21-textarea-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 28 28"],["d","M0 0h24v24H0V0z","fill","none"],["cx","15.5","cy","9.5","r","1.5"],["cx","8.5","cy","9.5","r","1.5"],["d","M12 16c-1.48 0-2.75-.81-3.45-2H6.88c.8 2.05 2.79 3.5 5.12 3.5s4.32-1.45 5.12-3.5h-1.67c-.7 1.19-1.97 2-3.45 2zm-.01-14C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"],["tabindex","1502","aria-label","allegati","for","chat21-file","id","chat21-start-upload-doc",1,"chat21-textarea-button"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 28 28","transform","rotate(45)"],["d","M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"],["tabindex","1503","type","file","aria-label","seleziona allegato","name","chat21-file","id","chat21-file",1,"inputfile",3,"accept","ngStyle","change"],["chat21_file",""],["id","emoji-mart",1,"emoji-mart",3,"showPreview","color","perLine","totalFrequentLines","enableSearch","darkMode","include","emojiSelect"]],template:function(e,n){1&e&&(t.YNc(0,Ui,10,12,"div",0),t.YNc(1,Di,4,6,"div",1),t.YNc(2,zi,14,5,"div",2),t.TgZ(3,"div",3),t.YNc(4,ji,1,7,"emoji-mart",4),t.qZA()),2&e&&(t.Q6J("ngIf",n.hideTextAreaContent),t.xp6(1),t.Q6J("ngIf",!n.hideTextAreaContent),t.xp6(1),t.Q6J("ngIf",!n.hideTextAreaContent),t.xp6(1),t.Udp("visibility",n.isEmojiiPickerShow?"visible":"hidden"),t.xp6(1),t.Q6J("ngIf",n.showEmojiPicker))},dependencies:[ue.O5,ue.PC,be.Fj,be.JJ,be.On,kn.qP],styles:[".visible-text-area[_ngcontent-%COMP%]{pointer-events:auto;border-radius:16px;background-color:#f6f7fb}.visible-text-area.disabled[_ngcontent-%COMP%]{background-color:#e8e9ed}.chat21-textarea-button[_ngcontent-%COMP%]{fill:#5f6368;pointer-events:auto}textarea[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]:visited, textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:active{all:unset}#button[_ngcontent-%COMP%]{position:absolute;bottom:12px;display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:1}#button.chat-open[_ngcontent-%COMP%]:not(.sidebar){right:5px;left:auto;background-color:#fff}#button[_ngcontent-%COMP%]:not(.sidebar)   .buttonWave[_ngcontent-%COMP%]{position:absolute;z-index:-1;width:60px;height:60px}#button-body[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:28px;border-color:transparent;display:inherit;align-items:center;justify-content:center;pointer-events:initial;transition:all .2s ease-in-out 0s;position:relative;box-shadow:#03060c80 0 4px 10px}#chat21-buttonToBottom[_ngcontent-%COMP%]{display:flex;position:relative;margin-right:-25px;margin-top:-40px;float:right;width:30px;height:30px;border-radius:50%;z-index:1;cursor:pointer;background-color:#fff;border:1px solid rgba(191,191,191,.2);text-align:center}#chat21-buttonToBottom[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:auto;fill:#aaa}#chat21-buttonToBottom[_ngcontent-%COMP%]:hover{background-color:#2a6ac1;opacity:1!important;transition:all .45s ease-in-out!important;-moz-transition:all .45s ease-in-out!important;-webkit-transition:all .45s ease-in-out!important;border:1px solid #ffffff}#chat21-buttonToBottom[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:#fff}textarea[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]:visited, textarea[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:active{all:unset}#chat21-main-message-context[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word;resize:horizontal;overflow-y:auto;box-sizing:border-box;color:#1a1a1a;min-width:100%;outline:0;resize:none;font-size:1.4em;line-height:1.4em;font-weight:300;max-height:110px;min-height:auto;height:20px;padding:0 12px;margin:10px 0;border:none}#chat21-main-message-context[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}#chat21-main-message-context[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}#chat21-main-message-context[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}.chat21-textarea-button[_ngcontent-%COMP%]{position:absolute;display:block;height:56px;bottom:22px;opacity:.3;cursor:initial}.chat21-textarea-button.active[_ngcontent-%COMP%]{opacity:1;cursor:pointer}.chat21-textarea-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover{background:rgba(240,240,240,.4)!important;opacity:1!important;transition:all .45s ease-in-out 0s!important;-moz-transition:all .45s ease-in-out 0s!important;-webkit-transition:all .45s ease-in-out 0s!important;padding:0;margin:0;border-radius:50%}.chat21-back-button[_ngcontent-%COMP%]{position:absolute;display:block;height:56px;cursor:pointer}.chat21-back-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover{background:rgba(240,240,240,.4)!important;opacity:1!important;transition:all .45s ease-in-out 0s!important;-moz-transition:all .45s ease-in-out 0s!important;-webkit-transition:all .45s ease-in-out 0s!important;padding:0;margin:0;border-radius:50%}#chat21-button-send[_ngcontent-%COMP%]{right:8px;bottom:0}#chat21-file[_ngcontent-%COMP%]{left:8px;bottom:0}#chat21-emoticon-picker[_ngcontent-%COMP%]{left:36px;bottom:0}#chat21-start-upload-doc[_ngcontent-%COMP%], #chat21-start-mic[_ngcontent-%COMP%], #chat21-back-button[_ngcontent-%COMP%]{left:8px;bottom:0}#floating-container[_ngcontent-%COMP%]{width:100%;border-top:0px solid #eeeeee;display:inline-flex;align-items:center;justify-content:center;box-shadow:none;vertical-align:top;text-align:center}#floating-container[_ngcontent-%COMP%]   .c21-label-button[_ngcontent-%COMP%]{margin-left:8px;font-weight:400;font-size:1.2em}#floating-container[_ngcontent-%COMP%]   .c21-button-primary[_ngcontent-%COMP%]{height:36px;margin:5px 3px}#floating-container[_ngcontent-%COMP%]   .c21-waiting-time[_ngcontent-%COMP%]{font-size:1.3em;font-weight:200;padding:0 24px 5px}.fade-in-bottom[_ngcontent-%COMP%]{animation:fade-in-bottom .5s cubic-bezier(.6,-.28,.735,.045) 0s}.emoji-container[_ngcontent-%COMP%]{height:312px;position:absolute;overflow:hidden;width:93%;bottom:100%;z-index:10;left:10px;box-shadow:0 -15px 20px -13px #00000061;-webkit-box-shadow:0px -15px 20px -13px rgba(0,0,0,.38)}.emoji-mart[_ngcontent-%COMP%]{position:absolute;border:none;margin:-2px -2px 0}"]}),i})();const Vi=function(i){return{disabled:i}};let Gi=(()=>{class i{constructor(e){this.elementRef=e,this.isConversationArchived=!0,this.onButtonClicked=new t.vpe,this.type="action"}ngOnInit(){}ngOnChanges(e){this.fontSize&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--buttonFontSize",this.fontSize),this.backgroundColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--backgroundColor",this.backgroundColor),this.textColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--textColor",this.textColor),this.hoverBackgroundColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--hoverBackgroundColor",this.hoverBackgroundColor),this.hoverTextColor&&this.elementRef.nativeElement.querySelector(".action").style.setProperty("--hoverTextColor",this.hoverTextColor)}onMouseOver(e){}onMouseOut(e){}actionButtonAction(){if(this.button&&this.button.action&&""!==this.button.action){const e=this.elementRef.nativeElement.querySelector(".action");e&&(e.classList.contains("active")||e.classList.add("active"),setTimeout(function(){e.classList.contains("active")&&e.classList.remove("active")},400)),this.onButtonClicked.emit({target:this,currentTarget:this})}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-action-button-attachment"]],inputs:{button:"button",isConversationArchived:"isConversationArchived",fontSize:"fontSize",backgroundColor:"backgroundColor",textColor:"textColor",hoverBackgroundColor:"hoverBackgroundColor",hoverTextColor:"hoverTextColor"},outputs:{onButtonClicked:"onButtonClicked"},features:[t.TTD],decls:3,vars:5,consts:[["id","actionButton",1,"button-in-msg","action",3,"ngClass","title","click","mouseover","mouseout"],["actionButton",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0,1),t.NdJ("click",function(){return n.actionButtonAction()})("mouseover",function(r){return n.onMouseOver(r)})("mouseout",function(r){return n.onMouseOut(r)}),t._uU(2),t.qZA()),2&e&&(t.s9C("title",null==n.button?null:n.button.value),t.Q6J("ngClass",t.VKq(3,Vi,n.isConversationArchived)),t.xp6(2),t.hij(" ",null==n.button?null:n.button.value,"\n"))},dependencies:[ue.mk],styles:['[_nghost-%COMP%]{--backgroundColor: rgb(42, 106, 193);--textColor: rgb(98, 168, 234);--hoverBackgroundColor: rgb(98, 168, 234);--hoverTextColor: rgb(42, 106, 193);--buttonFontSize: 15px;--max-width: 280px}.button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important;position:relative;max-width:var(--max-width);min-width:inherit;cursor:pointer;border:1px solid var(--textColor);border-radius:20px;margin:3px;background:var(--backgroundColor);overflow:hidden;font-family:Muli,sans-serif;font-size:var(--buttonFontSize);text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--textColor);line-height:16px}.action[_ngcontent-%COMP%]{background:var(--backgroundColor);transition:background-color .6s ease}.action[_ngcontent-%COMP%]:focus, .action[_ngcontent-%COMP%]:hover{color:var(--hoverTextColor);background:var(--hoverBackgroundColor);transform:scale(1.05)}.action[_ngcontent-%COMP%]:focus   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]:hover   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--hoverTextColor)}.action[_ngcontent-%COMP%]:after{content:"";position:absolute;width:0;height:0;top:50%;left:50%;transform-style:flat;transform:translate3d(-50%,-50%,0);background:rgba(255,255,255,.2);border-radius:100%;transition:width .5s ease,height .5s ease}.action.active[_ngcontent-%COMP%]:after{width:200px;height:200px}.disabled[_ngcontent-%COMP%]{pointer-events:none}']}),i})();function qi(i,a){1&i&&(t.TgZ(0,"span",4),t.O4$(),t.TgZ(1,"svg",5),t._UZ(2,"path",6)(3,"path",7),t.qZA()())}function Wi(i,a){1&i&&(t.TgZ(0,"span",8),t.O4$(),t.TgZ(1,"svg",9),t._UZ(2,"path",6)(3,"path",7),t.qZA()())}let Yi=(()=>{class i{constructor(e){this.elementRef=e,this.onButtonClicked=new t.vpe,this.type="url"}ngOnInit(){}ngOnChanges(e){this.fontSize&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--buttonFontSize",this.fontSize),this.backgroundColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--backgroundColor",this.backgroundColor),this.textColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--textColor",this.textColor),this.hoverBackgroundColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--hoverBackgroundColor",this.hoverBackgroundColor),this.hoverTextColor&&this.elementRef.nativeElement.querySelector(".url").style.setProperty("--hoverTextColor",this.hoverTextColor)}onMouseOver(e){}onMouseOut(e){}actionButtonUrl(){this.button&&this.button.link&&""!==this.button.link&&this.onButtonClicked.emit({target:this,currentTarget:this})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-link-button-attachment"]],inputs:{button:"button",fontSize:"fontSize",backgroundColor:"backgroundColor",textColor:"textColor",hoverBackgroundColor:"hoverBackgroundColor",hoverTextColor:"hoverTextColor"},outputs:{onButtonClicked:"onButtonClicked"},features:[t.TTD],decls:5,vars:4,consts:[[1,"button-in-msg","url",3,"title","click","mouseover","mouseout"],["class","icon-button-action",4,"ngIf"],["class","icon-button-action-self",4,"ngIf"],[1,"clear"],[1,"icon-button-action"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","black","width","18px","height","18px",2,"transform","rotateZ(45deg)"],["d","M0 0h24v24H0z","fill","none"],["d","M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"],[1,"icon-button-action-self"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","black","width","18px","height","18px",2,"transform","rotateZ(90deg)"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return n.actionButtonUrl()})("mouseover",function(r){return n.onMouseOver(r)})("mouseout",function(r){return n.onMouseOut(r)}),t.YNc(1,qi,4,0,"span",1),t.YNc(2,Wi,4,0,"span",2),t._uU(3),t._UZ(4,"div",3),t.qZA()),2&e&&(t.s9C("title",null==n.button?null:n.button.value),t.xp6(1),t.Q6J("ngIf","self"!==(null==n.button?null:n.button.target)),t.xp6(1),t.Q6J("ngIf","self"===(null==n.button?null:n.button.target)),t.xp6(1),t.hij(" ",null==n.button?null:n.button.value," "))},dependencies:[ue.O5],styles:["[_nghost-%COMP%]{--backgroundColor: rgb(42, 106, 193);--textColor: rgb(98, 168, 234);--hoverBackgroundColor: rgb(98, 168, 234);--hoverTextColor: rgb(42, 106, 193);--buttonFontSize: 15px;--max-width: 280px}.button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important;position:relative;max-width:var(--max-width);min-width:inherit;cursor:pointer;border:1px solid var(--textColor);border-radius:20px;margin:3px;background:var(--backgroundColor);overflow:hidden;font-family:Muli,sans-serif;font-size:var(--buttonFontSize);text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--textColor);line-height:16px}.url[_ngcontent-%COMP%]{transition:background-color .6s ease}.url[_ngcontent-%COMP%]   .icon-button-action[_ngcontent-%COMP%]{position:absolute;top:-1px;right:1px}.url[_ngcontent-%COMP%]   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--textColor)}.url[_ngcontent-%COMP%]   .icon-button-action-self[_ngcontent-%COMP%]{position:absolute;right:1px}.url[_ngcontent-%COMP%]   .icon-button-action-self[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--textColor)}.url[_ngcontent-%COMP%]:focus, .url[_ngcontent-%COMP%]:hover{color:var(--hoverTextColor);background:var(--hoverBackgroundColor);transform:scale(1.05)}.url[_ngcontent-%COMP%]:focus   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .url[_ngcontent-%COMP%]:focus   .icon-button-action-self[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .url[_ngcontent-%COMP%]:hover   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .url[_ngcontent-%COMP%]:hover   .icon-button-action-self[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--hoverTextColor)}"]}),i})();const Ji=function(i){return{disabled:i}};let Qi=(()=>{class i{constructor(e){this.elementRef=e,this.onButtonClicked=new t.vpe,this.type="text"}ngOnInit(){}ngOnChanges(e){this.fontSize&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--buttonFontSize",this.fontSize),this.backgroundColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--backgroundColor",this.backgroundColor),this.textColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--textColor",this.textColor),this.hoverBackgroundColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--hoverBackgroundColor",this.hoverBackgroundColor),this.hoverTextColor&&this.elementRef.nativeElement.querySelector(".text").style.setProperty("--hoverTextColor",this.hoverTextColor)}onMouseOver(e){}onMouseOut(e){}actionButtonText(){this.onButtonClicked.emit({target:this,currentTarget:this})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-text-button-attachment"]],inputs:{button:"button",isConversationArchived:"isConversationArchived",fontSize:"fontSize",backgroundColor:"backgroundColor",textColor:"textColor",hoverBackgroundColor:"hoverBackgroundColor",hoverTextColor:"hoverTextColor"},outputs:{onButtonClicked:"onButtonClicked"},features:[t.TTD],decls:2,vars:5,consts:[[1,"button-in-msg","text",3,"ngClass","title","click","mouseover","mouseout"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return n.actionButtonText()})("mouseover",function(r){return n.onMouseOver(r)})("mouseout",function(r){return n.onMouseOut(r)}),t._uU(1),t.qZA()),2&e&&(t.s9C("title",null==n.button?null:n.button.value),t.Q6J("ngClass",t.VKq(3,Ji,n.isConversationArchived)),t.xp6(1),t.hij(" ",null==n.button?null:n.button.value,"\n"))},dependencies:[ue.mk],styles:["[_nghost-%COMP%]{--backgroundColor: rgb(42, 106, 193);--textColor: rgb(98, 168, 234);--hoverBackgroundColor: rgb(98, 168, 234);--hoverTextColor: rgb(42, 106, 193);--buttonFontSize: 15px;--max-width: 280px}.button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important;position:relative;max-width:var(--max-width);min-width:inherit;cursor:pointer;border:1px solid var(--textColor);border-radius:20px;margin:3px;background:var(--backgroundColor);overflow:hidden;font-family:Muli,sans-serif;font-size:var(--buttonFontSize);text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--textColor);line-height:16px}.text[_ngcontent-%COMP%]{transition:background-color .6s ease}.text[_ngcontent-%COMP%]:focus, .text[_ngcontent-%COMP%]:hover{color:var(--hoverTextColor);background:var(--hoverBackgroundColor);transform:scale(1.05)}.text[_ngcontent-%COMP%]:focus   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .text[_ngcontent-%COMP%]:hover   .icon-button-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#1a1a1a}.disabled[_ngcontent-%COMP%]{pointer-events:none}"]}),i})();function Ki(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-text-button-attachment",6),t.NdJ("onButtonClicked",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.returnOnAttachmentButtonClicked(o))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("button",e)("isConversationArchived",n.isConversationArchived)("fontSize",n.stylesMap.get("buttonFontSize"))("backgroundColor",n.stylesMap.get("buttonBackgroundColor"))("textColor",n.stylesMap.get("buttonTextColor"))("hoverBackgroundColor",n.stylesMap.get("buttonHoverBackgroundColor"))("hoverTextColor",n.stylesMap.get("buttonHoverTextColor"))}}function $i(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-link-button-attachment",7),t.NdJ("onButtonClicked",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.returnOnAttachmentButtonClicked(o))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("button",e)("fontSize",n.stylesMap.get("buttonFontSize"))("backgroundColor",n.stylesMap.get("buttonBackgroundColor"))("textColor",n.stylesMap.get("buttonTextColor"))("hoverBackgroundColor",n.stylesMap.get("buttonHoverBackgroundColor"))("hoverTextColor",n.stylesMap.get("buttonHoverTextColor"))}}function Xi(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-action-button-attachment",6),t.NdJ("onButtonClicked",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.returnOnAttachmentButtonClicked(o))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("button",e)("isConversationArchived",n.isConversationArchived)("fontSize",n.stylesMap.get("buttonFontSize"))("backgroundColor",n.stylesMap.get("buttonBackgroundColor"))("textColor",n.stylesMap.get("buttonTextColor"))("hoverBackgroundColor",n.stylesMap.get("buttonHoverBackgroundColor"))("hoverTextColor",n.stylesMap.get("buttonHoverTextColor"))}}function er(i,a){if(1&i&&(t.TgZ(0,"span",3),t.YNc(1,Ki,1,7,"chat-text-button-attachment",4),t.YNc(2,$i,1,6,"chat-link-button-attachment",5),t.YNc(3,Xi,1,7,"chat-action-button-attachment",4),t.qZA()),2&i){const e=a.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngIf","text"===e.type&&!0===n.isLastMessage),t.xp6(1),t.Q6J("ngIf","url"===e.type),t.xp6(1),t.Q6J("ngIf","action"===e.type&&!0===n.isLastMessage)}}let tr=(()=>{class i{constructor(){this.onAttachmentButtonClicked=new t.vpe,this.onElementRendered=new t.vpe}ngOnInit(){this.getAttachmentButton()}getAttachmentButton(){if(this.message&&this.message.attributes&&this.message.attributes.attachment){try{this.type=this.message.attributes.attachment.type}catch{return}try{this.buttons=this.message.attributes.attachment.buttons}catch{return}}}ngAfterViewInit(){this.onElementRendered.emit({element:"attachment",status:!0})}returnOnAttachmentButtonClicked(e){e&&e.target&&this.onAttachmentButtonClicked.emit({target:e.target,message:this.message,currentTarget:this})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-message-attachment"]],inputs:{message:"message",isConversationArchived:"isConversationArchived",isLastMessage:"isLastMessage",stylesMap:"stylesMap"},outputs:{onAttachmentButtonClicked:"onAttachmentButtonClicked",onElementRendered:"onElementRendered"},decls:3,vars:1,consts:[["id","buttons-in-message"],[1,"buttons-wrapper"],["class","div-button",4,"ngFor","ngForOf"],[1,"div-button"],["class","div-button",3,"button","isConversationArchived","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked",4,"ngIf"],["class","div-button",3,"button","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked",4,"ngIf"],[1,"div-button",3,"button","isConversationArchived","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked"],[1,"div-button",3,"button","fontSize","backgroundColor","textColor","hoverBackgroundColor","hoverTextColor","onButtonClicked"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,er,4,3,"span",2),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.buttons))},dependencies:[ue.sg,ue.O5,Gi,Yi,Qi],styles:["#buttons-in-message[_ngcontent-%COMP%]{text-align:right;display:block;margin-right:16px;height:auto;width:85%;float:right}#buttons-in-message[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]{margin-top:0;display:flex;flex-wrap:wrap;justify-content:flex-end;width:100%;border:none}#buttons-in-message[_ngcontent-%COMP%]   .div-button[_ngcontent-%COMP%]{display:inline-block}#buttons-in-message[_ngcontent-%COMP%]   .div-button[_ngcontent-%COMP%]   .button-in-msg[_ngcontent-%COMP%]{padding:8px 16px!important}#buttons-in-message.align-left[_ngcontent-%COMP%]{text-align:left;margin:4px 50px}"]}),i})();var Ht=_e(158);const nr=function(i,a){return{width:i,height:a}};function or(i,a){if(1&i&&t._UZ(0,"div",3),2&i){const e=t.oxw();t.Q6J("ngStyle",t.WLB(1,nr,e.width,e.height))}}const ir=function(i,a){return{"max-width":"100%",width:i,height:a}},rr=function(i){return{isLoadingImage:i}};let sr=(()=>{class i{constructor(e){this.sanitizer=e,this.onElementRendered=new t.vpe,this.url=null,this.loading=!0}ngOnInit(){this.metadata&&this.metadata.src&&(this.url=this.sanitizer.bypassSecurityTrustResourceUrl(this.metadata.src))}ngOnDestroy(){this.url=null}onLoaded(e){this.loading=!1,this.onElementRendered.emit({element:"frame",status:!0})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.H7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-frame"]],inputs:{metadata:"metadata",width:"width",height:"height"},outputs:{onElementRendered:"onElementRendered"},decls:3,vars:9,consts:[[3,"ngStyle"],["class","loader",3,"ngStyle",4,"ngIf"],["allowfullscreen","","width","100%","height","100%",3,"ngClass","src","load"],[1,"loader",3,"ngStyle"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,or,1,4,"div",1),t.TgZ(2,"iframe",2),t.NdJ("load",function(r){return n.onLoaded(r)}),t.qZA()()),2&e&&(t.Q6J("ngStyle",t.WLB(4,ir,n.width,n.height)),t.xp6(1),t.Q6J("ngIf",n.loading),t.xp6(1),t.Q6J("ngClass",t.VKq(7,rr,n.loading))("src",n.url,t.uOi))},dependencies:[ue.mk,ue.O5,ue.PC],styles:["[_nghost-%COMP%]{--borderRadius: 8px}.loader[_ngcontent-%COMP%]{float:left;z-index:1000;border-radius:var(--borderRadius);background-image:linear-gradient(90deg,transparent 0px,#e8e8e8 40px,transparent 80px);background-size:600px;animation:shine-loader 1.6s infinite linear}.isLoadingImage[_ngcontent-%COMP%]{display:none}iframe[_ngcontent-%COMP%]{border:none;border-radius:var(--borderRadius)}@keyframes shine-loader{0%{background-position:-32px}40%,to{background-position:208px}}"]}),i})(),ar=(()=>{class i{constructor(e){this.sanitizer=e}transform(e,n){return this.sanitizer.bypassSecurityTrustHtml(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.H7,16))},i.\u0275pipe=t.Yjl({name:"safeHtml",type:i,pure:!0}),i})();const lr=["htmlCode"];let cr=(()=>{class i{constructor(e){this.elementRef=e}ngOnInit(){}ngOnChanges(e){this.fontSize&&this.elementRef.nativeElement.style.setProperty("--buttonFontSize",this.fontSize),this.themeColor&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.themeColor),this.foregroundColor&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.foregroundColor)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-html"]],viewQuery:function(e,n){if(1&e&&t.Gf(lr,5),2&e){let o;t.iGM(o=t.CRH())&&(n.container=o.first)}},inputs:{htmlText:"htmlText",fontSize:"fontSize",themeColor:"themeColor",foregroundColor:"foregroundColor"},features:[t.TTD],decls:3,vars:3,consts:[["id","htmlCode",3,"innerHTML"],["htmlCode",""]],template:function(e,n){1&e&&(t._UZ(0,"div",0,1),t.ALo(2,"safeHtml")),2&e&&t.Q6J("innerHTML",t.lcZ(2,1,n.htmlText),t.oJD)},dependencies:[ar],styles:["[_ngcontent-%COMP%]:root{--themeColor: rgb(42, 106, 193);--foregroundColor: #ffffff;--buttonFontSize: 15px}  .button-html{padding:8px 16px!important;position:relative;max-width:300px;min-width:inherit;cursor:pointer!important;border:1px solid var(--themeColor);border-radius:20px;margin:3px;background:transparent;overflow:hidden;font-family:Muli,sans-serif!important;font-size:var(--buttonFontSize)!important;text-overflow:ellipsis;white-space:nowrap;letter-spacing:-.24px;-webkit-font-smoothing:antialiased;color:var(--themeColor);line-height:16px}  .url{transition:background-color .6s ease}  .url .icon-button-action{position:absolute;top:-1px;right:1px}  .url .icon-button-action svg{fill:var(--themeColor)}  .url .icon-button-action-self{position:absolute;right:1px}  .url .icon-button-action-self svg{fill:var(--themeColor)}  .url:focus,   .url:hover{color:#fff;background:var(--themeColor)}  .url:focus .icon-button-action svg,   .url:focus .icon-button-action-self svg,   .url:hover .icon-button-action svg,   .url:hover .icon-button-action-self svg{fill:#fff}  .url:active{font-size:20px}  .text-html{font-size:1.4em;margin:0;padding:8px;font-style:normal;letter-spacing:normal;font-stretch:normal;font-feature-settings:normal;font-variant:normal;font-weight:300;overflow:hidden}"]}),i})();var hr=_e(4327);const Rn=function(i,a){return{width:i,height:a}};function dr(i,a){if(1&i&&t._UZ(0,"div",4),2&i){const e=t.oxw();t.Q6J("ngStyle",t.WLB(1,Rn,e.width,e.height))}}function ur(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(e.tooltipMessage)}}const gr=function(i){return{isLoadingImage:i}};let Ln=(()=>{class i{constructor(){this.onElementRendered=new t.vpe,this.loading=!0,this.tooltipOptions={"show-delay":0,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},this.popupUrl=At}ngOnInit(){}onLoaded(e){this.loading=!1,this.onElementRendered.emit({element:"image",status:!0})}downloadImage(e,n){console.log("Image COMP - IMAGE URL ",e),console.log("Image COMP - IMAGE FILENAME ",n),n||(n=decodeURIComponent(decodeURIComponent(e).split("/").pop())),(0,hr.saveAs)(e,n)}onClickImage(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-image"]],inputs:{metadata:"metadata",width:"width",height:"height"},outputs:{onElementRendered:"onElementRendered"},decls:5,vars:9,consts:[[1,"c21-img-container"],["class","loader",3,"ngStyle",4,"ngIf"],[1,"message-contentX","message-content-imageX",3,"ngClass","ngStyle","src","load","click"],["timeTooltipRight",""],[1,"loader",3,"ngStyle"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,dr,1,4,"div",1),t.TgZ(2,"img",2),t.NdJ("load",function(r){return n.onLoaded(r)})("click",function(){return n.downloadImage(n.metadata.src,n.metadata.name)}),t.qZA(),t.YNc(3,ur,2,1,"ng-template",null,3,t.W1O),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",n.loading),t.xp6(1),t.Q6J("ngClass",t.VKq(4,gr,n.loading))("ngStyle",t.WLB(6,Rn,n.width,n.height))("src",n.metadata.src,t.LSH))},dependencies:[ue.mk,ue.O5,ue.PC],styles:["[_nghost-%COMP%]{--borderRadius: 8px}img[_ngcontent-%COMP%]{border-radius:var(--borderRadius);margin-bottom:0;max-width:calc(100% - 6px);width:auto;height:auto;object-fit:cover;transition:transform .3s ease-in-out 0s}.c21-img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{cursor:pointer;transform:scale(1.05)}.c21-img-container[_ngcontent-%COMP%]{text-align:center;width:100%;overflow:hidden;border-radius:var(--borderRadius)}.demo-content[_ngcontent-%COMP%]{position:relative}.isLoadingImage[_ngcontent-%COMP%]{display:none}.loader[_ngcontent-%COMP%]{float:left;z-index:1000;border-radius:var(--borderRadius);background-image:linear-gradient(90deg,transparent 0px,#e8e8e8 40px,transparent 80px);background-size:600px;animation:shine-loader 1.6s infinite linear}@keyframes shine-loader{0%{background-position:-32px}40%,to{background-position:208px}}"]}),i})(),Nn=(()=>{class i{transform(e,n){return e=function io(i){return String(i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}(e),e=function ro(i){return i.replace(/[\n\r]/g,"<br>")}(e),e.trim()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=t.Yjl({name:"htmlEntitiesEncode",type:i,pure:!0}),i})();var yt=_e(8645);let Zt=(()=>{class i{transform(e){const n=new yt.TU.Renderer;return n.link=function(o,r,v){return yt.TU.Renderer.prototype.link.call(this,o,r,v).replace("<a",'<a target="_blank" ')},yt.TU.setOptions({renderer:n}),e&&e.length>0?(0,yt.TU)(e):e}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=t.Yjl({name:"marked",type:i,pure:!0}),i})(),pr=(()=>{class i{constructor(){this.htmlEnabled=!1,this.onBeforeMessageRender=new t.vpe,this.onAfterMessageRender=new t.vpe}ngOnInit(){}printMessage(e,n,o){const r={messageEl:n,component:o};this.onBeforeMessageRender.emit(r);const v=e;return this.onAfterMessageRender.emit(r),v}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-text"]],inputs:{text:"text",htmlEnabled:"htmlEnabled",color:"color",fontSize:"fontSize",fontFamily:"fontFamily"},outputs:{onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender"},decls:4,vars:9,consts:[[1,"message_innerhtml","marked",3,"innerHTML"],["messageEl",""]],template:function(e,n){if(1&e&&(t._UZ(0,"p",0,1),t.ALo(2,"marked"),t.ALo(3,"htmlEntitiesEncode")),2&e){const o=t.MAs(1);t.Udp("color",n.color)("font-size",n.fontSize),t.Q6J("innerHTML",t.lcZ(2,5,t.lcZ(3,7,n.printMessage(n.text,o,n))),t.oJD)}},dependencies:[Nn,Zt],styles:[".message_innerhtml[_ngcontent-%COMP%]{margin:0}.message_innerhtml.marked[_ngcontent-%COMP%]{padding:8px;margin-block-start:-1em!important;margin-block-end:-1em!important}.message_innerhtml[_ngcontent-%COMP%]   .text-message[_ngcontent-%COMP%]{padding-top:14px}p[_ngcontent-%COMP%]{font-size:1.4em;margin:0;padding:14px;line-height:1.4em;font-style:normal;letter-spacing:normal;font-stretch:normal;font-feature-settings:normal;font-variant:normal;font-weight:300;overflow:hidden}"]}),i})();const fr=function(i){return{margin:i}};function mr(i,a){if(1&i&&(t.TgZ(0,"div",4),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.Udp("color",e.convertColorToRGBA(e.fontColor,65)),t.Q6J("ngStyle",t.VKq(4,fr,e.isImage(e.message)||e.isFrame(e.message)?"10px 16px 8px 16px":"10px 8px 0px 8px")),t.xp6(1),t.hij(" ",null==e.message?null:e.message.sender_fullname," ")}}function _r(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-image",5),t.NdJ("onElementRendered",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onElementRenderedFN(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("metadata",e.message.metadata)("width",null==e.sizeImage?null:e.sizeImage.width)("height",null==e.sizeImage?null:e.sizeImage.height)}}function vr(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-frame",5),t.NdJ("onElementRendered",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onElementRenderedFN(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("metadata",e.message.metadata)("width",null==e.sizeImage?null:e.sizeImage.width)("height",null==e.sizeImage?null:e.sizeImage.height)}}function br(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"amTimeAgo"),t.ALo(3,"amDateFormat"),t.ALo(4,"amLocal"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,e.message.timestamp)," (",t.xi3(3,4,t.lcZ(4,7,e.message.timestamp),"L HH:mm:ss"),")")}}function Cr(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-text",10),t.NdJ("onBeforeMessageRender",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onBeforeMessageRenderFN(o))})("onAfterMessageRender",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onAfterMessageRenderFN(o))}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("text",null==e.message?null:e.message.text)("color",e.fontColor)("fontSize",e.fontSize)("fontFamily",e.fontFamily)}}function wr(i,a){if(1&i&&t._UZ(0,"chat-html",11),2&i){const e=t.oxw(2);t.Q6J("htmlText",null==e.message?null:e.message.text)("fontSize",e.stylesMap.get("buttonFontSize"))("themeColor",e.stylesMap.get("themeColor"))("foregroundColor",e.stylesMap.get("foregroundColor"))}}function yr(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",6),t.NdJ("click",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.handleTooltipEvents(o))}),t.YNc(1,br,5,9,"ng-template",null,7,t.W1O),t.YNc(3,Cr,1,4,"chat-text",8),t.YNc(4,wr,1,4,"chat-html",9),t.qZA()}if(2&i){const e=t.MAs(2),n=t.oxw();t.Q6J("tooltip",e),t.xp6(3),t.Q6J("ngIf","html"!==(null==n.message?null:n.message.type)),t.xp6(1),t.Q6J("ngIf","html"===(null==n.message?null:n.message.type))}}const Or=function(i){return{padding:i}};let xr=(()=>{class i{constructor(e){this.sanitizer=e,this.onBeforeMessageRender=new t.vpe,this.onAfterMessageRender=new t.vpe,this.onElementRendered=new t.vpe,this.isImage=Lt,this.isFile=vo,this.isFrame=un,this.convertColorToRGBA=ke,this.messageType=je,this.MESSAGE_TYPE_MINE=$,this.MESSAGE_TYPE_OTHERS=ne,this.logger=ve.getInstance()}ngOnInit(){}ngOnChanges(){this.message&&this.message.metadata&&"object"==typeof this.message.metadata&&(this.sizeImage=this.getMetadataSize(this.message.metadata))}getMetadataSize(e){const n={width:e.width,height:e.height};if(e.width&&e.width<q)if(e.width<=55){const o=e.width/e.height;n.width=130,n.height=130/o}else e.width>55&&(n.width=e.width,n.height=e.height);else if(e.width&&e.width>q){const o=e.width/e.height;n.width=q,n.height=q/o}return n}handleTooltipEvents(e){const n=this;setTimeout(function(){try{const r=document.getElementsByClassName("chat-tooltip");if(r){const v=r[0];v.classList.contains("tooltip-show")||v.classList.add("tooltip-show"),setTimeout(function(){v.classList.contains("tooltip-show")&&v.classList.remove("tooltip-show")},Te.hideDelayAfterClick)}}catch(r){n.logger.error("[BUBBLE-MESSAGE] handleTooltipEvents >>>> Error :"+r)}},Te.showDelay)}onBeforeMessageRenderFN(e){this.onBeforeMessageRender.emit({message:this.message,sanitizer:this.sanitizer,messageEl:e.messageEl,component:e.component})}onAfterMessageRenderFN(e){this.onAfterMessageRender.emit({message:this.message,sanitizer:this.sanitizer,messageEl:e.messageEl,component:e.component})}onElementRenderedFN(e){this.onElementRendered.emit({element:e.element,status:e.status})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.H7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-bubble-message"]],inputs:{message:"message",isSameSender:"isSameSender",fontColor:"fontColor",fontSize:"fontSize",fontFamily:"fontFamily",stylesMap:"stylesMap"},outputs:{onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender",onElementRendered:"onElementRendered"},features:[t.TTD],decls:6,vars:7,consts:[["id","bubble-message",1,"messages","primary-color",3,"ngStyle"],["class","message_sender_fullname",3,"color","ngStyle",4,"ngIf"],[3,"metadata","width","height","onElementRendered",4,"ngIf"],["placement","left","contentType","template",3,"tooltip","click",4,"ngIf"],[1,"message_sender_fullname",3,"ngStyle"],[3,"metadata","width","height","onElementRendered"],["placement","left","contentType","template",3,"tooltip","click"],["timeTooltipLeft",""],[3,"text","color","fontSize","fontFamily","onBeforeMessageRender","onAfterMessageRender",4,"ngIf"],[3,"htmlText","fontSize","themeColor","foregroundColor",4,"ngIf"],[3,"text","color","fontSize","fontFamily","onBeforeMessageRender","onAfterMessageRender"],[3,"htmlText","fontSize","themeColor","foregroundColor"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div"),t.YNc(2,mr,2,6,"div",1),t.YNc(3,_r,1,3,"chat-image",2),t.YNc(4,vr,1,3,"chat-frame",2),t.YNc(5,yr,5,3,"div",3),t.qZA()()),2&e&&(t.Q6J("ngStyle",t.VKq(5,Or,n.isImage(n.message)||n.isFrame(n.message)?"0 0px":"0 8px")),t.xp6(2),t.Q6J("ngIf",n.messageType(n.MESSAGE_TYPE_OTHERS,n.message)&&!n.isSameSender),t.xp6(1),t.Q6J("ngIf",n.isImage(n.message)),t.xp6(1),t.Q6J("ngIf",n.isFrame(n.message)),t.xp6(1),t.Q6J("ngIf",null==n.message?null:n.message.text))},dependencies:[ue.O5,ue.PC,Ht.i9,sr,cr,Ln,pr,Ve.Ek,Ve.eG,Ve.Bs],styles:[".messages[_ngcontent-%COMP%]{border-radius:20px;padding:0;word-wrap:break-word}.messages[_ngcontent-%COMP%]   .message_sender_fullname[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.messages[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:20px;padding:3px;margin-bottom:0;max-width:calc(100% - 6px);width:auto;height:auto;object-fit:cover}.messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{margin:0}.messages[_ngcontent-%COMP%]   .message_innerhtml.marked[_ngcontent-%COMP%]{padding:8px;margin-block-start:-1em!important;margin-block-end:-1em!important}.messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]   .text-message[_ngcontent-%COMP%]{padding-top:14px}"]}),i})();function Mr(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"img",3),t.NdJ("error",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onBotImgError(o))})("load",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onLoadedBot(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("src",e.url,t.LSH)}}function Er(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"img",3),t.NdJ("error",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onHumanImgError(o))})("load",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onLoadedHuman(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("src",e.url,t.LSH)}}let Fn=(()=>{class i{constructor(e){this.imageRepoService=e}ngOnInit(){if(this.senderID){-1!==this.senderID.indexOf("bot_")||this.senderFullname.toLowerCase().includes("bot")?this.url=this.baseLocation+"/assets/images/tommy_bot_tiledesk.svg":-1==this.senderID.indexOf("bot_")&&(this.url=this.baseLocation+"/assets/images/chat_human_avatar.svg");let e=this.imageRepoService.getImagePhotoUrl(this.senderID);this.checkImageExists(e,n=>{n&&(this.url=e)})}}onBotImgError(e){e.target.src=this.baseLocation+"/assets/images/tommy_bot_tiledesk.svg"}onHumanImgError(e){e.target.src=this.baseLocation+"/assets/images/chat_human_avatar.svg"}onLoadedBot(e){}onLoadedHuman(e){}checkImageExists(e,n){var o=new Image;o.onload=function(){n(!0)},o.onerror=function(){n(!1)},o.src=e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(et))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-avatar-image"]],inputs:{senderID:"senderID",senderFullname:"senderFullname",baseLocation:"baseLocation"},decls:4,vars:2,consts:[[1,"c21-icon-avatar"],[1,"c21-avatar-image","profile_image"],[3,"src","error","load",4,"ngIf"],[3,"src","error","load"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Mr,1,1,"img",2),t.YNc(3,Er,1,1,"img",2),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngIf",-1!==(null==n.senderID?null:n.senderID.indexOf("bot_"))||n.senderFullname.toLowerCase().includes("bot")),t.xp6(1),t.Q6J("ngIf",-1===(null==n.senderID?null:n.senderID.indexOf("bot_"))&&!n.senderFullname.toLowerCase().includes("bot")))},dependencies:[ue.O5],styles:[".c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%;display:flex;align-items:center;justify-content:center}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}.c21-pallozzo[_ngcontent-%COMP%]{display:inline}.c21-ball[_ngcontent-%COMP%]{position:relative;width:52px;height:52px;border-radius:50%;display:inline-flex;align-items:center;text-align:center;margin:0 0 0 -10px}.c21-ball[_ngcontent-%COMP%]   .c21-ball-label[_ngcontent-%COMP%]{color:#fff;margin:auto;font-size:20px;-webkit-user-select:none;user-select:none;font-weight:500}.c21-ball[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}"]}),i})();function Sr(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"amTimeAgo"),t.ALo(3,"amDateFormat"),t.ALo(4,"amLocal"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.AsE("",t.lcZ(2,2,e.message.timestamp)," (",t.xi3(3,4,t.lcZ(4,7,e.message.timestamp),"L HH:mm:ss"),")")}}let Tr=(()=>{class i{constructor(){this.logger=ve.getInstance()}ngOnInit(){this.logger.debug("[INFO-COMP] message ",this.message),this.message&&this.message.text&&(this.message.text=this.message.text.replace(/<br\s*[\/]?>/gi,"\n"),this.logger.debug("[INFO-COMP] message .text  ",this.message.text))}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-info-message"]],inputs:{message:"message"},decls:14,vars:4,consts:[[1,"info-container"],[1,"spinner"],[1,"bounce3"],[1,"bounce2"],[1,"bounce1"],[2,"max-width","70%"],["placement","left","contentType","template",1,"base_info",3,"innerHTML","tooltip"],["timeTooltipLeft",""]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2)(3,"div",3)(4,"div",4),t.qZA(),t.TgZ(5,"div",5),t._UZ(6,"span",6),t.ALo(7,"marked"),t.YNc(8,Sr,5,9,"ng-template",null,7,t.W1O),t.qZA(),t.TgZ(10,"div",1),t._UZ(11,"div",4)(12,"div",3)(13,"div",2),t.qZA()()),2&e){const o=t.MAs(9);t.xp6(6),t.Q6J("innerHTML",t.lcZ(7,2,null==n.message?null:n.message.text),t.oJD)("tooltip",o)}},dependencies:[Ht.i9,Ve.Ek,Ve.eG,Ve.Bs,Zt],styles:[".info-container[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:center;padding:4px 0 2px;width:100%}.base_info[_ngcontent-%COMP%]{border-radius:14px;padding:6px 10px;display:inline-block;background:rgba(24,119,242,.1);font-size:10px;color:#666;margin-left:5px;margin-right:5px}.base_info[_ngcontent-%COMP%]    >p{margin-top:0!important;margin-bottom:0!important}.base_info[_ngcontent-%COMP%]    >p a{word-break:break-all;color:#3880ff!important}.spinner[_ngcontent-%COMP%]{width:45px;min-height:100%;margin:auto 0}.spinner[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;background-color:#333;border-radius:100%;display:inline-block;margin:0 2px}.spinner[_ngcontent-%COMP%]   .bounce1[_ngcontent-%COMP%]{background-color:#1877f21a}.spinner[_ngcontent-%COMP%]   .bounce2[_ngcontent-%COMP%]{background-color:#1877f21a;opacity:.6}.spinner[_ngcontent-%COMP%]   .bounce3[_ngcontent-%COMP%]{background-color:#1877f21a;opacity:.4}"]}),i})();function Pr(i,a){1&i&&(t.TgZ(0,"div",2),t.O4$(),t.TgZ(1,"svg",3)(2,"defs")(3,"style"),t._uU(4,".cls-1{fill:none;}"),t.qZA()(),t.TgZ(5,"g",4)(6,"g",5),t._UZ(7,"path",6)(8,"path",7)(9,"path",8),t.qZA()()()())}function kr(i,a){1&i&&(t.TgZ(0,"div",2),t.O4$(),t.TgZ(1,"svg",3)(2,"defs")(3,"style"),t._uU(4,".cls-1{fill:none;}"),t.qZA()(),t.TgZ(5,"g",4)(6,"g",5),t._UZ(7,"path",7)(8,"path",9),t.qZA()()()())}function Ar(i,a){1&i&&(t.TgZ(0,"div",2),t.O4$(),t.TgZ(1,"svg",3)(2,"defs")(3,"style"),t._uU(4,".cls-1{fill:none;}"),t.qZA()(),t.TgZ(5,"g",4)(6,"g",5),t._UZ(7,"path",7)(8,"path",9),t.qZA()()()())}function Ir(i,a){1&i&&(t.TgZ(0,"div",2),t.O4$(),t.TgZ(1,"svg",3)(2,"defs")(3,"style"),t._uU(4,".cls-1{fill:none;}"),t.qZA()(),t.TgZ(5,"g",4)(6,"g",5),t._UZ(7,"path",7)(8,"path",10),t.qZA()()()())}let Rr=(()=>{class i{constructor(){this.MSG_STATUS_SENT=100,this.MSG_STATUS_SENT_SERVER=150,this.MSG_STATUS_RETURN_RECEIPT=250}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-return-receipt"]],inputs:{status:"status"},decls:5,vars:4,consts:[[1,"status-message"],["class","icon",4,"ngIf"],[1,"icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 18 18"],["id","Livello_2","data-name","Livello 2"],["id","Livello_1-2","data-name","Livello 1"],["d","M9,1.5A7.5,7.5,0,1,0,16.5,9,7.5,7.5,0,0,0,9,1.5ZM9,15a6,6,0,1,1,6-6A6,6,0,0,1,9,15Z"],["d","M0,0H18V18H0Z",1,"cls-1"],["d","M9.38,5.25H8.25v4.5l3.94,2.36.56-.92-3.37-2Z"],["d","M6.75,12.15,3.6,9,2.55,10l4.2,4.2,9-9-1-1.05Z"],["d","M13.5,5.25,12.44,4.19,7.69,8.95,8.74,10Zm3.18-1.06L8.74,12.13,5.61,9,4.55,10.06l4.19,4.19,9-9ZM.31,10.06,4.5,14.25l1.06-1.06L1.37,9Z"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Pr,10,0,"div",1),t.YNc(2,kr,9,0,"div",1),t.YNc(3,Ar,9,0,"div",1),t.YNc(4,Ir,9,0,"div",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!n.status),t.xp6(1),t.Q6J("ngIf",n.status==n.MSG_STATUS_SENT),t.xp6(1),t.Q6J("ngIf",n.status==n.MSG_STATUS_SENT_SERVER),t.xp6(1),t.Q6J("ngIf",n.status==n.MSG_STATUS_RETURN_RECEIPT))},dependencies:[ue.O5],styles:[".status-message[_ngcontent-%COMP%]{width:16px;height:16px;margin-left:4px}.status-message[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:13px;height:13px;background-repeat:no-repeat;background-position:center;background-size:cover;overflow-x:hidden;overflow-y:hidden}.status-message[_ngcontent-%COMP%]   .c21-ico-schedule[_ngcontent-%COMP%]{background-image:url(f21ico-schedule.svg)}.status-message[_ngcontent-%COMP%]   .c21-ico-done[_ngcontent-%COMP%]{background-image:url(f21ico-done.svg)}.status-message[_ngcontent-%COMP%]   .c21-ico-done_all[_ngcontent-%COMP%]{background-image:url(f21ico-done_all.svg)}"]}),i})();function Lr(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij("",e.nameUserTypingNow," ")}}function Nr(i,a){if(1&i&&(t.TgZ(0,"div",2),t.YNc(1,Lr,2,1,"span",3),t._uU(2),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.nameUserTypingNow),t.xp6(1),t.hij(" ",null==e.translationMap?null:e.translationMap.get("LABEL_WRITING"),"\n")}}function Fr(i,a){1&i&&(t.TgZ(0,"div",4),t._UZ(1,"div",5)(2,"div",6)(3,"div",7),t.qZA())}let Bn=(()=>{class i{constructor(e){this.elementRef=e,this.typingLocation="content"}ngOnInit(){this.elementRef.nativeElement.style.setProperty("--bubbleReceivedBackgroundColor",this.color)}ngOnDestroy(){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["user-typing"]],inputs:{typingLocation:"typingLocation",translationMap:"translationMap",color:"color",idUserTypingNow:"idUserTypingNow",nameUserTypingNow:"nameUserTypingNow"},decls:2,vars:2,consts:[["class","tile-typing-now",4,"ngIf"],["class","spinner",4,"ngIf"],[1,"tile-typing-now"],[4,"ngIf"],[1,"spinner"],[1,"bounce1"],[1,"bounce2"],[1,"bounce3"]],template:function(e,n){1&e&&(t.YNc(0,Nr,3,2,"div",0),t.YNc(1,Fr,4,0,"div",1)),2&e&&(t.Q6J("ngIf","header"===n.typingLocation),t.xp6(1),t.Q6J("ngIf","content"===n.typingLocation))},dependencies:[ue.O5],styles:["[_ngcontent-%COMP%]:root{--bubbleReceivedBackgroundColor: $blue;--foregroundColor: $bck-msg-sent}.tile-typing-now[_ngcontent-%COMP%]{position:absolute;left:40px;right:40px;bottom:3px;width:auto;text-align:center;margin:0;padding:0;font-size:1.1em;color:var(--foregroundColor)}#tile-spinner[_ngcontent-%COMP%]{position:relative;left:0;top:0;margin:0}#tile-spinner[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;background-color:var(--basic-blue)}.spinner[_ngcontent-%COMP%]{margin:15px 10px;width:70px;min-height:20px;display:block}.spinner[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:9px;height:9px;border-radius:100%;display:inline-block;animation:sk-bouncedelay 1.4s infinite ease-in-out both}.spinner[_ngcontent-%COMP%]   .bounce1[_ngcontent-%COMP%]{animation-delay:-.32s;background-color:var(--bubbleReceivedBackgroundColor)}.spinner[_ngcontent-%COMP%]   .bounce2[_ngcontent-%COMP%]{animation-delay:-.16s;background-color:var(--bubbleReceivedBackgroundColor);opacity:.4}.spinner[_ngcontent-%COMP%]   .bounce3[_ngcontent-%COMP%]{background-color:var(--bubbleReceivedBackgroundColor);opacity:.6}@keyframes sk-bouncedelay{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}"]}),i})();const Br=["scrollMe"];function Ur(i,a){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"user-typing",12),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("color",null==e.stylesMap?null:e.stylesMap.get("iconColor"))("translationMap",e.translationMap)("idUserTypingNow",e.idUserTypingNow)("nameUserTypingNow",e.nameUserTypingNow)}}const Un=function(i,a){return{background:i,color:a}},Dr=function(i){return{"button-in-msg":i}};function Hr(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",19)(1,"chat-bubble-message",20),t.NdJ("onBeforeMessageRender",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onBeforeMessageRenderFN(o))})("onAfterMessageRender",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onAfterMessageRenderFN(o))})("onElementRendered",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onElementRenderedFN(o))}),t.qZA(),t._UZ(2,"chat-return-receipt",21),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.ekj("no-background",(n.isImage(e)||n.isFrame(e))&&""===(null==e?null:e.text.trim()))("emoticon",n.isEmojii(null==e?null:e.text)),t.Q6J("ngStyle",t.WLB(12,Un,n.stylesMap.get("bubbleSentBackground"),n.stylesMap.get("bubbleSentTextColor")))("ngClass",t.VKq(15,Dr,(null==e?null:e.metadata)&&(null==e||null==e.metadata?null:e.metadata.button)))("message",e)("fontColor",n.stylesMap.get("bubbleSentTextColor"))("fontSize",n.stylesMap.get("fontSize"))("fontFamily",n.stylesMap.get("fontFamily"))("stylesMap",n.stylesMap),t.xp6(1),t.Q6J("status",null==e?null:e.status)}}const zt=function(){return{"slide-in-left":!1}};function Zr(i,a){if(1&i&&t._UZ(0,"chat-avatar-image",25),2&i){const e=t.oxw(2).$implicit,n=t.oxw();t.Q6J("ngClass",t.DdM(4,zt))("senderID",null==e?null:e.sender)("senderFullname",null==e?null:e.sender_fullname)("baseLocation",n.baseLocation)}}function zr(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",22),t.YNc(1,Zr,1,5,"chat-avatar-image",23),t.TgZ(2,"chat-bubble-message",24),t.NdJ("onBeforeMessageRender",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onBeforeMessageRenderFN(o))})("onAfterMessageRender",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onAfterMessageRenderFN(o))})("onElementRendered",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onElementRenderedFN(o))}),t.qZA()()}if(2&i){const e=t.oxw(),n=e.$implicit,o=e.index,r=t.oxw();t.xp6(1),t.Q6J("ngIf",!r.isSameSender(null==n?null:n.sender,o)),t.xp6(1),t.Udp("margin-left",r.isSameSender(null==n?null:n.sender,o)?"50px":null),t.ekj("no-background",(r.isImage(n)||r.isFrame(n))&&""===(null==n?null:n.text.trim()))("emoticon",r.isEmojii(null==n?null:n.text)),t.Q6J("ngClass",t.DdM(15,zt))("ngStyle",t.WLB(16,Un,r.stylesMap.get("bubbleReceivedBackground"),r.stylesMap.get("bubbleReceivedTextColor")))("isSameSender",r.isSameSender(null==n?null:n.sender,o))("message",n)("fontColor",r.stylesMap.get("bubbleReceivedTextColor"))("fontSize",r.stylesMap.get("fontSize"))("fontFamily",r.stylesMap.get("fontFamily"))("stylesMap",r.stylesMap)}}function jr(i,a){if(1&i&&(t.TgZ(0,"div",26),t._UZ(1,"chat-info-message",27),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("message",e)}}function Vr(i,a){if(1&i&&(t.TgZ(0,"time",null,28),t._uU(2),t.ALo(3,"amTimeAgo"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.hij("",t.lcZ(3,1,null==e?null:e.timestamp)," ")}}function Gr(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",29)(1,"chat-message-attachment",30),t.NdJ("onElementRendered",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onElementRenderedFN(o))})("onAttachmentButtonClicked",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onAttachmentButtonClickedFN(o))}),t.qZA()()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("ngClass",t.DdM(5,zt)),t.xp6(1),t.Q6J("message",e)("isConversationArchived",n.isConversationArchived)("isLastMessage",n.isLastMessage(null==e?null:e.uid))("stylesMap",n.stylesMap)}}const qr=function(i){return{sender:i}};function Wr(i,a){if(1&i&&(t.TgZ(0,"div",13),t.YNc(1,Hr,3,17,"div",14),t.YNc(2,zr,3,19,"div",15),t.YNc(3,jr,2,1,"div",16),t.TgZ(4,"div",17),t.YNc(5,Vr,4,3,"time",3),t.qZA(),t.YNc(6,Gr,2,6,"div",18),t.qZA()),2&i){const e=a.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.messageType(n.MESSAGE_TYPE_MINE,e)),t.xp6(1),t.Q6J("ngIf",n.messageType(n.MESSAGE_TYPE_OTHERS,e)),t.xp6(1),t.Q6J("ngIf",n.messageType(n.MESSAGE_TYPE_INFO,e)),t.xp6(1),t.Q6J("ngClass",t.VKq(6,qr,(null==e?null:e.sender)==n.senderId)),t.xp6(1),t.Q6J("ngIf",""!==(null==e?null:e.sender)&&"{.sv: timestamp}"!==(null==e?null:e.timestamp)),t.xp6(1),t.Q6J("ngIf",(null==e?null:e.attributes)&&(null==e||null==e.attributes?null:e.attributes.attachment))}}const Yr=function(i){return{"background-color":i}},Jr=function(i){return{"background-color":i,opacity:.4}},Qr=function(i){return{"background-color":i,opacity:.6}};function Kr(i,a){if(1&i&&(t.TgZ(0,"div",31)(1,"div",32),t._UZ(2,"div",33)(3,"div",34)(4,"div",35),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngStyle",t.VKq(3,Yr,e.stylesMap.get("iconColor"))),t.xp6(1),t.Q6J("ngStyle",t.VKq(5,Jr,e.stylesMap.get("iconColor"))),t.xp6(1),t.Q6J("ngStyle",t.VKq(7,Qr,e.stylesMap.get("iconColor")))}}function $r(i,a){if(1&i&&t._UZ(0,"chat-avatar-image",39),2&i){const e=t.oxw(2);t.Q6J("senderID",e.idUserTypingNow)("senderFullname",e.nameUserTypingNow)("baseLocation",e.baseLocation)}}const Xr=function(i){return{userTypingNowExist:i}};function es(i,a){if(1&i&&(t.TgZ(0,"div",36),t.YNc(1,$r,1,3,"chat-avatar-image",37),t._UZ(2,"user-typing",38),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.idUserTypingNow),t.xp6(1),t.Q6J("ngClass",t.VKq(6,Xr,!e.idUserTypingNow))("color",null==e.stylesMap?null:e.stylesMap.get("iconColor"))("translationMap",e.translationMap)("idUserTypingNow",e.idUserTypingNow)("nameUserTypingNow",e.nameUserTypingNow)}}let Dn=(()=>{class i{constructor(e,n,o){this.cdref=e,this.elementRef=n,this.uploadService=o,this.onBeforeMessageRender=new t.vpe,this.onAfterMessageRender=new t.vpe,this.onMenuOptionShow=new t.vpe,this.onEmojiiPickerShow=new t.vpe,this.onAttachmentButtonClicked=new t.vpe,this.onScrollContent=new t.vpe,this.startScroll=!0,this.idDivScroll="c21-contentScroll",this.isScrolling=!1,this.isIE=/msie\s|trident\//i.test(window.navigator.userAgent),this.firstScroll=!0,this.isPopupUrl=no,this.popupUrl=At,this.MSG_STATUS_SENT=100,this.MSG_STATUS_SENT_SERVER=150,this.MSG_STATUS_RETURN_RECEIPT=250,this.isMine=Nt,this.isInfo=_t,this.messageType=je,this.isEmojii=bo,this.isImage=Lt,this.isFrame=un,this.MESSAGE_TYPE_INFO=D,this.MESSAGE_TYPE_MINE=$,this.MESSAGE_TYPE_OTHERS=ne,this.tooltipOptions={"show-delay":1500,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},this.urlBOTImage="https://s3.eu-west-1.amazonaws.com/tiledesk-widget/dev/2.0.4-beta.7/assets/images/avatar_bot_tiledesk.svg",this.showUploadProgress=!1,this.logger=ve.getInstance()}ngOnInit(){this.listenToUploadFileProgress()}ngAfterContentChecked(){this.cdref.detectChanges()}ngOnChanges(e){this.stylesMap&&this.stylesMap.get("bubbleSentTextColor")&&this.elementRef.nativeElement.querySelector(".c21-body").style.setProperty("--textColorSent",this.stylesMap.get("bubbleSentTextColor")),this.stylesMap&&this.stylesMap.get("bubbleReceivedTextColor")&&this.elementRef.nativeElement.querySelector(".c21-body").style.setProperty("--textColorReceive",this.stylesMap.get("bubbleReceivedTextColor"))}getMetadataSize(e){void 0===e.width&&(e.width="100%"),void 0===e.height&&(e.height=Ge);const n={width:e.width,height:e.height};if(e.width&&e.width>Ge){const o=e.width/e.height;n.width=Ge,n.height=Ge/o}return n}listenToUploadFileProgress(){this.uploadService.BSStateUpload.subscribe(e=>{this.logger.debug("[CONV-CONTENT] BSStateUpload",e),e&&(this.showUploadProgress=100!==e.upload&&!isNaN(e.upload),this.uploadProgress=e.upload,this.fileType="file",this.scrollToBottom())})}onScroll(e){this.startScroll=!1,this.scrollMe&&(this.checkContentScrollPosition(this.scrollMe.nativeElement)?this.onScrollContent.emit(!0):this.onScrollContent.emit(!1))}checkContentScrollPosition(e){return e||(e=this.scrollMe.nativeElement),e.scrollHeight-e.scrollTop<=e.clientHeight+40?(this.logger.debug("[CONV-CONTENT] - SONO ALLA FINE"),!0):(this.logger.debug("[CONV-CONTENT] - NON SONO ALLA FINE"),!1)}scrollToBottom(e){const n=this;try{n.isScrolling=!0;const o=document.getElementById(n.idDivScroll);setTimeout(function(){!0===n.isIE||!0===e||!0===n.firstScroll?o.parentElement.classList.add("withoutAnimation"):o.parentElement.classList.remove("withoutAnimation"),o.parentElement.scrollTop=o.scrollHeight,o.style.opacity="1",n.firstScroll=!1},0)}catch(o){this.logger.error("[CONV-CONTENT] scrollToBottom > Error :"+o)}n.isScrolling=!1}isLastMessage(e){return e===this.messages[this.messages.length-1].uid}isSameSender(e,n){return!(!e||!this.messages[n-1]||e!==this.messages[n-1].sender)}isFirstMessage(e,n){return!(!e||0!=n||!this.messages[n]||this.messages[n]===e)}hideOutsideElements(){this.onMenuOptionShow.emit(!1),this.onEmojiiPickerShow.emit(!1)}onAttachmentButtonClickedFN(e){this.onAttachmentButtonClicked.emit(e)}onBeforeMessageRenderFN(e){this.onBeforeMessageRender.emit(e)}onAfterMessageRenderFN(e){this.onAfterMessageRender.emit(e)}onElementRenderedFN(e){e.status&&this.scrollMe&&(this.checkContentScrollPosition(this.scrollMe.nativeElement),this.scrollToBottom())}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(rt))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-conversation-content"]],viewQuery:function(e,n){if(1&e&&t.Gf(Br,5),2&e){let o;t.iGM(o=t.CRH())&&(n.scrollMe=o.first)}},inputs:{messages:"messages",senderId:"senderId",baseLocation:"baseLocation",isConversationArchived:"isConversationArchived",isTypings:"isTypings",idUserTypingNow:"idUserTypingNow",nameUserTypingNow:"nameUserTypingNow",typingLocation:"typingLocation",fullscreenMode:"fullscreenMode",translationMap:"translationMap",stylesMap:"stylesMap"},outputs:{onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender",onMenuOptionShow:"onMenuOptionShow",onEmojiiPickerShow:"onEmojiiPickerShow",onAttachmentButtonClicked:"onAttachmentButtonClicked",onScrollContent:"onScrollContent"},features:[t.TTD],decls:12,vars:5,consts:[[1,"c21-body",3,"click"],[1,"c21-body-container"],["tabindex","1520","aria-label"," messaggi della conversazione: ",1,"c21-body-content"],[4,"ngIf"],["id","chat21-sheet-content",1,"chat21-sheet-content"],[1,"chat21-conversation-parts-container"],["id","scroll-me",3,"scroll"],["scrollMe",""],[1,"c21-contentScroll",3,"id"],["tabindex","1521","class","rowMsg",4,"ngFor","ngForOf"],["class","msg_container base_sent",4,"ngIf"],["class","msg_container base_receive",4,"ngIf"],[1,"loading",3,"color","translationMap","idUserTypingNow","nameUserTypingNow"],["tabindex","1521",1,"rowMsg"],["role","messaggio","class","msg_container base_sent",4,"ngIf"],["role","messaggio","class","msg_container base_receive",4,"ngIf"],["class","msg_info_container",4,"ngIf"],[1,"time","slide-in-left",3,"ngClass"],["class","attachment_container",3,"ngClass",4,"ngIf"],["role","messaggio",1,"msg_container","base_sent"],[1,"messages","msg_sent",3,"ngStyle","ngClass","message","fontColor","fontSize","fontFamily","stylesMap","onBeforeMessageRender","onAfterMessageRender","onElementRendered"],[3,"status"],["role","messaggio",1,"msg_container","base_receive"],[3,"ngClass","senderID","senderFullname","baseLocation",4,"ngIf"],[1,"messages","msg_receive",3,"ngClass","ngStyle","isSameSender","message","fontColor","fontSize","fontFamily","stylesMap","onBeforeMessageRender","onAfterMessageRender","onElementRendered"],[3,"ngClass","senderID","senderFullname","baseLocation"],[1,"msg_info_container"],[1,"messages",3,"message"],["timeTooltip",""],[1,"attachment_container",3,"ngClass"],[2,"height","100%","display","block",3,"message","isConversationArchived","isLastMessage","stylesMap","onElementRendered","onAttachmentButtonClicked"],[1,"msg_container","base_sent"],["id","chat21-spinner",1,"chat21-spinner","active",2,"margin","0px 6px 0px"],[1,"chat21-bounce1",3,"ngStyle"],[1,"chat21-bounce2",3,"ngStyle"],[1,"chat21-bounce3",3,"ngStyle"],[1,"msg_container","base_receive"],["class","slide-in-left",3,"senderID","senderFullname","baseLocation",4,"ngIf"],[3,"ngClass","color","translationMap","idUserTypingNow","nameUserTypingNow"],[1,"slide-in-left",3,"senderID","senderFullname","baseLocation"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return n.hideOutsideElements()}),t.TgZ(1,"div",1)(2,"div",2),t.YNc(3,Ur,2,4,"span",3),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6,7),t.NdJ("scroll",function(r){return n.onScroll(r)}),t.TgZ(8,"div",8),t.YNc(9,Wr,7,8,"div",9),t.YNc(10,Kr,5,9,"div",10),t.YNc(11,es,3,8,"div",11),t.qZA()()()()()()()),2&e&&(t.xp6(3),t.Q6J("ngIf",n.messages&&0===n.messages.length),t.xp6(5),t.s9C("id",n.idDivScroll),t.xp6(1),t.Q6J("ngForOf",n.messages),t.xp6(1),t.Q6J("ngIf",n.showUploadProgress),t.xp6(1),t.Q6J("ngIf",n.isTypings&&"content"===n.typingLocation))},dependencies:[ue.mk,ue.sg,ue.O5,ue.PC,tr,xr,Fn,Tr,Rr,Bn,Ve.eG],styles:["#scroll-me[_ngcontent-%COMP%]{scroll-behavior:smooth}#scroll-me.withoutAnimation[_ngcontent-%COMP%]{scroll-behavior:unset}[_nghost-%COMP%]{--textColorSent: #ffffff;--textColorReceive: #1a1a1a}[_nghost-%COMP%]   .base_receive[_ngcontent-%COMP%]   .msg_receive[_ngcontent-%COMP%]    >div>div>div>chat-text a{color:var(--textColorReceive)!important}[_nghost-%COMP%]   .base_sent[_ngcontent-%COMP%]   .msg_sent[_ngcontent-%COMP%]    >div>div>div>chat-text a{color:var(--textColorSent)!important}[_nghost-%COMP%]   .userTypingNowExist[_ngcontent-%COMP%]    >div.spinner{margin:15px 50px}[_nghost-%COMP%]   .loading[_ngcontent-%COMP%]    >div.spinner{margin:25px 50px}.c21-body[_ngcontent-%COMP%]{position:fixed}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .chat21-header-modal-select[_ngcontent-%COMP%]{font-family:Google Sans,sans-serif!important;padding:0;background-color:#b9b9b921;margin:8px;line-height:1.2em;color:#616161;font-size:15px;text-align:center;word-wrap:break-word;border-radius:8px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .chat21-header-modal-select-more-of-one-dept[_ngcontent-%COMP%]{position:relative;height:auto;padding:10px;margin:30px 0 0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]{position:absolute;inset:0 0 56px;overflow:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{margin-bottom:20px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]{height:100%;overflow-y:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #c21-contentScroll[_ngcontent-%COMP%]{position:absolute;left:0;right:0;padding:10px;opacity:0;transition:opacity .5s;transition-timing-function:ease-in}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;background-color:#0000!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.1);background-color:#0000!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .chat21-conversation-parts-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:6px!important;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,0);background-color:#00000040!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden;position:absolute;top:0;right:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   #scroll-me[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#d3d6dc}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .msg_container[_ngcontent-%COMP%]{overflow:hidden;display:flex;width:100%}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .attachment_container[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:flex-end}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .msg_info_container[_ngcontent-%COMP%]{text-align:center;padding:0 0 6px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]{border-radius:20px;padding:0;word-wrap:break-word}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.4em;margin:0;padding:14px;font-style:normal;letter-spacing:normal;font-stretch:normal;font-feature-settings:normal;font-variant:normal;font-weight:300;overflow:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:8px;padding:3px;margin-bottom:0;max-width:calc(100% - 6px);width:auto;height:auto;object-fit:cover}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{margin:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message_innerhtml.marked[_ngcontent-%COMP%]{padding:8px;margin-block-start:-1em!important;margin-block-end:-1em!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]   .text-message[_ngcontent-%COMP%]{padding-top:14px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_info[_ngcontent-%COMP%]{border-radius:8px;border:1px solid #C9E4F6;padding-left:4px;padding-right:4px;display:inline-block;background:#C9E4F6;font-size:.85em}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]{align-items:flex-end;justify-content:flex-end;padding:2px 0 4px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .msg_sent[_ngcontent-%COMP%]{background-color:#62a8ea;color:#fff;margin-right:0;margin-left:4px;max-width:calc(100% - 30px);min-width:14px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:8px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .no-background[_ngcontent-%COMP%]{background:transparent!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]{background:transparent!important;font-size:4em;margin:-15px 0 0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:0;margin:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]{width:16px;height:16px;margin-left:4px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:13px;height:13px;background-repeat:no-repeat;background-position:center;background-size:cover;overflow-x:hidden}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .c21-ico-schedule[_ngcontent-%COMP%]{background-image:url(f21ico-schedule.svg)}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .c21-ico-done[_ngcontent-%COMP%]{background-image:url(f21ico-done.svg)}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_sent[_ngcontent-%COMP%]   .status-message[_ngcontent-%COMP%]   .c21-ico-done_all[_ngcontent-%COMP%]{background-image:url(f21ico-done_all.svg)}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]{padding:2px 0 4px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .content-avatar[_ngcontent-%COMP%]{position:relative;border-radius:50%;width:28px;height:28px;margin-right:6px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .content-avatar[_ngcontent-%COMP%]   .profile_image[_ngcontent-%COMP%]{position:relative;width:25px;height:25px;border-radius:50%;overflow:hidden;background-color:#fff;border:1px solid #e2e2e2}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .content-avatar[_ngcontent-%COMP%]   .profile_image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .msg_receive[_ngcontent-%COMP%]{background-color:#f7f7f7;color:#1a1a1a;max-width:calc(100% - 70px);min-width:14px;margin:auto 20px auto 10px;height:-moz-fit-content;height:fit-content;width:auto}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:14px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .no-background[_ngcontent-%COMP%]{background:transparent!important}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]{background-color:transparent!important;font-size:4em;margin:-15px 20px -10px 10px}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .base_receive[_ngcontent-%COMP%]   .emoticon[_ngcontent-%COMP%]   .message_innerhtml[_ngcontent-%COMP%]{padding:0;margin:0}.c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .chat21-sheet-content[_ngcontent-%COMP%]   .message_sender_fullname[_ngcontent-%COMP%]{font-size:12px;color:#5f6368;margin:0 auto 4px}.c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}.c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}@keyframes sk-bouncedelay{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}"]}),i})();class ts{constructor(a,e,n,o,r,v,P,Y,X,ae,fe,Ce,de,we,ye,Se,Fe,Qe,We,Ye,Je){this.uid=a,this.attributes=e,this.channel_type=n,this.conversation_with_fullname=o,this.conversation_with=r,this.recipient=v,this.recipient_fullname=P,this.image=Y,this.is_new=X,this.last_message_text=ae,this.text=fe,this.sender=Ce,this.senderAuthInfo=de,this.sender_fullname=we,this.status=ye,this.timestamp=Se,this.selected=Fe,this.color=Qe,this.avatar=We,this.archived=Ye,this.type=Je}}var tt=_e(7625),ns=_e(8929);let jt=(()=>{class i{constructor(e,n,o){if(this.http=e,this.g=n,this.appConfigService=o,this.logger=ve.getInstance(),this.API_URL=this.appConfigService.getConfig().apiUrl,!this.API_URL)throw new Error("apiUrl is not defined");this.obsCloseConversation=new me.X(null)}httpSendRate(e,n){const o=this.g.tiledeskToken,r=this.g.projectid,v=this.g.recipientId;if(e&&o&&r&&v){const P=new Ee.WM({Accept:"application/json","Content-Type":"application/json",Authorization:o}),Y=this.API_URL+r+"/requests/"+v+"/rating";this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e url: ",Y);const X={rating:e,rating_message:n};return this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e options: ",P),this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e body: ",JSON.stringify(X)),this.http.patch(Y,JSON.stringify(X),{headers:P}).pipe((0,yn.U)(ae=>ae.json()))}}setOsservable(e){this.logger.debug("[STAR-RATING-SERVICE] ------------------\x3e setOsservable: ",e),this.obsCloseConversation.next(e)}_dowloadTranscript(e){this.g.windowContext.open(this.API_URL+"public/requests/"+e+"/messages-user.html","_blank")}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ie),t.LFG(Re))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();function os(i,a){if(1&i&&t._UZ(0,"user-typing",17),2&i){const e=t.oxw();t.Q6J("color",null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))("translationMap",e.translationMap)("nameUserTypingNow",e.nameUserTypingNow)("typingLocation",e.typingLocation)}}function is(i,a){if(1&i&&(t.O4$(),t.TgZ(0,"svg",24),t._UZ(1,"path",5)(2,"path",25),t.TgZ(3,"title",7),t._uU(4),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(null==e.translationMap?null:e.translationMap.get("SOUND_OFF"))}}function rs(i,a){if(1&i&&(t.O4$(),t.TgZ(0,"svg",24),t._UZ(1,"path",5)(2,"path",26),t.TgZ(3,"title",7),t._uU(4),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(null==e.translationMap?null:e.translationMap.get("SOUND_ON"))}}function ss(i,a){if(1&i&&(t.TgZ(0,"span",27),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",null==e.translationMap?null:e.translationMap.get("SOUND_OFF"),"")}}function as(i,a){if(1&i&&(t.TgZ(0,"span",27),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",null==e.translationMap?null:e.translationMap.get("SOUND_ON"),"")}}function ls(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.dowloadTranscript())}),t.O4$(),t.TgZ(1,"svg",28),t._UZ(2,"path",5)(3,"path",29),t.TgZ(4,"title",7),t._uU(5),t.qZA()(),t.kcU(),t.TgZ(6,"span",27),t._uU(7),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(5),t.Oqu(null==e.translationMap?null:e.translationMap.get("DOWNLOAD_TRANSCRIPT")),t.xp6(2),t.Oqu(null==e.translationMap?null:e.translationMap.get("DOWNLOAD_TRANSCRIPT"))}}function cs(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.closeChat())}),t.O4$(),t.TgZ(1,"svg",30),t._UZ(2,"path",31)(3,"rect",32)(4,"path",33),t.TgZ(5,"title",7),t._uU(6),t.qZA()(),t.kcU(),t.TgZ(7,"span",27),t._uU(8),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(6),t.Oqu(null==e.translationMap?null:e.translationMap.get("CLOSE_CHAT")),t.xp6(2),t.Oqu(null==e.translationMap?null:e.translationMap.get("CLOSE_CHAT"))}}function hs(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.restartChat())}),t.O4$(),t.TgZ(1,"svg",34),t._UZ(2,"path",35)(3,"path",36),t.TgZ(4,"title",7),t._uU(5),t.qZA()(),t.kcU(),t.TgZ(6,"span",27),t._uU(7),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(5),t.Oqu(null==e.translationMap?null:e.translationMap.get("RESTART")),t.xp6(2),t.Oqu(null==e.translationMap?null:e.translationMap.get("RESTART"))}}function ds(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.signOut())}),t.O4$(),t.TgZ(1,"svg",37),t._UZ(2,"path",5)(3,"path",38),t.TgZ(4,"title",7),t._uU(5),t.qZA()(),t.kcU(),t.TgZ(6,"span",27),t._uU(7),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(5),t.Oqu(null==e.translationMap?null:e.translationMap.get("LOGOUT")),t.xp6(2),t.Oqu(null==e.translationMap?null:e.translationMap.get("LOGOUT"))}}function us(i,a){if(1&i&&(t.TgZ(0,"div",39)(1,"span",27),t._uU(2),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.build_version)}}function gs(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.toggleSound())}),t.YNc(2,is,5,1,"svg",20),t.YNc(3,rs,5,1,"svg",20),t.YNc(4,ss,2,1,"span",21),t.YNc(5,as,2,1,"span",21),t.qZA(),t.YNc(6,ls,8,2,"div",22),t.YNc(7,cs,9,2,"div",22),t.YNc(8,hs,8,2,"div",22),t.YNc(9,ds,8,2,"div",22),t.YNc(10,us,3,1,"div",23),t.qZA()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",!e.soundEnabled),t.xp6(1),t.Q6J("ngIf",e.soundEnabled),t.xp6(1),t.Q6J("ngIf",!e.soundEnabled),t.xp6(1),t.Q6J("ngIf",e.soundEnabled),t.xp6(1),t.Q6J("ngIf",e.isTrascriptDownloadEnabled),t.xp6(1),t.Q6J("ngIf",!e.hideCloseConversationOptionMenu),t.xp6(1),t.Q6J("ngIf",!e.hideRestartConversationOptionsMenu),t.xp6(1),t.Q6J("ngIf",!e.hideSignOutOptionMenu),t.xp6(1),t.Q6J("ngIf",e.build_version)}}const ps=function(i){return{"background-image":i}},Vt=function(i){return{display:i}},Gt=function(i){return{fill:i}},fs=function(i){return{color:i}};let ms=(()=>{class i{constructor(e,n){this.g=e,this.appConfigService=n,this.onBack=new t.vpe,this.onCloseWidget=new t.vpe,this.onSoundChange=new t.vpe,this.onCloseChat=new t.vpe,this.onRestartChat=new t.vpe,this.onWidgetHeightChange=new t.vpe,this.onSignOut=new t.vpe,this.onMenuOptionShow=new t.vpe,this.convertColorToRGBA=ke,this.isButtonsDisabled=!0,this.isDirect=!1,this.subscriptions=[],this.membersConversation=["SYSTEM"],this.heightStatus="min",this.logger=ve.getInstance(),this.API_URL=this.appConfigService.getConfig().apiUrl}ngOnInit(){this.logger.debug("[CONV-HEADER] ngOnInit: conversation-header COMPONENT ",this.translationMap),this.membersConversation.push(this.senderId)}ngOnChanges(e){e.idConversation&&void 0!==e.idConversation.currentValue&&this.logger.debug("[CONV-HEADER] onChanges -- Conversation-header.component-> start initializeTyping()",this.idConversation)}ngAfterViewInit(){this.logger.debug("[CONV-HEADER] --------ngAfterViewInit: conversation-header-------- "),this.isButtonsDisabled=!1,this.setSubscriptions()}setSubscriptions(){}returnHome(){this.onBack.emit()}closeChat(){this.onCloseChat.emit()}restartChat(){this.onRestartChat.emit(),this.onMenuOptionShow.emit(!1)}closeWidget(){this.onCloseWidget.emit()}dowloadTranscript(){this.windowContext.open(this.API_URL+"public/requests/"+this.idConversation+"/messages-user.html","_blank"),this.onMenuOptionShow.emit(!1)}toggleSound(){this.onMenuOptionShow.emit(!1),this.onSoundChange.emit(!this.soundEnabled)}signOut(){this.onSignOut.emit(!0)}toggleMenu(){this.onMenuOptionShow.emit(!this.isMenuShow)}maximizeMinimize(e){this.heightStatus=e,this.onWidgetHeightChange.emit(e)}ngOnDestroy(){this.logger.debug("[CONV-HEADER] ngOnDestroy ------------------\x3e this.subscriptions",this.subscriptions),this.unsubescribeAll()}unsubescribeAll(){this.logger.debug("[CONV-HEADER] unsubescribeAll: ",this.subscriptions),this.subscriptions.forEach(e=>{this.logger.debug("[CONV-HEADER] unsubescribe: ",e),e.value.unsubscribe()}),this.subscriptions.length=0,this.subscriptions=[]}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(Re))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-conversation-header"]],inputs:{idConversation:"idConversation",senderId:"senderId",soundEnabled:"soundEnabled",isMenuShow:"isMenuShow",isTypings:"isTypings",nameUserTypingNow:"nameUserTypingNow",typingLocation:"typingLocation",isTrascriptDownloadEnabled:"isTrascriptDownloadEnabled",hideCloseConversationOptionMenu:"hideCloseConversationOptionMenu",hideRestartConversationOptionsMenu:"hideRestartConversationOptionsMenu",hideHeaderCloseButton:"hideHeaderCloseButton",hideHeaderBackButton:"hideHeaderBackButton",hideHeaderConversationOptionsMenu:"hideHeaderConversationOptionsMenu",hideSignOutOptionMenu:"hideSignOutOptionMenu",windowContext:"windowContext",stylesMap:"stylesMap",translationMap:"translationMap",widgetTitle:"widgetTitle",build_version:"build_version"},outputs:{onBack:"onBack",onCloseWidget:"onCloseWidget",onSoundChange:"onSoundChange",onCloseChat:"onCloseChat",onRestartChat:"onRestartChat",onWidgetHeightChange:"onWidgetHeightChange",onSignOut:"onSignOut",onMenuOptionShow:"onMenuOptionShow"},features:[t.TTD],decls:26,vars:33,consts:[[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-content"],["tabindex","-1",1,"c21-header-button","c21-right","c21-close","c21-button-clean",3,"ngStyle","click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],["tabindex","-1",1,"c21-header-button","c21-right","c21-button-clean",3,"ngStyle","click"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",3,"ngStyle"],["d","M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"],["tabindex","1530","aria-label"," indietro ",1,"c21-header-button","c21-left","c21-button-clean",3,"ngStyle","click"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],[1,"c21-title",3,"ngStyle"],[1,"titleText"],[3,"color","translationMap","nameUserTypingNow","typingLocation",4,"ngIf"],["id","c21-options-menu",4,"ngIf"],[3,"color","translationMap","nameUserTypingNow","typingLocation"],["id","c21-options-menu"],[1,"c21-header-button","c21-right",3,"click"],["aria-labelledby","altIconTitle","class","icon-menu","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",4,"ngIf"],["class","label-menu-item",4,"ngIf"],["class","c21-header-button c21-right",3,"click",4,"ngIf"],["class","c21-button build_version_menu",4,"ngIf"],["aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",1,"icon-menu"],["d","M4.34 2.93L2.93 4.34 7.29 8.7 7 9H3v6h4l5 5v-6.59l4.18 4.18c-.65.49-1.38.88-2.18 1.11v2.06c1.34-.3 2.57-.92 3.61-1.75l2.05 2.05 1.41-1.41L4.34 2.93zM10 15.17L7.83 13H5v-2h2.83l.88-.88L10 11.41v3.76zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zm-7-8l-1.88 1.88L12 7.76zm4.5 8c0-1.77-1.02-3.29-2.5-4.03v1.79l2.48 2.48c.01-.08.02-.16.02-.24z"],["d","M3 9v6h4l5 5V4L7 9H3zm7-.17v6.34L7.83 13H5v-2h2.83L10 8.83zM16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77 0-4.28-2.99-7.86-7-8.77z"],[1,"label-menu-item"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24",1,"icon-menu"],["d","M16 13h-3V3h-2v10H8l4 4 4-4zM4 19v2h16v-2H4z"],["role","img","id","archive","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 512 512",1,"icon-menu"],["d","M80 152v256a40.12 40.12 0 0040 40h272a40.12 40.12 0 0040-40V152","stroke-linecap","round","stroke-linejoin","round","stroke-width","50px","fill","none"],["x","48","y","64","width","416","height","80","rx","28","ry","28","stroke-linejoin","round","stroke-width","50px","fill","none"],["stroke-linecap","round","stroke-linejoin","round","d","M320 304l-64 64-64-64M256 345.89V224","stroke-width","50px","fill","none"],["role","img","id","refresh","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 20 20",1,"icon-menu"],["d","M9.6,18.2c0.6,0,1-0.7,1-1.5s-0.5-1.5-1-1.5H6c-0.6,0-1-0.7-1-1.5V7.8h1c0.4,0,0.8-0.4,1-0.9c0.2-0.6,0.1-1.2-0.2-1.6  l-2.1-3c-0.4-0.6-1.1-0.6-1.5,0l-2.1,3C0.9,5.7,0.8,6.3,1,6.9s0.5,0.9,1,0.9h1v5.9c0,2.5,1.4,4.4,3.1,4.4H9.6z"],["d","M10.5,1.8c-0.5,0-1,0.7-1,1.5s0.4,1.5,1,1.5h3.5c0.5,0,1,0.7,1,1.5v5.9h-1c-0.4,0-0.8,0.4-0.9,0.9s-0.1,1.2,0.2,1.6l2,3  c0.4,0.6,1,0.6,1.4,0l2-3c0.3-0.4,0.4-1.1,0.2-1.6c-0.2-0.6-0.5-0.9-0.9-0.9h-1V6.3c0-2.5-1.3-4.4-3-4.4H10.5z"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","aria-labelledby","altIconTitle",1,"icon-menu"],["d","M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"],[1,"c21-button","build_version_menu"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return n.closeWidget()}),t.O4$(),t.TgZ(4,"svg",4),t._UZ(5,"path",5)(6,"path",6),t.TgZ(7,"title",7),t._uU(8),t.qZA()()(),t.kcU(),t.TgZ(9,"button",8),t.NdJ("click",function(){return n.toggleMenu()}),t.O4$(),t.TgZ(10,"svg",9),t._UZ(11,"path",5)(12,"path",10),t.TgZ(13,"title",7),t._uU(14),t.qZA()()(),t.kcU(),t.TgZ(15,"button",11),t.NdJ("click",function(){return n.returnHome()}),t.O4$(),t.TgZ(16,"svg",4),t._UZ(17,"path",5)(18,"path",12),t.TgZ(19,"title",7),t._uU(20),t.qZA()()(),t.kcU(),t.TgZ(21,"div",13)(22,"div",14),t._uU(23),t.qZA()(),t.YNc(24,os,1,4,"user-typing",15),t.qZA()()(),t.YNc(25,gs,11,9,"div",16)),2&e&&(t.Q6J("ngStyle",t.VKq(17,ps,null==n.stylesMap?null:n.stylesMap.get("colorGradient"))),t.xp6(3),t.Q6J("ngStyle",t.VKq(19,Vt,n.hideHeaderCloseButton?"none":"flex")),t.uIk("disabled",!!n.isButtonsDisabled||null),t.xp6(1),t.Q6J("ngStyle",t.VKq(21,Gt,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(null==n.translationMap?null:n.translationMap.get("BUTTON_CLOSE_TO_ICON")),t.xp6(1),t.Q6J("ngStyle",t.VKq(23,Vt,n.hideHeaderConversationOptionsMenu?"none":"flex")),t.uIk("disabled",!!n.isButtonsDisabled||null),t.xp6(1),t.Q6J("ngStyle",t.VKq(25,Gt,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(null==n.translationMap?null:n.translationMap.get("OPTIONS")),t.xp6(1),t.Q6J("ngStyle",t.VKq(27,Vt,n.hideHeaderBackButton?"none":"flex")),t.uIk("disabled",!!n.isButtonsDisabled||null),t.xp6(1),t.Q6J("ngStyle",t.VKq(29,Gt,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(null==n.translationMap?null:n.translationMap.get("PREV_CONVERSATIONS")),t.xp6(1),t.Q6J("ngStyle",t.VKq(31,fs,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(2),t.Oqu(n.widgetTitle),t.xp6(1),t.Q6J("ngIf",n.isTypings&&"header"===n.typingLocation),t.xp6(1),t.Q6J("ngIf",n.isMenuShow))},dependencies:[ue.O5,ue.PC,Bn],styles:[".c21-header[_ngcontent-%COMP%]{position:fixed;left:0;right:0}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-writing[_ngcontent-%COMP%]{position:absolute;left:40px;right:40px;bottom:3px;width:auto;text-align:center;margin:0;padding:0;font-size:1.1em;color:#fff}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .avatar-project[_ngcontent-%COMP%]{position:relative;padding:0;margin:0 10px 0 0;float:left;height:42px;width:42px;line-height:42px}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{font-size:16px}.c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{max-width:30px;max-height:30px;margin:6px}#c21-options-menu[_ngcontent-%COMP%]{width:auto;height:auto;min-width:100px;max-width:80%;position:absolute;z-index:10;top:40px;right:15px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;color:#2a6ac1;box-shadow:0 4px 15px #0003,0 1px 2px #0003;background-color:#fff}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{margin:5px;padding:5px 10px;display:flex;align-items:center;color:#777}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;border-radius:6px;cursor:pointer}#c21-options-menu[_ngcontent-%COMP%]   .label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}#c21-options-menu[_ngcontent-%COMP%]   .icon-menu[_ngcontent-%COMP%]{fill:#5f6368}#c21-options-menu[_ngcontent-%COMP%]   .icon-menu#archive[_ngcontent-%COMP%]{stroke:#5f6368}#c21-options-menu[_ngcontent-%COMP%]   .build_version_menu[_ngcontent-%COMP%]{color:#aaa;justify-content:center;font-size:.8em}#c21-options-menu[_ngcontent-%COMP%]   .build_version_menu[_ngcontent-%COMP%]:hover{cursor:default;background-color:unset}"]}),i})();var qt=_e(5861);const _s=["divPreview"];function vs(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-image",25),t.NdJ("onImageRendered",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onImageRenderedFN(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("metadata",e.fileSelected)("width",null==e.fileSelected?null:e.fileSelected.width)("height",null==e.fileSelected?null:e.fileSelected.height)}}const bs=function(i){return{display:i}},Cs=function(i){return{fill:i}};let ws=(()=>{class i{constructor(e){this.sanitizer=e,this.onSendAttachment=new t.vpe,this.onCloseModalPreview=new t.vpe,this.hideHeaderCloseButton=!1,this.arrayFiles=[],this.isFilePendingToLoad=!1,this.HEIGHT_DEFAULT="20px",this.currentHeight=0,this.startScroll=!0,this.idDivScroll="c21-contentScroll-preview",this.isScrolling=!1,this.isIE=/msie\s|trident\//i.test(window.navigator.userAgent),this.firstScroll=!0,this.logger=ve.getInstance()}ngOnInit(){this.logger.log("[LOADER-PREVIEW-PAGE] Hello!",this.textInputTextArea),this.setFocusOnId("chat21-main-message-context-preview");for(let e=0;e<this.attachments.length;e++)this.logger.log("[LOADER-PREVIEW-PAGE] ngOnInit",this.attachments[e]),this.readAsDataURL(this.attachments[e])}getMetadataSize(e){void 0===e.width&&(e.width=230),void 0===e.height&&(e.height=230);const r={width:e.width,height:e.height};if(e.width&&e.width>230){const v=e.width/e.height;r.width=e.width=230,r.height=e.height=230/v}else if(e.width&&e.width<=55){const v=e.width/e.height;r.width=130,r.height=130/v}return e.height&&e.height>150&&(r.width=150/(e.height/e.width),r.height=150),r}readAsDataURL(e){this.logger.log("[LOADER-PREVIEW-PAGE] readAsDataURL file",e),e.file.type.startsWith("image")&&!e.file.type.includes("svg")?(this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE IMAGE - IMAGE ",e),this.fileSelected||(this.fileSelected=Object.assign({},this.attachments[0].metadata),this.fileSelected=Object.assign(this.fileSelected,this.getMetadataSize(this.fileSelected)))):e.file.type.startsWith("image")&&e.file.type.includes("svg")?(this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE SVG - SVG ",e),e.metadata.src=this.sanitizer.bypassSecurityTrustUrl(e.metadata.src),this.fileSelected||(this.fileSelected=Object.assign({},this.attachments[0].metadata),this.fileSelected=Object.assign(this.fileSelected,this.getMetadataSize(this.fileSelected)))):e.file.type.startsWith("image")||(this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE FILE - FILE ",e),this.logger.log("[LOADER-PREVIEW-PAGE] - readAsDataURL - USE CASE FILE - FILE TYPE",e.file.type),this.file_extension=e.file.name.substring(e.file.name.lastIndexOf(".")+1,e.file.name.length)||e.file.name,this.createFile(e))}createFile(e){var n=this;return(0,qt.Z)(function*(){const o=n;let v=yield(yield fetch(o.baseLocation+"/assets/images/file-alt-solid.png")).blob(),P=new File([v],e.file.name);n.logger.log("[LOADER-PREVIEW-PAGE] - createFile file - file",P);const Y=new FileReader;Y.onloadend=()=>{const X=new Image;n.logger.debug("[LOADER-PREVIEW-PAGE] onload ",X),X.src=Y.result.toString(),X.title=e.file.name,X.onload=function(){const ae={name:X.title,src:o.sanitizer.bypassSecurityTrustUrl(X.src),width:80,height:106,type:e.metadata.type,uid:e.metadata.uid};o.logger.debug("[LOADER-PREVIEW-PAGE] OK: ",ae),o.arrayFiles.push({metadata:ae}),o.fileSelected||(o.fileSelected=Object.assign({},ae))}},Y.readAsDataURL(P)})()}onTextAreaChange(){this.resizeInputField(),this.resizeModalHeight()}setFocusOnId(e){setTimeout(function(){const n=document.getElementById(e);n&&(n.setAttribute("value"," "),n.focus())},500)}resizeInputField(){try{const e=document.getElementById("chat21-main-message-context-preview");e.style.height="100%","\n"===e.value?(e.value="",e.style.height=this.HEIGHT_DEFAULT):e.scrollHeight>e.offsetHeight?(e.style.height=e.scrollHeight+2+"px",e.style.minHeight=this.HEIGHT_DEFAULT):e.style.height=this.HEIGHT_DEFAULT}catch(e){this.logger.error("[LOADER-PREVIEW-PAGE] > Error :"+e)}}resizeModalHeight(){try{const e=document.getElementById("chat21-main-message-context-preview"),n=+e.style.height.substring(0,e.style.height.length-2);n>20&&n<110?this.scrollMe.nativeElement.style.height="calc(39% + "+(n-20)+"px":n<=20&&(this.scrollMe.nativeElement.style.height="39%")}catch(e){this.logger.error("[LOADER-PREVIEW-PAGE] > Error :"+e)}}restoreTextArea(){this.resizeInputField();const e=document.getElementById("chat21-main-message-context-preview");this.textInputTextArea="",e?(e.value="",e.placeholder=this.translationMap.get("LABEL_PLACEHOLDER"),this.logger.debug("[LOADER-PREVIEW-PAGE] AppComponent:restoreTextArea::restoreTextArea::textArea:","restored")):this.logger.error("[LOADER-PREVIEW-PAGE] restoreTextArea::textArea:","not restored"),this.setFocusOnId("chat21-main-message-context-preview")}onkeypress(e){const n=e.which||e.keyCode;this.textInputTextArea=document.getElementById("chat21-main-message-context-preview").value,13===n?this.textInputTextArea&&""!==this.textInputTextArea.trim()&&(this.onSendAttachment.emit(this.textInputTextArea),this.restoreTextArea()):9===n&&e.preventDefault()}onkeydown(e){27===(e.which||e.keyCode)&&this.onClickClose()}onPaste(e){this.resizeInputField(),this.logger.debug("[LOADER-PREVIEW] onPaste",e)}onClickClose(){this.logger.debug("[LOADER-PREVIEW] onCLose"),this.onCloseModalPreview.emit()}onSendPressed(e){this.logger.debug("[LOADER-PREVIEW] onSendPressed",e),this.onSendAttachment.emit(this.textInputTextArea)}onImageRenderedFN(e){this.isFilePendingToLoad=!1}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.H7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-conversation-attachment-preview"]],viewQuery:function(e,n){if(1&e&&t.Gf(_s,5),2&e){let o;t.iGM(o=t.CRH())&&(n.scrollMe=o.first)}},inputs:{textInputTextArea:"textInputTextArea",attachments:"attachments",baseLocation:"baseLocation",translationMap:"translationMap",stylesMap:"stylesMap"},outputs:{onSendAttachment:"onSendAttachment",onCloseModalPreview:"onCloseModalPreview"},decls:29,vars:13,consts:[["id","c21-preview"],["id","divPreview",1,"modal-preview-image"],["divPreview",""],[1,"c21-header"],[1,"c21-header-container"],[1,"c21-header-content"],["tabindex","-1",1,"c21-header-button","c21-right","c21-close","c21-button-clean",3,"ngStyle","click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],["id","altIconTitle"],["id","scroll-me-preview",1,"c21-content"],["scrollMePreview",""],[3,"metadata","width","height","onImageRendered",4,"ngIf"],["id","img-preview-file-extension"],["id","c21-footer"],[1,"visible-text-area"],["start-focus-chat21-conversation-preview-component","","inputTextArea","","tabindex","1502","aria-labelledby","altTextArea","rows","1","id","chat21-main-message-context-preview",1,"f21textarea","c21-button-clean",3,"ngModel","placeholder","ngModelChange","keypress","keydown","paste"],["textbox",""],["tabindex","-1","id","chat21-button-send",1,"chat21-textarea-button",3,"click"],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",0,"xml","space","preserve",2,"enable-background","new 0 0 24 24"],["d","M1.8,18.9V1.7L22,10.3L1.8,18.9z M3.9,15.6l12.6-5.4L3.9,4.9v3.7l6.4,1.6l-6.4,1.6V15.6z M3.9,15.6V4.9v7V15.6z"],["id","testFocus","tabindex","1599","onFocus","document.querySelector('[start-focus-chat21-conversation-preview-component]').focus()"],["id","altTextArea",2,"display","none"],[3,"metadata","width","height","onImageRendered"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1,2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),t.NdJ("click",function(){return n.onClickClose()}),t.O4$(),t.TgZ(7,"svg",7),t._UZ(8,"path",8)(9,"path",9),t.TgZ(10,"title",10),t._uU(11),t.qZA()()()()()(),t.kcU(),t.TgZ(12,"div",11,12),t.YNc(14,vs,1,3,"chat-image",13),t.TgZ(15,"div",14),t._uU(16),t.qZA()(),t.TgZ(17,"div",15)(18,"div",16)(19,"textarea",17,18),t.NdJ("ngModelChange",function(r){return n.textInputTextArea=r})("ngModelChange",function(){return n.onTextAreaChange()})("keypress",function(r){return n.onkeypress(r)})("keydown",function(r){return n.onkeydown(r)})("paste",function(r){return n.onPaste(r)}),t._uU(21,"        "),t.qZA()(),t.TgZ(22,"div",19),t.NdJ("click",function(r){return n.onSendPressed(r)}),t.TgZ(23,"span",20),t.O4$(),t.TgZ(24,"svg",21),t._UZ(25,"path",22),t.qZA()()()()()(),t.kcU(),t._UZ(26,"span",23),t.TgZ(27,"span",24),t._uU(28,"scrivi la tua domanda"),t.qZA()),2&e&&(t.xp6(6),t.Q6J("ngStyle",t.VKq(9,bs,n.hideHeaderCloseButton?"none":"flex")),t.xp6(1),t.Q6J("ngStyle",t.VKq(11,Cs,null==n.stylesMap?null:n.stylesMap.get("themeColor"))),t.xp6(4),t.Oqu(null==n.translationMap?null:n.translationMap.get("CLOSE")),t.xp6(3),t.Q6J("ngIf",n.fileSelected),t.xp6(2),t.hij("",n.file_extension," "),t.xp6(3),t.s9C("placeholder",null==n.translationMap?null:n.translationMap.get("LABEL_PLACEHOLDER")),t.Q6J("ngModel",n.textInputTextArea),t.xp6(3),t.ekj("active",!n.isFilePendingToLoad))},dependencies:[ue.O5,ue.PC,be.Fj,be.JJ,be.On,Ln],styles:["[_nghost-%COMP%]   .c21-content[_ngcontent-%COMP%]    >chat-image div{margin:2px auto!important}#c21-preview[_ngcontent-%COMP%]{--margin-top: 200px;--margin-left: 50px;--margin-right: 50px;--header-height: 40px;--modal-height: 240px;--modal-width: 80%;--content-height: 160px;--border-radius: 16px;background-color:#0006;height:100%;width:100%;position:absolute;z-index:25}#c21-preview[_ngcontent-%COMP%]   .modal-preview-image[_ngcontent-%COMP%]{width:auto;height:auto;min-height:var(--modal-height);min-width:100px;max-width:80%;border-radius:var(--border-radius);font-size:1.2em;line-height:normal;overflow:hidden;background-color:#fff;z-index:25;margin:auto;margin-top:var(--margin-top)}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{height:calc(var(--header-height));width:var(--modal-width);position:fixed;top:var(--margin-top)}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{height:calc(var(--header-height))}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;display:inline-block;width:auto;height:40px;padding:0;margin:0 10px;font-size:1em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}#c21-preview[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{margin:6px;width:30px;height:30px}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]{position:fixed;top:calc(var(--margin-top) + var(--header-height));width:var(--modal-width);height:var(--content-height);display:flex;justify-content:center;align-items:center}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #c21-contentScroll-preview[_ngcontent-%COMP%]{position:absolute;left:0;right:10px;padding:10px;opacity:0;transition:opacity .5s;transition-timing-function:ease-in}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden;position:absolute;top:0;right:0}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview[_ngcontent-%COMP%]{scroll-behavior:smooth}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #scroll-me-preview.withoutAnimation[_ngcontent-%COMP%]{scroll-behavior:unset}#c21-preview[_ngcontent-%COMP%]   .c21-content[_ngcontent-%COMP%]   #img-preview-file-extension[_ngcontent-%COMP%]{text-align:center;position:absolute;text-transform:uppercase;color:#fff;bottom:30px;font-weight:500}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]{position:fixed;top:calc(var(--margin-top) + var(--header-height) + var(--content-height));width:var(--modal-width);border-radius:var(--border-radius);background:white;--heigth: calc( var(--modal-height) - var(--header-height) - var(--content-height));--paddingTopBottom: 8px;display:flex;gap:5px;padding:var(--paddingTopBottom) 10px;box-sizing:border-box}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word;resize:horizontal;overflow-y:auto;box-sizing:border-box;color:#1a1a1a;min-width:100%;outline:0;resize:none;font-size:1.4em;line-height:1.4em;font-weight:300;max-height:110px;min-height:auto;height:20px;padding:0 12px;margin:10px 0;border:none}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-main-message-context-preview[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button[_ngcontent-%COMP%]{position:absolute;display:block;bottom:22px;height:var(--heigth);opacity:.3;cursor:initial}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button.active[_ngcontent-%COMP%]{opacity:1;cursor:pointer}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   #chat21-button-send[_ngcontent-%COMP%]{right:8px;bottom:var(--paddingTopBottom)}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .visible-text-area[_ngcontent-%COMP%]{pointer-events:auto;border-radius:10px;background-color:#f6f7fb;-webkit-box-flex:1;width:88%}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button[_ngcontent-%COMP%]{pointer-events:auto}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   .chat21-textarea-button[_ngcontent-%COMP%]{fill:#5f6368;pointer-events:auto}#c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:visited, #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:hover, #c21-preview[_ngcontent-%COMP%]   #c21-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:active{all:unset}"]}),i})();const ys=["iframe"],Hn=function(i){return{fill:i}};function Os(i,a){if(1&i){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.returnOpenExternal())}),t.O4$(),t.TgZ(1,"svg",3),t._UZ(2,"path",15)(3,"path",16),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.VKq(1,Hn,null==e.stylesMap?null:e.stylesMap.get("foregroundColor")))}}function xs(i,a){1&i&&(t.TgZ(0,"div",17),t._UZ(1,"div")(2,"div")(3,"div")(4,"div")(5,"div")(6,"div")(7,"div")(8,"div"),t.qZA())}const Ms=function(i){return{"background-image":i}},Es=function(i){return{color:i}};let Ss=(()=>{class i{constructor(e){this.sanitizer=e,this.onOpenExternal=new t.vpe,this.onClose=new t.vpe,this.isOpen="open",this.hideSpinner=!1,this.logger=ve.getInstance(),this.convertColorToRGBA=ke}ngOnInit(){this.button&&this.button.link&&(this.url=this.sanitizer.bypassSecurityTrustResourceUrl(this.button.link))}ngAfterViewInit(){this.logger.debug("[INTERNALFRAME] ngAfterViewInit",this.iframe.nativeElement.contentDocument||this.iframe.nativeElement.contentWindow,this.iframe.nativeElement.contentWindow,this.iframe.nativeElement.contentWindow.history)}ngOnDestroy(){this.url=null,this.hideSpinner=!1}returnClose(){this.isOpen="closed",this.onClose.emit()}returnOpenExternal(){this.onOpenExternal.emit(this.button)}onIframeLoaded(e){this.hideSpinner=!0}onError(e){this.logger.error("[INTERNALFRAME] onError ",e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.H7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-internal-frame"]],viewQuery:function(e,n){if(1&e&&t.Gf(ys,5),2&e){let o;t.iGM(o=t.CRH())&&(n.iframe=o.first)}},inputs:{button:"button",openExternalLinkButton:"openExternalLinkButton",stylesMap:"stylesMap",translationMap:"translationMap"},outputs:{onOpenExternal:"onOpenExternal",onClose:"onClose"},decls:16,vars:15,consts:[[1,"c21-iframe-container"],[1,"c21-iframe-header","c21-header",3,"ngStyle"],["tabindex","1530",1,"c21-header-button","c21-left","c21-button-clean",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],["id","altIconTitle"],["tabindex","1530","class","c21-header-button c21-right c21-button-clean",3,"click",4,"ngIf"],[1,"c21-title",3,"ngStyle"],[1,"titleText"],[1,"c21-iframe"],["class","lds-roller",4,"ngIf"],["id","contentFrame","allowfullscreen","","title","","width","100%","height","100%",2,"border","none",3,"src","load","error"],["iframe",""],["tabindex","1530",1,"c21-header-button","c21-right","c21-button-clean",3,"click"],["d","M0 0h24v24H0z","fill","none"],["d","M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"],[1,"lds-roller"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return n.returnClose()}),t.O4$(),t.TgZ(3,"svg",3),t._UZ(4,"path",4)(5,"path",5),t.TgZ(6,"title",6),t._uU(7),t.qZA()()(),t.YNc(8,Os,4,3,"button",7),t.kcU(),t.TgZ(9,"div",8)(10,"div",9),t._uU(11),t.qZA()()(),t.TgZ(12,"div",10),t.YNc(13,xs,9,0,"div",11),t.TgZ(14,"iframe",12,13),t.NdJ("load",function(r){return n.onIframeLoaded(r)})("error",function(r){return n.onError(r)}),t.qZA()()()),2&e&&(t.Q6J("@enterAnimation",void 0),t.xp6(1),t.Q6J("ngStyle",t.VKq(9,Ms,null==n.stylesMap?null:n.stylesMap.get("colorGradient"))),t.xp6(2),t.Q6J("ngStyle",t.VKq(11,Hn,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(null==n.translationMap?null:n.translationMap.get("CLOSE")),t.xp6(1),t.Q6J("ngIf",n.openExternalLinkButton),t.xp6(1),t.Q6J("ngStyle",t.VKq(13,Es,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(2),t.Oqu(null==n.button?null:n.button.value),t.xp6(2),t.Q6J("ngIf",!n.hideSpinner),t.xp6(1),t.Q6J("src",n.url,t.uOi))},dependencies:[ue.O5,ue.PC],styles:['.c21-iframe-container[_ngcontent-%COMP%]{max-width:100%;height:100%;width:100%;position:fixed;background-color:#fff;z-index:10}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]{left:0;right:0}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{display:block;align-items:center;text-align:center;width:40px;height:40px;margin:6px;padding:0;cursor:pointer}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button.c21-right[_ngcontent-%COMP%]{float:right}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button.c21-left[_ngcontent-%COMP%]{float:left}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button.c21-close[_ngcontent-%COMP%]{display:none}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:20px;width:20px;margin:10px}.c21-iframe-container[_ngcontent-%COMP%]   .c21-iframe[_ngcontent-%COMP%]{height:calc(100% - 40px)}.lds-roller[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;margin:30px auto}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{animation:lds-roller 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:7px;height:7px;border-radius:50%;background:rgb(30,96,181);margin:-4px 0 0 -4px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1){animation-delay:-36ms}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1):after{top:63px;left:63px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){animation-delay:-72ms}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2):after{top:68px;left:56px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){animation-delay:-.108s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3):after{top:71px;left:48px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4){animation-delay:-.144s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4):after{top:72px;left:40px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(5){animation-delay:-.18s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(5):after{top:71px;left:32px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(6){animation-delay:-.216s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(6):after{top:68px;left:24px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(7){animation-delay:-.252s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(7):after{top:63px;left:17px}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(8){animation-delay:-.288s}.lds-roller[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(8):after{top:56px;left:12px}@keyframes lds-roller{0%{transform:rotate(0)}to{transform:rotate(360deg)}}'],data:{animation:[(0,Pe.X$)("enterAnimation",[(0,Pe.eR)(":enter",[(0,Pe.oB)({transform:"translateX(100%)",opacity:0}),(0,Pe.jt)("400ms",(0,Pe.oB)({transform:"translateX(0)",opacity:1}))]),(0,Pe.eR)(":leave",[(0,Pe.oB)({transform:"translateX(0)",opacity:1}),(0,Pe.jt)("400ms",(0,Pe.oB)({transform:"translateX(100%)",opacity:0}))])])]}}),i})();const Ts=["afConversationComponent"];function Ps(i,a){1&i&&(t.TgZ(0,"div",10)(1,"div",11),t._uU(2," drop zone "),t.qZA()())}function ks(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-internal-frame",12),t.NdJ("onOpenExternal",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onOpenExternalFrame(o))})("onClose",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onCloseInternalFrame(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("button",e.buttonClicked)("openExternalLinkButton",null==e.g?null:e.g.openExternalLinkButton)("translationMap",e.translationMapHeader)("stylesMap",e.stylesMap)}}function As(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-conversation-attachment-preview",13),t.NdJ("onSendAttachment",function(o){t.CHM(e);const r=t.oxw();return t.KtG(r.onSendAttachment(o))})("onCloseModalPreview",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onCloseModalPreview())}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("textInputTextArea",e.textInputTextArea)("attachments",e.attachments)("baseLocation",null==e.g?null:e.g.baseLocation)("translationMap",e.translationMapPreview)("stylesMap",e.stylesMap)}}function Is(i,a){if(1&i&&(t.O4$(),t.kcU(),t.TgZ(0,"div",19),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.messagesBadgeCount)}}function Rs(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",14),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.scrollToBottom())}),t.O4$(),t.TgZ(1,"svg",15),t._UZ(2,"path",16)(3,"path",17),t.qZA(),t.YNc(4,Is,2,1,"div",18),t.qZA()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",0!=e.messagesBadgeCount)}}let Ls=(()=>{class i{constructor(e,n,o,r,v,P,Y,X,ae,fe,Ce,de,we){this.g=e,this.starRatingWidgetService=n,this.sanitizer=o,this.appComponent=r,this.appStorageService=v,this.conversationHandlerBuilderService=P,this.appConfigService=Y,this.customTranslateService=X,this.chatManager=ae,this.typingService=fe,this.tiledeskRequestService=Ce,this.changeDetectorRef=de,this.elementRef=we,this.onBackHome=new t.vpe,this.onCloseWidget=new t.vpe,this.onSoundChange=new t.vpe,this.onConversationClosed=new t.vpe,this.onSignOut=new t.vpe,this.onBeforeMessageSent=new t.vpe,this.onAfterSendMessage=new t.vpe,this.onNewConversationInit=new t.vpe,this.onBeforeMessageRender=new t.vpe,this.onAfterMessageRender=new t.vpe,this.onNewMessageCreated=new t.vpe,this.onNewConversationButtonClicked=new t.vpe,this.isMenuShow=!1,this.isEmojiiPickerShow=!1,this.isButtonsDisabled=!0,this.hideFooterTextReply=!1,this.hideTextAreaContent=!1,this.footerMessagePlaceholder="",this.isTrascriptDownloadEnabled=!1,this.showContinueConversationButton=!1,this.isScrolling=!1,this.idDivScroll="c21-contentScroll",this.showBadgeScroollToBottom=!1,this.messagesBadgeCount=0,this.isFileSelected=!1,this.isOpenAttachmentPreview=!1,this.isPopupUrl=on,this.popupUrl=At,this.messages=[],this.CLIENT_BROWSER=navigator.userAgent,this.subscriptions=[],this.unsubscribe$=new ns.xQ,this.isIE=/msie\s|trident\//i.test(window.navigator.userAgent),this.firstScroll=!0,this.isHovering=!1,this.tooltipOptions={"show-delay":1500,"tooltip-class":"chat-tooltip",theme:"light",shadow:!1,"hide-delay-mobile":0,hideDelayAfterClick:3e3,"hide-delay":200},this.isTypings=!1,this.isDirect=!1,this.membersConversation=["SYSTEM"],this.isButtonUrl=!1,this.logger=ve.getInstance()}onResize(e){this.logger.debug("[CONV-COMP] resize event",e)}ngOnInit(){this.logger.debug("[CONV-COMP] ngOnInit: ",this.senderId),this.showMessageWelcome=!1,this.translations()}translations(){this.translationMapHeader=this.customTranslateService.translateLanguage(["LABEL_LAST_ACCESS","LABEL_WRITING","BUTTON_CLOSE_TO_ICON","OPTIONS","PREV_CONVERSATIONS","SOUND_OFF","SOUND_ON","DOWNLOAD_TRANSCRIPT","BACK","CLOSE","MAXIMIZE","MINIMIZE","CLOSE_CHAT","RESTART","LOGOUT"]),this.translationMapFooter=this.customTranslateService.translateLanguage(["LABEL_PLACEHOLDER","GUEST_LABEL","LABEL_START_NW_CONV","CONTINUE"]),this.translationMapContent=this.customTranslateService.translateLanguage(["INFO_SUPPORT_USER_ADDED_SUBJECT","INFO_SUPPORT_USER_ADDED_YOU_VERB","INFO_SUPPORT_USER_ADDED_COMPLEMENT","INFO_SUPPORT_USER_ADDED_VERB","INFO_SUPPORT_CHAT_REOPENED","INFO_SUPPORT_CHAT_CLOSED","INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU","INFO_SUPPORT_LEAD_UPDATED","INFO_SUPPORT_MEMBER_LEFT_GROUP","INFO_SUPPORT_LIVE_PAGE","LABEL_TODAY","LABEL_TOMORROW","LABEL_LOADING","LABEL_TO","ARRAY_DAYS"]),this.translationMapPreview=this.customTranslateService.translateLanguage(["BACK","CLOSE","LABEL_PLACEHOLDER","LABEL_PREVIEW"])}ngAfterViewInit(){this.logger.debug("[CONV-COMP] --------ngAfterViewInit: conversation-------- "),setTimeout(()=>{this.initAll(),!0===this.g.newConversationStart&&(this.onNewConversationComponentInit(),this.g.newConversationStart=!1),this.setSubscriptions(),this.afConversationComponent&&this.afConversationComponent.nativeElement.focus(),this.isButtonsDisabled=!1},300)}ngAfterViewChecked(){this.changeDetectorRef.detectChanges()}ngOnChanges(e){this.logger.debug("[CONV-COMP] onChagnges",e),this.stylesMap&&(this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))),e&&e.conversationId&&void 0!==e.conversationId.previousValue&&e.conversationId.previousValue!==e.conversationId.currentValue&&(this.logger.debug("[CONV-COMP] UID CHANGESSSS",e.conversationId),this.ngOnDestroy(),this.ngOnInit(),this.ngAfterViewInit())}updateConversationBadge(){if(this.logger.debug("[CONV-COMP] updateConversationBadge",this.conversationId,this.isConversationArchived),this.isConversationArchived&&this.conversationId&&this.archivedConversationsHandlerService&&this.archivedConversationsHandlerService.setConversationRead(this.conversationId),!this.isConversationArchived&&this.conversationId&&this.conversationsHandlerService){this.conversationsHandlerService.setConversationRead(this.conversationId);const e=this.conversationsHandlerService.countIsNew();this.g.setParameter("conversationsBadge",e)}}initAll(){this.logger.debug("[CONV-COMP] ------ 2: setConversation ------ "),this.setConversation(),this.logger.debug("[CONV-COMP] ------ 3: connectConversation ------ "),this.initConversationHandler(),this.logger.debug("[CONV-COMP] ------ 4: initializeChatManager ------ "),this.logger.debug("[CONV-COMP] ------ 6: getConversationDetail ------ ",this.conversationId),this.getConversationDetail(e=>{this.logger.debug("[CONV-COMP] ------ 6: updateConversationbage ------ "),this.updateConversationBadge()}),this.g.customAttributes&&this.updateUserInfo(this.g.customAttributes),this.logger.debug("[CONV-COMP] ------ 7: initializeTyping()",this.conversationId),this.initializeTyping()}getConversationDetail(e){this.logger.debug("[CONV-COMP] getConversationDetail: isConversationArchived???",this.isConversationArchived,this.conversationWith),this.conversationsHandlerService.getConversationDetail(this.conversationWith,n=>{this.logger.debug("[CONV-COMP] getConversationDetail: conversationsHandlerService ",this.conversationWith,n,this.isConversationArchived),n&&(this.conversation=n,this.isConversationArchived=!1,e(this.isConversationArchived)),n||(this.logger.debug("[CONV-COMP] getConversationDetail: conv not exist --\x3e search in archived list",this.isConversationArchived,this.conversationWith),this.archivedConversationsHandlerService.getConversationDetail(this.conversationWith,o=>{this.logger.debug("[CONV-COMP] getConversationDetail: archivedConversationsHandlerService",this.conversationWith,o,this.isConversationArchived),o?(this.conversation=o,this.isConversationArchived=!0,this.showContinueConversationButton=function ao(i,a){const e=nt(i),n=nt(a),o=nt.duration(n.diff(e));return{days:o.asDays(),hours:o.asHours(),minutes:o.asMinutes()}}(this.conversation.timestamp,Date.now()).hours<this.g.continueConversationBeforeTime,e(this.isConversationArchived)):o||e(null)}))})}setConversation(){const e=this.g.recipientId,n=this.g.channelType;this.logger.debug("[CONV-COMP] setConversation recipientId::: ",e,n),e||this.g.setParameter("recipientId",this.setRecipientId()),n||this.g.setParameter("channelType",this.setChannelType()),this.conversationWith=e,this.logger.debug("[CONV-COMP] setConversation conversation::: ",this.conversation),this.conversation||(this.conversation=new ts(e,this.g.attributes,n,this.g.recipientFullname,this.conversationWith,e,this.g.recipientFullname,"",!0,"","",this.senderId,"",this.g.userFullname,"0","",!0,"","",!1,"text"))}setRecipientId(){let e;return e=this.appStorageService.getItem(this.senderId),e||(e=tn+this.g.projectid+"-"+(0,pt.Z)().replace(/-/g,""),this.logger.debug("[CONV-COMP] recipitent",e)),e}setChannelType(){let e="group";const n=this.g.projectid;return this.g.recipientId&&-1!==this.g.recipientId.indexOf("group")?e="group":n||(e="direct"),e}initConversationHandler(){const e=this.g.tenant;this.messages=[];const n={uid:this.senderId},o=this.g.recipientFullname;this.logger.debug("[CONV-COMP] initconversation NEWWW",n,o,e),this.showMessageWelcome=!1;const r=this.chatManager.getConversationHandlerByConversationId(this.conversationWith);if(this.logger.debug("[CONV-COMP] DETTAGLIO CONV - handler **************",r,this.conversationWith),r)this.logger.debug("[CONV-COMP] NON ENTRO ***",this.conversationHandlerService,r),this.conversationHandlerService=r,this.messages=this.conversationHandlerService.messages;else{this.conversationHandlerService=this.conversationHandlerBuilderService.build(),this.conversationHandlerService.initialize(this.conversationWith,o,n,e,this.translationMapContent,this.g.showInfoMessage),this.conversationHandlerService.connect(),this.logger.debug("[CONV-COMP] DETTAGLIO CONV - NEW handler **************",this.conversationHandlerService),this.messages=this.conversationHandlerService.messages,this.sendFirstMessagePreChatForm(),this.logger.debug("[CONV-COMP] DETTAGLIO CONV - messages **************",this.messages),this.chatManager.addConversationHandler(this.conversationHandlerService);const v=this;setTimeout(()=>{(!v.messages||0===v.messages.length)&&(v.showMessageWelcome=!0,v.logger.debug("[CONV-COMP] setTimeout ***",v.showMessageWelcome))},8e3)}this.logger.debug("[CONV-COMP] CONVERSATION MESSAGES "+this.messages),this.conversationsHandlerService=this.chatManager.conversationsHandlerService,this.archivedConversationsHandlerService=this.chatManager.archivedConversationsService}sendFirstMessagePreChatForm(){setTimeout(()=>{this.messages&&0===this.messages.length&&(this.logger.debug("[CONV-COMP] sendFirstMessage: messages + attributes ",this.messages,this.g.attributes),this.g.attributes&&this.g.attributes.preChatForm&&this.g.attributes.preChatForm.firstMessage)&&this.conversationFooter.sendMessage(this.g.attributes.preChatForm.firstMessage,ft,this.g.attributes)},1e3)}sendLivePage(){setTimeout(()=>{const e="Moved to: ["+this.g.attributes.sourceTitle+"]("+this.g.attributes.sourcePage+")",n={subtype:"info/support",messagelabel:{key:Z}};this.logger.debug("[CONV-COMP] sendLivePage --\x3e attributes+message",n,e),this.conversationFooter.sendMessage(e,ft,null,n)},1e3)}initializeTyping(){this.logger.debug("[CONV-COMP] membersconversation",this.membersConversation),this.membersConversation.push(this.senderId),this.typingService.isTyping(this.conversationId,this.senderId,this.isDirect)}subscribeTypings(e){const n=this;try{const o=e.uidUserTypingNow,r=e.waitTime;this.nameUserTypingNow=null,this.idUserTypingNow=null,e.nameUserTypingNow&&(this.nameUserTypingNow=e.nameUserTypingNow),e.uidUserTypingNow&&(this.idUserTypingNow=e.uidUserTypingNow),this.logger.debug("[CONV-COMP] subscribeTypings data:",e),!this.membersConversation.includes(o)&&o&&(this.isTypings=!0,setTimeout(function(){n.conversationContent.scrollToBottom()},0),this.setTimeoutWritingMessages=setTimeout(()=>{n.isTypings=!1},r))}catch(o){this.logger.error("[CONV-COMP] error: ",o)}}initiTimeout(e){const n=this;this.setTimeoutWritingMessages=setTimeout(()=>{n.isTypings=!1},e)}resetTimeout(){this.isTypings=!1,this.setTimeoutWritingMessages=null,clearTimeout(this.setTimeoutWritingMessages)}setSubscriptions(){const e=this;let n,o;o="starRating",n=this.subscriptions.find(r=>r.key===o),n||(this.starRatingWidgetService.setOsservable(!1),this.logger.debug("[CONV-COMP] setSubscriptions!!!! StartRating",this.starRatingWidgetService.obsCloseConversation.value),n=this.starRatingWidgetService.obsCloseConversation.pipe((0,tt.R)(this.unsubscribe$)).subscribe(v=>{this.logger.debug("[CONV-COMP] startratingggg",v),e.g.setParameter("isOpenStartRating",v),!1===v?this.logger.debug("[CONV-COMP] NOT OPEN StartRating **"):!0===v&&this.logger.debug("[CONV-COMP] OPEN StartRating **")}),this.subscriptions.push({key:o,value:n})),o="messageAdded",n=this.subscriptions.find(r=>r.key===o),n||(this.logger.debug("[CONV-COMP] ***** add messageAdded *****",this.conversationHandlerService),n=this.conversationHandlerService.messageAdded.pipe((0,tt.R)(this.unsubscribe$)).subscribe(v=>{this.logger.debug("[CONV-COMP] ***** DETAIL messageAdded *****",v),v&&(e.newMessageAdded(v),this.onNewMessageCreated.emit(v),this.checkMessagesLegntForTranscriptDownloadMenuOption(),this.resetTimeout())}),this.subscriptions.push({key:o,value:n})),o="conversationsRemoved",n=this.subscriptions.find(r=>r.key===o),n||(n=this.chatManager.conversationsHandlerService.conversationRemoved.pipe((0,tt.R)(this.unsubscribe$)).subscribe(v=>{this.logger.debug("[CONV-COMP] ***** DATAIL conversationsRemoved *****",v,this.conversationWith,this.isConversationArchived),v&&v.uid===this.conversationWith&&(this.isConversationArchived=!0,this.g.nativeRating&&this.starRatingWidgetService.setOsservable(!0),this.g.nativeRating||this.onConversationClosed.emit(v.uid))}),this.subscriptions.push({key:o,value:n})),o="conversationsChanged",n=this.subscriptions.find(r=>r.key===o),n||(n=this.chatManager.conversationsHandlerService.conversationChanged.pipe((0,tt.R)(this.unsubscribe$)).subscribe(v=>{this.logger.debug("[CONV-COMP] ***** DATAIL conversationsChanged *****",v,this.conversationWith,this.isConversationArchived),(!v||v.recipient!==this.g.senderId||!gn(v))&&v&&v.sender!==this.senderId&&e.conversationContent.checkContentScrollPosition()&&v.is_new&&(this.logger.debug("[CONV-COMP] updateConversationBadge..."),e.updateConversationBadge())}),this.subscriptions.push({key:o,value:n})),o="messageWait",n=this.subscriptions.find(r=>r.key===o),n||(this.logger.debug("[CONV-COMP] ***** add messageWait *****",this.conversationHandlerService),n=this.conversationHandlerService.messageWait.pipe((0,tt.R)(this.unsubscribe$)).subscribe(v=>{this.logger.debug("[CONV-COMP] ***** DETAIL messageWait *****",v),v&&v.waitTime&&0!==v.waitTime&&this.conversationId===v.uid&&e.subscribeTypings(v)}),this.subscriptions.push({key:o,value:n})),o="messageInfo",n=this.subscriptions.find(r=>r.key===o),n||(this.logger.debug("[CONV-COMP] ***** add messageInfo *****",this.conversationHandlerService),n=this.conversationHandlerService.messageInfo.pipe((0,tt.R)(this.unsubscribe$)).subscribe(v=>{this.logger.debug("[CONV-COMP] ***** DETAIL messageInfo *****",v),v&&this.updateLeadInfo(v)}),this.subscriptions.push({key:o,value:n})),o="conversationTyping",n=this.subscriptions.find(r=>r.key===o),n||(n=this.typingService.BSIsTyping.pipe((0,tt.R)(this.unsubscribe$)).subscribe(v=>{this.logger.debug("[CONV-COMP] ***** BSIsTyping *****",v),v&&this.conversationId===v.uid&&e.subscribeTypings(v)}),this.subscriptions.push({key:o,value:n}))}checkMessagesLegntForTranscriptDownloadMenuOption(){this.messages.length>1&&this.g.allowTranscriptDownload&&(this.isTrascriptDownloadEnabled=!0)}newMessageAdded(e){const n=this,o=n.senderId;e.sender===o?(n.logger.debug("[CONV-COMP] *A1-------"),setTimeout(function(){n.conversationContent.scrollToBottom()},200)):e.sender!==o&&(n.conversationContent.checkContentScrollPosition()?(n.logger.debug("[CONV-COMP] *A2-------"),setTimeout(function(){n.conversationContent.scrollToBottom()},200)):(n.logger.debug("[CONV-COMP] *A3-------"),n.messagesBadgeCount++),e.attributes&&e.attributes.disableInputMessage?this.hideFooterTextReply=e.attributes.disableInputMessage:e.attributes&&!e.attributes.disableInputMessage&&(this.hideFooterTextReply=!1),this.footerMessagePlaceholder=e.attributes&&e.attributes.inputMessagePlaceholder?e.attributes.inputMessagePlaceholder:"")}updateLeadInfo(e){if(e.attributes&&e.attributes.updateUserFullname){const n=e.attributes.updateUserFullname;this.logger.debug("[CONV-COMP] newMessageAdded --\x3e updateUserFullname",n),this.g.setAttributeParameter("userFullname",n),this.g.setParameter("userFullname",n),this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes))}if(e.attributes&&e.attributes.updateUserEmail){const n=e.attributes.updateUserEmail;this.logger.debug("[CONV-COMP] newMessageAdded --\x3e userEmail",n),this.g.setAttributeParameter("userEmail",n),this.g.setParameter("userEmail",n),this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes))}}updateUserInfo(e){if(e&&e.userFullname){const n=e.userFullname;this.logger.debug("[CONV-COMP] updateUserInfo --\x3e userFullname",n),this.g.setAttributeParameter("userFullname",n),this.g.setParameter("userFullname",n)}if(e&&e.userEmail){const n=e.userEmail;this.logger.debug("[CONV-COMP] updateUserInfo --\x3e userEmail",n),this.g.setAttributeParameter("userEmail",n),this.g.setParameter("userEmail",n)}this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes))}scrollToBottom(){this.conversationContent.scrollToBottom()}onBackHomeFN(){this.onBackHome.emit()}onCloseWidgetFN(){this.onCloseWidget.emit()}onSoundChangeFN(e){this.onSoundChange.emit(e)}onCloseChat(e){this.logger.debug("[CONV-COMP] close chat with uid ",this.conversation.uid),this.tiledeskRequestService.closeSupportGroup(this.conversation.uid).then(n=>{"closed"===n&&(this.isMenuShow=!1,this.logger.debug("[CONV-COMP] chat closed successfully with uid ",this.conversation.uid))}).catch(n=>{this.logger.error("[CONV-COMP] ERROR while closing chat with id: ",this.conversation.uid,n)})}onRestartChat(e){this.hideTextAreaContent=!0}onWidgetHeightChange(e){var n=this.g.windowContext.window.document.getElementById("tiledeskdiv");"max"===e?n.style.maxHeight="unset":"min"===e&&(n.style.maxHeight="620px"),this.isMenuShow=!1}onSignOutFN(e){this.onSignOut.emit(!0)}onMenuOption(e){this.isMenuShow=e,this.conversationFooter.removeFocusOnId("chat21-main-message-context")}onBeforeMessageRenderFN(e){this.onBeforeMessageRender.emit(e)}onAfterMessageRenderFN(e){this.onAfterMessageRender.emit(e)}onAttachmentButtonClicked(e){if(this.logger.debug("[CONV-COMP] eventbutton",e),e&&e.target.type)switch(e.target.type){case"url":try{this.openLink(e.target.button)}catch(n){this.logger.error("[CONV-COMP] url > Error :"+n)}return;case"action":try{this.actionButton(e.target.button)}catch(n){this.logger.error("[CONV-COMP] action > Error :"+n)}return!1;case"text":try{this.conversationFooter.sendMessage(e.target.button.value,ft,{button:!0})}catch(n){this.logger.error("[CONV-COMP] text > Error :"+n)}default:return}}onScrollContent(e){this.showBadgeScroollToBottom=!e,this.logger.debug("[CONV-COMP] scroool eventtt",e),this.showBadgeScroollToBottom||(this.messagesBadgeCount=0,this.updateConversationBadge())}onOpenExternalFrame(e){window.open(e.link,"_blank")}onCloseInternalFrame(e){this.isButtonUrl=!1,this.buttonClicked=null,this.restoreDefaultWidgetSize()}onSendAttachment(e){this.isOpenAttachmentPreview=!1,this.conversationFooter.uploadSingle(this.attachments[0].metadata,this.attachments[0].file,e)}onCloseModalPreview(){this.isOpenAttachmentPreview=!1,this.conversationFooter.isFilePendingToUpload=!1,this.logger.debug("[CONV-COMP] onCloseModalPreview::::",this.isOpenAttachmentPreview,this.conversationFooter)}onEmojiiPickerShow(e){this.isEmojiiPickerShow=e}onBeforeMessangeSentFN(e){this.onBeforeMessageSent.emit(e)}onAfterSendMessageFN(e){this.onAfterSendMessage.emit(e)}onChangeTextArea(e){if(e&&e.textAreaEl){const n=this.conversationContent.scrollMe,o=+e.textAreaEl.style.height.substring(0,e.textAreaEl.style.height.length-2);o>20&&o<110?(n.nativeElement.style.height="calc(100% - "+(o-20)+"px",this.scrollToBottom()):o<=20&&(n.nativeElement.style.height="100%")}}onAttachmentFileButtonClicked(e){this.logger.debug("[CONV-COMP] onAttachmentButtonClicked::::",e),this.attachments=e.attachments,this.textInputTextArea=e.message,this.logger.debug("[CONV-COMP] onAttachmentButtonClicked::::",this.textInputTextArea),this.isOpenAttachmentPreview=!0}onNewConversationButtonClickedFN(e){this.logger.debug("[CONV-COMP] floating onNewConversationButtonClicked"),this.onNewConversationButtonClicked.emit()}onBackButton(e){this.hideTextAreaContent=e;try{document.getElementById("chat21-footer").classList.remove("maximize-width")}catch(n){this.logger.error("[CONV-COMP] onBackButton > Error :"+n)}}openInputFiles(){alert("ok"),document.getElementById("chat21-file")&&(document.getElementById("chat21-file").style.display="block")}ngOnDestroy(){this.logger.debug("[CONV-COMP] ngOnDestroy ------------------\x3e this.subscriptions",this.subscriptions),this.isConversationArchived=!1,this.hideTextAreaContent=!1,this.conversationFooter.textInputTextArea="",this.hideFooterTextReply=!1,this.footerMessagePlaceholder="",this.unsubscribe()}unsubscribe(){this.logger.debug("[CONV-COMP] ******* unsubscribe *******"),this.unsubscribe$.next(),this.unsubscribe$.complete(),this.chatManager.conversationsHandlerService.conversationRemoved.next(null),this.conversationHandlerService.messageWait.next(null),this.typingService.BSIsTyping.next(null),this.subscriptions.forEach(function(e){e.value.unsubscribe()}),this.subscriptions=[],this.subscriptions.length=0,this.logger.debug("[CONV-COMP]this.subscriptions",this.subscriptions)}onIncreaseWith(){try{this.g.windowContext.window.document.getElementById("tiledeskdiv").classList.add("increaseSize"),document.getElementById("chat21-conversations").style.borderRadius="16px"}catch(e){this.logger.error("[CONV-COMP] onIncreaseWith > Error :"+e)}}restoreDefaultWidgetSize(){try{const e=this.g.windowContext.window.document.getElementById("tiledeskdiv");e.classList.remove("increaseSize"),e.classList.remove("decreaseSize")}catch(e){this.logger.error("[CONV-COMP] restoreDefaultWidgetSize > Error :"+e)}}openLink(e){const n=e.link?e.link:"",o=e.target?e.target:"";"self"===o?(this.isButtonUrl=!0,this.buttonClicked=e):"parent"===o?window.open(n,"_parent"):window.open(n,"_blank")}actionButton(e){this.conversationFooter.sendMessage(e.value?e.value:"",ft,null,{action:e.action?e.action:"",subtype:e.show_echo?"":"info"}),this.logger.debug("[CONV-COMP] > action :")}onNewConversationComponentInit(){this.logger.debug("[CONV-COMP] ------- onNewConversationComponentInit ------- "),this.setConversation();const e=this.conversationWith,n=this.g.default_settings,o=this.appConfigService.getConfig();this.onNewConversationInit.emit({global:this.g,default_settings:n,newConvId:e,appConfigs:o})}drop(e){e.preventDefault(),e.stopPropagation(),this.logger.log("[CONV-COMP] ----\x3e FILE - DROP ev ",e);const n=e.dataTransfer.files;this.logger.log("[CONV-COMP] ----\x3e FILE - DROP ev.dataTransfer.files ",n),this.isHovering=!1,n.length>0&&(this.logger.log("[CONV-COMP] ----\x3e FILE - DROP file ",n[0]),this.logger.log("[CONV-COMP] ----\x3e FILE - DROP mimeType files ",n[0].type),this.dropEvent=e)}allowDrop(e){e.preventDefault(),e.stopPropagation(),this.logger.log("[CONV-COMP] ----\x3e FILE - (dragover) allowDrop ev ",e),this.isHovering=!0}drag(e){e.preventDefault(),e.stopPropagation(),console.log("dragleave--\x3e",e),this.isHovering=!1}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(jt),t.Y36(T.H7),t.Y36(Dt),t.Y36(Ne),t.Y36(dt),t.Y36(Re),t.Y36(Xe),t.Y36(bt),t.Y36(it),t.Y36(Ut),t.Y36(t.sBO),t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-conversation"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Ts,5),t.Gf(In,5),t.Gf(Dn,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.afConversationComponent=o.first),t.iGM(o=t.CRH())&&(n.conversationFooter=o.first),t.iGM(o=t.CRH())&&(n.conversationContent=o.first)}},hostBindings:function(e,n){1&e&&t.NdJ("resize",function(r){return n.onResize(r)},!1,t.Jf7)},inputs:{conversationId:"conversationId",stylesMap:"stylesMap",isOpen:"isOpen",senderId:"senderId",isConversationArchived:"isConversationArchived"},outputs:{onBackHome:"onBackHome",onCloseWidget:"onCloseWidget",onSoundChange:"onSoundChange",onConversationClosed:"onConversationClosed",onSignOut:"onSignOut",onBeforeMessageSent:"onBeforeMessageSent",onAfterSendMessage:"onAfterSendMessage",onNewConversationInit:"onNewConversationInit",onBeforeMessageRender:"onBeforeMessageRender",onAfterMessageRender:"onAfterMessageRender",onNewMessageCreated:"onNewMessageCreated",onNewConversationButtonClicked:"onNewConversationButtonClicked"},features:[t.TTD],decls:10,vars:56,consts:[["id","chat21-conversation-component","tabindex","1500","aria-modal","true"],["afConversationComponent",""],[3,"idConversation","senderId","soundEnabled","isTrascriptDownloadEnabled","hideHeaderCloseButton","hideHeaderBackButton","hideCloseConversationOptionMenu","hideRestartConversationOptionsMenu","hideHeaderConversationOptionsMenu","hideSignOutOptionMenu","stylesMap","translationMap","widgetTitle","build_version","windowContext","isMenuShow","isTypings","nameUserTypingNow","typingLocation","onBack","onCloseWidget","onSoundChange","onCloseChat","onRestartChat","onWidgetHeightChange","onSignOut","onMenuOptionShow"],["id","dropZone_container",4,"ngIf"],[3,"messages","senderId","baseLocation","isConversationArchived","isTypings","idUserTypingNow","nameUserTypingNow","typingLocation","fullscreenMode","translationMap","stylesMap","onBeforeMessageRender","onAfterMessageRender","onAttachmentButtonClicked","onScrollContent","onMenuOptionShow","onEmojiiPickerShow","drop","dragover","dragleave"],[3,"button","openExternalLinkButton","translationMap","stylesMap","onOpenExternal","onClose",4,"ngIf"],[3,"textInputTextArea","attachments","baseLocation","translationMap","stylesMap","onSendAttachment","onCloseModalPreview",4,"ngIf"],["id","chat21-footer"],["id","chat21-buttonToBottom",3,"click",4,"ngIf"],[3,"conversationWith","attributes","senderId","tenant","projectid","channelType","userFullname","userEmail","showContinueConversationButton","showAttachmentButton","hideTextAreaContent","isConversationArchived","hideTextReply","isMobile","isEmojiiPickerShow","footerMessagePlaceholder","fileUploadAccept","dropEvent","stylesMap","translationMap","onEmojiiPickerShow","onBeforeMessageSent","onAfterSendMessage","onChangeTextArea","onAttachmentFileButtonClicked","onNewConversationButtonClicked","onBackButton"],["id","dropZone_container"],[1,"drop"],[3,"button","openExternalLinkButton","translationMap","stylesMap","onOpenExternal","onClose"],[3,"textInputTextArea","attachments","baseLocation","translationMap","stylesMap","onSendAttachment","onCloseModalPreview"],["id","chat21-buttonToBottom",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["opacity",".87","fill","none","d","M24 24H0V0h24v24z"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],["id","chat21-divBudge","class","c21-divBudge",4,"ngIf"],["id","chat21-divBudge",1,"c21-divBudge"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0,1)(2,"chat-conversation-header",2),t.NdJ("onBack",function(){return n.onBackHomeFN()})("onCloseWidget",function(){return n.onCloseWidgetFN()})("onSoundChange",function(r){return n.onSoundChangeFN(r)})("onCloseChat",function(r){return n.onCloseChat(r)})("onRestartChat",function(r){return n.onRestartChat(r)})("onWidgetHeightChange",function(r){return n.onWidgetHeightChange(r)})("onSignOut",function(r){return n.onSignOutFN(r)})("onMenuOptionShow",function(r){return n.onMenuOption(r)}),t.qZA(),t.YNc(3,Ps,3,0,"div",3),t.TgZ(4,"chat-conversation-content",4),t.NdJ("onBeforeMessageRender",function(r){return n.onBeforeMessageRenderFN(r)})("onAfterMessageRender",function(r){return n.onAfterMessageRenderFN(r)})("onAttachmentButtonClicked",function(r){return n.onAttachmentButtonClicked(r)})("onScrollContent",function(r){return n.onScrollContent(r)})("onMenuOptionShow",function(r){return n.onMenuOption(r)})("onEmojiiPickerShow",function(r){return n.onEmojiiPickerShow(r)})("drop",function(r){return n.drop(r)})("dragover",function(r){return n.allowDrop(r)})("dragleave",function(r){return n.drag(r)}),t.qZA(),t.YNc(5,ks,1,4,"chat-internal-frame",5),t.YNc(6,As,1,5,"chat-conversation-attachment-preview",6),t.TgZ(7,"div",7),t.YNc(8,Rs,5,1,"div",8),t.TgZ(9,"chat-conversation-footer",9),t.NdJ("onEmojiiPickerShow",function(r){return n.onEmojiiPickerShow(r)})("onBeforeMessageSent",function(r){return n.onBeforeMessangeSentFN(r)})("onAfterSendMessage",function(r){return n.onAfterSendMessageFN(r)})("onChangeTextArea",function(r){return n.onChangeTextArea(r)})("onAttachmentFileButtonClicked",function(r){return n.onAttachmentFileButtonClicked(r)})("onNewConversationButtonClicked",function(r){return n.onNewConversationButtonClickedFN(r)})("onBackButton",function(r){return n.onBackButton(r)}),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("idConversation",n.conversationWith)("senderId",n.senderId)("soundEnabled",null==n.g?null:n.g.soundEnabled)("isTrascriptDownloadEnabled",n.isTrascriptDownloadEnabled)("hideHeaderCloseButton",null==n.g?null:n.g.hideHeaderCloseButton)("hideHeaderBackButton",null==n.g?null:n.g.singleConversation)("hideCloseConversationOptionMenu",n.isConversationArchived||(null==n.g?null:n.g.hideCloseConversationOptionMenu))("hideRestartConversationOptionsMenu",!(null!=n.g&&n.g.singleConversation)&&!n.hideTextAreaContent||(null==n.g?null:n.g.hideRestartConversationOptionsMenu))("hideHeaderConversationOptionsMenu",null==n.g?null:n.g.hideHeaderConversationOptionsMenu)("hideSignOutOptionMenu",!(null!=n.g&&n.g.singleConversation&&null!=n.g&&n.g.showLogoutOption))("stylesMap",n.stylesMap)("translationMap",n.translationMapHeader)("widgetTitle",null==n.g||null==n.g.project?null:n.g.project.widgetTitle)("build_version",null!=n.g&&n.g.singleConversation?null==n.g?null:n.g.BUILD_VERSION:null)("windowContext",null==n.g?null:n.g.windowContext)("isMenuShow",n.isMenuShow)("isTypings",n.isTypings)("nameUserTypingNow",n.nameUserTypingNow)("typingLocation",null==n.g?null:n.g.typingLocation),t.xp6(1),t.Q6J("ngIf",n.isHovering),t.xp6(1),t.Q6J("messages",n.messages)("senderId",n.senderId)("baseLocation",null==n.g||null==n.g.windowContext.tiledesk?null:n.g.windowContext.tiledesk.getBaseLocation())("isConversationArchived",n.isConversationArchived)("isTypings",n.isTypings)("idUserTypingNow",n.idUserTypingNow)("nameUserTypingNow",n.nameUserTypingNow)("typingLocation",null==n.g?null:n.g.typingLocation)("fullscreenMode",null==n.g?null:n.g.fullscreenMode)("translationMap",n.translationMapContent)("stylesMap",n.stylesMap),t.xp6(1),t.Q6J("ngIf",n.isButtonUrl),t.xp6(1),t.Q6J("ngIf",n.isOpenAttachmentPreview),t.xp6(1),t.ekj("maximize-width",(null==n.g?null:n.g.singleConversation)&&n.hideTextAreaContent||n.isConversationArchived&&!(null!=n.g&&n.g.allowReopen)),t.xp6(1),t.Q6J("ngIf",n.showBadgeScroollToBottom),t.xp6(1),t.Q6J("conversationWith",n.conversationWith)("attributes",null==n.g?null:n.g.attributes)("senderId",n.senderId)("tenant",null==n.g?null:n.g.tenant)("projectid",null==n.g?null:n.g.projectid)("channelType",null==n.g?null:n.g.channelType)("userFullname",null==n.g?null:n.g.userFullname)("userEmail",null==n.g?null:n.g.userEmail)("showContinueConversationButton",(null==n.g?null:n.g.singleConversation)&&n.showContinueConversationButton)("showAttachmentButton",null==n.g?null:n.g.showAttachmentButton)("hideTextAreaContent",(null==n.g?null:n.g.singleConversation)&&n.hideTextAreaContent||n.isConversationArchived&&!(null!=n.g&&n.g.allowReopen))("isConversationArchived",n.isConversationArchived)("hideTextReply",n.hideFooterTextReply)("isMobile",null==n.g?null:n.g.isMobile)("isEmojiiPickerShow",n.isEmojiiPickerShow)("footerMessagePlaceholder",n.footerMessagePlaceholder)("fileUploadAccept",null==n.appConfigService?null:n.appConfigService.getConfig().fileUploadAccept)("dropEvent",n.dropEvent)("stylesMap",n.stylesMap)("translationMap",n.translationMapFooter))},dependencies:[ue.O5,ms,Dn,In,ws,Ss],styles:["[_nghost-%COMP%]{--themeColor: $bck-msg-sent;--foregroundColor: $col-msg-sent}#scroll-me[_ngcontent-%COMP%]{scroll-behavior:smooth}#scroll-me.withoutAnimation[_ngcontent-%COMP%]{scroll-behavior:unset}#chat21-conversation-component[_ngcontent-%COMP%]{position:absolute;background-color:#fff;width:100%;height:100%;inset:0}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:50px;right:100px;display:flex;align-items:center;width:auto;height:42px;padding:0;margin:5px 0;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#chat21-conversation-component[_ngcontent-%COMP%]   .titleText[_ngcontent-%COMP%]{position:relative;line-height:40px;text-align:left;font-size:1em}#chat21-conversation-component[_ngcontent-%COMP%]   .avatar-project[_ngcontent-%COMP%]{position:relative;padding:0;margin:0 10px 0 0;float:left;height:42px;width:42px;line-height:42px}#chat21-conversation-component[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{font-size:16px}#chat21-conversation-component[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{max-width:30px;max-height:30px;margin:6px}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]{position:relative;padding:0;margin:0;height:40px;width:40px;min-height:40px;min-width:40px;line-height:40px;border-radius:50%;overflow:hidden;background-color:#fff}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;text-align:center;font-size:1.4em;color:#fff;font-weight:500}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:50%}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-icon-avatar[_ngcontent-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;min-width:25px;min-height:25px;object-fit:cover}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{position:fixed;left:0;right:0}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-writing[_ngcontent-%COMP%]{position:absolute;left:40px;right:40px;bottom:3px;width:auto;text-align:center;margin:0;padding:0;font-size:1.1em;color:#fff}#chat21-conversation-component[_ngcontent-%COMP%]   .rowMsg[_ngcontent-%COMP%]{position:relative;height:auto;display:block}#chat21-conversation-component[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{position:fixed}#chat21-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;margin:0;padding:8px 45px 8px 70px;background:white;min-height:40px}#chat21-footer.maximize-width[_ngcontent-%COMP%]{padding:8px 0}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]{display:flex;position:relative;margin-right:-25px;margin-top:-40px;float:right;width:30px;height:30px;border-radius:50%;z-index:1;cursor:pointer;background-color:#fff;border:1px solid rgba(191,191,191,.2);text-align:center}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:auto;fill:#aaa}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]:hover{background-color:var(--themeColor);opacity:1!important;transition:all .45s ease-in-out!important;-moz-transition:all .45s ease-in-out!important;-webkit-transition:all .45s ease-in-out!important;border:1px solid var(--foregroundColor)}#chat21-footer[_ngcontent-%COMP%]   #chat21-buttonToBottom[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--foregroundColor)}#dropZone_container[_ngcontent-%COMP%]{position:absolute;inset:52px 0 56px;background-color:#f0f8ff99}#dropZone_container[_ngcontent-%COMP%]   .drop[_ngcontent-%COMP%]{position:absolute;inset:0;margin:5px;border:2px dashed #a4acb3;border-radius:16px}#c21-options-menu[_ngcontent-%COMP%]{width:auto;height:auto;min-height:40px;min-width:100px;max-width:80%;position:absolute;z-index:10;top:40px;right:15px;border-radius:6px;font-size:1.2em;line-height:normal;overflow:hidden;border:1px solid #d7d7d7;background-color:#fff;padding:10px 0}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{padding:6px 10px;display:flex;align-items:center}#c21-options-menu[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;cursor:pointer}#c21-options-menu[_ngcontent-%COMP%]   .label-menu-item[_ngcontent-%COMP%]{line-height:20px;position:relative;margin:0 10px}@media (max-width: 451px){#chat21-conversation-component[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-header-button.c21-close[_ngcontent-%COMP%]{display:flex}}"]}),i})();var Ns=_e(9614);const Fs=["div_input"];function Bs(i,a){if(1&i&&(t.TgZ(0,"div",6),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",null==e.translationErrorLabelMap?null:e.translationErrorLabelMap.get("LABEL_ERROR_FIELD_REQUIRED")," ")}}function Us(i,a){if(1&i&&(t.TgZ(0,"div",6),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",null==e.element?null:e.element.errorLabel," ")}}const Ds=function(i){return{"is-empty":i}};let Hs=(()=>{class i{constructor(e,n){this.rootFormGroup=e,this.elementRef=n,this.onKeyEnterPressed=new t.vpe,this.inputType="text"}ngOnInit(){this.form=this.rootFormGroup.control,this.form&&this.form.controls&&this.form.controls[this.controlName]&&this.form.controls[this.controlName].valueChanges.subscribe(e=>{this.hasSubmitted=!1,this.setFormStyle()})}ngOnChanges(e){this.controlName&&(this.controlName.toLowerCase().includes("email")||this.controlName.toLowerCase().includes("e-mail"))&&(this.inputType="email"),this.stylesMap&&this.stylesMap.get("themeColor")&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.stylesMap&&this.stylesMap.get("foregroundColor")&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))}onFocusOut(){this.input.nativeElement.classList.remove("is-focused")}onFocus(){this.input.nativeElement.classList.add("is-focused")}onEnterPressed(e){this.onKeyEnterPressed.emit(e)}setFormStyle(){this.form.controls[this.controlName].hasError("pattern")||this.form.controls[this.controlName].hasError("required")||this.form.controls[this.controlName].invalid?(this.input.nativeElement.classList.add("form-danger"),this.input.nativeElement.classList.remove("form-success")):this.form.controls[this.controlName].valid&&(this.input.nativeElement.classList.remove("form-danger"),this.input.nativeElement.classList.add("form-success"))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(be.sg),t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-form-text"]],viewQuery:function(e,n){if(1&e&&t.Gf(Fs,5),2&e){let o;t.iGM(o=t.CRH())&&(n.input=o.first)}},inputs:{element:"element",controlName:"controlName",translationErrorLabelMap:"translationErrorLabelMap",stylesMap:"stylesMap",hasSubmitted:"hasSubmitted"},outputs:{onKeyEnterPressed:"onKeyEnterPressed"},features:[t.TTD],decls:8,vars:12,consts:[[3,"formGroup"],["id","div_input",1,"form-group","label-floating",3,"ngClass"],["div_input",""],[1,"control-label"],[1,"form-control",3,"formControlName","type","tabIndex","keydown.enter","focus","focusout"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"div",1,2)(3,"label",3),t._uU(4),t.qZA(),t.TgZ(5,"input",4),t.NdJ("keydown.enter",function(r){return n.onEnterPressed(r)})("focus",function(){return n.onFocus()})("focusout",function(){return n.onFocusOut()}),t.qZA()(),t.YNc(6,Bs,2,1,"div",5),t.YNc(7,Us,2,1,"div",5),t.qZA()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngClass",t.VKq(10,Ds,!(null!=n.form&&n.form.controls[n.element.name].value))),t.xp6(3),t.hij(" ",null==n.element?null:n.element.text," "),t.xp6(1),t.ekj("errors",(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].errors)&&n.hasSubmitted),t.Q6J("formControlName",null==n.element?null:n.element.name)("type",n.inputType)("tabIndex",null==n.element?null:n.element.tabIndex),t.xp6(1),t.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].errors)&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].hasError("required"))),t.xp6(1),t.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].errors)&&(null==n.form?null:n.form.controls[null==n.element?null:n.element.name].hasError("pattern"))&&(null==n.element?null:n.element.errorLabel)))},dependencies:[ue.mk,ue.O5,be._Y,be.Fj,be.JJ,be.JL,be.sg,be.u],styles:["[_nghost-%COMP%]{--foregroundColor: #0000;--themeColor: #2a6ac1}.c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;overflow:hidden;width:100%;height:36px;display:inline-flex}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:visited{box-shadow:none;background-color:#fff;outline:none}.c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}input[type=text].errors[_ngcontent-%COMP%]{color:red}.text-danger[_ngcontent-%COMP%]{color:red;font-size:1em;min-height:20px;background-color:#fff;margin:0 10px}.form-group[_ngcontent-%COMP%]{position:relative;padding-bottom:0;margin:35px 0 0}.form-group[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{font-size:11px;line-height:1.07142857;color:#b3b6b8;font-weight:400;margin:16px 0 0}input[_ngcontent-%COMP%]{border:0;background-image:none;background-size:0 2px,100% 1px;background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-color:#f6f7fb;transition:background 0s ease-out;float:none;box-shadow:none;border-radius:16px;font-weight:400;height:48px;padding:16px;font-size:14px;line-height:1.42857143;display:block;width:100%;color:#555}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transition:.3s ease all}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{will-change:left,top,contents}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-2px;left:16px;font-size:14px;line-height:1.42857}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-40px;left:0;font-size:16px;line-height:1.07143;color:#9b9b9c}.form-group.label-floating[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-28px;left:0;font-size:11px;line-height:1.07143}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-11px;font-size:11px;line-height:1.5}.form-group.form-group-sm.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-5px;font-size:18px;line-height:1.33333}.form-group.form-group-lg.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.is-focused[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{outline:none;background-image:linear-gradient(var(--themeColor),var(--themeColor)),linear-gradient(#D2D2D2,#D2D2D2);background-size:100% 2px,100% 1px;box-shadow:none;transition-duration:.3s}.form-group.is-focused.form-info[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#00bcd4,#00bcd4),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-success[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#4caf50,#4caf50),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-warning[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#ff9800,#ff9800),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-danger[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#f44336,#f44336),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-rose[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#e91e63,#e91e63),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-white[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#FFFFFF,#FFFFFF),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-black[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#555555,#555555),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{color:#aaa}.form-group.is-focused[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{box-shadow:none;border-color:#d2d2d2}select.form-control[multiple][_ngcontent-%COMP%], .form-group.is-focused[_ngcontent-%COMP%]   select.form-control[multiple][_ngcontent-%COMP%]{height:85px}"]}),i})(),Zs=(()=>{class i{constructor(e){this.rootFormGroup=e}ngOnInit(){this.form=this.rootFormGroup.control}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(be.sg))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-form-label"]],inputs:{element:"element",controlName:"controlName",hasSubmitted:"hasSubmitted"},decls:2,vars:2,consts:[[1,"c21-header-label"],[1,"c21-form-message-field",3,"innerHTML","tabIndex"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"label",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("innerHTML",null==n.element?null:n.element.text,t.oJD)("tabIndex",null==n.element?null:n.element.tabIndex))},styles:[".c21-header-label[_ngcontent-%COMP%]{padding:10px 0;position:relative;left:0;right:0}.c21-header-label[_ngcontent-%COMP%]   .c21-form-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}"]}),i})();function zs(i,a){if(1&i&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.translationErrorLabelMap.get("LABEL_ERROR_FIELD_REQUIRED")," ")}}const js=function(i){return{errors:i}};let Vs=(()=>{class i{constructor(e,n){this.rootFormGroup=e,this.elementRef=n,this.onKeyEnterPressed=new t.vpe}ngOnInit(){this.form=this.rootFormGroup.control}ngOnChanges(e){this.stylesMap&&this.stylesMap.get("themeColor")&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.stylesMap&&this.stylesMap.get("foregroundColor")&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))}onEnterPressed(e){this.onKeyEnterPressed.emit(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(be.sg),t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-form-checkbox"]],inputs:{element:"element",controlName:"controlName",translationErrorLabelMap:"translationErrorLabelMap",stylesMap:"stylesMap",hasSubmitted:"hasSubmitted"},outputs:{onKeyEnterPressed:"onKeyEnterPressed"},features:[t.TTD],decls:6,vars:9,consts:[[3,"formGroup"],[1,"c21-body-header-checkbox"],["type","checkbox",1,"form-check-input","errors",3,"formControlName","checked","tabIndex","ngClass","keydown.enter"],[1,"c21-form-message-field"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"input",2),t.NdJ("keydown.enter",function(r){return n.onEnterPressed(r)}),t.qZA(),t.TgZ(3,"label",3),t._uU(4),t.qZA(),t.YNc(5,zs,2,1,"div",4),t.qZA()()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(2),t.Q6J("formControlName",null==n.element?null:n.element.name)("checked",null==n.element?null:n.element.value)("tabIndex",null==n.element?null:n.element.tabIndex)("ngClass",t.VKq(7,js,n.hasSubmitted&&n.form.controls[null==n.element?null:n.element.name].errors)),t.xp6(2),t.Oqu(null==n.element?null:n.element.text),t.xp6(1),t.Q6J("ngIf",n.hasSubmitted&&n.form.get(null==n.element?null:n.element.name).errors))},dependencies:[ue.mk,ue.O5,be._Y,be.Wl,be.JJ,be.JL,be.sg,be.u],styles:['[_nghost-%COMP%]{--foregroundColor: #0000;--themeColor: #2a6ac1;--backgroundUnchecked: #ffff;--dangerError: #ff0000}.c21-body-header-checkbox[_ngcontent-%COMP%]{--dangerError: #ff0000;position:relative;left:0;right:0}.c21-body-header-checkbox[_ngcontent-%COMP%]   .c21-form-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}input[type=radio][_ngcontent-%COMP%], input[type=checkbox][_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;margin:0 .4em .4em 0;border:1px solid var(--themeColor);border-radius:3px;-webkit-border-radius:3px;-webkit-appearance:none;transition:box-shadow .2s}input[type=checkbox][_ngcontent-%COMP%]:not(:checked):hover, input[type=checkbox][_ngcontent-%COMP%]:not(:checked):focus{border-width:2px;background-color:#fff;border-radius:4px;box-shadow:0 2px 5px #00000040;cursor:pointer;padding:15px 25px;transition:all .1s ease-in}input[type=radio][_ngcontent-%COMP%]:active:not(:disabled), input[type=checkbox][_ngcontent-%COMP%]:active:not(:disabled){border-width:2px}input[type=radio][_ngcontent-%COMP%]:focus, input[type=checkbox][_ngcontent-%COMP%]:focus{outline:none}input[type=radio][_ngcontent-%COMP%]:checked, input[type=checkbox][_ngcontent-%COMP%]:checked{background-color:var(--themeColor);animation:shrink-bounce .2s cubic-bezier(.4,0,.23,1)}input[type=radio][_ngcontent-%COMP%]:checked:before{display:block;height:.4em;width:.4em;position:relative;left:.4em;top:.4em;background:var(--backgroundUnchecked);border-radius:100%;content:""}input[type=checkbox][_ngcontent-%COMP%]:checked:before{content:"";display:block;width:4px;height:10px;border:solid var(--foregroundColor);color:var(--foregroundColor);border-width:0 3px 3px 0;transform:rotate(45deg);margin-left:0;margin-top:-5px;transform-origin:0% 100%;background-color:transparent;animation:rippleOn .2s}input[type=checkbox][_ngcontent-%COMP%]:checked:after{border:solid var(--backgroundUnchecked);background-color:var(--themeColor);animation:rippleOn .2s forwards}input[type=checkbox][_ngcontent-%COMP%]:not(:checked):before{animation:rippleOff .2s}input[type=checkbox][_ngcontent-%COMP%]:not(:checked):after{animation:rippleOff .2s}input[_ngcontent-%COMP%]:disabled{opacity:.6;background:rgba(0,0,0,.1);box-shadow:none}input[_ngcontent-%COMP%]:disabled + label[_ngcontent-%COMP%]{opacity:.6;cursor:default;-webkit-user-select:none}input[type=checkbox].errors[_ngcontent-%COMP%]{border:2px solid var(--dangerError)}.text-danger[_ngcontent-%COMP%]{color:var(--dangerError);font-size:1em;min-height:20px;background-color:var(--backgroundUnchecked);margin:0 10px}@keyframes rippleOn{0%{opacity:0}50%{opacity:.3}to{opacity:0}}@keyframes rippleOff{0%{opacity:0}50%{opacity:.2}to{opacity:0}}']}),i})();const Gs=["div_input"];function qs(i,a){if(1&i&&(t.TgZ(0,"div",6),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.translationErrorLabelMap.get("LABEL_ERROR_FIELD_REQUIRED")," ")}}function Ws(i,a){if(1&i&&(t.TgZ(0,"div",6),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.element.errorLabel," ")}}const Ys=function(i){return{"is-empty":i}};let Js=(()=>{class i{constructor(e,n){this.rootFormGroup=e,this.elementRef=n,this.rows=3,this.onKeyEnterPressed=new t.vpe}ngOnInit(){this.form=this.rootFormGroup.control,this.form&&this.form.controls&&this.form.controls[this.controlName]&&this.form.controls[this.controlName].valueChanges.subscribe(e=>{this.hasSubmitted=!1,this.setFormStyle()})}ngOnChanges(e){this.stylesMap&&this.stylesMap.get("themeColor")&&this.elementRef.nativeElement.style.setProperty("--themeColor",this.stylesMap.get("themeColor")),this.stylesMap&&this.stylesMap.get("foregroundColor")&&this.elementRef.nativeElement.style.setProperty("--foregroundColor",this.stylesMap.get("foregroundColor"))}onFocusOut(){this.input.nativeElement.classList.remove("is-focused")}onFocus(){this.input.nativeElement.classList.add("is-focused")}onEnterPressed(e){e.preventDefault(),this.onKeyEnterPressed.emit(e)}onkeydown(e){(e.metaKey||e.shiftKey||e.altKey||e.ctrlKey)&&13===(e.which||e.keyCode)&&(e.preventDefault(),this.form.controls[this.controlName].patchValue(this.form.controls[this.controlName].value+"\r\n"))}setFormStyle(){this.form.controls[this.controlName].hasError("pattern")||this.form.controls[this.controlName].hasError("required")||this.form.controls[this.controlName].invalid?(this.input.nativeElement.classList.add("form-danger"),this.input.nativeElement.classList.remove("form-success")):this.form.controls[this.controlName].valid&&(this.input.nativeElement.classList.remove("form-danger"),this.input.nativeElement.classList.add("form-success"))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(be.sg),t.Y36(t.SBq))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-form-textarea"]],viewQuery:function(e,n){if(1&e&&t.Gf(Gs,5),2&e){let o;t.iGM(o=t.CRH())&&(n.input=o.first)}},inputs:{element:"element",controlName:"controlName",rows:"rows",translationErrorLabelMap:"translationErrorLabelMap",stylesMap:"stylesMap",hasSubmitted:"hasSubmitted"},outputs:{onKeyEnterPressed:"onKeyEnterPressed"},features:[t.TTD],decls:9,vars:10,consts:[[3,"formGroup"],["id","div_input",1,"form-group","label-floating",3,"ngClass"],["div_input",""],[1,"control-label"],["type","text",1,"form-control",3,"formControlName","rows","tabIndex","keydown","keydown.enter","focus","focusout"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"div",1,2)(3,"label",3),t._uU(4),t.qZA(),t.TgZ(5,"textarea",4),t.NdJ("keydown",function(r){return n.onkeydown(r)})("keydown.enter",function(r){return n.onEnterPressed(r)})("focus",function(){return n.onFocus()})("focusout",function(){return n.onFocusOut()}),t._uU(6,"    "),t.qZA()(),t.YNc(7,qs,2,1,"div",5),t.YNc(8,Ws,2,1,"div",5),t.qZA()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngClass",t.VKq(8,Ys,!(null!=n.form&&null!=n.form.controls[n.element.name]&&n.form.controls[n.element.name].value))),t.xp6(3),t.hij(" ",null==n.element?null:n.element.text," "),t.xp6(1),t.Q6J("formControlName",null==n.element?null:n.element.name)("rows",n.rows)("tabIndex",null==n.element?null:n.element.tabIndex),t.xp6(2),t.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[n.element.name].errors)&&(null==n.form?null:n.form.controls[n.element.name].hasError("required"))),t.xp6(1),t.Q6J("ngIf",n.hasSubmitted&&(null==n.form?null:n.form.controls[n.element.name].errors)&&(null==n.form?null:n.form.controls[n.element.name].hasError("pattern"))&&(null==n.element?null:n.element.errorLabel)))},dependencies:[ue.mk,ue.O5,be._Y,be.Fj,be.JJ,be.JL,be.sg,be.u],styles:["[_nghost-%COMP%]{--foregroundColor: #0000;--themeColor: #2a6ac1}.c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;overflow:hidden;width:100%;display:inline-flex}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}.c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:active, .c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:hover, .c21-input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:visited{background-image:linear-gradient(#3ea9f5,#3ea9f5),linear-gradient(#d2d2d2,#d2d2d2);background-size:0 2px,100% 1px;background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-color:#0000;transition:background 0s ease-out}textarea[type=text].errors[_ngcontent-%COMP%]{border-bottom:2px solid red;color:red}.text-danger[_ngcontent-%COMP%]{color:red;font-size:1em;min-height:20px;background-color:#fff;margin:0 10px}.form-group[_ngcontent-%COMP%]{position:relative;padding-bottom:0;margin:35px 0 0}.form-group[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{font-size:11px;line-height:1.07142857;color:#b3b6b8;font-weight:400;margin:16px 0 0}textarea[_ngcontent-%COMP%]{border:0;background-image:none;background-size:0 2px,100% 1px;background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-color:#f6f7fb;transition:background 0s ease-out;float:none;box-shadow:none;border-radius:16px;font-weight:400;padding:16px;font-size:14px;line-height:1.42857143;display:block;width:100%;color:#555;resize:vertical}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transition:.3s ease all}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{will-change:left,top,contents}.form-group.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-2px;left:16px;font-size:14px;line-height:1.42857}.form-group.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-40px;left:0;font-size:16px;line-height:1.07143;color:#9b9b9c}.form-group.label-floating[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-28px;left:0;font-size:11px;line-height:1.07143}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-11px;font-size:11px;line-height:1.5}.form-group.form-group-sm.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-sm.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-sm.label-floating[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-25px;left:0;font-size:9px;line-height:1.125}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-5px;font-size:18px;line-height:1.33333}.form-group.form-group-lg.label-static[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating.is-focused[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%], .form-group.form-group-lg.label-floating[_ngcontent-%COMP%]:not(.is-empty)   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.form-group-lg.label-floating[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label.control-label[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{top:-32px;left:0;font-size:14px;line-height:1}.form-group.is-focused[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{outline:none;background-image:linear-gradient(var(--themeColor),var(--themeColor)),linear-gradient(#D2D2D2,#D2D2D2);background-repeat:no-repeat;background-position:center bottom,center calc(100% - 1px);background-size:100% 2px,100% 1px;transition-duration:.3s;width:100%}.form-group.is-focused.form-info[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#00bcd4,#00bcd4),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-success[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#4caf50,#4caf50),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-warning[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#ff9800,#ff9800),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-danger[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#f44336,#f44336),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-rose[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#e91e63,#e91e63),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-white[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#FFFFFF,#FFFFFF),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.form-black[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-image:linear-gradient(#555555,#555555),linear-gradient(#D2D2D2,#D2D2D2)}.form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .form-group.is-focused.label-placeholder[_ngcontent-%COMP%]   label.control-label[_ngcontent-%COMP%]{color:#aaa}.form-group.is-focused[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{box-shadow:none;border-color:#d2d2d2}"]}),i})();function Qs(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-form-text",13),t.NdJ("onKeyEnterPressed",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onEnterButtonPressed(o))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("element",e)("controlName",null==e?null:e.name)("translationErrorLabelMap",n.translationErrorLabelMap)("stylesMap",n.stylesMap)("hasSubmitted",n.submitted)}}function Ks(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-form-label",14),t.NdJ("onKeyEnterPressed",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onEnterButtonPressed(o))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("element",e)("controlName",null==e?null:e.name)("hasSubmitted",n.submitted)}}function $s(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-form-checkbox",13),t.NdJ("onKeyEnterPressed",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onEnterButtonPressed(o))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("element",e)("controlName",null==e?null:e.name)("translationErrorLabelMap",n.translationErrorLabelMap)("stylesMap",n.stylesMap)("hasSubmitted",n.submitted)}}function Xs(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"chat-form-textarea",15),t.NdJ("onKeyEnterPressed",function(o){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onEnterButtonPressed(o))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("element",e)("controlName",null==e?null:e.name)("rows",null==e?null:e.rows)("translationErrorLabelMap",n.translationErrorLabelMap)("stylesMap",n.stylesMap)("hasSubmitted",n.submitted)}}function ea(i,a){if(1&i&&(t.TgZ(0,"span"),t.YNc(1,Qs,1,5,"chat-form-text",10),t.YNc(2,Ks,1,3,"chat-form-label",11),t.YNc(3,$s,1,5,"chat-form-checkbox",10),t.YNc(4,Xs,1,6,"chat-form-textarea",12),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf","text"===(null==e?null:e.type)),t.xp6(1),t.Q6J("ngIf","static"===(null==e?null:e.type)),t.xp6(1),t.Q6J("ngIf","checkbox"===(null==e?null:e.type)),t.xp6(1),t.Q6J("ngIf","textarea"===(null==e?null:e.type))}}const ta=function(i,a,e){return{"background-color":i,"border-color":a,color:e}},na=function(i){return{fill:i}};let oa=(()=>{class i{constructor(e,n){this.formBuilder=e,this.customTranslateService=n,this.onSubmitForm=new t.vpe,this.onErrorRenderForm=new t.vpe,this.submitted=!1,this.logger=ve.getInstance()}ngOnInit(){this.translationErrorLabelMap=this.customTranslateService.translateLanguage(["LABEL_ERROR_FIELD_REQUIRED","PRECHAT_REQUIRED_ERROR"]),this.translationMap=this.customTranslateService.translateLanguage(["LABEL_START_NW_CONV"]),this.logger.debug("[FORM-BUILDER] ngOnChanges: preChatFormJson ----\x3e",this.formArray),this.logger.debug("[FORM-BUILDER] ngOnChanges: preChatForm completed ----\x3e",this.preChatFormGroupCustom)}ngOnChanges(e){this.formArray&&(this.browserLang=navigator.language,this.preChatFormGroupCustom=this.buildFormGroup(this.formArray),this.formArray=this.setTranslations(this.formArray),this.subscribeToFormChanges())}buildFormGroup(e){let n={},o=!1;return e.forEach((v,P)=>{if(v.tabIndex=1411+P,this.lastTabIndex=1411+P+1,v.label||(v.label=v.name),v.type=v.type?v.type.toLowerCase():"text",!v.type||"text"!==v.type&&"textarea"!==v.type){if("checkbox"!==v.type){if("static"===v.type)return;return this.logger.error("[FORM-BUILDER] ERROR while rendering field --\x3e RESTORE DEFAULT"),void(o=!0)}{let Y=[],X=!1;v.mandatory&&Y.push(be.kI.required,be.kI.requiredTrue),v.value&&(X="true"===v.value||!0===v.value),n[v.name]=new be.NI(X,be.kI.compose(Y))}}else{let Y=[],X=null;v.mandatory&&Y.push(be.kI.required),v.regex&&Y.push(be.kI.pattern(new RegExp(function co(i){let a=i;return"/"!==i.substring(0,1)&&(a="/"+i),"/"!==i.substring(i.length-1,i.length)&&(a+="/"),a}(v.regex).slice(1,-1)))),v.value&&(X=v.value),n[v.name]=new be.NI(X,be.kI.compose(Y))}}),o&&(n={},this.logger.error("[FORM-BUILDER] ERROR while rendering field --\x3e restoreDefault",n),this.onErrorRenderForm.emit()),this.formBuilder.group(n)}setTranslations(e){return e.forEach(n=>{if("object"==typeof n.label){const o=this.getAcceptLanguage(n.label);this.logger.debug("[FORM-BUILDER] setTranslations acceptedLanguage for element.label:",n,o),n.text=n.label[o]}else"string"==typeof n.label&&(n.text=this.customTranslateService.translateLanguage([n.label]).get(n.label));if("object"==typeof n.errorLabel){const o=this.getAcceptLanguage(n.errorLabel);this.logger.debug("[FORM-BUILDER] setTranslations acceptedLanguage for element.errorLabel:",n,o),n.errorLabel=n.errorLabel[o]}else"string"==typeof n.errorLabel&&(n.errorLabel=this.customTranslateService.translateLanguage([n.errorLabel]).get(n.errorLabel))}),this.formArray}getAcceptLanguage(e){let n="",o="";e&&e.default&&(o="default"),navigator.languages.forEach(v=>{n+=v+","});const r=Ns.e(Object.keys(e),n);return r&&(o=r),o}subscribeToFormChanges(){this.preChatFormGroupCustom&&this.preChatFormGroupCustom.valueChanges.subscribe(e=>{this.submitted=!1})}onSubmitPreChatForm(){this.submitted=!0,this.logger.debug("[FORM-BUILDER] onSubmitPreChatForm",this.preChatFormGroupCustom),this.preChatFormGroupCustom.valid&&this.onSubmitForm.emit(this.preChatFormGroupCustom.value)}onEnterButtonPressed(e){this.logger.debug("[FORM-BUILDER] onEnterButtonPressed event",e),this.onSubmitPreChatForm()}onResetForm(){this.submitted=!1,this.preChatFormGroupCustom.reset()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(be.qu),t.Y36(Xe))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-form-builder"]],inputs:{formArray:"formArray",isOpenPrechatForm:"isOpenPrechatForm",stylesMap:"stylesMap"},outputs:{onSubmitForm:"onSubmitForm",onErrorRenderForm:"onErrorRenderForm"},features:[t.TTD],decls:12,vars:12,consts:[["id","chat21-form-container",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"c21-new-conversation"],[1,"c21-button-primary",3,"tabindex","ngStyle","click","keydown.enter"],[1,"v-align-center"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",3,"ngStyle"],["d","M0 0h24v24H0z","fill","none"],[1,"v-align-center","c21-label-button"],[1,"clear"],[3,"element","controlName","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed",4,"ngIf"],[3,"element","controlName","hasSubmitted","onKeyEnterPressed",4,"ngIf"],[3,"element","controlName","rows","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed",4,"ngIf"],[3,"element","controlName","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed"],[3,"element","controlName","hasSubmitted","onKeyEnterPressed"],[3,"element","controlName","rows","translationErrorLabelMap","stylesMap","hasSubmitted","onKeyEnterPressed"]],template:function(e,n){1&e&&(t.TgZ(0,"div")(1,"form",0),t.YNc(2,ea,5,4,"span",1),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return n.onSubmitPreChatForm()})("keydown.enter",function(r){return n.onEnterButtonPressed(r)}),t.TgZ(5,"span",4),t.O4$(),t.TgZ(6,"svg",5),t._UZ(7,"path",6)(8,"path",7),t.qZA()(),t.kcU(),t.TgZ(9,"span",8),t._uU(10),t.qZA(),t._UZ(11,"div",9),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("formGroup",n.preChatFormGroupCustom),t.xp6(1),t.Q6J("ngForOf",n.formArray),t.xp6(2),t.Q6J("tabindex",n.lastTabIndex)("ngStyle",t.kEZ(6,ta,null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("themeColor"),null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(3),t.Q6J("ngStyle",t.VKq(10,na,null==n.stylesMap?null:n.stylesMap.get("foregroundColor"))),t.xp6(3),t.hij(" ",null==n.translationMap?null:n.translationMap.get("LABEL_START_NW_CONV")," "))},dependencies:[ue.sg,ue.O5,ue.PC,be._Y,be.JL,be.sg,Hs,Zs,Vs,Js],styles:[".c21-label-button[_ngcontent-%COMP%]{font-size:1.2em!important}.c21-new-conversation[_ngcontent-%COMP%]{width:auto;height:auto;position:relative;border-top:0px solid #eeeeee;display:flex;align-items:center;justify-content:center;box-shadow:none;vertical-align:top}.c21-new-conversation[_ngcontent-%COMP%]   button.c21-button-primary[_ngcontent-%COMP%]{margin:10px 0}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;overflow:hidden;width:100%;height:36px;display:inline-flex}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:block;padding:11px 10px 8px;color:#616161;font-size:1.3em;font-weight:300;line-height:1.2em;box-shadow:none}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input.errors[_ngcontent-%COMP%]{border:1px solid red}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:visited{box-shadow:none;background-color:#fff;outline:none}#chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}"]}),i})();const ia=["afPrechatFormComponent"],ra=["privacyInputField"],sa=function(i,a){return{color:i,"background-image":a}},aa=function(i){return{fill:i}},la=function(i){return{color:i}};let ca=(()=>{class i{constructor(e,n,o){this.g=e,this.formBuilder=n,this.appStorageService=o,this.onClosePage=new t.vpe,this.onCloseForm=new t.vpe,this.logger=ve.getInstance()}ngOnInit(){this.initialize()}initialize(){}ngAfterViewInit(){setTimeout(()=>{this.afPrechatFormComponent&&this.afPrechatFormComponent.nativeElement.focus()},1e3)}openNewConversation(){if(this.g.attributes){const e=this.g.attributes;if(this.privacyInputField&&!1===this.privacyInputField.nativeElement.checked){this.g.privacyApproved=!1;const n=window.document.getElementById("span-checkmark");return void(n&&n.classList.add("unchecked"))}this.privacyInputField&&!0===this.privacyInputField.nativeElement.checked&&(this.g.privacyApproved=!0),this.g.setAttributeParameter("privacyApproved",this.g.privacyApproved),this.g.setAttributeParameter("userFullname",this.userFullname),this.g.setAttributeParameter("userEmail",this.userEmail),this.g.setParameter("userFullname",this.userFullname),this.g.setParameter("userEmail",this.userEmail),this.appStorageService.setItem("attributes",JSON.stringify(e)),this.onCloseForm.emit()}}returnClosePage(){this.onClosePage.emit()}onSubmitForm(e){this.logger.debug("[PRE-CHAT-FORM] onSubmitForm:",e),this.g.attributes&&(e.hasOwnProperty("userFullname")&&(this.g.setAttributeParameter("userFullname",e.userFullname),this.g.setParameter("userFullname",e.userFullname)),e.hasOwnProperty("userEmail")&&(this.g.setAttributeParameter("userEmail",e.userEmail),this.g.setParameter("userEmail",e.userEmail)),this.g.attributes.preChatForm=e,this.appStorageService.setItem("attributes",JSON.stringify(this.g.attributes)),this.onCloseForm.emit())}onErrorRenderForm(){this.logger.debug("[PRE-CHAT-FORM] onErrorRenderForm: RESTORE DEFAULT JSON"),this.g.setParameter("preChatFormJson",[{name:"userFullname",type:"text",mandatory:!0,label:"LABEL_FIELD_NAME"},{name:"userEmail",type:"text",mandatory:!0,regex:"/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)+$/",label:"LABEL_FIELD_EMAIL",errorLabel:"LABEL_ERROR_FIELD_EMAIL"}])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(be.qu),t.Y36(Ne))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-prechat-form"]],viewQuery:function(e,n){if(1&e&&(t.Gf(ia,5),t.Gf(ra,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.afPrechatFormComponent=o.first),t.iGM(o=t.CRH())&&(n.privacyInputField=o.first)}},inputs:{stylesMap:"stylesMap"},outputs:{onClosePage:"onClosePage",onCloseForm:"onCloseForm"},decls:20,vars:14,consts:[["id","chat21-prechat-form","tabindex","1400","aria-modal","true","onFocus","document.querySelector('[start-focus-chat21-prechat-form]').focus()"],["afPrechatFormComponent",""],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-button"],[1,"c21-close-button","c21-small"],["tabindex","1490","aria-label"," chiudi pannello",1,"c21-close-button-body",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"c21-header-content"],[1,"c21-title",3,"ngStyle"],[1,"c21-body"],[1,"c21-body-container"],[1,"c21-body-header"],["start-focus-chat21-prechat-form","","tabindex","1410",1,"c21-form-message-field"],[1,"c21-body-content"],[3,"formArray","isOpenPrechatForm","stylesMap","onSubmitForm","onErrorRenderForm"],["tabindex","1499","onFocus","document.querySelector('[start-focus-chat21-prechat-form]').focus()"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),t.NdJ("click",function(){return n.returnClosePage()}),t.O4$(),t.TgZ(7,"svg",7),t._UZ(8,"path",8)(9,"path",9),t.qZA()()()(),t.kcU(),t.TgZ(10,"div",10),t._UZ(11,"div",11),t.qZA()()(),t.TgZ(12,"div",12)(13,"div",13)(14,"div",14)(15,"div",15),t._uU(16),t.qZA()(),t.TgZ(17,"div",16)(18,"chat-form-builder",17),t.NdJ("onSubmitForm",function(r){return n.onSubmitForm(r)})("onErrorRenderForm",function(){return n.onErrorRenderForm()}),t.qZA()()(),t._UZ(19,"span",18),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngStyle",t.WLB(7,sa,n.g.themeForegroundColor,n.g.colorGradient180)),t.xp6(5),t.Q6J("ngStyle",t.VKq(10,aa,n.g.themeForegroundColor)),t.xp6(4),t.Q6J("ngStyle",t.VKq(12,la,n.g.themeForegroundColor)),t.xp6(5),t.Oqu(n.g.LABEL_COMPLETE_FORM),t.xp6(2),t.Q6J("formArray",n.g.preChatFormJson)("isOpenPrechatForm",n.g.isOpenPrechatForm)("stylesMap",n.stylesMap))},dependencies:[ue.PC,oa],styles:['#chat21-prechat-form[_ngcontent-%COMP%]{background-color:#fff;width:100%;height:100%}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{overflow:hidden;width:100%;height:52px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]{width:31px;height:31px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]   .c21-close-button-body[_ngcontent-%COMP%]{width:31px;height:31px;-webkit-appearance:initial;border:none}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;margin:0 auto}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]{width:auto;height:auto;top:6px;left:40px;right:40px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{display:inline-block;width:100%;height:auto;padding:0;margin:10px 0;text-align:center;font-size:1.6em;line-height:normal}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{padding:0;margin:20px auto}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]{padding:10px 25px;position:relative;left:0;right:0}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .c21-form-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]{padding:10px 30px;position:relative}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .c21-label-button[_ngcontent-%COMP%]{font-size:1.2em}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]{padding:0 0 30px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]{background-color:#fff;overflow:hidden;position:relative;height:36px;margin:10px 10px 0}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .text-danger[_ngcontent-%COMP%]{color:#a94442;font-size:1em;min-height:20px;background-color:#fff;margin:0 10px}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]{border-bottom:1px solid rgba(211,212,213,.4);border-radius:3px;background-color:#fff;position:relative;margin:0;padding:0;width:100%;display:inline-flex}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;margin:0;border:0;padding:12px 0;background-color:#fff;vertical-align:middle}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:block;padding:11px 10px 8px;color:#616161;font-size:1.3em;font-weight:300;line-height:1.2em;box-shadow:none}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#b3b6b8;font-weight:initial;opacity:1}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-ms-input-placeholder{color:#b3b6b8;font-weight:initial}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:visited{box-shadow:none;background-color:#fff;outline:none}#chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, #chat21-prechat-form[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   #chat21-form-container[_ngcontent-%COMP%]   .c21-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]{display:block;position:absolute;bottom:0;padding:35px;font-size:12px;text-align:left;-webkit-user-select:none;user-select:none}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:22px;position:absolute;top:30px;left:10px;opacity:0;cursor:pointer;height:18px;width:18px}#chat21-prechat-form[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;top:30;left:10;height:18px;width:18px;background-color:#eee;border:solid white;cursor:pointer}#chat21-prechat-form[_ngcontent-%COMP%]   .checkmark.unchecked[_ngcontent-%COMP%]{box-shadow:0 0 0 1px red}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{background-color:#ccc}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:#2196f3}#chat21-prechat-form[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}#chat21-prechat-form[_ngcontent-%COMP%]   .privacy-field[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:5px;top:2px;width:5px;height:8px;border:solid white;border-width:0 3px 3px 0;transform:rotate(45deg)}']}),i})();function ha(i,a){1&i&&(t.TgZ(0,"div"),t._uU(1,"here is ignored"),t.qZA())}function da(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p",22),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.popupUrl(o.g.windowContext,o.conversation.last_message_text,"windowName"))}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(3);t.xp6(1),t.hij("",e.strip_tags(e.conversation.last_message_text)," ")}}function ua(i,a){if(1&i&&(t._UZ(0,"p",23),t.ALo(1,"marked"),t.ALo(2,"htmlEntitiesEncode")),2&i){const e=t.oxw(3);t.Q6J("innerHTML",t.lcZ(1,1,t.lcZ(2,3,e.conversation.last_message_text)),t.oJD)}}function ga(i,a){if(1&i&&(t.TgZ(0,"div",18),t.YNc(1,ha,2,0,"div",19),t.YNc(2,da,2,1,"ng-template",null,20,t.W1O),t.YNc(4,ua,3,5,"ng-template",null,21,t.W1O),t.qZA()),2&i){const e=t.MAs(3),n=t.MAs(5),o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.isPopupUrl(o.conversation.last_message_text))("ngIfThen",e)("ngIfElse",n)}}function pa(i,a){if(1&i&&(t.TgZ(0,"time"),t._uU(1),t.ALo(2,"amTimeAgo"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij("",t.lcZ(2,1,e.conversation.timestamp)," ")}}function fa(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openConversationByID(o.conversation))}),t.TgZ(5,"span"),t._uU(6,"View more"),t.qZA()(),t.TgZ(7,"div",6),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.closeMessagePreview())}),t.TgZ(8,"span"),t.O4$(),t.TgZ(9,"svg",7),t._UZ(10,"path",8)(11,"path",9),t.qZA()()()()(),t.kcU(),t.TgZ(12,"div",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openConversationByID(o.conversation))}),t.TgZ(13,"div",11),t._uU(14),t.qZA(),t.YNc(15,ga,6,3,"div",12),t.TgZ(16,"div",13),t.YNc(17,pa,3,3,"time",14),t.qZA(),t.TgZ(18,"div",15)(19,"div",16),t._UZ(20,"chat-avatar-image",17),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(14),t.Oqu(e.conversation.sender_fullname),t.xp6(1),t.Q6J("ngIf","text"==e.conversation.type),t.xp6(2),t.Q6J("ngIf","{.sv: timestamp}"!==e.conversation.timestamp),t.xp6(3),t.Q6J("senderID",e.conversation.sender)("senderFullname",e.conversation.sender_fullname)("baseLocation",e.baseLocation)}}let ma=(()=>{class i{constructor(e,n){this.imageRepoService=e,this.g=n,this.onCloseMessagePreview=new t.vpe,this.onSelectedConversation=new t.vpe,this.subscriptions=[],this.isPopupUrl=on,this.popupUrl=$n,this.strip_tags=Xn,this.isImage=Lt,this.logger=ve.getInstance()}ngOnInit(){}ngAfterViewInit(){}ngOnChanges(e){this.logger.debug("[LASTMESSAGE] onChanges",e),this.conversation&&(this.conversation.image=this.imageRepoService.getImagePhotoUrl(this.conversation.sender))}getMetadataSize(e){void 0===e.width&&(e.width=Ge),void 0===e.height&&(e.height=Ge);const n={width:e.width,height:e.height};if(e.width&&e.width>Ge){const o=e.width/e.height;n.width=Ge,n.height=Ge/o}return n}onAttachmentButtonClicked(e){this.logger.debug("[LASTMESSAGE] onAttachmentButtonClicked",e)}openConversationByID(e){this.logger.debug("[LASTMESSAGE] openConversationByID: ",e),this.conversation=null,this.g.isOpenNewMessage=!1,e&&this.onSelectedConversation.emit(e)}closeMessagePreview(){this.conversation=null,this.g.isOpenNewMessage=!1,this.onCloseMessagePreview.emit()}ngOnDestroy(){this.conversation=null,this.g.isOpenNewMessage=!1}unsubscribe(){this.subscriptions.forEach(function(e){e.unsubscribe()}),this.subscriptions=[],this.logger.debug("[LASTMESSAGE] this.subscriptions",this.subscriptions)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(et),t.Y36(Ie))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-last-message"]],inputs:{conversation:"conversation",baseLocation:"baseLocation",stylesMap:"stylesMap"},outputs:{onCloseMessagePreview:"onCloseMessagePreview",onSelectedConversation:"onSelectedConversation"},features:[t.TTD],decls:1,vars:1,consts:[["id","messagePreview",4,"ngIf"],["id","messagePreview"],["role","messaggio","id","new_message"],[1,"headerPreviewMessage"],[1,"boxButtons"],["role","button","tabindex","0",1,"buttonMore",3,"click"],["aria-label","Dismiss","role","button","tabindex","0",1,"buttonClose",3,"click"],["aria-labelledby","altIconTitle","height","20px","role","img","viewBox","0 0 24 24","width","20px","xmlns","http://www.w3.org/2000/svg",2,"fill","rgb(255, 255, 255)"],["d","M0 0h24v24H0V0z","fill","none"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"previewNewMessagge",3,"click"],["role","messaggio",1,"c21-text","message_sender_fullname"],["class","c21-box-text",4,"ngIf"],[1,"c21-time","c21-text"],[4,"ngIf"],[1,"c21-icon-avatar"],[1,"c21-avatar-image","profile_image"],[1,"slide-in-left",3,"senderID","senderFullname","baseLocation"],[1,"c21-box-text"],[4,"ngIf","ngIfThen","ngIfElse"],["contentPopup",""],["contentNewTab",""],[1,"c21-link",3,"click"],[1,"c21-text","overflow4Lines",3,"innerHTML"]],template:function(e,n){1&e&&t.YNc(0,fa,21,6,"div",0),2&e&&t.Q6J("ngIf",n.conversation&&n.g.isOpenNewMessage)},dependencies:[ue.O5,Fn,Ve.eG,Nn,Zt],styles:['[_nghost-%COMP%]   .c21-avatar-image[_ngcontent-%COMP%]    >chat-avatar-image .c21-icon-avatar{height:32px;width:32px;min-width:32px;min-height:32px}[_nghost-%COMP%]   .slide-in-left[_ngcontent-%COMP%]    >chat-message-attachment>#buttons-in-message>span>chat-text-button-attachment .button-in-msg{font-size:13px;padding:5px 10px!important}#messagePreview[_ngcontent-%COMP%]{position:relative;width:320px;max-height:200px;height:100%;padding:0 10px 10px;background-color:transparent;font-family:Helvetica Neue,"Apple Color Emoji",Helvetica,Arial,sans-serif;font-size:100%;font-style:normal;letter-spacing:normal;font-stretch:normal;font-weight:400;text-align:left;text-align-last:initial;text-indent:0px;text-shadow:none;text-transform:none;box-sizing:content-box;-webkit-font-smoothing:antialiased;line-height:1;font-feature-settings:normal;font-variant:normal}#new_message[_ngcontent-%COMP%]:hover   .boxButtons[_ngcontent-%COMP%]{display:block;animation:fade-in-dw-up .3s ease-in 0s}.previewNewMessagge[_ngcontent-%COMP%]{position:relative;box-sizing:border-box;background-color:#fff;box-shadow:#232f3517 0 2px 8px;clear:both;margin-left:45px;margin-bottom:8px;border-radius:5px 5px 5px 0;padding:4;font-size:14px}.previewNewMessagge[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:-5px;width:0px;height:0px;border-style:solid;border-width:0px 0px 13px 5px;border-color:transparent transparent white}.c21-text.message_sender_fullname[_ngcontent-%COMP%]{font-size:13px;padding:0 10;margin:4 0;clear:both;color:#686868}.c21-box-text[_ngcontent-%COMP%]{max-height:110;overflow-y:auto}.c21-text[_ngcontent-%COMP%]{font-size:14px;color:#000;padding:0 10;margin:0;line-height:1.4;word-break:break-word}.overflow4Lines[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical}.c21-img[_ngcontent-%COMP%]{margin-left:5px;width:120px}.c21-text.c21-time[_ngcontent-%COMP%]{font-size:13px;padding:0 10;clear:both;color:#737376}.c21-link[_ngcontent-%COMP%]{text-decoration:underline;padding:8px;cursor:pointer}.c21-icon-avatar[_ngcontent-%COMP%]{position:absolute;width:32px;height:32px;bottom:0;left:-40px;box-shadow:#232f3517 0 2px 8px;border-radius:100%;border:1px solid #eee;overflow:hidden}.c21-avatar-image[_ngcontent-%COMP%]{width:32px;height:32px;display:block;position:absolute}.c21-avatar-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.headerPreviewMessage[_ngcontent-%COMP%]{position:relative;height:40;margin:10 0 0 50}.boxButtons[_ngcontent-%COMP%]{display:none}.buttonClose[_ngcontent-%COMP%]{transform:translateY(0);opacity:1;position:absolute;top:0;right:0;transition:all .12s ease-out 80ms}.buttonMore[_ngcontent-%COMP%]{transform:translateY(0);opacity:1;display:inline-block;transition:all .12s ease-out 80ms;text-align:center}.buttonMore[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .buttonClose[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;background-color:#67788f;color:#fff;font-size:13px;height:32px;line-height:32px;cursor:pointer;border-radius:16px;background-position:center center;padding:0 20px}.buttonClose[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:32px;height:32px;padding:0}.buttonClose[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{padding:6}#new_message[_ngcontent-%COMP%]{position:absolute;left:0;right:10;bottom:0}']}),i})();const ut=function(i){return{fill:i}};function _a(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.prevStep())}),t.O4$(),t.TgZ(1,"svg",11),t._UZ(2,"path",12)(3,"path",13),t.TgZ(4,"title",14),t._uU(5),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.VKq(2,ut,null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(e.g.BACK)}}const Wt=function(i){return{color:i}};function va(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",38)(1,"div",39),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.dowloadTranscript())}),t.TgZ(2,"span",40),t._uU(3),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("ngStyle",t.VKq(2,Wt,null==e.stylesMap?null:e.stylesMap.get("themeColor"))),t.xp6(1),t.Oqu(e.g.DOWNLOAD_TRANSCRIPT)}}const Ot=function(i,a,e){return{"background-color":i,"border-color":a,color:e}};function ba(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",15),t.YNc(1,va,4,4,"div",16),t._UZ(2,"div",17),t.TgZ(3,"div",18)(4,"div",19),t._uU(5),t.qZA(),t.TgZ(6,"fieldset",20),t._UZ(7,"input",21),t.TgZ(8,"label",22),t.NdJ("mouseover",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(1))})("mouseleave",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(0))})("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openRate(1))}),t.O4$(),t.TgZ(9,"svg",23),t._UZ(10,"path",24),t.qZA()(),t.kcU(),t._UZ(11,"input",25),t.TgZ(12,"label",26),t.NdJ("mouseover",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(2))})("mouseleave",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(0))})("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openRate(2))}),t.O4$(),t.TgZ(13,"svg",23),t._UZ(14,"path",24),t.qZA()(),t.kcU(),t._UZ(15,"input",27),t.TgZ(16,"label",28),t.NdJ("mouseover",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(3))})("mouseleave",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(0))})("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openRate(3))}),t.O4$(),t.TgZ(17,"svg",23),t._UZ(18,"path",24),t.qZA()(),t.kcU(),t._UZ(19,"input",29),t.TgZ(20,"label",30),t.NdJ("mouseover",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(4))})("mouseleave",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(0))})("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openRate(4))}),t.O4$(),t.TgZ(21,"svg",23),t._UZ(22,"path",24),t.qZA()(),t.kcU(),t._UZ(23,"input",31),t.TgZ(24,"label",32),t.NdJ("mouseover",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(5))})("mouseleave",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.mouseOverRate(0))})("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openRate(5))}),t.O4$(),t.TgZ(25,"svg",23),t._UZ(26,"path",24),t.qZA()()()(),t.kcU(),t._UZ(27,"div",17),t.TgZ(28,"button",33),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.returnClosePage())}),t.TgZ(29,"span",34),t.O4$(),t.TgZ(30,"svg",35),t._UZ(31,"path",12)(32,"path",36),t.TgZ(33,"title",14),t._uU(34),t.qZA()()(),t.kcU(),t.TgZ(35,"span",37),t._uU(36),t.qZA(),t._UZ(37,"div",17),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.g.allowTranscriptDownload),t.xp6(4),t.Oqu(e.g.YOUR_OPINION_ON_OUR_CUSTOMER_SERVICE),t.xp6(1),t.uIk("disabled",e.g.isOpenStartRating?null:""),t.xp6(3),t.ekj("active",e.mouseRate>=1),t.xp6(4),t.ekj("active",e.mouseRate>=2),t.xp6(4),t.ekj("active",e.mouseRate>=3),t.xp6(4),t.ekj("active",e.mouseRate>=4),t.xp6(4),t.ekj("active",e.mouseRate>=5),t.xp6(3),t.Q6J("ngStyle",t.kEZ(17,Ot,null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(2),t.Q6J("ngStyle",t.VKq(21,ut,null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(e.g.CLOSE),t.xp6(2),t.hij(" ",e.g.CLOSE," ")}}function Ca(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",15),t._UZ(1,"div",17),t.TgZ(2,"div",41)(3,"textarea",42,43),t._uU(5),t.qZA(),t._UZ(6,"div",17),t.TgZ(7,"button",44),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.returnClosePage())}),t.TgZ(8,"span",34),t.O4$(),t.TgZ(9,"svg",35),t._UZ(10,"path",12)(11,"path",36),t.TgZ(12,"title",14),t._uU(13),t.qZA()()(),t.kcU(),t.TgZ(14,"span",37),t._uU(15),t.qZA(),t._UZ(16,"div",17),t.qZA(),t.TgZ(17,"button",45),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.sendRate())}),t.TgZ(18,"span",34),t.O4$(),t.TgZ(19,"svg",35),t._UZ(20,"path",46)(21,"path",47),t.TgZ(22,"title",14),t._uU(23),t.qZA()()(),t.kcU(),t.TgZ(24,"span",37),t._uU(25),t.qZA(),t._UZ(26,"div",17),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.s9C("placeholder",e.g.WRITE_YOUR_OPINION),t.xp6(2),t.Oqu(e.message),t.xp6(2),t.Q6J("ngStyle",t.kEZ(10,Ot,null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(2),t.Q6J("ngStyle",t.VKq(14,ut,null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(e.g.CLOSE),t.xp6(2),t.hij(" ",e.g.CLOSE," "),t.xp6(2),t.Q6J("ngStyle",t.kEZ(16,Ot,null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(2),t.Q6J("ngStyle",t.VKq(20,ut,null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(e.g.SUBMIT),t.xp6(2),t.hij(" ",e.g.SUBMIT," ")}}function wa(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",38)(1,"div",39),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.dowloadTranscript())}),t.TgZ(2,"span",40),t._uU(3),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Q6J("ngStyle",t.VKq(2,Wt,null==e.stylesMap?null:e.stylesMap.get("themeColor"))),t.xp6(1),t.Oqu(e.g.DOWNLOAD_TRANSCRIPT)}}function ya(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",15),t.YNc(1,wa,4,4,"div",16),t._UZ(2,"div",17),t.TgZ(3,"div",41)(4,"div",48),t._uU(5),t.qZA(),t.TgZ(6,"div",19),t._uU(7),t.qZA()(),t.TgZ(8,"button",44),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.returnClosePage())}),t.TgZ(9,"span",34),t.O4$(),t.TgZ(10,"svg",35),t._UZ(11,"path",12)(12,"path",36),t.TgZ(13,"title",14),t._uU(14),t.qZA()()(),t.kcU(),t.TgZ(15,"span",37),t._uU(16),t.qZA(),t._UZ(17,"div",17),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.g.allowTranscriptDownload),t.xp6(4),t.Oqu(e.g.THANK_YOU_FOR_YOUR_EVALUATION),t.xp6(2),t.Oqu(e.g.YOUR_RATING_HAS_BEEN_RECEIVED),t.xp6(1),t.Q6J("ngStyle",t.kEZ(7,Ot,null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("themeColor"),null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(2),t.Q6J("ngStyle",t.VKq(11,ut,null==e.stylesMap?null:e.stylesMap.get("foregroundColor"))),t.xp6(4),t.Oqu(e.g.CLOSE),t.xp6(2),t.hij(" ",e.g.CLOSE," ")}}const Oa=function(i,a){return{color:i,"background-image":a}};let xa=(()=>{class i{constructor(e,n){this.starRatingWidgetService=e,this.g=n,this.onClosePage=new t.vpe,this.onCloseRate=new t.vpe,this.logger=ve.getInstance()}ngOnInit(){this.step=0}dowloadTranscript(){this.starRatingWidgetService._dowloadTranscript(this.recipientId)}openRate(e){const n=this;this.rate=e,setTimeout(function(){n.step=1},300)}mouseOverRate(e){this.mouseRate=e}nextStep(){this.step=this.step+1}prevStep(){this.step=this.step-1}sendRate(){this.message=document.getElementById("chat21-message-rate-context").value,this.logger.debug("[STAR-RATING_COMP] sendRate!!!::",this.message);const e=this;this.starRatingWidgetService.httpSendRate(this.rate,this.message).subscribe(n=>{e.logger.debug("[STAR-RATING_COMP] OK sender",n),e.nextStep()},n=>{e.nextStep()},()=>{})}ngOnDestroy(){this.step=0}returnClosePage(){this.logger.debug("[STAR-RATING_COMP] closePage: ",this.mouseRate,this.step,this.rate),this.rate&&0!==this.rate&&this.step<2?this.sendRate():this.step=0,this.starRatingWidgetService.setOsservable(!1),this.onClosePage.emit()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(jt),t.Y36(Ie))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-star-rating-widget"]],inputs:{recipientId:"recipientId",stylesMap:"stylesMap"},outputs:{onClosePage:"onClosePage",onCloseRate:"onCloseRate"},decls:14,vars:12,consts:[["id","chat21-star-rating-widget"],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-content"],["tabindex","1417","aria-label"," indietro ","class","c21-header-button c21-left c21-button-clean",3,"click",4,"ngIf"],[1,"c21-title",3,"ngStyle"],[1,"c21-body"],[1,"c21-body-container"],[1,"c21-body-content"],["class","step-rate",4,"ngIf"],["tabindex","1417","aria-label"," indietro ",1,"c21-header-button","c21-left","c21-button-clean",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","24px","height","24px","viewBox","0 0 24 24",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"],["id","altIconTitle"],[1,"step-rate"],["class","c21-modal-content","style","text-align: right; margin: 0px 20px 30px 10px;",4,"ngIf"],[1,"clear"],[1,"c21-modal-content"],[1,"default-text"],[1,"chat21-rating"],["type","radio","id","star1","name","rating","value","1",1,"c21-input-star"],["for","star1","title","scarso - 1 star",1,"full","c21-button",3,"mouseover","mouseleave","click"],["width","30px","height","30px","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 576 512",1,"star"],["d","M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"],["type","radio","id","star2","name","rating","value","2",1,"c21-input-star"],["for","star2","title","sufficiente - 2 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["type","radio","id","star3","name","rating","value","3",1,"c21-input-star"],["for","star3","title","buono - 3 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["type","radio","id","star4","name","rating","value","4",1,"c21-input-star"],["for","star4","title","ottimo - 4 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["type","radio","id","star5","name","rating","value","5",1,"c21-input-star"],["for","star5","title","eccellente - 5 stars",1,"full","c21-button",3,"mouseover","mouseleave","click"],["tabindex","1414",1,"c21-button-primary",3,"ngStyle","click"],[1,"v-align-center"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24",3,"ngStyle"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"v-align-center","c21-label-button"],[1,"c21-modal-content",2,"text-align","right","margin","0px 20px 30px 10px"],[1,"c21-link",3,"click"],[3,"ngStyle"],[1,"c21-step-content"],["rows","1","id","chat21-message-rate-context",1,"textarea-rate",3,"placeholder"],["textbox",""],["tabindex","1415",1,"c21-button-primary",3,"ngStyle","click"],["tabindex","1416",1,"c21-button-primary",3,"ngStyle","click"],["d","M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"],["d","M0 0h24v24H0z","fill","none"],[1,"default-title"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.YNc(4,_a,6,4,"button",4),t.TgZ(5,"div",5)(6,"span"),t._uU(7),t.qZA()()()()(),t.TgZ(8,"div",6)(9,"div",7)(10,"div",8),t.YNc(11,ba,38,23,"div",9),t.YNc(12,Ca,27,22,"div",9),t.YNc(13,ya,18,13,"div",9),t.qZA()()()()),2&e&&(t.xp6(1),t.Q6J("ngStyle",t.WLB(7,Oa,n.g.themeForegroundColor,n.g.colorGradient180)),t.xp6(3),t.Q6J("ngIf",n.step>0&&2!=n.step),t.xp6(1),t.Q6J("ngStyle",t.VKq(10,Wt,n.g.themeForegroundColor)),t.xp6(2),t.Oqu(n.g.CUSTOMER_SATISFACTION),t.xp6(4),t.Q6J("ngIf",0==n.step),t.xp6(1),t.Q6J("ngIf",1==n.step),t.xp6(1),t.Q6J("ngIf",2==n.step))},dependencies:[ue.O5,ue.PC],styles:["#chat21-star-rating-widget[_ngcontent-%COMP%]{background-color:#fff;width:100%;height:100%;font-size:10px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]{z-index:1}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button[_ngcontent-%COMP%]{width:31px;height:31px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button[_ngcontent-%COMP%]   .c21-close-button-body[_ngcontent-%COMP%]{width:31px;height:31px;-webkit-appearance:initial;border:none}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{display:flex;align-items:center}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{position:absolute;left:45px;right:45px;display:flex;align-items:center;width:auto;height:1.6em;line-height:1.6em;padding:0;margin:13px 0;text-align:center;font-size:1.6em;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]{overflow:hidden}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]{padding:10px 30px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .c21-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#616161;font-size:1.5em;text-align:center;word-wrap:break-word}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]{padding:10px 0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .default-title[_ngcontent-%COMP%]{font-size:2em;font-family:Roboto;color:#1a1a1a}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .default-text[_ngcontent-%COMP%]{font-size:1.4em;font-family:Roboto;color:#1a1a1a;margin:0 0 4px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]{text-align:center;position:relative;margin:10px 0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]{border:none;width:190px;min-height:30px;margin:20px auto;font-size:1.6em;padding:0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   input.c21-input-star[_ngcontent-%COMP%]{border:0;width:1px;height:1px;overflow:hidden;position:absolute!important;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);opacity:0}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]{position:relative;display:inline;float:none;color:#c8c8c8}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]:before{margin:5px;display:inline-block;font-size:24px;color:#ccc;-webkit-user-select:none;user-select:none}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   input.c21-input-star[_ngcontent-%COMP%]:checked ~ label.c21-button[_ngcontent-%COMP%]:before{color:#ffc107}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]:hover ~ label.c21-button[_ngcontent-%COMP%]:before{color:#ffdb70}#chat21-star-rating-widget[_ngcontent-%COMP%]   .chat21-rating[_ngcontent-%COMP%]   label.c21-button[_ngcontent-%COMP%]:hover:before{color:#ffc107}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   .chat21-stars[_ngcontent-%COMP%]{padding:0;position:absolute;text-align:right;display:block;top:0;right:40px;width:70px;line-height:20px;fill:gold}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   svg.star[_ngcontent-%COMP%]{fill:#efefef}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   svg.star[_ngcontent-%COMP%]:hover{fill:gold;stroke-width:15px;transform:rotate(-15deg) scale(1.3)}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   svg.star.active[_ngcontent-%COMP%]{fill:gold}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   .fa-star[_ngcontent-%COMP%]:before{margin:0;font-size:1em;display:inline-block;color:gold}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]{margin:0 auto 10px;border:hidden;overflow-x:hidden;overflow-y:visible;box-sizing:border-box;padding:10px;color:#1a1a1a;width:calc(100% - 40px);height:110px;resize:none;font-size:13px;border-radius:16px;background-color:#fafafa;text-align:left;font-weight:300}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;background-color:#0000!important}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{background-color:#f9f9f9!important}#chat21-star-rating-widget[_ngcontent-%COMP%]   .step-rate[_ngcontent-%COMP%]   textarea.textarea-rate[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background:#777777}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-step-content[_ngcontent-%COMP%]{margin:10px 0 20px;position:relative}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-button-primary[_ngcontent-%COMP%]{font-size:1.4em;border:1px solid;margin:0 10px}#chat21-star-rating-widget[_ngcontent-%COMP%]   .c21-link[_ngcontent-%COMP%]{cursor:pointer;font-size:14px}#chat21-star-rating-widget[_ngcontent-%COMP%]   a.c21-link[_ngcontent-%COMP%]:visited, #chat21-star-rating-widget[_ngcontent-%COMP%]   a.c21-link[_ngcontent-%COMP%]:link{color:#2a6ac1}",".star.active[_ngcontent-%COMP%]{\n    fill:#FFD700;\n}\nsvg.star[_ngcontent-%COMP%]{\n    fill: #efefef;\n}\nsvg.star[_ngcontent-%COMP%]:hover{\n    fill: #FFD700;\n}"]}),i})();const Ma=["aflauncherbutton"];function Ea(i,a){if(1&i&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.g.conversationsBadge)}}const Sa=function(i){return{width:"100%",height:"100%",margin:"auto","border-radius":i}};function Ta(i,a){if(1&i&&t._UZ(0,"img",11),2&i){const e=t.oxw(3);t.Q6J("src",e.g.baloonImage,t.LSH)("ngStyle",t.VKq(2,Sa,e.g.baloonShape))}}const Pa=function(i,a){return{fill:i,display:a}};function ka(i,a){if(1&i&&(t.TgZ(0,"div",6),t.YNc(1,Ta,1,4,"img",7),t.O4$(),t.TgZ(2,"svg",8),t._UZ(3,"path",9)(4,"path",10),t.qZA()()),2&i){const e=t.oxw(2);t.Q6J("@enterBubbleAnimation",void 0),t.xp6(1),t.Q6J("ngIf",""!==e.g.baloonImage),t.xp6(1),t.Q6J("ngStyle",t.WLB(3,Pa,e.g.themeForegroundColor,""===e.g.baloonImage?"":"none"))}}const Aa=function(i){return{fill:i}};function Ia(i,a){if(1&i&&(t.TgZ(0,"div",6),t.O4$(),t.TgZ(1,"svg",8),t._UZ(2,"path",9)(3,"path",12),t.qZA()()),2&i){const e=t.oxw(2);t.Q6J("@enterCloseAnimation",void 0),t.xp6(1),t.Q6J("ngStyle",t.VKq(2,Aa,e.g.themeForegroundColor))}}const Ra=function(i,a){return{"c21-align-left":i,"c21-align-right":a}},La=function(i,a,e,n,o,r,v){return{"background-color":i,bottom:a,left:e,right:n,width:o,height:r,"border-radius":v}};function Na(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",1,2),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openCloseWidget())}),t.YNc(2,Ea,2,1,"div",3),t.YNc(3,ka,5,6,"div",4),t.YNc(4,Ia,4,4,"div",4),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("ngClass",t.WLB(5,Ra,"left"===e.g.align,"left"!==e.g.align))("ngStyle",t.Hh0(8,La,e.g.baloonImage?null:e.g.themeColor,e.g.marginY+"px!important","left"===e.g.align?e.g.marginX+"px!important":"","right"===e.g.align?e.g.marginX+"px!important":"",e.g.launcherWidth,e.g.launcherHeight,e.g.baloonShape)),t.xp6(2),t.Q6J("ngIf",e.g.conversationsBadge>0),t.xp6(1),t.Q6J("ngIf",!e.g.isOpen),t.xp6(1),t.Q6J("ngIf",e.g.isOpen)}}let Fa=(()=>{class i{constructor(e,n){this.g=e,this.appStorageService=n,this.onButtonClicked=new t.vpe}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{!this.g.isOpen&&this.aflauncherbutton&&(this.aflauncherbutton.nativeElement.style["box-shadow"]="0px 4px 20px "+ke(this.g.themeColor,50))},0)}openCloseWidget(){!0===this.g.isLogged&&this.onButtonClicked.emit(this.g.isOpen)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Ie),t.Y36(Ne))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-launcher-button"]],viewQuery:function(e,n){if(1&e&&t.Gf(Ma,5),2&e){let o;t.iGM(o=t.CRH())&&(n.aflauncherbutton=o.first)}},outputs:{onButtonClicked:"onButtonClicked"},decls:1,vars:1,consts:[["aflauncherbutton","","id","c21-launcher-button","class","c21-button-clean scale-in-center","tabindex","1000","aria-label","    apri chat",3,"ngClass","ngStyle","click",4,"ngIf"],["aflauncherbutton","","id","c21-launcher-button","tabindex","1000","aria-label","    apri chat",1,"c21-button-clean","scale-in-center",3,"ngClass","ngStyle","click"],["aflauncherbutton",""],["class","c21-divBudge",4,"ngIf"],["class","launcher-button rotate-center",4,"ngIf"],[1,"c21-divBudge"],[1,"launcher-button","rotate-center"],[3,"src","ngStyle",4,"ngIf"],["role","img","xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 90 90",3,"ngStyle"],["fill","none","d","M0 0h24v24H0V0z"],["d","M33.57,31A4.58,4.58,0,0,0,29,35.57V58.3a1.94,1.94,0,0,0,3.32,1.38l3-3a.29.29,0,0,1,.21-.09H56.43A4.58,4.58,0,0,0,61,52V35.57A4.58,4.58,0,0,0,56.43,31Z"],[3,"src","ngStyle"],["d","M54.92,37.08l-2-2L45,43l-7.92-7.92-2,2L43,45l-7.92,7.92,2,2L45,47l7.92,7.92,2-2L47,45Z",1,"cls-1"]],template:function(e,n){1&e&&t.YNc(0,Na,5,16,"button",0),2&e&&t.Q6J("ngIf",1==n.g.isLogged&&0==n.g.isOpen)},dependencies:[ue.mk,ue.O5,ue.PC],styles:["#c21-launcher-button[_ngcontent-%COMP%]{position:fixed;bottom:0;cursor:pointer;display:block;margin:20px;z-index:1;box-shadow:#00122e29 0 0 16px}#c21-launcher-button[_ngcontent-%COMP%]   .launcher-button[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;margin:0;display:flex}.c21-divBudge[_ngcontent-%COMP%]{position:absolute;top:0;width:16px;height:16px;min-width:12px;font-size:1.2em;line-height:16px;border-radius:50%;background-color:red;color:#fff;font-weight:700;padding:5px;text-align:center;margin-top:-10px;display:inline-block}@media (max-width: 451px){#c21-launcher-button.c21-align-right[_ngcontent-%COMP%]{right:0}#c21-launcher-button.c21-align-left[_ngcontent-%COMP%]{left:0}}"],data:{animation:[(0,Pe.X$)("enterCloseAnimation",[(0,Pe.eR)(":enter",[(0,Pe.oB)({transform:"rotate(-90deg)",opacity:1}),(0,Pe.jt)("450ms ease-out",(0,Pe.oB)({transform:"rotate(0deg)",opacity:1}))]),(0,Pe.eR)(":leave",[(0,Pe.oB)({transform:"scale(1)",opacity:1}),(0,Pe.jt)("200ms ease-in",(0,Pe.oB)({transform:"scale(0.5)",opacity:0}))])]),(0,Pe.X$)("enterBubbleAnimation",[(0,Pe.eR)(":enter",[(0,Pe.oB)({transform:"scale(0.5)",opacity:0}),(0,Pe.jt)("200ms ease-out",(0,Pe.oB)({transform:"scale(1)",opacity:1}))]),(0,Pe.eR)(":leave",[(0,Pe.oB)({transform:"scale(1)",opacity:1}),(0,Pe.jt)("200ms ease-in",(0,Pe.oB)({transform:"scale(0.5)",opacity:0}))])])]}}),i})();const Ba=["afSelectionDepartment"];function Ua(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"li")(1,"button",20),t.NdJ("click",function(){const r=t.CHM(e).$implicit,v=t.oxw();return t.KtG(v.onSelectDepartment(r))}),t.TgZ(2,"span",21),t._uU(3),t.qZA(),t.TgZ(4,"span",22),t._uU(5),t.qZA()()()}if(2&i){const e=a.$implicit,n=a.index;t.xp6(3),t.Oqu(n+1),t.xp6(2),t.Oqu(null==e?null:e.name)}}const Da=function(i,a){return{color:i,"background-image":a}},Ha=function(i){return{color:i}};let Za=(()=>{class i{constructor(e,n,o){this.elementRef=e,this.g=n,this.appStorageService=o,this.onDepartmentSelected=new t.vpe,this.onClose=new t.vpe,this.onOpen=new t.vpe,this.onBeforeDepartmentsFormRender=new t.vpe,this.logger=ve.getInstance()}ngOnInit(){this.logger.debug("[SELECT-DEP] ngOnInit"),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--backgroundColor",this.g.themeForegroundColor),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--textColor",this.g.themeColor),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--hoverBackgroundColor",this.g.themeColor),this.elementRef.nativeElement.querySelector("#chat21-selection-department").style.setProperty("--hoverTextColor",this.g.themeForegroundColor),this.g.departments&&this.g.departments.length>0&&(this.g.windowContext&&this.g.windowContext.tiledesk&&this.g.windowContext.tiledesk.beforeDepartmentsFormRender?(this.departments=this.g.departments,this.departments=this.g.windowContext.tiledesk.beforeDepartmentsFormRender(this.g.departments)):(this.departments=JSON.parse(JSON.stringify(this.g.departments)),this.triggerOnbeforeDepartmentsFormRender()))}ngAfterViewInit(){setTimeout(()=>{this.afSelectionDepartment&&this.afSelectionDepartment.nativeElement.focus()},1e3)}setDepartment(e){if(this.g.setParameter("departmentSelected",e),this.g.attributes){const n=this.g.attributes;this.g.setAttributeParameter("departmentId",e._id),this.g.setAttributeParameter("departmentName",e.name),this.appStorageService.setItem("attributes",JSON.stringify(n)),this.logger.debug("[SELECT-DEP] setDepartment: attributes",JSON.stringify(n))}}onSelectDepartment(e){this.logger.debug("[SELECT-DEP] onSelectDepartment: ",e),this.setDepartment(e),this.onDepartmentSelected.emit(e)}openPage(){this.logger.debug("[SELECT-DEP] openPage "),this.onOpen.emit()}closePage(){this.logger.debug("[SELECT-DEP] closePage"),this.onClose.emit()}cancelPage(){this.logger.debug("[SELECT-DEP] cancelPage"),this.g.newConversationStart=!1,this.onClose.emit()}triggerOnbeforeDepartmentsFormRender(){this.onBeforeDepartmentsFormRender.emit(this.departments)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq),t.Y36(Ie),t.Y36(Ne))},i.\u0275cmp=t.Xpm({type:i,selectors:[["chat-selection-department"]],viewQuery:function(e,n){if(1&e&&t.Gf(Ba,5),2&e){let o;t.iGM(o=t.CRH())&&(n.afSelectionDepartment=o.first)}},outputs:{onDepartmentSelected:"onDepartmentSelected",onClose:"onClose",onOpen:"onOpen",onBeforeDepartmentsFormRender:"onBeforeDepartmentsFormRender"},decls:21,vars:9,consts:[["id","chat21-selection-department","tabindex","1200","aria-modal","true","onFocus","document.querySelector('[start-focus-chat21-selection-department]').focus()"],["afSelectionDepartment",""],[1,"c21-header",3,"ngStyle"],[1,"c21-header-container"],[1,"c21-header-button"],["role","button",1,"c21-close-button","c21-small"],["tabindex","1210","aria-label"," chiudi pannello",1,"c21-close-button-body",3,"click"],["role","img","aria-labelledby","altIconTitle","xmlns","http://www.w3.org/2000/svg","width","20px","height","20px","viewBox","0 0 24 24"],["fill","none","d","M0 0h24v24H0V0z"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"],[1,"c21-header-content"],[1,"c21-title",3,"ngStyle"],[1,"c21-body"],[1,"c21-body-container"],[1,"c21-body-header"],["start-focus-chat21-selection-department","","tabindex","1201",1,"c21-message-field"],["tabindex","211","onFocus","document.querySelector('[start-focus]').focus()",1,"c21-body-content"],[1,"chat21-content-modal-select"],[4,"ngFor","ngForOf"],["tabindex","1299","onFocus","document.querySelector('[start-focus-chat21-selection-department]').focus()",2,"height","0px"],["tabindex","1202",1,"c21-button-department","c21-button-clean",3,"click"],[1,"chat21-badge"],[1,"chat21-name-list"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),t.NdJ("click",function(){return n.closePage()}),t.O4$(),t.TgZ(7,"svg",7),t._UZ(8,"path",8)(9,"path",9),t.qZA()()()(),t.kcU(),t.TgZ(10,"div",10),t._UZ(11,"div",11),t.qZA()()(),t.TgZ(12,"div",12)(13,"div",13)(14,"div",14)(15,"div",15),t._uU(16),t.qZA()(),t.TgZ(17,"div",16)(18,"ul",17),t.YNc(19,Ua,6,2,"li",18),t.qZA()()()(),t._UZ(20,"span",19),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngStyle",t.WLB(4,Da,n.g.themeForegroundColor,n.g.colorGradient180)),t.xp6(9),t.Q6J("ngStyle",t.VKq(7,Ha,n.g.themeForegroundColor)),t.xp6(5),t.Oqu(n.g.LABEL_SELECT_TOPIC),t.xp6(3),t.Q6J("ngForOf",n.departments))},dependencies:[ue.sg,ue.PC],styles:["#chat21-selection-department[_ngcontent-%COMP%]{--backgroundColor: #f7f7f7;--textColor: rgb(42, 106, 193);--hoverBackgroundColor: rgb(42, 106, 193);--hoverTextColor: #f7f7f7;background-color:#fff;width:100%;height:100%}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]{overflow:hidden;width:100%;height:52px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]{width:31px;height:31px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-button[_ngcontent-%COMP%]   .c21-close-button.c21-small[_ngcontent-%COMP%]   .c21-close-button-body[_ngcontent-%COMP%]{width:31px;height:31px;-webkit-appearance:initial;border:none}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;margin:0 auto}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]{width:100%;height:auto;padding:0 40px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-header[_ngcontent-%COMP%]   .c21-header-container[_ngcontent-%COMP%]   .c21-header-content[_ngcontent-%COMP%]   .c21-title[_ngcontent-%COMP%]{display:inline-block;width:100%;height:auto;padding:0;text-align:center;font-size:1.8em;line-height:normal}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:16px;padding-right:16px;gap:10px}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]{position:relative;inset:0;padding:20px 30px 0}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-header[_ngcontent-%COMP%]   .c21-message-field[_ngcontent-%COMP%]{padding:0;margin:0;line-height:1.2em;color:#aaa;font-size:1.6em;text-align:center;word-wrap:break-word}#chat21-selection-department[_ngcontent-%COMP%]   .c21-body[_ngcontent-%COMP%]   .c21-body-content[_ngcontent-%COMP%]{padding:0 0 40px;position:relative;width:100%}.chat21-content-modal-select[_ngcontent-%COMP%]{margin:0 0 2em;list-style-type:none;padding:0;height:auto;overflow-y:auto;display:flex;flex-direction:column;gap:12px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{cursor:pointer;position:relative;margin:0;padding:20px 16px;font-size:1.4em;text-align:left;color:var(--textColor);border:1px solid var(--textColor);line-height:normal;display:block;border-radius:10px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .c21-button-department[_ngcontent-%COMP%]{width:100%;text-align:left;display:flex;gap:12px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{background-color:var(--hoverBackgroundColor);border-radius:10px}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover   .chat21-name-list[_ngcontent-%COMP%]{color:var(--hoverTextColor)}.chat21-content-modal-select[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover   .chat21-badge[_ngcontent-%COMP%]{color:var(--hoverBackgroundColor);background-color:var(--hoverTextColor)}.chat21-content-modal-select[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:relative}.chat21-content-modal-select[_ngcontent-%COMP%]   .chat21-badge[_ngcontent-%COMP%]{box-sizing:initial;display:flex;justify-content:center;align-items:center;font-size:12px;padding:0;line-height:24px;height:24px;width:24px;border-radius:50%;margin:0 10px 0 0;text-align:center;font-weight:500;color:var(--backgroundColor);background-color:var(--textColor)}.chat21-content-modal-select[_ngcontent-%COMP%]   .chat21-name-list[_ngcontent-%COMP%]{font-size:18px;font-weight:500;line-height:24px;color:#7d87a4}.chat21-content-modal-select[_ngcontent-%COMP%]   .chat21-title[_ngcontent-%COMP%]{margin-left:10px;font-weight:initial;line-height:normal}"]}),i})();var za=_e(8746),xt=_e(2344);let ja=(()=>{class i{constructor(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Va=(()=>{class i extends ja{constructor(e){super(),this.logger=e,this.logLevel=xe.ERROR,this.isLogEnabled=!0}setLoggerConfig(e,n){this.isLogEnabled=e,"string"==typeof n?this.logLevel=xe[n.toUpperCase()]:console.error("logLevel is not a string. See the chat21-ionic README.md")}getLoggerConfig(){return{isLogEnabled:this.isLogEnabled,logLevel:this.logLevel}}error(e,...n){this.isLogEnabled&&this.logLevel>=xe.ERROR&&this.logger.error(e,...n)}warn(e,...n){this.isLogEnabled&&this.logLevel>=xe.WARN&&this.logger.warn(e,...n)}info(e,...n){this.isLogEnabled&&this.logLevel>=xe.INFO&&this.logger.info(e,...n)}debug(e,...n){this.isLogEnabled&&this.logLevel>=xe.DEBUG&&this.logger.debug(e,...n)}log(e,...n){this.isLogEnabled&&this.logLevel>=xe.DEBUG&&this.logger.log(e,...n)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(xt.Kf))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Yt=(()=>{class i{constructor(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var Oe=_e(7835);let Zn=(()=>{class i{constructor(){}static initFirebase(e){if(!i.firebaseInit){if(!e||"CHANGEIT"===e.apiKey)throw new Error("Firebase config is not defined. Please create your widget-config.json. See the Chat21-Web_widget Installation Page");i.firebaseInit=Oe.Z.initializeApp(e)}return i.firebaseInit}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();_e(6035),_e(7255),_e(7315);let Ga=(()=>{class i extends Ct{constructor(e){super(),this.http=e,this.BSAuthStateChanged=new me.X(null),this.BSSignOut=new me.X(null),this.logger=ve.getInstance()}initialize(){this.SERVER_BASE_URL=this.getBaseUrl(),this.URL_TILEDESK_CREATE_CUSTOM_TOKEN=this.SERVER_BASE_URL+"chat21/firebase/auth/createCustomToken",this.logger.debug("[FIREBASEAuthSERVICE] - initialize URL_TILEDESK_CREATE_CUSTOM_TOKEN ",this.URL_TILEDESK_CREATE_CUSTOM_TOKEN),this.onAuthStateChanged()}getToken(){return this.firebaseToken}onAuthStateChanged(){const e=this;Oe.Z.auth().onAuthStateChanged(n=>{this.logger.debug("[FIREBASEAuthSERVICE] onAuthStateChanged",n),n?(this.logger.debug("[FIREBASEAuthSERVICE] 2 - PUBLISH ONLINE to chat-manager"),e.BSAuthStateChanged.next("online")):(this.logger.debug("[FIREBASEAuthSERVICE] 1 - PUBLISH OFFLINE to chat-manager"),e.BSAuthStateChanged.next("offline"))})}signInFirebaseWithCustomToken(e){const n=this;let o;switch(this.getPersistence()){case"SESSION":o=Oe.Z.auth.Auth.Persistence.SESSION;break;case"LOCAL":o=Oe.Z.auth.Auth.Persistence.LOCAL;break;default:o=Oe.Z.auth.Auth.Persistence.NONE}return Oe.Z.auth().setPersistence(o).then((0,qt.Z)(function*(){return Oe.Z.auth().signInWithCustomToken(e).then((0,qt.Z)(function*(){})).catch(r=>{n.logger.error("[FIREBASEAuthSERVICE] signInFirebaseWithCustomToken Error: ",r)})})).catch(r=>{n.logger.error("[FIREBASEAuthSERVICE] signInFirebaseWithCustomToken Error: ",r)})}createUserWithEmailAndPassword(e,n){const o=this;return Oe.Z.auth().createUserWithEmailAndPassword(e,n).then(r=>(o.logger.debug("[FIREBASEAuthSERVICE] CRATE USER WITH EMAIL: ",e," & PSW: ",n),r)).catch(r=>(o.logger.error("[FIREBASEAuthSERVICE] createUserWithEmailAndPassword error: ",r.message),r))}sendPasswordResetEmail(e){const n=this;return Oe.Z.auth().sendPasswordResetEmail(e).then(()=>{n.logger.debug("[FIREBASEAuthSERVICE] firebase-send-password-reset-email")}).catch(o=>{n.logger.error("[FIREBASEAuthSERVICE] sendPasswordResetEmail error: ",o)})}signOut(){const e=this;return new Promise((n,o)=>{Oe.Z.auth().signOut().then(()=>{e.logger.debug("[FIREBASEAuthSERVICE] firebase-sign-out"),e.BSSignOut.next(!0),n(!0)}).catch(r=>{n(!1),e.logger.error("[FIREBASEAuthSERVICE] signOut error: ",r)})})}delete(){const e=this;Oe.Z.auth().currentUser.delete().then(()=>{e.logger.debug("[FIREBASEAuthSERVICE] firebase-current-user-delete")}).catch(n=>{e.logger.error("[FIREBASEAuthSERVICE] delete error: ",n)})}createCustomToken(e){const n=new Ee.WM({"Content-type":"application/json",Authorization:e}),v=this;this.http.post(this.URL_TILEDESK_CREATE_CUSTOM_TOKEN,{},{headers:n,responseType:"text"}).subscribe(P=>{v.firebaseToken=P,v.signInFirebaseWithCustomToken(P)},P=>{v.logger.error("[FIREBASEAuthSERVICE] createFirebaseCustomToken ERR ",P)})}logout(){return this.logger.debug("[FIREBASEAuthSERVICE] logout"),this.signOut()}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),qa=(()=>{class i extends at{constructor(e,n){super(),this.http=e,this.appConfig=n,this.BSConversationDetail=new me.X(null),this.conversationAdded=new me.X(null),this.conversationChanged=new me.X(null),this.conversationChangedDetailed=new me.X(null),this.conversationRemoved=new me.X(null),this.conversations=[],this.logger=ve.getInstance()}initialize(e,n,o){this.tenant=e,this.loggedUserId=n,this.translationMap=o,this.conversations=[],this.isConversationClosingMap=new Map,this.BASE_URL=this.appConfig.getConfig().firebaseConfig.chat21ApiUrl,this.BASE_URL_DATABASE=this.appConfig.getConfig().firebaseConfig.databaseURL}subscribeToConversations(e){const n=this,o=mt(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEConversationsHandlerSERVICE] SubscribeToConversations conversations::ACTIVE urlNodeFirebase",o),this.ref=Oe.Z.database().ref(o).orderByChild("timestamp").limitToLast(200),this.ref.on("child_changed",r=>{n.changed(r)}),this.ref.on("child_removed",r=>{n.removed(r)}),this.ref.on("child_added",r=>{n.added(r)}),setTimeout(()=>{e()},2e3)}getLastConversation(e){this.getFirebaseToken((n,o)=>{if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi  idToken",o),this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi  error",n),o){const r={headers:new Ee.WM({Accept:"application/json","Content-Type":"application/json"})},v=mt(this.tenant,this.loggedUserId);this.http.get(this.BASE_URL_DATABASE+v+".json?auth="+o+'&orderBy="timestamp"&limitToLast=1',r).subscribe(X=>{if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi - RES",X),X){const ae=X[Object.keys(X)[0]];ae.uid=Object.keys(X)[0];const fe=this.completeConversation(ae);e(fe,null)}else X||e(null,null)},X=>{this.logger.error("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi ERROR ",X),e(null,"error")},()=>{this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationsRESTApi * COMPLETE *")})}else e(null,"error")})}countIsNew(){let e=0;return this.conversations.forEach(n=>{!0===n.is_new&&e++}),e}setConversationRead(e){const n=mt(this.tenant,this.loggedUserId)+"/"+e;Oe.Z.database().ref(n).update({"/is_new":!1})}getClosingConversation(e){return this.isConversationClosingMap[e]}setClosingConversation(e,n){this.isConversationClosingMap[e]=n}deleteClosingConversation(e){this.isConversationClosingMap.delete(e)}archiveConversation(e){const n=this;this.setClosingConversation(e,!0);const o=Le(this.conversations,e);this.deleteConversation(e,function(r){n.logger.debug("[FIREBASEConversationsHandlerSERVICE]  ARCHIVE-CONV",r),"success"===r?o>-1&&n.conversations.splice(o,1):"error"===r&&n.setClosingConversation(e,!1)})}deleteConversation(e,n){this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV conversationId",e),this.getFirebaseToken((o,r)=>{if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV idToken",r),this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV error",o),r){const v={headers:new Ee.WM({Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r})};this.http.delete(this.BASE_URL+"/api/"+this.tenant+"/conversations/"+e,v).subscribe(Y=>{this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV - RES",Y),n("success")},Y=>{this.logger.error("[FIREBASEConversationsHandlerSERVICE] DELETE CONV ERROR ",Y),n("error")},()=>{this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DELETE CONV * COMPLETE *")})}else n("error")})}getFirebaseToken(e){const n=Oe.Z.auth().currentUser;this.logger.debug(" // firebase current user ",n),n&&n.getIdToken(!0).then(function(o){e(null,o)}).catch(function(o){e(o,null)})}getConversationDetail(e,n){const o=this.conversations.find(r=>r.uid===e);if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE]  conversations *****: ",this.conversations),this.logger.debug("[FIREBASEConversationsHandlerSERVICE]  getConversationDetail *****: ",o),o)n(o);else{const r=mt(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEConversationsHandlerSERVICE] conversationDetail urlNodeFirebase *****",r);const v=Oe.Z.database().ref(r);this.subscribe=v.on("value",P=>{const Y=P.child("/"+e);if(Y.exists()){const X=Y.val();if(this.logger.debug("[FIREBASEConversationsHandlerSERVICE] getConversationDetail conversation exist",Y.val(),Y.key),Y&&Y.key&&X){X.uid=Y.key;const ae=this.completeConversation(X);n(ae||null)}}else this.logger.log("[FIREBASEConversationsHandlerSERVICE] getConversationDetail conversation NOT exist",e),n(null)})}}dispose(){this.conversations=[],this.uidConvSelected="",this.logger.debug("[FIREBASEConversationsHandlerSERVICE] DISPOSE::: ",this.ref)}conversationGenerate(e){const n=e.val();n.uid=e.key;const o=this.completeConversation(n);if(this.isValidConversation(o)){this.setClosingConversation(e.key,!1);const r=Le(this.conversations,o.uid);return r>-1?this.conversations.splice(r,1,o):this.conversations.splice(0,0,o),this.conversations.sort($e("timestamp","desc")),!0}return!1}added(e){if(this.conversationGenerate(e)){const n=Le(this.conversations,e.key);n>-1&&this.conversationAdded.next(this.conversations[n])}else this.logger.error("[FIREBASEConversationsHandlerSERVICE]ADDED::conversations with conversationId: ",e.key,"is not valid")}changed(e){const n=this.conversations[Le(this.conversations,e.key)];if(this.conversationGenerate(e)){const o=Le(this.conversations,e.key);if(o>-1){const r=this.conversations[o];this.conversationChanged.next(r),this.conversationChangedDetailed.next({value:r,previousValue:n})}}else this.logger.error("[FIREBASEConversationsHandlerSERVICE]CHANGED::conversations with conversationId: ",e.key,"is not valid")}removed(e){const n=Le(this.conversations,e.key);if(n>-1){const o=this.conversations[n];this.conversations.splice(n,1),this.conversationRemoved.next(o)}this.deleteClosingConversation(e.key)}completeConversation(e){this.logger.debug("[FIREBASEConversationsHandlerSERVICE] completeConversation --\x3e conv from firebase",e),e.selected=!1,(!e.sender_fullname||"undefined"===e.sender_fullname||""===e.sender_fullname.trim())&&(e.sender_fullname=e.sender),(!e.recipient_fullname||"undefined"===e.recipient_fullname||""===e.recipient_fullname.trim())&&(e.recipient_fullname=e.recipient);let n=e.sender_fullname,o=e.sender;return e.sender===this.loggedUserId?(o=e.recipient,n=e.recipient_fullname,e.sender_fullname=this.translationMap.get("YOU")):hn(e)&&(o=e.recipient,n=e.recipient_fullname),e.conversation_with=o,e.conversation_with_fullname=n,e.status=this.setStatusConversation(e.sender,e.uid),e.avatar=ht(n),e.color=ct(n),e}setStatusConversation(e,n){let o="0";return o=e===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(e){return st(parseInt(e,10)/1e3)}isValidConversation(e){return!!(this.isValidField(e.uid)&&this.isValidField(e.is_new)&&this.isValidField(e.last_message_text)&&this.isValidField(e.recipient)&&this.isValidField(e.recipient_fullname)&&this.isValidField(e.sender)&&this.isValidField(e.sender_fullname)&&this.isValidField(e.status)&&this.isValidField(e.timestamp)&&this.isValidField(e.channel_type))}isValidField(e){return null!=e}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Re))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Wa=(()=>{class i extends lt{constructor(){super(),this.BSConversationDetail=new me.X(null),this.archivedConversationAdded=new me.X(null),this.archivedConversationChanged=new me.X(null),this.archivedConversationRemoved=new me.X(null),this.archivedConversations=[],this.logger=ve.getInstance()}initialize(e,n,o){this.tenant=e,this.loggedUserId=n,this.translationMap=o,this.archivedConversations=[],this.isConversationClosingMap=new Map}subscribeToConversations(e){const n=this,o=Pt(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] SubscribeToConversations conversations::ARCHIVED urlNodeFirebase",o),this.ref=Oe.Z.database().ref(o).orderByChild("timestamp").limitToLast(200),this.ref.on("child_changed",r=>{n.changed(r)}),this.ref.on("child_removed",r=>{n.removed(r)}),this.ref.on("child_added",r=>{n.added(r)}),setTimeout(()=>{e()},2e3)}countIsNew(){let e=0;return this.archivedConversations.forEach(n=>{!0===n.is_new&&e++}),e}setConversationRead(e){const n=Pt(this.tenant,this.loggedUserId)+"/"+e;Oe.Z.database().ref(n).update({"/is_new":!1})}getClosingConversation(e){return this.isConversationClosingMap[e]}setClosingConversation(e,n){this.isConversationClosingMap[e]=n}deleteClosingConversation(e){this.isConversationClosingMap.delete(e)}getConversationDetail(e,n){const o=this.archivedConversations.find(r=>r.uid===e);if(this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] SubscribeToConversations getConversationDetail::ARCHIVED *****: ",o),o)n(o);else{const r=Pt(this.tenant,this.loggedUserId);this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] urlNodeFirebase conversationDetail *****",r,e);const v=Oe.Z.database().ref(r);this.subscribe=v.on("value",P=>{const Y=P.child("/"+e);if(Y.exists()){const X=Y.val();if(this.logger.log("[FIREBASEArchivedConversationsHandlerSERVICE] getConversationDetail archived conversation exist",X),Y&&Y.key&&X){X.uid=Y.key;const ae=this.completeConversation(X);n(ae||null)}}else this.logger.log("[FIREBASEArchivedConversationsHandlerSERVICE] getConversationDetail archived conversation NOT exist",e),n(null)})}}dispose(){this.archivedConversations=[],this.uidConvSelected="",this.logger.debug("[FIREBASEArchivedConversationsHandlerSERVICE] DISPOSE::: ",this.ref)}conversationGenerate(e){const n=e.val();n.uid=e.key;const o=this.completeConversation(n);if(this.isValidConversation(o)){this.setClosingConversation(e.key,!1);const r=Le(this.archivedConversations,o.uid);return r>-1?this.archivedConversations.splice(r,1,o):this.archivedConversations.splice(0,0,o),this.archivedConversations.sort($e("timestamp","desc")),!0}return!1}added(e){if(this.conversationGenerate(e)){const n=Le(this.archivedConversations,e.key);n>-1&&this.archivedConversationAdded.next(this.archivedConversations[n])}else this.logger.error("[FIREBASEArchivedConversationsHandlerSERVICE] ADDED::conversations with conversationId: ",e.key,"is not valid")}changed(e){if(this.conversationGenerate(e)){const n=Le(this.archivedConversations,e.key);n>-1&&this.archivedConversationChanged.next(this.archivedConversations[n])}else this.logger.error("[FIREBASEArchivedConversationsHandlerSERVICE] CHANGED::conversations with conversationId: ",e.key,"is not valid")}removed(e){const n=Le(this.archivedConversations,e.key);if(n>-1){const o=this.archivedConversations[n];this.archivedConversations.splice(n,1),this.archivedConversationRemoved.next(o)}this.deleteClosingConversation(e.key)}completeConversation(e){e.selected=!1,(!e.sender_fullname||"undefined"===e.sender_fullname||""===e.sender_fullname.trim())&&(e.sender_fullname=e.sender),(!e.recipient_fullname||"undefined"===e.recipient_fullname||""===e.recipient_fullname.trim())&&(e.recipient_fullname=e.recipient);let n=e.sender_fullname,o=e.sender;return e.sender===this.loggedUserId?(o=e.recipient,n=e.recipient_fullname,e.sender_fullname=this.translationMap.get("YOU")):hn(e)&&(o=e.recipient,n=e.recipient_fullname),e.conversation_with=o,e.conversation_with_fullname=n,e.status=this.setStatusConversation(e.sender,e.uid),e.avatar=ht(n),e.color=ct(n),e.archived=!0,e}setStatusConversation(e,n){let o="0";return o=e===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(e){return st(parseInt(e,10)/1e3)}isValidConversation(e){return!!(this.isValidField(e.uid)&&this.isValidField(e.is_new)&&this.isValidField(e.last_message_text)&&this.isValidField(e.recipient)&&this.isValidField(e.recipient_fullname)&&this.isValidField(e.sender)&&this.isValidField(e.sender_fullname)&&this.isValidField(e.status)&&this.isValidField(e.timestamp)&&this.isValidField(e.channel_type))}isValidField(e){return null!=e}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();_e(9361);class zn{constructor(a,e,n,o,r,v,P,Y,X,ae,fe,Ce,de,we,ye){this.uid=a,this.language=e,this.recipient=n,this.recipient_fullname=o,this.sender=r,this.sender_fullname=v,this.status=P,this.metadata=Y,this.text=X,this.timestamp=ae,this.type=fe,this.attributes=Ce,this.channel_type=de,this.isSender=we,this.emoticon=ye}}let jn=(()=>{class i extends Yt{constructor(e){super(),this.skipInfoMessage=e,this.messageAdded=new me.X(null),this.messageChanged=new me.X(null),this.messageRemoved=new me.X(null),this.messageWait=new me.X(null),this.messageInfo=new me.X(null),this.startTime=new Date,this.logger=ve.getInstance()}initialize(e,n,o,r,v,P){this.logger.debug("[FIREBASEConversationHandlerSERVICE] initWithRecipient",e,n,o,r,v),this.recipientId=e,this.recipientFullname=n,this.loggedUser=o,o&&(this.senderId=o.uid),this.tenant=r,this.translationMap=v,this.listSubsriptions=[],this.CLIENT_BROWSER=navigator.userAgent,this.conversationWith=e,this.messages=[],this.showInfoMessage=P}connect(){const e=this;this.urlNodeFirebase=function to(i,a){return"/apps/"+i+"/users/"+a+"/messages/"}(this.tenant,this.loggedUser.uid),this.urlNodeFirebase=this.urlNodeFirebase+this.conversationWith,this.logger.debug("[FIREBASEConversationHandlerSERVICE] urlNodeFirebase *****",this.urlNodeFirebase);const n=Oe.Z.database().ref(this.urlNodeFirebase);this.ref=n.orderByChild("timestamp").limitToLast(100),this.ref.on("child_added",o=>{e.logger.debug("[FIREBASEConversationHandlerSERVICE] >>>>>>>>>>>>>> child_added: ",o.val());const r=o.val();r.uid=o.key,r.attributes&&r.attributes.commands?(this.logger.debug("[FIREBASEConversationHandlerSERVICE] splitted message::::",r),e.addCommandMessage(r)):(this.logger.debug("[FIREBASEConversationHandlerSERVICE] NOT splitted message::::",r),e.addedNew(r))}),this.ref.on("child_changed",o=>{e.logger.debug("[FIREBASEConversationHandlerSERVICE] >>>>>>>>>>>>>> child_changed: ",o.val()),e.changed(o)}),this.ref.on("child_removed",o=>{e.removed(o)})}sendMessage(e,n,o,r,v,P,Y,X,ae){(!X||"undefined"===X)&&(X=te);const Ce=Oe.Z.database().ref(this.urlNodeFirebase),de=document.documentElement.lang,we=v,Se=new zn("",de,r,we,P,Y,0,o,e,Oe.Z.database.ServerValue.TIMESTAMP,n,ae,X,!0);return Ce.push({language:de,recipient:r,recipient_fullname:we,sender:P,sender_fullname:Y,status:0,metadata:o,text:e,timestamp:Oe.Z.database.ServerValue.TIMESTAMP,type:n,attributes:ae,channel_type:X}),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e messages: ",this.messages),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e senderFullname: ",Y),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e sender: ",P),this.logger.debug("[FIREBASEConversationHandlerSERVICE] sendMessage --\x3e SEND MESSAGE: ",e,X),Se}dispose(){}added(e){const n=this.messageGenerate(e);je(D,n)||(this.addRepalceMessageInArray(e.key,n),this.messageAdded.next(n))}addedNew(e){const n=this.messageCommandGenerate(e);if(this.isValidMessage(n)){let o=je(D,n);if(o&&this.messageInfo.next(n),o&&vt(n,this.showInfoMessage))return;if(o&&!vt(n,this.showInfoMessage)&&!pn(n,this.loggedUser))return;this.addRepalceMessageInArray(n.uid,n),this.messageAdded.next(n)}else this.logger.error("[FIREBASEConversationHandlerSERVICE] ADDED::message with uid: ",n.uid,"is not valid")}changed(e){const n=this.messageGenerate(e);if(this.isValidMessage(n)){if(je(D,n)||n.attributes&&n.attributes.commands)return;this.addRepalceMessageInArray(e.key,n),this.messageChanged.next(n)}else this.logger.error("[FIREBASEConversationHandlerSERVICE] CHANGED::message with uid: ",n.uid,"is not valid")}removed(e){const n=Le(this.messages,e.key);n>-1&&(this.messages.splice(n,1),this.messageRemoved.next(e.key))}messageGenerate(e){const n=e.val();return n.uid=e.key,n.text=n.text.trim(),(!n.sender_fullname||"undefined"===n.sender_fullname)&&(n.sender_fullname=n.sender),n.isSender=this.isSender(n.sender,this.loggedUser.uid),je(D,n)&&this.translateInfoSupportMessages(n),n}messageCommandGenerate(e){const n=e;return n.text&&(n.text=n.text.trim()),(!n.sender_fullname||"undefined"===n.sender_fullname)&&(n.sender_fullname=n.sender),n.isSender=this.isSender(n.sender,this.loggedUser.uid),je(D,n)&&this.translateInfoSupportMessages(n),n}addRepalceMessageInArray(e,n){const o=Le(this.messages,e);o>-1?this.messages.splice(o,1,n):this.messages.splice(0,0,n),this.messages.sort($e("timestamp","asc")),this.setStatusMessage(n,this.conversationWith)}translateInfoSupportMessages(e){const n=this.translationMap.get("INFO_SUPPORT_USER_ADDED_SUBJECT"),o=this.translationMap.get("INFO_SUPPORT_USER_ADDED_YOU_VERB"),r=this.translationMap.get("INFO_SUPPORT_USER_ADDED_COMPLEMENT"),v=this.translationMap.get("INFO_SUPPORT_USER_ADDED_VERB"),P=this.translationMap.get("INFO_SUPPORT_CHAT_REOPENED"),Y=this.translationMap.get("INFO_SUPPORT_CHAT_CLOSED"),X=this.translationMap.get("INFO_SUPPORT_LEAD_UPDATED"),ae=this.translationMap.get("INFO_SUPPORT_MEMBER_LEFT_GROUP"),fe=this.translationMap.get("INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU"),Ce=this.translationMap.get("INFO_SUPPORT_LIVE_PAGE");if(e.attributes.messagelabel&&e.attributes.messagelabel.parameters&&e.attributes.messagelabel.key===l){let de,we,ye;e.attributes.messagelabel.parameters.member_id===this.loggedUser.uid?(de=n,we=o,ye=r):e.attributes.messagelabel.parameters.fullname?(de=e.attributes.messagelabel.parameters.fullname,we=v,ye=r):(de=e.attributes.messagelabel.parameters.member_id,we=v,ye=r),e.text=de+" "+we+" "+ye}else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===ee)e.text=P;else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===s)e.text=Y;else if(e.attributes&&e.attributes.messagelabel&&e.attributes.messagelabel.key===U&&"system"===e.sender){const de=e.text.split(":")[1];void 0!==de&&(e.text=fe+": "+de)}else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===S)e.text=X;else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===d){let de="";de=e.attributes.messagelabel.parameters.fullname?e.attributes.messagelabel.parameters.fullname:e.attributes.messagelabel.parameters.member_id,e.text=de+" "+ae}else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===Z){let de="";e.attributes&&e.attributes.sourcePage&&(de=e.attributes.sourcePage),e.attributes&&e.attributes.sourceTitle&&(de="["+e.attributes.sourceTitle+"]("+de+")"),e.text=Ce+": "+de}}setStatusMessage(e,n){if(this.logger.debug("[FIREBASEConversationHandlerSERVICE] update statusss",e),e.status<g){let o=e.uid;if(e.attributes.commands&&(o=e.attributes.parentUid),e.sender!==this.loggedUser.uid&&e.status<g){const r=this.urlNodeFirebase+"/"+o;this.logger.debug("[FIREBASEConversationHandlerSERVICE] update message status",r),Oe.Z.database().ref(r).update({status:g})}}}isSender(e,n){return!!n&&e===n}unsubscribe(e){this.listSubsriptions.forEach(n=>{if(this.logger.debug("[FIREBASEConversationHandlerSERVICE] unsubscribe: ",n.uid,e),n.uid===e)return this.logger.debug("[FIREBASEConversationHandlerSERVICE] unsubscribe: ",n.uid,e),void n.unsubscribe(e,null)})}addCommandMessage(e){const n=this,o=e.attributes.commands;let r=0;!function v(P){if("message"===P.type){if(n.logger.debug('[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e type="message"',P,r),r>=2){if(o[r-1].time||(o[r-1].time=1e3),P.message.timestamp=o[r-2].message.timestamp+o[r-1].time,!ot(n.startTime.getTime(),e.timestamp)){let Y=e.timestamp;o[r-2]&&(Y=o[r-2].message.timestamp),P.message.timestamp=Y+100,o[r+1]&&(o[r+1].time=0)}}else P.message.timestamp=e.timestamp,ot(n.startTime.getTime(),e.timestamp)||o[r+1]&&(o[r+1].time=0);n.generateMessageObject(e,P.message,function(){r+=1,r<o.length?v(o[r]):n.logger.debug("[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (wait), exit")})}else"wait"===P.type&&(n.logger.debug('[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e type="wait"',P,r,o.length),ot(n.startTime.getTime(),e.timestamp)&&n.messageWait.next({uid:n.conversationWith,uidUserTypingNow:e.sender,nameUserTypingNow:e.sender_fullname,waitTime:P.time,command:P}),setTimeout(function(){r+=1,r<o.length?v(o[r]):n.logger.debug("[FIREBASEConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (send message), exit")},P.time))}(o[0])}generateMessageObject(e,n,o){let r=e.uid;n.uid=(0,pt.Z)(),n.text&&(n.text=n.text.trim()),n.language=e.language,n.recipient=e.recipient,n.recipient_fullname=e.recipient_fullname,n.sender=e.sender,n.sender_fullname=e.sender_fullname,n.channel_type=e.channel_type,n.status=e.status,n.isSender=e.isSender,n.attributes?n.attributes.commands=!0:n.attributes={commands:!0},n.attributes.parentUid=r,this.addedNew(n),o()}isValidMessage(e){return!0}isValidField(e){return null!=e}}return i.\u0275fac=function(e){return new(e||i)(t.LFG("skipMessage"))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Ya=(()=>{class i extends dt{constructor(){super()}build(){return new jn(!1)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();class Ja{constructor(a,e,n,o){this.uid=a,this.timestamp=e,this.message=n,this.name=o}}let Qa=(()=>{class i extends it{constructor(){super(),this.BSIsTyping=new me.X(null),this.BSSetTyping=new me.X(null),this.logger=ve.getInstance()}initialize(e){this.tenant=e,this.logger.debug("[FIREBASETypingSERVICE] initialize - tenant ",this.tenant),this.urlNodeTypings="/apps/"+this.tenant+"/typings/"}isTyping(e,n,o){let v=this.urlNodeTypings+e;o&&(v=this.urlNodeTypings+n+"/"+e),this.logger.debug("[FIREBASETypingSERVICE] urlTyping: ",v),this.ref=Oe.Z.database().ref(v),this.ref.on("child_changed",P=>{const Y=P.val();this.logger.debug("[FIREBASETypingSERVICE] child_changed: ",Y),this.BSIsTyping.next({uid:e,uidUserTypingNow:Y.uid,nameUserTypingNow:Y.name,waitTime:2e3})})}setTyping(e,n,o,r){clearTimeout(this.setTimeoutWritingMessages),this.setTimeoutWritingMessages=setTimeout(()=>{const P=this.urlNodeTypings+e+"/"+o;this.logger.debug("[FIREBASETypingSERVICE] setWritingMessages:",P,r);const X=new Ja(o,Oe.Z.database.ServerValue.TIMESTAMP,n,r);Oe.Z.database().ref(P).set(X,ae=>{ae?this.logger.error("[FIREBASETypingSERVICE] setTyping error",ae):this.BSSetTyping.next({uid:e,typing:X})})},500)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Ka=(()=>{class i extends wt{constructor(){super(),this.BSIsOnline=new me.X(null),this.BSLastOnline=new me.X(null),this.logger=ve.getInstance(),this.online_member=[]}initialize(e){this.tenant=e,this.logger.debug("[FIREBASEPresenceSERVICE] initialize this.tenant",this.tenant),this.urlNodePresence="/apps/"+this.tenant+"/presence/"}userIsOnline(e){const n=this;let o=new me.X(null);const r=this.urlNodePresence+e+"/connections";this.logger.debug("[FIREBASEPresenceSERVICE] userIsOnline: ",r);const v=Oe.Z.database().ref().child(r);return v.off(),v.on("value",P=>{n.logger.debug("[FIREBASEPresenceSERVICE] CONVERSATION-DETAIL group detail userIsOnline id user",e,"- child.val: ",P.val()),P.val()?(n.BSIsOnline.next({uid:e,isOnline:!0}),o.next({uid:e,isOnline:!0})):(n.BSIsOnline.next({uid:e,isOnline:!1}),o.next({uid:e,isOnline:!1}))}),o}lastOnlineForUser(e){this.logger.debug("[FIREBASEPresenceSERVICE] lastOnlineForUser",e),this.referenceLastOnlineForUser(e).on("value",r=>{r.val()?this.BSLastOnline.next({uid:e,lastOnline:r.val()}):this.BSLastOnline.next({uid:e,lastOnline:null})})}setPresence(e){this.onlineConnectionsRef=this.referenceOnlineForUser(e),this.lastOnlineConnectionsRef=this.referenceLastOnlineForUser(e),Oe.Z.database().ref("/.info/connected").on("value",r=>{if(this.logger.debug("[FIREBASEPresenceSERVICE] self.deviceConnectionRef: ",r.val()),r.val())if(this.onlineConnectionsRef){this.keyConnectionRef=this.onlineConnectionsRef.push(!0),this.keyConnectionRef.onDisconnect().remove();const P=(new Date).valueOf();this.lastOnlineConnectionsRef.onDisconnect().set(P)}else this.logger.error("[FIREBASEPresenceSERVICE] setPresence --\x3e This is an error. self.deviceConnectionRef already set. Cannot be set again.")})}removePresence(){if(this.onlineConnectionsRef){const n=(new Date).valueOf();this.lastOnlineConnectionsRef.set(n),this.onlineConnectionsRef.off(),this.onlineConnectionsRef.remove(),this.logger.debug("[FIREBASEPresenceSERVICE] goOffline onlineConnectionsRef",this.onlineConnectionsRef)}}referenceLastOnlineForUser(e){const n=this.urlNodePresence+e+"/lastOnline";return Oe.Z.database().ref().child(n)}referenceOnlineForUser(e){const n=this.urlNodePresence+e+"/connections";return Oe.Z.database().ref().child(n)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),$a=(()=>{class i extends et{constructor(e){super(),this.http=e,this.urlStorageBucket=Ae.firebaseConfig.storageBucket+"/o/profiles%2F"}getImagePhotoUrl(e){this.baseImageURL=this.getImageBaseUrl();let n="";n=e&&e.includes("bot_")?e.slice(4):e;const r="/o/profiles%2F"+n+"%2Fthumb_photo.jpg?alt=media";return this.baseImageURL+Oe.Z.storage().ref().bucket+r}checkImageExists(e,n){this.http.get(e,{responseType:"blob"}).subscribe(o=>{n(!0)},o=>{n(!1)})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Xa=(()=>{class i extends rt{constructor(){super(),this.BSStateUpload=new me.X(null),this.logger=ve.getInstance()}initialize(){this.logger.debug("[FIREBASEUploadSERVICE] initialize")}upload(e,n){const o=this,v="/public/images/"+e+"/"+this.createGuid()+"/"+n.file.name;this.logger.debug("[FIREBASEUploadSERVICE] pushUpload ",v,n.file);const P=Oe.Z.storage().ref();this.logger.debug("[FIREBASEUploadSERVICE] storageRef",P);const Y=P.child(v);this.logger.debug("[FIREBASEUploadSERVICE] mountainsRef ",Y);let ae=Y.put(n.file,{name:n.file.name,contentType:n.file.type,contentDisposition:"attachment; filename="+n.file.name});return new Promise((fe,Ce)=>{ae.on("state_changed",function(we){var ye=we.bytesTransferred/we.totalBytes*100;switch(o.logger.debug("[FIREBASEUploadSERVICE] Upload is "+ye+"% done"),o.BSStateUpload.next({upload:ye,type:n.file.type}),we.state){case Oe.Z.storage.TaskState.PAUSED:o.logger.debug("[FIREBASEUploadSERVICE] Upload is paused");break;case Oe.Z.storage.TaskState.RUNNING:o.logger.debug("[FIREBASEUploadSERVICE] Upload is running")}},function(de){Ce(de)},function(){o.logger.debug("[FIREBASEUploadSERVICE] Upload is complete",n),fe(ae.snapshot.ref.getDownloadURL())})})}createGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),el=_e(7994);const Jt="/clientadded",Mt="/clientupdated",Vn="/clientdeleted",Gn="onMessageUpdatedForConversation",qn="onMessageAddedForConversation";class qe{constructor(a){if(this.client=null,this.reconnections=0,this.client_id=this.uuidv4(),this.log=!!a.log,a&&a.MQTTendpoint)if(a.MQTTendpoint.startsWith("/")){var n;this.log&&console.log("MQTTendpoint relative url"),n="mqtt:",n+="//"+window.location.host,this.endpoint=n+=a.MQTTendpoint}else this.endpoint=a.MQTTendpoint;else this.endpoint="ws://34.253.207.0:15675/ws";this.APIendpoint=a.APIendpoint,this.appid=a.appId,this.log&&console.log("final endpoint:",this.endpoint),this.user_id=null,this.jwt=null,this.last_handler=0,this.onConversationAddedCallbacks=new Map,this.onConversationUpdatedCallbacks=new Map,this.onConversationDeletedCallbacks=new Map,this.onArchivedConversationAddedCallbacks=new Map,this.onArchivedConversationDeletedCallbacks=new Map,this.onMessageAddedCallbacks=new Map,this.onMessageUpdatedCallbacks=new Map,this.onGroupUpdatedCallbacks=new Map,this.callbackHandlers=new Map,this.on_message_handler=null,this.topic_inbox=null,this.connected=!1}subscribeToMyConversations(a){this.topic_inbox="apps/tilechat/users/"+this.user_id+"/#",this.log&&console.log("subscribing to:",this.user_id,"topic",this.topic_inbox),this.client.subscribe(this.topic_inbox,e=>{e&&console.error("An error occurred while subscribing user",this.user_id,"on topic:",this.topic_inbox,"Error:",e),this.log&&console.log("subscribed to:",this.topic_inbox," with err",e),a()})}sendMessage(a,e,n,o,r,v,P,Y,X){let ae=`apps/${this.appid}/outgoing/users/${this.user_id}/messages/${n}/outgoing`,fe={text:a,type:e,recipient_fullname:o,sender_fullname:r,attributes:v,metadata:P,channel_type:Y};const Ce=JSON.stringify(fe);this.client.publish(ae,Ce,null,de=>{X(de,fe)})}basicMessageBuilder(a,e,n,o,r,v,P){return{text:a,type:e,recipient_fullname:n,sender_fullname:o,attributes:r,metadata:v,channel_type:P}}sendMessageRaw(a,e,n){let o=`apps/${this.appid}/outgoing/users/${this.user_id}/messages/${e}/outgoing`;this.log&&console.log("dest_topic:",o);const r=JSON.stringify(a);this.client.publish(o,r,null,v=>{n(v,a)})}updateMessageStatus(a,e,n,o){this.log&&console.log("updating recipient_id:",a,"on conversWith",e,"status",n);let r=`apps/${this.appid}/users/${this.user_id}/messages/${e}/${a}/update`;this.log&&console.log("update dest_topic:",r);let v={status:n};const P=JSON.stringify(v);this.log&&console.log("payload:",P),this.client.publish(r,P,null,Y=>{o&&o(Y,v)})}updateConversationIsNew(a,e,n){this.log&&console.log("updating conversation with:",a,"is_new",e);let o=`apps/${this.appid}/users/${this.user_id}/conversations/${a}/update`;this.log&&console.log("update dest_topic:",o);const v=JSON.stringify({is_new:e});this.log&&console.log("payload:",v),this.client.publish(o,v,null,P=>{n&&n(P)})}groupCreate(a,e,n,o){this.log&&console.log("creating group:",a,"id",e,"members",n);const r=`${this.APIendpoint}/${this.appid}/groups`;this.log&&console.log("creating group...",r),qe.myrequest({url:r,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:{group_name:a,group_id:e,group_members:n},method:"POST"},(P,Y,X)=>{P?o(P,null):X&&o&&o(null,X)},this.log)}groupData(a,e){qe.myrequest({url:`${this.APIendpoint}/${this.appid}/groups/${a}`,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},method:"GET"},(r,v,P)=>{r?e(r,null):P&&e&&e(null,P)},this.log)}groupLeave(a,e,n){this.log&&console.log("leaving group:",a);const o=`${this.APIendpoint}/${this.appid}/groups/${a}/members/${e}`;this.log&&console.log("leaving group:",o),qe.myrequest({url:o,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},method:"DELETE"},(v,P,Y)=>{v?n(v,null):n&&n(null,Y)},this.log)}groupJoin(a,e,n){this.log&&console.log("leaving group:",a);const o=`${this.APIendpoint}/${this.appid}/groups/${a}/members`;this.log&&console.log("joining group:",o),qe.myrequest({url:o,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:{member_id:e},method:"POST"},(v,P,Y)=>{v?n(v,null):n&&n(null,Y)},this.log)}groupSetMembers(a,e,n){this.log&&console.log("setting group members of",a,"members",e);const o=`${this.APIendpoint}/${this.appid}/groups/${a}/members`;this.log&&console.log("setting group members...",o),qe.myrequest({url:o,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:{members:e},method:"PUT"},(v,P,Y)=>{v?n(v,null):Y&&n&&n(null,Y)},this.log)}saveInstance(a,e,n){this.log&&console.log("saving instance_id:",a,"data",e);const o=`${this.APIendpoint}/${this.appid}/${this.user_id}/instances/${a}`;this.log&&console.log("saving instance..."),qe.myrequest({url:o,headers:{Authorization:this.jwt,"Content-Type":"application/json;charset=UTF-8"},data:e,method:"POST"},(v,P,Y)=>{v?n(v,null):Y&&n&&n(null,Y)},this.log)}archiveConversation(a,e){this.log&&console.log("archiving conversation with:",a);let n="apps/tilechat/users/"+this.user_id+"/conversations/"+a+"/archive";this.log&&console.log("archive dest_topic:",n);const o=JSON.stringify({});this.client.publish(n,o,null,r=>{e&&e(r)})}onConversationAdded(a){return this.last_handler++,this.onConversationAddedCallbacks.set(this.last_handler,a),this.last_handler}onConversationUpdated(a){return this.last_handler++,this.onConversationUpdatedCallbacks.set(this.last_handler,a),this.last_handler}onConversationDeleted(a){return this.last_handler++,this.onConversationDeletedCallbacks.set(this.last_handler,a),this.last_handler}onArchivedConversationAdded(a){return this.last_handler++,this.onArchivedConversationAddedCallbacks.set(this.last_handler,a),this.last_handler}onArchivedConversationDeleted(a){return this.last_handler++,this.onArchivedConversationDeletedCallbacks.set(this.last_handler,a),this.last_handler}onMessageAdded(a){return this.last_handler++,this.onMessageAddedCallbacks.set(this.last_handler,a),this.last_handler}onMessageAddedInConversation(a,e){return this.last_handler++,this.callbackHandlers.set(this.last_handler,{type:qn,conversWith:a,callback:e}),this.last_handler}onMessageUpdatedInConversation(a,e){return this.last_handler++,this.callbackHandlers.set(this.last_handler,{type:Gn,conversWith:a,callback:e}),this.last_handler}onMessageUpdated(a){return this.last_handler+=1,this.onMessageUpdatedCallbacks.set(this.last_handler,a),this.last_handler}onGroupUpdated(a){return this.last_handler+=1,this.onGroupUpdatedCallbacks.set(this.last_handler,a),this.last_handler}removeOnMessageAddedHandler(a){this.onMessageAddedCallbacks.delete(a)}removeOnGroupUpdatedHandler(a){this.onGroupUpdatedCallbacks.delete(a)}start(a){if(this.on_message_handler)return this.log&&console.log("this.on_message_handler already subscribed. Reconnected num",this.reconnections),void callbsubscribedCallbackack();this.subscribeToMyConversations(()=>{this.on_message_handler=this.client.on("message",(e,n)=>{this.log&&console.log("topic:"+e+"\nmessage payload:"+n);const o=this.parseTopic(e);if(!o)return void(this.log&&console.log("Invalid message topic:",e));const r=o.conversWith;try{const v=JSON.parse(n.toString());if(this.onConversationUpdatedCallbacks&&e.includes("/conversations/")&&e.endsWith(Mt)&&(this.log&&console.log("conversation updated! /conversations/, topic:",e),this.onConversationUpdatedCallbacks.forEach((P,Y,X)=>{P(JSON.parse(n.toString()),o)})),this.onConversationDeletedCallbacks&&e.includes("/conversations/")&&e.endsWith(Vn)&&(this.log&&console.log("conversation deleted! /conversations/, topic:",e,n.toString()),this.onConversationDeletedCallbacks.forEach((P,Y,X)=>{P(JSON.parse(n.toString()),o)})),this.onArchivedConversationAddedCallbacks&&e.includes("/archived_conversations/")&&e.endsWith(Jt)&&this.onArchivedConversationAddedCallbacks.forEach((P,Y,X)=>{P(JSON.parse(n.toString()),o)}),this.onArchivedConversationDeletedCallbacks&&e.includes("/archived_conversations/")&&e.endsWith(Vn)&&this.onArchivedConversationDeletedCallbacks.forEach((P,Y,X)=>{P(JSON.parse(n.toString()),o)}),e.includes("/messages/")&&e.endsWith(Jt)){this.onMessageAddedCallbacks&&this.onMessageAddedCallbacks.forEach((Y,X,ae)=>{Y(JSON.parse(n.toString()),o)});let P=!0;v.attributes&&0==v.attributes.updateconversation&&(P=!1),P&&this.onConversationAddedCallbacks&&this.onConversationAddedCallbacks.forEach((Y,X,ae)=>{v.is_new=!0;const fe=JSON.stringify(v);Y(JSON.parse(fe),o)})}this.onMessageUpdatedCallbacks&&e.includes("/messages/")&&e.endsWith(Mt)&&this.onMessageUpdatedCallbacks.forEach((P,Y,X)=>{P(JSON.parse(n.toString()),o)}),this.onGroupUpdatedCallbacks&&e.includes("/groups/")&&e.endsWith(Mt)&&this.onGroupUpdatedCallbacks.forEach((P,Y,X)=>{P(JSON.parse(n.toString()),o)}),this.callbackHandlers.forEach((P,Y,X)=>{const ae=P,fe=ae.type;e.includes("/messages/")&&e.endsWith(Jt)&&(this.log&&console.log("/messages/_CLIENTADDED"),fe===qn&&r===ae.conversWith&&(this.log&&console.log("/messages/_CLIENTADDED on: ",r),ae.callback(JSON.parse(n.toString()),o))),e.includes("/messages/")&&e.endsWith(Mt)&&(this.log&&console.log("/messages/_CLIENTUPDATED"),fe===Gn&&r===ae.conversWith&&(this.log&&console.log("/messages/_CLIENTUPDATED on: ",r),ae.callback(JSON.parse(n.toString()),o)))})}catch(v){console.error("ERROR:",v)}}),a()})}parseTopic(a){var e=a.split("/");return e.length>=7?{conversWith:e[5]}:null}lastArchivedConversations(a){const e=`${this.APIendpoint}/${this.appid}/${this.user_id}/archived_conversations`;this.log&&console.log("getting last archived conversations...",e);var n=new XMLHttpRequest;n.open("GET",e,!0),n.setRequestHeader("authorization",this.jwt),n.onreadystatechange=function(){if(a&&4==n.readyState&&200==n.status&&n.responseText)try{const o=JSON.parse(n.responseText);a(null,o.result)}catch(o){console.error("parsing json ERROR",o),a(o,null)}},n.send(null)}lastConversations(a,e){const o=`${this.APIendpoint}/${this.appid}/${this.user_id}/conversations`+(a?"/archived":"");this.log&&console.log("getting last convs...",o);var r=new XMLHttpRequest;r.open("GET",o,!0),r.setRequestHeader("authorization",this.jwt),r.onreadystatechange=function(){if(e&&4==r.readyState&&200==r.status&&r.responseText)try{const v=JSON.parse(r.responseText);e(null,v.result)}catch(v){console.error("parsing json ERROR",v),e(v,null)}},r.send(null)}conversationDetail(a,e){this.log&&console.log("conversationDetail(). searching on user:",this.user_id," - conversWith:",a),this.crossConversationDetail(a,!1,e)}archivedConversationDetail(a,e){this.log&&console.log("archivedConversationDetail(). searching on user:",this.user_id," - conversWith:",a),this.crossConversationDetail(a,!0,e)}crossConversationDetail(a,e,n){this.log&&console.log("searching on user:",this.user_id," - conv of conversWith:",a," - archived:",e);let o="conversations";e&&(o="archived_conversations");const r=`${this.APIendpoint}/${this.appid}/${this.user_id}/${o}/${a}`;this.log&&(console.log("getting conversation detail:",r),console.log("conversWith:",a)),qe.myrequest({url:r,headers:{Authorization:this.jwt},method:"GET"},(P,Y,X)=>{this.log&&console.log("JSON...",X),X&&X.result&&Array.isArray(X.result)&&1==X.result.length?n(null,X.result[0]):n(null,null)},this.log)}lastMessages(a,e){const n=this.APIendpoint+"/"+this.appid+"/"+this.user_id+"/conversations/"+a+"/messages";var o=new XMLHttpRequest;o.open("GET",n,!0),o.setRequestHeader("authorization",this.jwt),o.onreadystatechange=function(){if(e&&4==o.readyState&&200==o.status&&o.responseText)try{const r=JSON.parse(o.responseText);e(null,r.result)}catch(r){console.error("parsing json messages ERROR",r),e(r,null)}},o.send(null)}static myrequest(a,e,n){n&&console.log("HTTP Request:",a);{let o=new XMLHttpRequest;o.open(a.method,a.url,!0),Object.keys(a.headers).forEach(r=>{o.setRequestHeader(r,a.headers[r])}),o.onreadystatechange=function(){if(e&&4==o.readyState&&200==o.status&&o.responseText)try{const r=JSON.parse(o.responseText);e(null,null,r)}catch(r){console.error("parsing json ERROR",r),e(r,null)}},o.send("POST"===a.method?JSON.stringify(a.data):null)}}connect(a,e,n){this.user_id=a,this.jwt=e,this.log&&(console.log("connecting user_id:",a),console.log("using jwt token:",e)),this.client&&this.client.end();const o="apps/tilechat/users/"+this.user_id+"/presence/"+this.client_id;let r={keepalive:10,reconnectPeriod:1e3,will:{topic:o,payload:'{"disconnected":true}',qos:1,retain:!0},clientId:this.client_id,username:"JWT",password:e,rejectUnauthorized:!1};this.log&&console.log("starting mqtt connection with LWT on:",o,this.endpoint),this.client=el.connect(this.endpoint,r),this.client.on("connect",()=>{this.log&&console.log("Chat client connected. User:"+a),this.connected||(this.log&&console.log("Chat client first connection for:"+a),this.connected=!0,this.start(()=>{n()}))}),this.client.on("reconnect",()=>{this.log&&console.log("Chat client reconnect event")}),this.client.on("close",()=>{this.log&&console.log("Chat client close event")}),this.client.on("offline",()=>{this.log&&console.log("Chat client offline event")}),this.client.on("error",v=>{console.error("Chat client error event",v)})}close(a){this.topic_inbox&&this.client.unsubscribe(this.topic_inbox,e=>{this.log&&console.log("unsubscribed from",this.topic_inbox),this.client.end(()=>{this.connected=!1,this.onConversationAddedCallbacks=new Map,this.onConversationUpdatedCallbacks=new Map,this.onConversationDeletedCallbacks=new Map,this.onArchivedConversationAddedCallbacks=new Map,this.onArchivedConversationDeletedCallbacks=new Map,this.onMessageAddedCallbacks=new Map,this.onMessageUpdatedCallbacks=new Map,this.onGroupUpdatedCallbacks=new Map,this.callbackHandlers=new Map,this.on_message_handler=null,this.topic_inbox=null,a&&a()})})}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var e=16*Math.random()|0;return("x"==a?e:3&e|8).toString(16)})}}let Ze=(()=>{class i{constructor(){}set config(e){this._config=e}get config(){return this._config}initChat(){if(!this._config||"CHANGEIT"===this._config.appId)throw new Error("chat21Config is not defined. Please setup your environment");this.chatClient?console.log("Did you try again to create a Chat21Client istance?"):this.chatClient=new qe(this._config)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),nl=(()=>{class i extends Ct{constructor(e,n,o){super(),this.http=e,this.chat21Service=n,this.appStorage=o,this.BSAuthStateChanged=new me.X(null),this.BSSignOut=new me.X(null),this.logger=ve.getInstance()}initialize(){this.SERVER_BASE_URL=this.getBaseUrl(),this.URL_TILEDESK_CREATE_CUSTOM_TOKEN=this.SERVER_BASE_URL+"chat21/native/auth/createCustomToken",this.logger.log("[MQTTAuthService] initialize "),this.onAuthStateChanged()}logout(){return this.logger.log("[MQTTAuthService] logout: closing mqtt connection..."),new Promise((e,n)=>{this.chat21Service.chatClient.close(()=>{this.currentUser=null,this.logger.debug("[MQTTAuthService] logout: mqtt connection closed. user removed. OK"),this.BSSignOut.next(!0),this.BSAuthStateChanged.next("offline"),e(!0)})})}getUser(){return this.currentUser}getToken(){return this.logger.debug("[MQTTAuthService]::getToken"),this.token}onAuthStateChanged(){this.logger.debug("UserService::onAuthStateChanged"),this.BSAuthStateChanged.next("offline"),this.logger.debug("STORAGE CHANGED: added listner")}createCustomToken(e){this.connectWithCustomToken(e)}connectWithCustomToken(e){const n=new Ee.WM({"Content-type":"application/json",Authorization:e});this.http.post(this.URL_TILEDESK_CREATE_CUSTOM_TOKEN,{},{headers:n,responseType:"text"}).subscribe(v=>{this.logger.debug("[MQTTAuthService] connectWithCustomToken: **** data",v);const P=JSON.parse(v);this.connectMQTT(P)},v=>{this.logger.error(v)})}connectMQTT(e){this.logger.debug("[MQTTAuthService] connectMQTT: **** credentials:",e),this.chat21Service.chatClient.connect(e.userid,e.token,()=>{this.logger.debug("[MQTTAuthService] connectMQTT: Chat connected."),this.BSAuthStateChanged.next("online")})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ze),t.LFG(Ne))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),ol=(()=>{class i extends at{constructor(e){super(),this.chat21Service=e,this.BSConversationDetail=new me.X(null),this.conversationAdded=new me.X(null),this.conversationChanged=new me.X(null),this.conversationChangedDetailed=new me.X(null),this.conversationRemoved=new me.X(null),this.conversations=[],this.logger=ve.getInstance()}initialize(e,n,o){this.logger.debug("[MQTTConversationsHandler] initialize"),this.tenant=e,this.loggedUserId=n,this.translationMap=o,this.conversations=[],this.isConversationClosingMap=new Map}getConversationDetail(e,n){const o=this.conversations.find(r=>r.conversation_with===e);this.logger.log("[MQTTConversationsHandler] getConversationDetail found locally? *****: ",o),o?n(o):(this.logger.log("[MQTTConversationsHandler] getConversationDetail Not found locally, remote.getConversationDetail *****: ",o),this.chat21Service.chatClient.conversationDetail(e,(r,v)=>{this.logger.log("[MQTTConversationsHandler] getConversationDetail --REMOTE CONV IS OBJ:",v),v?n&&n(this.completeConversation(v)):n&&n(null)}))}setConversationRead(e){this.logger.debug("[MQTTConversationsHandler] setConversationRead..."),this.chat21Service.chatClient.updateConversationIsNew(e,!1,n=>{n?this.logger.error("[MQTTConversationsHandler]setConversationRead: false. An error occurred",n):this.logger.debug("[MQTTConversationsHandler]setConversationRead: false. Ok")})}subscribeToConversations(e){this.logger.debug("[MQTTConversationsHandler] connecting MQTT conversations handler"),this.chat21Service.chatClient.onConversationAdded(n=>{let o=this.completeConversation(n);this.logger.log("onConversationAdded completed:",o),this.searchIndexInArrayForConversationWith(this.conversations,o.conversation_with)>-1?(this.logger.log("[MQTTConversationsHandler] Added conv -> Changed!"),this.changed(o)):(this.logger.log("[MQTTConversationsHandler] Added conv -> Added!"),this.added(o))}),this.chat21Service.chatClient.onConversationUpdated((n,o)=>{this.logger.debug("[MQTTConversationsHandler] conversation updated:",JSON.stringify(n)),this.changed(n)}),this.chat21Service.chatClient.onConversationDeleted((n,o)=>{this.logger.debug("[MQTTConversationsHandler] conversation deleted:",n,o),this.removed({uid:o.conversWith})}),this.chat21Service.chatClient.lastConversations(!1,(n,o)=>{this.logger.debug("[MQTTConversationsHandler] Last conversations",o,"err",n),n||(o.forEach(r=>{this.added(r)}),e())})}getLastConversation(e){this.chat21Service.chatClient.lastConversations(!1,(n,o)=>{if(this.logger.debug("[MQTTConversationsHandler] getLastConversation ",o,"err",n),n)e(null,n);else if(o&&o.length>0){let r=this.completeConversation(o[0]);e(r,null)}else e(null,null)})}added(e){this.logger.debug("[MQTTConversationsHandler] NEW CONV childSnapshot",e);let n=this.completeConversation(e);if(this.isValidConversation(n)){this.setClosingConversation(n.conversation_with,!1),this.logger.debug("[MQTTConversationsHandler] conversations:",n.uid,this.conversations);const o=this.searchIndexInArrayForConversationWith(this.conversations,n.conversation_with);o>-1?(this.logger.debug("[MQTTConversationsHandler] TROVATO"),this.conversations.splice(o,1,n)):(this.logger.debug("[MQTTConversationsHandler] NON TROVATO"),this.conversations.splice(0,0,n)),this.logger.debug("[MQTTConversationsHandler] NUOVA CONVER;.uid3"+n.uid),this.conversations.sort($e("timestamp","desc")),this.logger.debug("[MQTTConversationsHandler] TUTTE:",this.conversations),this.conversationAdded.next(n)}else this.logger.error("[MQTTConversationsHandler] ChatConversationsHandler::added::conversations with conversationId: ",n.conversation_with,"is not valid")}searchIndexInArrayForConversationWith(e,n){return e.findIndex(o=>o.conversation_with===n)}changed(e){this.logger.debug("[MQTTConversationsHandler] Conversation changed:",e),e.conversation_with||(e.conversation_with=e.conversWith);const n=Le(this.conversations,e.conversation_with),o=this.conversations[n];n>-1&&(this.updateConversationWithSnapshot(this.conversations[n],e),this.logger.debug("[MQTTConversationsHandler] conversationchanged.isnew",JSON.stringify(e)),this.conversationChanged.next(this.conversations[n]),this.conversationChangedDetailed.next({value:this.conversations[n],previousValue:o}),this.conversations.splice(n,1,this.conversations[n]),this.conversations.sort($e("timestamp","desc")))}updateConversationWithSnapshot(e,n){this.logger.debug("[MQTTConversationsHandler] updating conv",e,"with snap",n),Object.keys(n).forEach(o=>{"is_new"===o&&(e.is_new=n[o]),"text"===o&&(e.last_message_text=n[o],e.text=n[o]),"recipient"===o&&(e.recipient=n[o]),"recipient_fullname"===o&&(e.recipient_fullname=n[o]),"sender"===o&&(e.sender=n[o]),"sender_fullname"===o&&(e.sender_fullname=n[o]),"attributes"===o&&(e.attributes=n[o]),"timestamp"===o&&(e.timestamp=n[o]),"status"===o&&(e.status=this.setStatusConversation(e.sender,e.uid)),"type"===o&&(e.type=n[o])})}removed(e){const n=Le(this.conversations,e.uid);if(n>-1){const o=this.conversations[n];this.conversations.splice(n,1),this.logger.debug("[MQTTConversationsHandler] conversationRemoved::",o),this.conversationRemoved.next(o)}this.deleteClosingConversation(e.uid)}dispose(){this.conversations.length=0,this.conversations=[],this.uidConvSelected=""}getClosingConversation(e){return this.isConversationClosingMap[e]}setClosingConversation(e,n){this.isConversationClosingMap[e]=n}deleteClosingConversation(e){this.isConversationClosingMap.delete(e)}archiveConversation(e){this.chat21Service.chatClient.archiveConversation(e)}completeConversation(e){(!e.sender_fullname||"undefined"===e.sender_fullname||""===e.sender_fullname.trim())&&(e.sender_fullname=e.sender),(!e.recipient_fullname||"undefined"===e.recipient_fullname||""===e.recipient_fullname.trim())&&(e.recipient_fullname=e.recipient);let n=e.sender_fullname,o=e.sender;return(e.sender===this.loggedUserId||this.isGroup(e))&&(o=e.recipient,n=e.recipient_fullname,e.last_message_text=e.last_message_text),e.conversation_with_fullname=n,e.conversation_with=o,e.status=this.setStatusConversation(e.sender,e.uid),e.avatar=ht(n),e.color=ct(n),e.last_message_text||(e.last_message_text=e.text),e.uid=e.conversation_with,e.uid===this.uidConvSelected&&(e.is_new=!1),e.sender===this.loggedUserId&&(e.is_new=!1),e}isGroup(e){return!(!e.recipient||!e.recipient.startsWith("group-")&&!e.recipient.startsWith("support-group"))}setStatusConversation(e,n){let o="0";return o=e===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(e){return st(parseInt(e)/1e3)}countIsNew(){let e=0;return this.conversations.forEach(n=>{!0===n.is_new&&e++}),e}isValidConversation(e){return this.logger.debug("[MQTTConversationsHandler] checking uid of",e),this.logger.debug("[MQTTConversationsHandler] conversation.uid",e.uid),this.logger.debug("[MQTTConversationsHandler] channel_type is:",e.channel_type),this.isValidField(e.uid)?this.isValidField(e.last_message_text)?this.isValidField(e.recipient)?this.isValidField(e.recipient_fullname)?this.isValidField(e.sender)?this.isValidField(e.sender_fullname)?this.isValidField(e.status)?this.isValidField(e.timestamp)?!!this.isValidField(e.channel_type)||(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "channel_type is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "timestamp is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "status is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender_fullname is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient_fullname is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "last_message_text is not valid" '),!1):(this.logger.error('[MQTTConversationsHandler] ChatConversationsHandler::isValidConversation:: "uid is not valid" '),!1)}isValidField(e){return null!=e}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ze))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),il=(()=>{class i extends lt{constructor(e){super(),this.chat21Service=e,this.BSConversationDetail=new me.X(null),this.archivedConversationAdded=new me.X(null),this.archivedConversationChanged=new me.X(null),this.archivedConversationRemoved=new me.X(null),this.archivedConversations=[],this.logger=ve.getInstance()}initialize(e,n,o){this.logger.debug("[MQTTArchivedConversationsHandler] initialize"),this.tenant=e,this.loggedUserId=n,this.translationMap=o,this.archivedConversations=[],this.isConversationClosingMap=new Map}getConversationDetail(e,n){const o=this.archivedConversations.find(r=>r.conversation_with===e);this.logger.log("[MQTTArchivedConversationsHandler] getConversationDetail found locally? *****: ",o),o?n(o):(this.logger.log("[MQTTArchivedConversationsHandler] getConversationDetail Not found locally, remote.getConversationDetail *****: ",o),this.chat21Service.chatClient.archivedConversationDetail(e,(r,v)=>{this.logger.log("[MQTTArchivedConversationsHandler] getConversationDetail --REMOTE CONV IS OBJ:",v),v?n&&n(this.completeConversation(v)):n&&n(null)}))}setConversationRead(e){}subscribeToConversations(e){this.logger.debug("[MQTTArchivedConversationsHandler] connecting MQTT conversations handler"),this.chat21Service.chatClient.onArchivedConversationAdded(n=>{this.logger.log("[MQTTArchivedConversationsHandler] Added conv ->",n.text),this.added(n)}),this.chat21Service.chatClient.onArchivedConversationDeleted(n=>{this.logger.debug("[MQTTArchivedConversationsHandler] conversation deleted:",n),this.removed(n)}),this.chat21Service.chatClient.lastConversations(!0,(n,o)=>{this.logger.debug("[MQTTArchivedConversationsHandler] Last conversations",o,"err",n),n||(o.forEach(r=>{this.added(r)}),e())})}added(e){this.logger.debug("[MQTTArchivedConversationsHandler] NEW CONV childSnapshot",e);let n=this.completeConversation(e);if(n.uid=n.conversation_with,this.isValidConversation(n)){this.setClosingConversation(n.conversation_with,!1),this.logger.debug("[MQTTArchivedConversationsHandler] conversations:",n.uid,this.archivedConversations);const o=this.searchIndexInArrayForConversationWith(this.archivedConversations,n.conversation_with);o>-1?(this.logger.debug("[MQTTArchivedConversationsHandler] TROVATO"),this.archivedConversations.splice(o,1,n)):(this.logger.debug("[MQTTArchivedConversationsHandler] NON TROVATO"),this.archivedConversations.splice(0,0,n)),this.logger.debug("[MQTTArchivedConversationsHandler] NUOVA CONVER;.uid3"+n.uid),this.archivedConversations.sort($e("timestamp","desc")),this.logger.debug("[MQTTArchivedConversationsHandler] TUTTE:",this.archivedConversations),this.archivedConversationChanged.next(n),this.archivedConversationAdded.next(n)}else this.logger.error("[MQTTArchivedConversationsHandler] ChatConversationsHandler::added::conversations with conversationId: ",n.conversation_with,"is not valid")}searchIndexInArrayForConversationWith(e,n){return e.findIndex(o=>o.conversation_with===n)}removed(e){const n=Le(this.archivedConversations,e.key);if(n>-1){const o=this.archivedConversations[n];this.archivedConversations.splice(n,1),this.archivedConversationRemoved.next(o)}this.deleteClosingConversation(e.key)}dispose(){this.archivedConversations=[],this.archivedConversations.length=0,this.uidConvSelected=""}getClosingConversation(e){return this.isConversationClosingMap[e]}setClosingConversation(e,n){this.isConversationClosingMap[e]=n}deleteClosingConversation(e){this.isConversationClosingMap.delete(e)}archiveConversation(e){}completeConversation(e){(!e.sender_fullname||"undefined"===e.sender_fullname||""===e.sender_fullname.trim())&&(e.sender_fullname=e.sender),(!e.recipient_fullname||"undefined"===e.recipient_fullname||""===e.recipient_fullname.trim())&&(e.recipient_fullname=e.recipient);let n=e.sender_fullname,o=e.sender;return(e.sender===this.loggedUserId||"group"===e.channel_type)&&(o=e.recipient,n=e.recipient_fullname,e.last_message_text=e.last_message_text),e.conversation_with_fullname=n,e.conversation_with=o,e.status=this.setStatusConversation(e.sender,e.uid),e.avatar=ht(n),e.color=ct(n),e.last_message_text||(e.last_message_text=e.text),e}setStatusConversation(e,n){let o="0";return o=e===this.loggedUserId||n===this.uidConvSelected?"0":"1",o}getTimeLastMessage(e){return st(parseInt(e)/1e3)}countIsNew(){let e=0;return this.archivedConversations.forEach(n=>{!0===n.is_new&&e++}),e}isValidConversation(e){return this.logger.debug("[MQTTArchivedConversationsHandler] checking uid of",e),this.logger.debug("[MQTTArchivedConversationsHandler] conversation.uid",e.uid),this.logger.debug("[MQTTArchivedConversationsHandler] channel_type is:",e.channel_type),this.isValidField(e.uid)?this.isValidField(e.last_message_text)?this.isValidField(e.recipient)?this.isValidField(e.recipient_fullname)?this.isValidField(e.sender)?this.isValidField(e.sender_fullname)?this.isValidField(e.status)?this.isValidField(e.timestamp)?!!this.isValidField(e.channel_type)||(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "channel_type is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "timestamp is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "status is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender_fullname is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "sender is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient_fullname is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "recipient is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "last_message_text is not valid" '),!1):(this.logger.error('[MQTTArchivedConversationsHandler] ChatConversationsHandler::isValidConversation:: "uid is not valid" '),!1)}isValidField(e){return null!=e}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ze))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),Wn=(()=>{class i extends Yt{constructor(e,n){super(),this.chat21Service=e,this.skipInfoMessage=n,this.messageAdded=new me.X(null),this.messageChanged=new me.X(null),this.messageRemoved=new me.X(null),this.messageWait=new me.X(null),this.messageInfo=new me.X(null),this.startTime=new Date,this.logger=ve.getInstance()}initialize(e,n,o,r,v,P){this.logger.log("[MQTTConversationHandlerSERVICE] initWithRecipient:",r),this.recipientId=e,this.recipientFullname=n,this.loggedUser=o,o&&(this.senderId=o.uid),this.tenant=r,this.translationMap=v,this.listSubsriptions=[],this.CLIENT_BROWSER=navigator.userAgent,this.conversationWith=e,this.messages=[],this.showInfoMessage=P}connect(){this.logger.log("[MQTTConversationHandlerSERVICE] connecting conversation handler..."),null!=this.conversationWith?(this.chat21Service.chatClient.lastMessages(this.conversationWith,(o,r)=>{o||(this.logger.log("[MQTTConversationHandlerSERVICE] message lastMessages:",r),r.forEach(v=>{const P=v;P.uid=v.message_id,!(this.messages.filter(Y=>Y.attributes.parentUid===P.uid).length>0)&&(P.attributes&&P.attributes.commands?(this.logger.debug("[MQTTConversationHandlerSERVICE] splitted message::::",this.messages),this.addCommandMessage(P)):this.addedMessage(P))}))}),this.chat21Service.chatClient.onMessageAddedInConversation(this.conversationWith,(o,r)=>{this.logger.log("[MQTTConversationHandlerSERVICE] message added:",o,"on topic:",r,this.messages);const v=o;v.uid=o.message_id,!(this.messages.filter(P=>P.attributes.parentUid===v.uid).length>0)&&(v.attributes&&v.attributes.commands?(this.logger.debug("[MQTTConversationHandlerSERVICE] splitted message::::",v),this.addCommandMessage(v)):(this.logger.debug("[MQTTConversationHandlerSERVICE] NOT splitted message::::",v),this.addedMessage(v)))}),this.chat21Service.chatClient.onMessageUpdatedInConversation(this.conversationWith,(o,r)=>{this.logger.log("[MQTTConversationHandlerSERVICE] message updated:",o,"on topic:",r),this.changed(o)})):this.logger.error("[MQTTConversationHandlerSERVICE] cant connect invalid this.conversationWith",this.conversationWith)}sendMessage(e,n,o,r,v,P,Y,X,ae){(!X||"undefined"===X)&&(X=te),this.logger.log("[MQTTConversationHandlerSERVICE] Senderfullname",Y);const Ce=document.documentElement.lang,de=v,we=r;return ae.lang=Ce,this.chat21Service.chatClient.sendMessage(e,n,we,de,Y,ae,o,X,(ye,Se)=>{ye?(Se.status="-100",this.logger.log("[MQTTConversationHandlerSERVICE] ERROR",ye)):Se.status="150"}),new zn("",Ce,r,de,P,Y,0,o,e,Date.now(),n,this.attributes,X,!1)}dispose(){}addedMessage(e){const n=this.messageGenerate(e);let o=je(D,n);o&&this.messageInfo.next(n),(!o||!vt(n,this.showInfoMessage))&&(o&&!vt(n,this.showInfoMessage)&&!pn(n,this.loggedUser)||(this.logger.log("[MQTTConversationHandlerSERVICE] adding message:"+JSON.stringify(n)),this.addReplaceMessageInArray(n.uid,n),this.updateMessageStatusReceived(n),this.messageAdded.next(n)))}changed(e){if(je(D,e))return;this.logger.log("[MQTTConversationHandlerSERVICE] updating message with patch",e);const n=Le(this.messages,e.message_id);if(n>-1){const o=this.messages[n];o&&(o.status=e.status,this.logger.log("[MQTTConversationHandlerSERVICE] message found and patched (replacing)",o),this.addReplaceMessageInArray(o.uid,o),this.messageChanged.next(o))}}removed(e){const n=Le(this.messages,e.key);n>-1&&(this.messages.splice(n,1),this.messageRemoved.next(e.key))}messageGenerate(e){this.logger.log("[MQTTConversationHandlerSERVICE] childSnapshot >"+JSON.stringify(e));const n=e;return n.text=n.text.trim(),(!n.sender_fullname||"undefined"===n.sender_fullname)&&(n.sender_fullname=n.sender),this.logger.log("[MQTTConversationHandlerSERVICE] ****>msg.sender:"+n.sender),n.isSender=this.isSender(n.sender,this.loggedUser.uid),je(D,n)&&this.translateInfoSupportMessages(n),n}addReplaceMessageInArray(e,n){const o=Le(this.messages,e);o>-1?this.messages.splice(o,1,n):this.messages.splice(0,0,n),this.messages.sort($e("timestamp","asc"))}translateInfoSupportMessages(e){const n=this.translationMap.get("INFO_SUPPORT_USER_ADDED_SUBJECT"),o=this.translationMap.get("INFO_SUPPORT_USER_ADDED_YOU_VERB"),r=this.translationMap.get("INFO_SUPPORT_USER_ADDED_COMPLEMENT"),v=this.translationMap.get("INFO_SUPPORT_USER_ADDED_VERB"),P=this.translationMap.get("INFO_SUPPORT_CHAT_REOPENED"),Y=this.translationMap.get("INFO_SUPPORT_CHAT_CLOSED"),X=this.translationMap.get("INFO_SUPPORT_LEAD_UPDATED"),ae=this.translationMap.get("INFO_SUPPORT_MEMBER_LEFT_GROUP"),fe=this.translationMap.get("INFO_A_NEW_SUPPORT_REQUEST_HAS_BEEN_ASSIGNED_TO_YOU"),Ce=this.translationMap.get("INFO_SUPPORT_LIVE_PAGE");if(e.attributes.messagelabel&&e.attributes.messagelabel.parameters&&e.attributes.messagelabel.key===l){let de,we,ye;e.attributes.messagelabel.parameters.member_id===this.loggedUser.uid?(de=n,we=o,ye=r):e.attributes.messagelabel.parameters.fullname?(de=e.attributes.messagelabel.parameters.fullname,we=v,ye=r):(de=e.attributes.messagelabel.parameters.member_id,we=v,ye=r),e.text=de+" "+we+" "+ye}else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===ee)e.text=P;else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===s)e.text=Y;else if(e.attributes&&e.attributes.messagelabel&&e.attributes.messagelabel.key===U&&"system"===e.sender){const de=e.text.split(":")[1];void 0!==de&&(e.text=fe+": "+de)}else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===S)e.text=X;else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===d){let de;de=e.attributes.messagelabel.parameters.fullname?e.attributes.messagelabel.parameters.fullname:e.attributes.messagelabel.parameters.member_id,e.text=de+" "+ae}else if(e.attributes.messagelabel&&e.attributes.messagelabel.key===Z){let de="";e.attributes&&e.attributes.sourcePage&&(de=e.attributes.sourcePage),e.attributes&&e.attributes.sourceTitle&&(de="["+e.attributes.sourceTitle+"]("+de+")"),e.text=Ce+": "+de}}updateMessageStatusReceived(e){if(this.logger.log("[MQTTConversationHandlerSERVICE] updateMessageStatusReceived",e),e.status<g){this.logger.log("[MQTTConversationHandlerSERVICE] status ",e.status," < (RECEIVED:200)",g);let n=e.uid;e.attributes.commands&&(n=e.attributes.parentUid),e.sender!==this.loggedUser.uid&&e.status<g&&(this.logger.log("[MQTTConversationHandlerSERVICE] updating message with status received"),this.chat21Service.chatClient.updateMessageStatus(n,this.conversationWith,g,null))}}isSender(e,n){return!!n&&e===n}unsubscribe(e){this.logger.log("[MQTTConversationHandlerSERVICE] unsubscribe: ",e),this.listSubsriptions.forEach(n=>{this.logger.log("[MQTTConversationHandlerSERVICE] unsubscribe: ",n.uid,e),n.uid!==e||n.unsubscribe(e,null)})}addCommandMessage(e){const n=this,o=e.attributes.commands;let r=0;!function v(P){if("message"===P.type){if(n.logger.debug('[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e type="message"',P,r),r>=2){if(o[r-1].time||(o[r-1].time=1e3),P.message.timestamp=o[r-2].message.timestamp+o[r-1].time,!ot(n.startTime.getTime(),e.timestamp)){let Y=e.timestamp;o[r-2]&&(Y=o[r-2].message.timestamp),P.message.timestamp=Y+100,o[r+1]&&(o[r+1].time=0)}}else P.message.timestamp=e.timestamp,ot(n.startTime.getTime(),e.timestamp)||o[r+1]&&(o[r+1].time=0);n.generateMessageObject(e,P.message,function(){r+=1,r<o.length?v(o[r]):n.logger.debug("[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (wait), exit")})}else"wait"===P.type&&(n.logger.debug('[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e type="wait"',P,r,o.length),ot(n.startTime.getTime(),e.timestamp)&&n.messageWait.next({uid:n.conversationWith,uidUserTypingNow:e.sender,nameUserTypingNow:e.sender_fullname,waitTime:P.time,command:P}),setTimeout(function(){r+=1,r<o.length?v(o[r]):n.logger.debug("[MQTTConversationHandlerSERVICE] addCommandMessage --\x3e last command executed (send message), exit")},P.time))}(o[0])}generateMessageObject(e,n,o){let r=e.uid;n.uid=(0,pt.Z)(),n.text&&(n.text=n.text.trim()),n.language=e.language,n.recipient=e.recipient,n.recipient_fullname=e.recipient_fullname,n.sender=e.sender,n.sender_fullname=e.sender_fullname,n.channel_type=e.channel_type,n.status=e.status,n.isSender=e.isSender,n.attributes?n.attributes.commands=!0:n.attributes={commands:!0},n.attributes.parentUid=r,this.addedMessage(n),o()}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ze),t.LFG("skipMessage"))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),rl=(()=>{class i extends dt{constructor(e){super(),this.chat21Service=e}build(){return new Wn(this.chat21Service,!0)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ze))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),sl=(()=>{class i extends it{constructor(){super(),this.BSIsTyping=new me.X(null),this.BSSetTyping=new me.X(null),this.logger=ve.getInstance()}initialize(e){this.tenant=e,this.logger.debug("[MQTT-TYPING] initialize this.tenant",this.tenant),this.urlNodeTypings="/apps/"+this.tenant+"/typings/"}isTyping(e,n){}setTyping(e,n,o,r){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),al=(()=>{class i extends wt{constructor(){super(),this.BSIsOnline=new me.X(null),this.BSLastOnline=new me.X(null),this.logger=ve.getInstance()}initialize(e){this.tenant=e,this.logger.debug("[MQTT-PRESENCE] initialize this.tenant",this.tenant),this.urlNodePresence="/apps/"+this.tenant+"/presence/"}userIsOnline(e){return this.BSIsOnline}lastOnlineForUser(e){}setPresence(e){}removePresence(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),ll=(()=>{class i extends et{constructor(e){super(),this.http=e}getImagePhotoUrl(e){this.baseImageURL=this.getImageBaseUrl()+"images";let n="";return n=e.includes("bot_")?e.slice(4):e,this.baseImageURL+"?path=uploads/users/"+n+"/images/photo.jpg"}checkImageExists(e,n){this.http.get(e).subscribe(o=>{n(!0)},o=>{console.log("errorrrrrr",e,o),n(!1)})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),cl=(()=>{class i extends rt{constructor(e,n){super(),this.http=e,this.appStorage=n,this.BSStateUpload=new me.X(null),this.logger=ve.getInstance()}initialize(){this.logger.debug("[NATIVE UPLOAD] initialize"),this.URL_TILEDESK_FILE=this.getBaseUrl()+"files",this.URL_TILEDESK_IMAGES=this.getBaseUrl()+"images",this.tiledeskToken=this.appStorage.getItem("tiledeskToken")}upload(e,n){this.logger.debug("[NATIVE UPLOAD] - upload new image/file ... upload",n);const r={headers:new Ee.WM({Authorization:this.tiledeskToken})},v=new FormData;v.append("file",n.file);const P=this;if(n.file.type.startsWith("image")&&!n.file.type.includes("svg")){this.logger.debug("[NATIVE UPLOAD] - upload new image");const Y=this.URL_TILEDESK_IMAGES+"/users";return new Promise((X,ae)=>{P.http.post(Y,v,r).subscribe(fe=>{X(this.URL_TILEDESK_IMAGES+"?path="+fe.filename)},fe=>{ae(fe)})})}{this.logger.debug("[NATIVE UPLOAD] - upload new file");const Y=this.URL_TILEDESK_FILE+"/users";return new Promise((X,ae)=>{P.http.post(Y,v,r).subscribe(fe=>{let Ce=this.URL_TILEDESK_FILE+"/download?path="+encodeURI(fe.filename);n.file.type.includes("pdf")&&(Ce=this.URL_TILEDESK_FILE+"?path="+encodeURI(fe.filename)),X(Ce)},fe=>{this.logger.error("[NATIVE UPLOAD] - ERROR upload new file ",fe),ae(fe)})})}}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Ee.eN),t.LFG(Ne))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),hl=(()=>{class i extends Ne{constructor(){super(...arguments),this.storagePrefix=pe,this.logger=ve.getInstance()}initialize(e,n,o){this.storagePrefix=e,this.projectID=o,this.persistence=n}getItem(e){let n;try{n=this.storagePrefix+"_"}catch(r){this.logger.error("[LocalSessionStorage] getItem >Error :",r)}return this.getValueForKey(n+this.projectID+"_"+e)}setItem(e,n){let o;try{o=this.storagePrefix+"_"}catch(v){this.logger.error("[LocalSessionStorage] setItem > Error :",v)}this.saveValueForKey(o+this.projectID+"_"+e,n)}getItemWithoutProjectID(e){let n;try{n=this.storagePrefix+"_"}catch(r){this.logger.error("[LocalSessionStorage] getItemWithoutProjectID > Error :",r)}return this.getValueForKey(n+e)}setItemWithoutProjectID(e,n){this.removeItem(e);let o=pe;try{o=this.storagePrefix+"_"}catch(v){this.logger.error("[LocalSessionStorage] setItemWithoutProjectID > Error :",v)}this.saveValueForKey(o+e,n)}removeItem(e){let n;try{n=this.storagePrefix+"_"}catch(r){this.logger.error("[LocalSessionStorage] removeItem > Error :",r)}return this.removeItemForKey(n+this.projectID+"_"+e)}clear(){let e;try{e=this.storagePrefix+"_"}catch(r){this.logger.error("[LocalSessionStorage] clear > Error :",r)}const n=e+this.projectID,o=[];for(let r=0;r<localStorage.length;r++){const v=localStorage.key(r);-1!==v.indexOf(n)&&o.push(v)}for(let r=0;r<o.length;r++)this.removeItemForKey(o[r])}getValueForKey(e){return"local"===this.persistence||"LOCAL"===this.persistence?Ke()?localStorage.getItem(e):(this.logger.warn("localStorage is not defind. Storage disabled"),null):"session"===this.persistence||"SESSION"===this.persistence?kt()?sessionStorage.getItem(e):(this.logger.warn("sessionStorage is not defind. Storage disabled"),null):"none"===this.persistence||"NONE"===this.persistence?null:Ke()?localStorage.getItem(e):(this.logger.warn("localStorage is not defind. Storage disabled"),null)}saveValueForKey(e,n){return"local"===this.persistence||"LOCAL"===this.persistence?Ke()?localStorage.setItem(e,n):(this.logger.warn("localStorage is not defind. Storage disabled"),null):"session"===this.persistence||"SESSION"===this.persistence?kt()?sessionStorage.setItem(e,n):(this.logger.warn("sessionStorage is not defind. Storage disabled"),null):"none"===this.persistence||"NONE"===this.persistence?null:Ke()?localStorage.setItem(e,n):(this.logger.warn("localStorage is not defind. Storage disabled"),null)}removeItemForKey(e){return"local"===this.persistence||"LOCAL"===this.persistence?Ke()?localStorage.removeItem(e):(this.logger.warn("localStorage is not defind. Storage disabled"),null):"session"===this.persistence||"SESSION"===this.persistence?kt()?sessionStorage.removeItem(e):(this.logger.warn("sessionStorage is not defind. Storage disabled"),null):"none"===this.persistence||"NONE"===this.persistence?null:Ke()?localStorage.removeItem(e):(this.logger.warn("localStorage is not defind. Storage disabled"),null)}}return i.\u0275fac=function(){let a;return function(n){return(a||(a=t.n5z(i)))(n||i)}}(),i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();const dl=(i,a)=>()=>{let e=new Va(a);if(ve.setInstance(e),Ae.remoteConfig)return i.loadAppConfig()};function ul(i,a,e,n){const o=a.getConfig();if(o.chatEngine===Q){e.config=o.chat21Config,e.initChat();const r=new nl(i,e,n);return r.setBaseUrl(a.getConfig().apiUrl),r}{Zn.initFirebase(o.firebaseConfig);const r=new Ga(i);return r.setBaseUrl(o.apiUrl),r}}function gl(i,a,e){return e.getConfig().chatEngine===Q?new ol(i):new qa(a,e)}function pl(i,a){return a.getConfig().chatEngine===Q?new il(i):new Wa}function fl(i,a){return a.getConfig().chatEngine===Q?new rl(i):new Ya}function ml(i,a){return a.getConfig().chatEngine===Q?new Wn(i,!0):new jn(!0)}function _l(i){return i.getConfig().chatEngine===Q?new sl:new Qa}function vl(i){return i.getConfig().chatEngine===Q?new al:new Ka}function bl(i,a){const e=i.getConfig();if(e.uploadEngine===b){const n=new ll(a);return n.setImageBaseUrl(e.baseImageUrl),n}{const n=new $a(a);return Zn.initFirebase(e.firebaseConfig),n.setImageBaseUrl(e.baseImageUrl),n}}function Cl(i,a,e){const n=a.getConfig();if(n.uploadEngine===b){const o=new cl(i,e);return o.setBaseUrl(n.baseImageUrl),o}return new Xa}let wl=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i,bootstrap:[Dt]}),i.\u0275inj=t.cJS({providers:[Re,Ze,Ie,fn,_n,vn,jt,{provide:t.ip1,useFactory:dl,multi:!0,deps:[Re,xt.Kf]},{provide:Ne,useClass:hl},{provide:Ct,useFactory:ul,deps:[Ee.eN,Re,Ze,Ne]},{provide:at,useFactory:gl,deps:[Ze,Ee.eN,Re]},{provide:lt,useFactory:pl,deps:[Ze,Re]},{provide:dt,useFactory:fl,deps:[Ze,Re]},{provide:Yt,useFactory:ml,deps:[Ze,Re]},{provide:et,useFactory:bl,deps:[Re,Ee.eN]},{provide:wt,useFactory:vl,deps:[Re]},{provide:it,useFactory:_l,deps:[Re]},{provide:rt,useFactory:Cl,deps:[Ee.eN,Re,Ne]},Cn,Ut,Bt,Xe,mn,On],imports:[T.b2,za.PW,Ee.JF,be.u5,be.UX,Ve._G,Ht.z8.forRoot(Te),kn.bd,Ft.aw.forRoot({}),xt.f9.forRoot({level:xt._z.DEBUG,enableSourceMaps:!1,disableFileDetails:!0,colorScheme:["purple","yellow","gray","gray","red","red","red"]})]}),i})();t.B6R(Dt,function(){return[ue.mk,ue.O5,ue.PC,Fa,dn,Ti,Ii,Za,xa,ma,ca,Ls]},[]),Ae.production&&(0,t.G48)(),T.q6().bootstrapModule(wl).catch(i=>console.error(i))},7994:(He,gt,_e)=>{He.exports=function T(t,Q,x){function b(h,p){if(!Q[h]){if(!t[h]){if(_)return _(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var y=Q[h]={exports:{}};t[h][0].call(y.exports,function(M){return b(t[h][1][M]||M)},y,y.exports,T,t,Q,x)}return Q[h].exports}for(var _=void 0,c=0;c<x.length;c++)b(x[c]);return b}({1:[function(T,t,Q){(function(x,b){"use strict";var _=T("events").EventEmitter,c=T("./store"),h=T("mqtt-packet"),p=T("readable-stream").Writable,C=T("inherits"),f=T("reinterval"),y=T("./validations"),M=T("xtend"),g=T("debug")("mqttjs:client"),u=x?x.nextTick:function(R){setTimeout(R,0)},O=b.setImmediate||function(R){u(R)},L={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0},k=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND"],H={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};function z(R,F,W){g("sendPacket :: packet: %O",F),g("sendPacket :: emitting `packetsend`"),R.emit("packetsend",F),g("sendPacket :: writing to stream");var E=h.writeToStream(F,R.stream,R.options);g("sendPacket :: writeToStream result %s",E),!E&&W?(g("sendPacket :: handle events on `drain` once through callback."),R.stream.once("drain",W)):W&&(g("sendPacket :: invoking cb"),W())}function A(R,F,W,E){g("storeAndSend :: store packet with cmd %s to outgoingStore",F.cmd),R.outgoingStore.put(F,function(V){if(V)return W&&W(V);E(),z(R,F,W)})}function oe(R){g("nop ::",R)}function I(R,F){var W,E=this;if(!(this instanceof I))return new I(R,F);for(W in this.options=F||{},L)this.options[W]=void 0===this.options[W]?L[W]:F[W];g("MqttClient :: options.protocol",F.protocol),g("MqttClient :: options.protocolVersion",F.protocolVersion),g("MqttClient :: options.username",F.username),g("MqttClient :: options.keepalive",F.keepalive),g("MqttClient :: options.reconnectPeriod",F.reconnectPeriod),g("MqttClient :: options.rejectUnauthorized",F.rejectUnauthorized),this.options.clientId="string"==typeof F.clientId?F.clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),g("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=5===F.protocolVersion&&F.customHandleAcks?F.customHandleAcks:function(){arguments[3](0)},this.streamBuilder=R,this.outgoingStore=F.outgoingStore||new c,this.incomingStore=F.incomingStore||new c,this.queueQoSZero=void 0===F.queueQoSZero||F.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this.nextId=Math.max(1,Math.floor(65535*Math.random())),this.outgoing={},this._firstConnection=!0,this.on("connect",function(){var V=this.queue;g("connect :: sending queued packets"),function q(){var re,ie=V.shift();g("deliver :: entry %o",ie),ie&&(g("deliver :: call _sendPacket for %o",re=ie.packet),E._sendPacket(re,function(te){ie.cb&&ie.cb(te),q()}))}()}),this.on("close",function(){g("close :: connected set to `false`"),this.connected=!1,g("close :: clearing connackTimer"),clearTimeout(this.connackTimer),g("close :: clearing ping timer"),null!==E.pingTimer&&(E.pingTimer.clear(),E.pingTimer=null),g("close :: calling _setupReconnect"),this._setupReconnect()}),_.call(this),g("MqttClient :: setting up stream"),this._setupStream()}C(I,_),I.prototype._setupStream=function(){var R,F=this,W=new p,E=h.parser(this.options),V=null,q=[];function ie(){if(q.length)u(re);else{var te=V;V=null,te()}}function re(){g("work :: getting next packet in queue");var te=q.shift();if(te)g("work :: packet pulled from queue"),F._handlePacket(te,ie);else{g("work :: no packets in queue");var j=V;V=null,g("work :: done flag is %s",!!j),j&&j()}}if(g("_setupStream :: calling method to clear reconnect"),this._clearReconnect(),g("_setupStream :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),E.on("packet",function(te){g("parser :: on packet push to packets array."),q.push(te)}),W._write=function(te,j,N){V=N,g("writable stream :: parsing buffer"),E.parse(te),re()},g("_setupStream :: pipe stream to writable stream"),this.stream.pipe(W),this.stream.on("error",function(te){g("streamErrorHandler :: error",te.message),k.includes(te.code)?(g("streamErrorHandler :: emitting error"),F.emit("error",te)):oe(te)}),this.stream.on("close",function(){var te;g("(%s)stream :: on close",F.options.clientId),(te=F.outgoing)&&(g("flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(te).forEach(function(j){te[j].volatile&&"function"==typeof te[j].cb&&(te[j].cb(new Error("Connection closed")),delete te[j])})),g("stream: emit close to MqttClient"),F.emit("close")}),g("_setupStream: sending packet `connect`"),(R=Object.create(this.options)).cmd="connect",z(this,R),E.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return F.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;this.options.properties.authenticationMethod&&this.options.authPacket&&"object"==typeof this.options.authPacket&&z(this,M({cmd:"auth",reasonCode:0},this.options.authPacket))}this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(function(){g("!!connectTimeout hit!! Calling _cleanUp with force `true`"),F._cleanUp(!0)},this.options.connectTimeout)},I.prototype._handlePacket=function(R,F){var W=this.options;if(5===W.protocolVersion&&W.properties&&W.properties.maximumPacketSize&&W.properties.maximumPacketSize<R.length)return this.emit("error",new Error("exceeding packets size "+R.cmd)),this.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),this;switch(g("_handlePacket :: emitting packetreceive"),this.emit("packetreceive",R),R.cmd){case"publish":this._handlePublish(R,F);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(R),F();break;case"pubrel":this._handlePubrel(R,F);break;case"connack":this._handleConnack(R),F();break;case"pingresp":this._handlePingresp(R),F();break;case"disconnect":this._handleDisconnect(R),F()}},I.prototype._checkDisconnecting=function(R){return this.disconnecting&&(R?R(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},I.prototype.publish=function(R,F,W,E){var V;g("publish :: message `%s` to topic `%s`",F,R);var q=this.options;if("function"==typeof W&&(E=W,W=null),W=M({qos:0,retain:!1,dup:!1},W),this._checkDisconnecting(E))return this;switch(V={cmd:"publish",topic:R,payload:F,qos:W.qos,retain:W.retain,messageId:this._nextId(),dup:W.dup},5===q.protocolVersion&&(V.properties=W.properties,(!q.properties&&V.properties&&V.properties.topicAlias||W.properties&&q.properties&&(W.properties.topicAlias&&q.properties.topicAliasMaximum&&W.properties.topicAlias>q.properties.topicAliasMaximum||!q.properties.topicAliasMaximum&&W.properties.topicAlias))&&delete V.properties.topicAlias),g("publish :: qos",W.qos),W.qos){case 1:case 2:this.outgoing[V.messageId]={volatile:!1,cb:E||oe},this._storeProcessing?(g("_storeProcessing enabled"),this._packetIdsDuringStoreProcessing[V.messageId]=!1,this._storePacket(V,void 0,W.cbStorePut)):(g("MqttClient:publish: packet cmd: %s",V.cmd),this._sendPacket(V,void 0,W.cbStorePut));break;default:this._storeProcessing?(g("_storeProcessing enabled"),this._storePacket(V,E,W.cbStorePut)):(g("MqttClient:publish: packet cmd: %s",V.cmd),this._sendPacket(V,E,W.cbStorePut))}return this},I.prototype.subscribe=function(){for(var R,F=new Array(arguments.length),W=0;W<arguments.length;W++)F[W]=arguments[W];var E,V=[],q=F.shift(),ie=q.resubscribe,re=F.pop()||oe,te=F.pop(),j=this,N=this.options.protocolVersion;if(delete q.resubscribe,"string"==typeof q&&(q=[q]),"function"!=typeof re&&(te=re,re=oe),null!==(E=y.validateTopics(q)))return O(re,new Error("Invalid topic "+E)),this;if(this._checkDisconnecting(re))return g("subscribe: discconecting true"),this;var G={qos:0};if(5===N&&(G.nl=!1,G.rap=!1,G.rh=0),te=M(G,te),Array.isArray(q)?q.forEach(function(m){if(g("subscribe: array topic %s",m),!j._resubscribeTopics.hasOwnProperty(m)||j._resubscribeTopics[m].qos<te.qos||ie){var w={topic:m,qos:te.qos};5===N&&(w.nl=te.nl,w.rap=te.rap,w.rh=te.rh,w.properties=te.properties),g("subscribe: pushing topic `%s` and qos `%s` to subs list",w.topic,w.qos),V.push(w)}}):Object.keys(q).forEach(function(m){if(g("subscribe: object topic %s",m),!j._resubscribeTopics.hasOwnProperty(m)||j._resubscribeTopics[m].qos<q[m].qos||ie){var w={topic:m,qos:q[m].qos};5===N&&(w.nl=q[m].nl,w.rap=q[m].rap,w.rh=q[m].rh,w.properties=te.properties),g("subscribe: pushing `%s` to subs list",w),V.push(w)}}),R={cmd:"subscribe",subscriptions:V,qos:1,retain:!1,dup:!1,messageId:this._nextId()},te.properties&&(R.properties=te.properties),V.length){if(this.options.resubscribe){g("subscribe :: resubscribe true");var J=[];V.forEach(function(m){if(j.options.reconnectPeriod>0){var w={qos:m.qos};5===N&&(w.nl=m.nl||!1,w.rap=m.rap||!1,w.rh=m.rh||0,w.properties=m.properties),j._resubscribeTopics[m.topic]=w,J.push(m.topic)}}),j.messageIdToTopic[R.messageId]=J}return this.outgoing[R.messageId]={volatile:!0,cb:function(m,w){if(!m)for(var B=w.granted,D=0;D<B.length;D+=1)V[D].qos=B[D];re(m,V)}},g("subscribe :: call _sendPacket"),this._sendPacket(R),this}re(null,[])},I.prototype.unsubscribe=function(){for(var R={cmd:"unsubscribe",qos:1,messageId:this._nextId()},F=this,W=new Array(arguments.length),E=0;E<arguments.length;E++)W[E]=arguments[E];var V=W.shift(),q=W.pop()||oe,ie=W.pop();return"string"==typeof V&&(V=[V]),"function"!=typeof q&&(ie=q,q=oe),this._checkDisconnecting(q)||("string"==typeof V?R.unsubscriptions=[V]:Array.isArray(V)&&(R.unsubscriptions=V),this.options.resubscribe&&R.unsubscriptions.forEach(function(re){delete F._resubscribeTopics[re]}),"object"==typeof ie&&ie.properties&&(R.properties=ie.properties),this.outgoing[R.messageId]={volatile:!0,cb:q},g("unsubscribe: call _sendPacket"),this._sendPacket(R)),this},I.prototype.end=function(R,F,W){var E=this;function V(){g("end :: (%s) :: finish :: calling _cleanUp with force %s",E.options.clientId,R),E._cleanUp(R,()=>{g("end :: finish :: calling process.nextTick on closeStores"),u(function(){g("end :: closeStores: closing incoming and outgoing stores"),E.disconnected=!0,E.incomingStore.close(function(q){E.outgoingStore.close(function(ie){if(g("end :: closeStores: emitting end"),E.emit("end"),W){let re=q||ie;g("end :: closeStores: invoking callback with args"),W(re)}})}),E._deferredReconnect&&E._deferredReconnect()}.bind(E))},F)}return g("end :: (%s)",this.options.clientId),null!=R&&"boolean"==typeof R||(W=F||oe,F=R,R=!1,"object"!=typeof F&&(W=F,F=null,"function"!=typeof W&&(W=oe))),"object"!=typeof F&&(W=F,F=null),g("end :: cb? %s",!!W),W=W||oe,this.disconnecting?(W(),this):(this._clearReconnect(),this.disconnecting=!0,!R&&Object.keys(this.outgoing).length>0?(g("end :: (%s) :: calling finish in 10ms once outgoing is empty",E.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,V,10))):(g("end :: (%s) :: immediately calling finish",E.options.clientId),V()),this)},I.prototype.removeOutgoingMessage=function(R){var F=this.outgoing[R]?this.outgoing[R].cb:null;return delete this.outgoing[R],this.outgoingStore.del({messageId:R},function(){F(new Error("Message removed"))}),this},I.prototype.reconnect=function(R){g("client reconnect");var F=this,W=function(){R?(F.options.incomingStore=R.incomingStore,F.options.outgoingStore=R.outgoingStore):(F.options.incomingStore=null,F.options.outgoingStore=null),F.incomingStore=F.options.incomingStore||new c,F.outgoingStore=F.options.outgoingStore||new c,F.disconnecting=!1,F.disconnected=!1,F._deferredReconnect=null,F._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=W:W(),this},I.prototype._reconnect=function(){g("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this._setupStream()}),g("client already connected. disconnecting first.")):(g("_reconnect: calling _setupStream"),this._setupStream())},I.prototype._setupReconnect=function(){var R=this;!R.disconnecting&&!R.reconnectTimer&&R.options.reconnectPeriod>0?(this.reconnecting||(g("_setupReconnect :: emit `offline` state"),this.emit("offline"),g("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),g("_setupReconnect :: setting reconnectTimer for %d ms",R.options.reconnectPeriod),R.reconnectTimer=setInterval(function(){g("reconnectTimer :: reconnect triggered!"),R._reconnect()},R.options.reconnectPeriod)):g("_setupReconnect :: doing nothing...")},I.prototype._clearReconnect=function(){g("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},I.prototype._cleanUp=function(R,F){var W,E=arguments[2];if(F&&(g("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",F)),g("_cleanUp :: forced? %s",R),R)0===this.options.reconnectPeriod&&this.options.clean&&(W=this.outgoing)&&(g("flush: queue exists? %b",!!W),Object.keys(W).forEach(function(q){"function"==typeof W[q].cb&&(W[q].cb(new Error("Connection closed")),delete W[q])})),g("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{var V=M({cmd:"disconnect"},E);g("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(V,O.bind(null,this.stream.end.bind(this.stream)))}this.disconnecting||(g("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(g("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),F&&!this.connected&&(g("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",F),F())},I.prototype._sendPacket=function(R,F,W){if(g("_sendPacket :: (%s) ::  start",this.options.clientId),W=W||oe,!this.connected)return g("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(R,F,W);switch(this._shiftPingInterval(),R.cmd){case"publish":break;case"pubrel":return void A(this,R,F,W);default:return void z(this,R,F)}switch(R.qos){case 2:case 1:A(this,R,F,W);break;default:z(this,R,F)}g("_sendPacket :: (%s) ::  end",this.options.clientId)},I.prototype._storePacket=function(R,F,W){g("_storePacket :: packet: %o",R),g("_storePacket :: cb? %s",!!F),W=W||oe,0===(R.qos||0)&&this.queueQoSZero||"publish"!==R.cmd?this.queue.push({packet:R,cb:F}):R.qos>0?(F=this.outgoing[R.messageId]?this.outgoing[R.messageId].cb:null,this.outgoingStore.put(R,function(E){if(E)return F&&F(E);W()})):F&&F(new Error("No connection to broker"))},I.prototype._setupPingTimer=function(){g("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive);var R=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=f(function(){R._checkPing()},1e3*this.options.keepalive))},I.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},I.prototype._checkPing=function(){g("_checkPing :: checking ping..."),this.pingResp?(g("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(g("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))},I.prototype._handlePingresp=function(){this.pingResp=!0},I.prototype._handleConnack=function(R){g("_handleConnack");var F=this.options,W=5===F.protocolVersion?R.reasonCode:R.returnCode;if(clearTimeout(this.connackTimer),R.properties&&(R.properties.topicAliasMaximum&&(F.properties||(F.properties={}),F.properties.topicAliasMaximum=R.properties.topicAliasMaximum),R.properties.serverKeepAlive&&F.keepalive&&(F.keepalive=R.properties.serverKeepAlive,this._shiftPingInterval()),R.properties.maximumPacketSize&&(F.properties||(F.properties={}),F.properties.maximumPacketSize=R.properties.maximumPacketSize)),0===W)this.reconnecting=!1,this._onConnect(R);else if(W>0){var E=new Error("Connection refused: "+H[W]);E.code=W,this.emit("error",E)}},I.prototype._handlePublish=function(R,F){g("_handlePublish: packet %o",R),F=void 0!==F?F:oe;var W=R.topic.toString(),E=R.payload,V=R.qos,q=R.messageId,ie=this,re=this.options,te=[0,16,128,131,135,144,145,151,153];switch(g("_handlePublish: qos %d",V),V){case 2:re.customHandleAcks(W,E,R,function(j,N){return j instanceof Error||(N=j,j=null),j?ie.emit("error",j):-1===te.indexOf(N)?ie.emit("error",new Error("Wrong reason code for pubrec")):void(N?ie._sendPacket({cmd:"pubrec",messageId:q,reasonCode:N},F):ie.incomingStore.put(R,function(){ie._sendPacket({cmd:"pubrec",messageId:q},F)}))});break;case 1:re.customHandleAcks(W,E,R,function(j,N){return j instanceof Error||(N=j,j=null),j?ie.emit("error",j):-1===te.indexOf(N)?ie.emit("error",new Error("Wrong reason code for puback")):(N||ie.emit("message",W,E,R),void ie.handleMessage(R,function(G){if(G)return F&&F(G);ie._sendPacket({cmd:"puback",messageId:q,reasonCode:N},F)}))});break;case 0:this.emit("message",W,E,R),this.handleMessage(R,F);break;default:g("_handlePublish: unknown QoS. Doing nothing.")}},I.prototype.handleMessage=function(R,F){F()},I.prototype._handleAck=function(R){var F,W=R.messageId,E=R.cmd,V=null,q=this.outgoing[W]?this.outgoing[W].cb:null,ie=this;if(q){switch(g("_handleAck :: packet type",E),E){case"pubcomp":case"puback":var re=R.reasonCode;re&&re>0&&16!==re&&((F=new Error("Publish error: "+H[re])).code=re,q(F,R)),delete this.outgoing[W],this.outgoingStore.del(R,q);break;case"pubrec":V={cmd:"pubrel",qos:2,messageId:W};var te=R.reasonCode;te&&te>0&&16!==te?((F=new Error("Publish error: "+H[te])).code=te,q(F,R)):this._sendPacket(V);break;case"suback":delete this.outgoing[W];for(var j=0;j<R.granted.length;j++)if(0!=(128&R.granted[j])){var N=this.messageIdToTopic[W];N&&N.forEach(function(G){delete ie._resubscribeTopics[G]})}q(null,R);break;case"unsuback":delete this.outgoing[W],q(null);break;default:ie.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}else g("_handleAck :: Server sent an ack in error. Ignoring.")},I.prototype._handlePubrel=function(R,F){g("handling pubrel packet"),F=void 0!==F?F:oe;var W=this,E={cmd:"pubcomp",messageId:R.messageId};W.incomingStore.get(R,function(V,q){V?W._sendPacket(E,F):(W.emit("message",q.topic,q.payload,q),W.handleMessage(q,function(ie){if(ie)return F(ie);W.incomingStore.del(q,oe),W._sendPacket(E,F)}))})},I.prototype._handleDisconnect=function(R){this.emit("disconnect",R)},I.prototype._nextId=function(){var R=this.nextId++;return 65536===this.nextId&&(this.nextId=1),R},I.prototype.getLastMessageId=function(){return 1===this.nextId?65535:this.nextId-1},I.prototype._resubscribe=function(R){g("_resubscribe");var F=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||5===this.options.protocolVersion&&!R.sessionPresent)&&F.length>0)if(this.options.resubscribe)if(5===this.options.protocolVersion){g("_resubscribe: protocolVersion 5");for(var W=0;W<F.length;W++){var E={};E[F[W]]=this._resubscribeTopics[F[W]],E.resubscribe=!0,this.subscribe(E,{properties:E[F[W]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1},I.prototype._onConnect=function(R){if(this.disconnected)this.emit("connect",R);else{var F=this;this._setupPingTimer(),this._resubscribe(R),this.connected=!0,function W(){var E=F.outgoingStore.createStream();function V(){F._storeProcessing=!1,F._packetIdsDuringStoreProcessing={}}function q(){E.destroy(),E=null,V()}F.once("close",q),E.on("error",function(ie){V(),F.removeListener("close",q),F.emit("error",ie)}),E.on("end",function(){var ie=!0;for(var re in F._packetIdsDuringStoreProcessing)if(!F._packetIdsDuringStoreProcessing[re]){ie=!1;break}ie?(V(),F.removeListener("close",q),F.emit("connect",R)):W()}),function ie(){if(E){F._storeProcessing=!0;var re,te=E.read(1);te?F._packetIdsDuringStoreProcessing[te.messageId]?ie():F.disconnecting||F.reconnectTimer?E.destroy&&E.destroy():(re=F.outgoing[te.messageId]?F.outgoing[te.messageId].cb:null,F.outgoing[te.messageId]={volatile:!1,cb:function(j,N){re&&re(j,N),ie()}},F._packetIdsDuringStoreProcessing[te.messageId]=!0,F._sendPacket(te)):E.once("readable",ie)}}()}()}},t.exports=I}).call(this,T("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./store":7,"./validations":8,_process:44,debug:14,events:27,inherits:29,"mqtt-packet":34,"readable-stream":63,reinterval:64,xtend:74}],2:[function(T,t,Q){(function(x){"use strict";var b,_,c,h=T("readable-stream").Transform,p=T("duplexify"),C=!1;t.exports=function(f,y){if(y.hostname=y.hostname||y.host,!y.hostname)throw new Error("Could not determine host. Specify host manually.");var u,M="MQIsdp"===y.protocolId&&3===y.protocolVersion?"mqttv3.1":"mqtt";(u=y).hostname||(u.hostname="localhost"),u.path||(u.path="/"),u.wsOptions||(u.wsOptions={});var g=function(u,O){var L="alis"===u.protocol?"wss":"ws",k=L+"://"+u.hostname+u.path;return u.port&&80!==u.port&&443!==u.port&&(k=L+"://"+u.hostname+":"+u.port+u.path),"function"==typeof u.transformWsUrl&&(k=u.transformWsUrl(k,u,O)),k}(y,f);return(b=y.my).connectSocket({url:g,protocols:M}),_=function(){var u=new h;return u._write=function(O,L,k){b.sendSocketMessage({data:O.buffer,success:function(){k()},fail:function(){k(new Error)}})},u._flush=function(O){b.closeSocket({success:function(){O()}})},u}(),c=p.obj(),C||(C=!0,b.onSocketOpen(function(){c.setReadable(_),c.setWritable(_),c.emit("connect")}),b.onSocketMessage(function(u){if("string"==typeof u.data){var O=x.from(u.data,"base64");_.push(O)}else{var L=new FileReader;L.addEventListener("load",function(){var k=L.result;k=k instanceof ArrayBuffer?x.from(k):x.from(k,"utf8"),_.push(k)}),L.readAsArrayBuffer(u.data)}}),b.onSocketClose(function(){c.end(),c.destroy()}),b.onSocketError(function(u){c.destroy(u)})),c}}).call(this,T("buffer").Buffer)},{buffer:12,duplexify:16,"readable-stream":63}],3:[function(T,t,Q){"use strict";var x=T("net"),b=T("debug")("mqttjs:tcp");t.exports=function(_,c){var h,p;return c.port=c.port||1883,c.hostname=c.hostname||c.host||"localhost",b("port %d and host %s",h=c.port,p=c.hostname),x.createConnection(h,p)}},{debug:14,net:11}],4:[function(T,t,Q){"use strict";var x=T("tls"),b=T("debug")("mqttjs:tls");t.exports=function(_,c){var h;function p(C){c.rejectUnauthorized&&_.emit("error",C),h.end()}return c.port=c.port||8883,c.host=c.hostname||c.host||"localhost",c.servername=c.host,c.rejectUnauthorized=!1!==c.rejectUnauthorized,delete c.path,b("port %d host %s rejectUnauthorized %b",c.port,c.host,c.rejectUnauthorized),(h=x.connect(c)).on("secureConnect",function(){c.rejectUnauthorized&&!h.authorized?h.emit("error",new Error("TLS not authorized")):h.removeListener("error",p)}),h.on("error",p),h}},{debug:14,tls:11}],5:[function(T,t,Q){(function(x,b){"use strict";const _=T("ws"),c=T("debug")("mqttjs:ws"),h=T("duplexify"),p=T("readable-stream").Transform;let C=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];const f=void 0!==x&&"browser"===x.title||"function"==typeof _e;function y(g,u){let O=g.protocol+"://"+g.hostname+":"+g.port+g.path;return"function"==typeof g.transformWsUrl&&(O=g.transformWsUrl(O,g,u)),O}function M(g){let u=g;return g.hostname||(u.hostname="localhost"),g.port||(u.port="wss"===g.protocol?443:80),g.path||(u.path="/"),g.wsOptions||(u.wsOptions={}),f||"wss"!==g.protocol||C.forEach(function(O){g.hasOwnProperty(O)&&!g.wsOptions.hasOwnProperty(O)&&(u.wsOptions[O]=g[O])}),u}t.exports=f?function(g,u){let O;c("browserStreamBuilder");const L=function(V){let q=M(V);if(q.hostname||(q.hostname=q.host),!q.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");const ie=new URL(document.URL);q.hostname=ie.hostname,q.port||(q.port=ie.port)}return void 0===q.objectMode&&(q.objectMode=!(!0===q.binary||void 0===q.binary)),q}(u).browserBufferSize||524288,k=u.browserBufferTimeout||1e3,H=!u.objectMode;let z=function(V,q){const ie="MQIsdp"===q.protocolId&&3===q.protocolVersion?"mqttv3.1":"mqtt";let re=y(q,V),te=new WebSocket(re,[ie]);return te.binaryType="arraybuffer",te}(g,u),A=function(V,q,ie){let re=new p({objectModeMode:V.objectMode});return re._write=function V(q,ie,re){z.bufferedAmount>L&&setTimeout(V,k,q,ie,re),H&&"string"==typeof q&&(q=b.from(q,"utf8"));try{z.send(q)}catch(te){return re(te)}re()},re._flush=function(V){z.close(),V()},re}(u);u.objectMode||(A._writev=E),A.on("close",()=>{z.close()});const oe=void 0===z.addEventListener;function I(){O.setReadable(A),O.setWritable(A),O.emit("connect")}function R(){O.end(),O.destroy()}function F(V){O.destroy(V)}function W(V){let q=V.data;q=q instanceof ArrayBuffer?b.from(q):b.from(q,"utf8"),A.push(q)}function E(V,q){const ie=new Array(V.length);for(let re=0;re<V.length;re++)ie[re]="string"==typeof V[re].chunk?b.from(V[re],"utf8"):V[re].chunk;this._write(b.concat(ie),"binary",q)}return z.readyState===z.OPEN?O=A:(O=O=h(void 0,void 0,u),u.objectMode||(O._writev=E),oe?z.addEventListener("open",I):z.onopen=I),O.socket=z,oe?(z.addEventListener("close",R),z.addEventListener("error",F),z.addEventListener("message",W)):(z.onclose=R,z.onerror=F,z.onmessage=W),O}:function(g,u){c("streamBuilder");let O=M(u);const L=y(O,g);let k=function(z,A,oe){c("createWebSocket"),c("protocol: "+oe.protocolId+" "+oe.protocolVersion);const I="MQIsdp"===oe.protocolId&&3===oe.protocolVersion?"mqttv3.1":"mqtt";return c("creating new Websocket for url: "+A+" and protocol: "+I),new _(A,[I],oe.wsOptions)}(0,L,O),H=_.createWebSocketStream(k,O.wsOptions);return H.url=L,H}}).call(this,T("_process"),T("buffer").Buffer)},{_process:44,buffer:12,debug:14,duplexify:16,"readable-stream":63,ws:73}],6:[function(T,t,Q){(function(x){"use strict";var b,_,c,h=T("readable-stream").Transform,p=T("duplexify");t.exports=function(C,f){if(f.hostname=f.hostname||f.host,!f.hostname)throw new Error("Could not determine host. Specify host manually.");var u,y="MQIsdp"===f.protocolId&&3===f.protocolVersion?"mqttv3.1":"mqtt";(u=f).hostname||(u.hostname="localhost"),u.path||(u.path="/"),u.wsOptions||(u.wsOptions={});var M=function(u,O){var L="wxs"===u.protocol?"wss":"ws",k=L+"://"+u.hostname+u.path;return u.port&&80!==u.port&&443!==u.port&&(k=L+"://"+u.hostname+":"+u.port+u.path),"function"==typeof u.transformWsUrl&&(k=u.transformWsUrl(k,u,O)),k}(f,C);b=wx.connectSocket({url:M,protocols:[y]}),_=function(){var u=new h;return u._write=function(O,L,k){b.send({data:O.buffer,success:function(){k()},fail:function(H){k(new Error(H))}})},u._flush=function(O){b.close({success:function(){O()}})},u}(),(c=p.obj())._destroy=function(u,O){b.close({success:function(){O&&O(u)}})};var g=c.destroy;return c.destroy=function(){c.destroy=g;var u=this;setTimeout(function(){b.close({fail:function(){u._destroy(new Error)}})},0)}.bind(c),b.onOpen(function(){c.setReadable(_),c.setWritable(_),c.emit("connect")}),b.onMessage(function(u){var O=u.data;O=O instanceof ArrayBuffer?x.from(O):x.from(O,"utf8"),_.push(O)}),b.onClose(function(){c.end(),c.destroy()}),b.onError(function(u){c.destroy(new Error(u.errMsg))}),c}}).call(this,T("buffer").Buffer)},{buffer:12,duplexify:16,"readable-stream":63}],7:[function(T,t,Q){"use strict";var x=T("xtend"),b=T("readable-stream").Readable,_={objectMode:!0},c={clean:!0};function h(p){if(!(this instanceof h))return new h(p);this.options=p||{},this.options=x(c,p),this._inflights=new Map}h.prototype.put=function(p,C){return this._inflights.set(p.messageId,p),C&&C(),this},h.prototype.createStream=function(){var p=new b(_),C=!1,f=[],y=0;return this._inflights.forEach(function(M,g){f.push(M)}),p._read=function(){this.push(!C&&y<f.length?f[y++]:null)},p.destroy=function(){if(!C){var M=this;C=!0,setTimeout(function(){M.emit("close")},0)}},p},h.prototype.del=function(p,C){return(p=this._inflights.get(p.messageId))?(this._inflights.delete(p.messageId),C(null,p)):C&&C(new Error("missing packet")),this},h.prototype.get=function(p,C){return(p=this._inflights.get(p.messageId))?C(null,p):C&&C(new Error("missing packet")),this},h.prototype.close=function(p){this.options.clean&&(this._inflights=null),p&&p()},t.exports=h},{"readable-stream":63,xtend:74}],8:[function(T,t,Q){"use strict";function x(b){for(var _=b.split("/"),c=0;c<_.length;c++)if("+"!==_[c]){if("#"===_[c])return c===_.length-1;if(-1!==_[c].indexOf("+")||-1!==_[c].indexOf("#"))return!1}return!0}t.exports={validateTopics:function(b){if(0===b.length)return"empty_topic_list";for(var _=0;_<b.length;_++)if(!x(b[_]))return b[_];return null}}},{}],9:[function(T,t,Q){(function(x){"use strict";var b=T("../client"),_=T("../store"),c=T("url"),h=T("xtend"),p=T("debug")("mqttjs"),C={};function f(y,M){if(p("connecting to an MQTT broker..."),"object"!=typeof y||M||(M=y,y=null),M=M||{},y){var g=c.parse(y,!0);if(null!=g.port&&(g.port=Number(g.port)),null===(M=h(g,M)).protocol)throw new Error("Missing protocol");M.protocol=M.protocol.replace(/:$/,"")}if((L=M).auth&&((k=L.auth.match(/^(.+):(.+)$/))?(L.username=k[1],L.password=k[2]):L.username=L.auth),M.query&&"string"==typeof M.query.clientId&&(M.clientId=M.query.clientId),M.cert&&M.key){if(!M.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs","alis"].indexOf(M.protocol))switch(M.protocol){case"mqtt":M.protocol="mqtts";break;case"ws":M.protocol="wss";break;case"wx":M.protocol="wxs";break;case"ali":M.protocol="alis";break;default:throw new Error('Unknown protocol for secure connection: "'+M.protocol+'"!')}}var L,k;if(!C[M.protocol]){var u=-1!==["mqtts","wss"].indexOf(M.protocol);M.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter(function(L,k){return(!u||k%2!=0)&&"function"==typeof C[L]})[0]}if(!1===M.clean&&!M.clientId)throw new Error("Missing clientId for unclean clients");M.protocol&&(M.defaultProtocol=M.protocol);var O=new b(function(L){return M.servers&&(L._reconnectCount&&L._reconnectCount!==M.servers.length||(L._reconnectCount=0),M.host=M.servers[L._reconnectCount].host,M.port=M.servers[L._reconnectCount].port,M.protocol=M.servers[L._reconnectCount].protocol?M.servers[L._reconnectCount].protocol:M.defaultProtocol,M.hostname=M.host,L._reconnectCount++),p("calling streambuilder for",M.protocol),C[M.protocol](L,M)},M);return O.on("error",function(){}),O}void 0!==x&&"browser"!==x.title||"function"!=typeof _e?(C.mqtt=T("./tcp"),C.tcp=T("./tcp"),C.ssl=T("./tls"),C.tls=T("./tls"),C.mqtts=T("./tls")):(C.wx=T("./wx"),C.wxs=T("./wx"),C.ali=T("./ali"),C.alis=T("./ali")),C.ws=T("./ws"),C.wss=T("./ws"),t.exports=f,t.exports.connect=f,t.exports.MqttClient=b,t.exports.Store=_}).call(this,T("_process"))},{"../client":1,"../store":7,"./ali":2,"./tcp":3,"./tls":4,"./ws":5,"./wx":6,_process:44,debug:14,url:69,xtend:74}],10:[function(T,t,Q){"use strict";Q.byteLength=function(y){var M=C(y),u=M[1];return 3*(M[0]+u)/4-u},Q.toByteArray=function(y){var M,g,I,u=C(y),O=u[0],L=u[1],k=new _(3*(O+(I=L))/4-I),H=0,z=L>0?O-4:O;for(g=0;g<z;g+=4)M=b[y.charCodeAt(g)]<<18|b[y.charCodeAt(g+1)]<<12|b[y.charCodeAt(g+2)]<<6|b[y.charCodeAt(g+3)],k[H++]=M>>16&255,k[H++]=M>>8&255,k[H++]=255&M;return 2===L&&(M=b[y.charCodeAt(g)]<<2|b[y.charCodeAt(g+1)]>>4,k[H++]=255&M),1===L&&(M=b[y.charCodeAt(g)]<<10|b[y.charCodeAt(g+1)]<<4|b[y.charCodeAt(g+2)]>>2,k[H++]=M>>8&255,k[H++]=255&M),k},Q.fromByteArray=function(y){for(var M,g=y.length,u=g%3,O=[],L=0,k=g-u;L<k;L+=16383)O.push(f(y,L,L+16383>k?k:L+16383));return 1===u?O.push(x[(M=y[g-1])>>2]+x[M<<4&63]+"=="):2===u&&O.push(x[(M=(y[g-2]<<8)+y[g-1])>>10]+x[M>>4&63]+x[M<<2&63]+"="),O.join("")};for(var x=[],b=[],_=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,p=c.length;h<p;++h)x[h]=c[h],b[c.charCodeAt(h)]=h;function C(y){var M=y.length;if(M%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=y.indexOf("=");return-1===g&&(g=M),[g,g===M?0:4-g%4]}function f(y,M,g){for(var O,L=[],k=M;k<g;k+=3)L.push(x[(O=(y[k]<<16&16711680)+(y[k+1]<<8&65280)+(255&y[k+2]))>>18&63]+x[O>>12&63]+x[O>>6&63]+x[63&O]);return L.join("")}b["-".charCodeAt(0)]=62,b["_".charCodeAt(0)]=63},{}],11:[function(T,t,Q){},{}],12:[function(T,t,Q){(function(p){"use strict";var b=T("base64-js"),_=T("ieee754");Q.Buffer=p,Q.SlowBuffer=function(s){return+s!=s&&(s=0),p.alloc(+s)},Q.INSPECT_MAX_BYTES=50;var c=2147483647;function h(s){if(s>c)throw new RangeError('The value "'+s+'" is invalid for option "size"');var l=new Uint8Array(s);return l.__proto__=p.prototype,l}function p(s,l,d){if("number"==typeof s){if("string"==typeof l)throw new TypeError('The "string" argument must be of type string. Received type number');return y(s)}return C(s,l,d)}function C(s,l,d){if("string"==typeof s)return function(Z,K){if("string"==typeof K&&""!==K||(K="utf8"),!p.isEncoding(K))throw new TypeError("Unknown encoding: "+K);var le=0|u(Z,K),se=h(le),he=se.write(Z,K);return he!==le&&(se=se.slice(0,he)),se}(s,l);if(ArrayBuffer.isView(s))return M(s);if(null==s)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s);if(ne(s,ArrayBuffer)||s&&ne(s.buffer,ArrayBuffer))return function(Z,K,le){if(K<0||Z.byteLength<K)throw new RangeError('"offset" is outside of buffer bounds');if(Z.byteLength<K+(le||0))throw new RangeError('"length" is outside of buffer bounds');var se;return(se=void 0===K&&void 0===le?new Uint8Array(Z):void 0===le?new Uint8Array(Z,K):new Uint8Array(Z,K,le)).__proto__=p.prototype,se}(s,l,d);if("number"==typeof s)throw new TypeError('The "value" argument must not be of type number. Received type number');var S=s.valueOf&&s.valueOf();if(null!=S&&S!==s)return p.from(S,l,d);var U=function(Z){if(p.isBuffer(Z)){var K=0|g(Z.length),le=h(K);return 0===le.length||Z.copy(le,0,0,K),le}return void 0!==Z.length?"number"!=typeof Z.length||ee(Z.length)?h(0):M(Z):"Buffer"===Z.type&&Array.isArray(Z.data)?M(Z.data):void 0}(s);if(U)return U;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof s[Symbol.toPrimitive])return p.from(s[Symbol.toPrimitive]("string"),l,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s)}function f(s){if("number"!=typeof s)throw new TypeError('"size" argument must be of type number');if(s<0)throw new RangeError('The value "'+s+'" is invalid for option "size"')}function y(s){return f(s),h(s<0?0:0|g(s))}function M(s){for(var l=s.length<0?0:0|g(s.length),d=h(l),S=0;S<l;S+=1)d[S]=255&s[S];return d}function g(s){if(s>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return 0|s}function u(s,l){if(p.isBuffer(s))return s.length;if(ArrayBuffer.isView(s)||ne(s,ArrayBuffer))return s.byteLength;if("string"!=typeof s)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof s);var d=s.length,S=arguments.length>2&&!0===arguments[2];if(!S&&0===d)return 0;for(var U=!1;;)switch(l){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return B(s).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return D(s).length;default:if(U)return S?-1:B(s).length;l=(""+l).toLowerCase(),U=!0}}function O(s,l,d){var S=s[l];s[l]=s[d],s[d]=S}function L(s,l,d,S,U){if(0===s.length)return-1;if("string"==typeof d?(S=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),ee(d=+d)&&(d=U?0:s.length-1),d<0&&(d=s.length+d),d>=s.length){if(U)return-1;d=s.length-1}else if(d<0){if(!U)return-1;d=0}if("string"==typeof l&&(l=p.from(l,S)),p.isBuffer(l))return 0===l.length?-1:k(s,l,d,S,U);if("number"==typeof l)return l&=255,"function"==typeof Uint8Array.prototype.indexOf?U?Uint8Array.prototype.indexOf.call(s,l,d):Uint8Array.prototype.lastIndexOf.call(s,l,d):k(s,[l],d,S,U);throw new TypeError("val must be string, number or Buffer")}function k(s,l,d,S,U){var Z,K=1,le=s.length,se=l.length;if(void 0!==S&&("ucs2"===(S=String(S).toLowerCase())||"ucs-2"===S||"utf16le"===S||"utf-16le"===S)){if(s.length<2||l.length<2)return-1;K=2,le/=2,se/=2,d/=2}function he(De,xe){return 1===K?De[xe]:De.readUInt16BE(xe*K)}if(U){var pe=-1;for(Z=d;Z<le;Z++)if(he(s,Z)===he(l,-1===pe?0:Z-pe)){if(-1===pe&&(pe=Z),Z-pe+1===se)return pe*K}else-1!==pe&&(Z-=Z-pe),pe=-1}else for(d+se>le&&(d=le-se),Z=d;Z>=0;Z--){for(var Ue=!0,Be=0;Be<se;Be++)if(he(s,Z+Be)!==he(l,Be)){Ue=!1;break}if(Ue)return Z}return-1}function H(s,l,d,S){d=Number(d)||0;var U=s.length-d;S?(S=Number(S))>U&&(S=U):S=U;var Z=l.length;S>Z/2&&(S=Z/2);for(var K=0;K<S;++K){var le=parseInt(l.substr(2*K,2),16);if(ee(le))return K;s[d+K]=le}return K}function z(s,l,d,S){return $(B(l,s.length-d),s,d,S)}function A(s,l,d,S){return $(function(U){for(var Z=[],K=0;K<U.length;++K)Z.push(255&U.charCodeAt(K));return Z}(l),s,d,S)}function oe(s,l,d,S){return A(s,l,d,S)}function I(s,l,d,S){return $(D(l),s,d,S)}function R(s,l,d,S){return $(function(U,Z){for(var K,le,he=[],pe=0;pe<U.length&&!((Z-=2)<0);++pe)le=(K=U.charCodeAt(pe))>>8,he.push(K%256),he.push(le);return he}(l,s.length-d),s,d,S)}function F(s,l,d){return b.fromByteArray(0===l&&d===s.length?s:s.slice(l,d))}function W(s,l,d){d=Math.min(s.length,d);for(var S=[],U=l;U<d;){var Z,K,le,se,he=s[U],pe=null,Ue=he>239?4:he>223?3:he>191?2:1;if(U+Ue<=d)switch(Ue){case 1:he<128&&(pe=he);break;case 2:128==(192&(Z=s[U+1]))&&(se=(31&he)<<6|63&Z)>127&&(pe=se);break;case 3:K=s[U+2],128==(192&(Z=s[U+1]))&&128==(192&K)&&(se=(15&he)<<12|(63&Z)<<6|63&K)>2047&&(se<55296||se>57343)&&(pe=se);break;case 4:K=s[U+2],le=s[U+3],128==(192&(Z=s[U+1]))&&128==(192&K)&&128==(192&le)&&(se=(15&he)<<18|(63&Z)<<12|(63&K)<<6|63&le)>65535&&se<1114112&&(pe=se)}null===pe?(pe=65533,Ue=1):pe>65535&&(S.push((pe-=65536)>>>10&1023|55296),pe=56320|1023&pe),S.push(pe),U+=Ue}return function(Be){var De=Be.length;if(De<=E)return String.fromCharCode.apply(String,Be);for(var xe="",Te=0;Te<De;)xe+=String.fromCharCode.apply(String,Be.slice(Te,Te+=E));return xe}(S)}Q.kMaxLength=c,(p.TYPED_ARRAY_SUPPORT=function(){try{var s=new Uint8Array(1);return s.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===s.foo()}catch{return!1}}())||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&null!=Symbol.species&&p[Symbol.species]===p&&Object.defineProperty(p,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),p.poolSize=8192,p.from=function(s,l,d){return C(s,l,d)},p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,p.alloc=function(s,l,d){return U=l,Z=d,f(S=s),S<=0?h(S):void 0!==U?"string"==typeof Z?h(S).fill(U,Z):h(S).fill(U):h(S);var S,U,Z},p.allocUnsafe=function(s){return y(s)},p.allocUnsafeSlow=function(s){return y(s)},p.isBuffer=function(s){return null!=s&&!0===s._isBuffer&&s!==p.prototype},p.compare=function(s,l){if(ne(s,Uint8Array)&&(s=p.from(s,s.offset,s.byteLength)),ne(l,Uint8Array)&&(l=p.from(l,l.offset,l.byteLength)),!p.isBuffer(s)||!p.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===l)return 0;for(var d=s.length,S=l.length,U=0,Z=Math.min(d,S);U<Z;++U)if(s[U]!==l[U]){d=s[U],S=l[U];break}return d<S?-1:S<d?1:0},p.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(s,l){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(0===s.length)return p.alloc(0);var d;if(void 0===l)for(l=0,d=0;d<s.length;++d)l+=s[d].length;var S=p.allocUnsafe(l),U=0;for(d=0;d<s.length;++d){var Z=s[d];if(ne(Z,Uint8Array)&&(Z=p.from(Z)),!p.isBuffer(Z))throw new TypeError('"list" argument must be an Array of Buffers');Z.copy(S,U),U+=Z.length}return S},p.byteLength=u,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var s=this.length;if(s%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var l=0;l<s;l+=2)O(this,l,l+1);return this},p.prototype.swap32=function(){var s=this.length;if(s%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var l=0;l<s;l+=4)O(this,l,l+3),O(this,l+1,l+2);return this},p.prototype.swap64=function(){var s=this.length;if(s%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var l=0;l<s;l+=8)O(this,l,l+7),O(this,l+1,l+6),O(this,l+2,l+5),O(this,l+3,l+4);return this},p.prototype.toLocaleString=p.prototype.toString=function(){var s=this.length;return 0===s?"":0===arguments.length?W(this,0,s):function(l,d,S){var U=!1;if((void 0===d||d<0)&&(d=0),d>this.length||((void 0===S||S>this.length)&&(S=this.length),S<=0)||(S>>>=0)<=(d>>>=0))return"";for(l||(l="utf8");;)switch(l){case"hex":return ie(this,d,S);case"utf8":case"utf-8":return W(this,d,S);case"ascii":return V(this,d,S);case"latin1":case"binary":return q(this,d,S);case"base64":return F(this,d,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,d,S);default:if(U)throw new TypeError("Unknown encoding: "+l);l=(l+"").toLowerCase(),U=!0}}.apply(this,arguments)},p.prototype.equals=function(s){if(!p.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s||0===p.compare(this,s)},p.prototype.inspect=function(){var s="",l=Q.INSPECT_MAX_BYTES;return s=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(s+=" ... "),"<Buffer "+s+">"},p.prototype.compare=function(s,l,d,S,U){if(ne(s,Uint8Array)&&(s=p.from(s,s.offset,s.byteLength)),!p.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(void 0===l&&(l=0),void 0===d&&(d=s?s.length:0),void 0===S&&(S=0),void 0===U&&(U=this.length),l<0||d>s.length||S<0||U>this.length)throw new RangeError("out of range index");if(S>=U&&l>=d)return 0;if(S>=U)return-1;if(l>=d)return 1;if(this===s)return 0;for(var Z=(U>>>=0)-(S>>>=0),K=(d>>>=0)-(l>>>=0),le=Math.min(Z,K),se=this.slice(S,U),he=s.slice(l,d),pe=0;pe<le;++pe)if(se[pe]!==he[pe]){Z=se[pe],K=he[pe];break}return Z<K?-1:K<Z?1:0},p.prototype.includes=function(s,l,d){return-1!==this.indexOf(s,l,d)},p.prototype.indexOf=function(s,l,d){return L(this,s,l,d,!0)},p.prototype.lastIndexOf=function(s,l,d){return L(this,s,l,d,!1)},p.prototype.write=function(s,l,d,S){if(void 0===l)S="utf8",d=this.length,l=0;else if(void 0===d&&"string"==typeof l)S=l,d=this.length,l=0;else{if(!isFinite(l))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");l>>>=0,isFinite(d)?(d>>>=0,void 0===S&&(S="utf8")):(S=d,d=void 0)}var U=this.length-l;if((void 0===d||d>U)&&(d=U),s.length>0&&(d<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");for(var Z=!1;;)switch(S){case"hex":return H(this,s,l,d);case"utf8":case"utf-8":return z(this,s,l,d);case"ascii":return A(this,s,l,d);case"latin1":case"binary":return oe(this,s,l,d);case"base64":return I(this,s,l,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,s,l,d);default:if(Z)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase(),Z=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function V(s,l,d){var S="";d=Math.min(s.length,d);for(var U=l;U<d;++U)S+=String.fromCharCode(127&s[U]);return S}function q(s,l,d){var S="";d=Math.min(s.length,d);for(var U=l;U<d;++U)S+=String.fromCharCode(s[U]);return S}function ie(s,l,d){var S=s.length;(!l||l<0)&&(l=0),(!d||d<0||d>S)&&(d=S);for(var U="",Z=l;Z<d;++Z)U+=w(s[Z]);return U}function re(s,l,d){for(var S=s.slice(l,d),U="",Z=0;Z<S.length;Z+=2)U+=String.fromCharCode(S[Z]+256*S[Z+1]);return U}function te(s,l,d){if(s%1!=0||s<0)throw new RangeError("offset is not uint");if(s+l>d)throw new RangeError("Trying to access beyond buffer length")}function j(s,l,d,S,U,Z){if(!p.isBuffer(s))throw new TypeError('"buffer" argument must be a Buffer instance');if(l>U||l<Z)throw new RangeError('"value" argument is out of bounds');if(d+S>s.length)throw new RangeError("Index out of range")}function N(s,l,d,S,U,Z){if(d+S>s.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("Index out of range")}function G(s,l,d,S,U){return l=+l,d>>>=0,U||N(s,0,d,4),_.write(s,l,d,S,23,4),d+4}function J(s,l,d,S,U){return l=+l,d>>>=0,U||N(s,0,d,8),_.write(s,l,d,S,52,8),d+8}p.prototype.slice=function(s,l){var d=this.length;(s=~~s)<0?(s+=d)<0&&(s=0):s>d&&(s=d),(l=void 0===l?d:~~l)<0?(l+=d)<0&&(l=0):l>d&&(l=d),l<s&&(l=s);var S=this.subarray(s,l);return S.__proto__=p.prototype,S},p.prototype.readUIntLE=function(s,l,d){s>>>=0,l>>>=0,d||te(s,l,this.length);for(var S=this[s],U=1,Z=0;++Z<l&&(U*=256);)S+=this[s+Z]*U;return S},p.prototype.readUIntBE=function(s,l,d){s>>>=0,l>>>=0,d||te(s,l,this.length);for(var S=this[s+--l],U=1;l>0&&(U*=256);)S+=this[s+--l]*U;return S},p.prototype.readUInt8=function(s,l){return s>>>=0,l||te(s,1,this.length),this[s]},p.prototype.readUInt16LE=function(s,l){return s>>>=0,l||te(s,2,this.length),this[s]|this[s+1]<<8},p.prototype.readUInt16BE=function(s,l){return s>>>=0,l||te(s,2,this.length),this[s]<<8|this[s+1]},p.prototype.readUInt32LE=function(s,l){return s>>>=0,l||te(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+16777216*this[s+3]},p.prototype.readUInt32BE=function(s,l){return s>>>=0,l||te(s,4,this.length),16777216*this[s]+(this[s+1]<<16|this[s+2]<<8|this[s+3])},p.prototype.readIntLE=function(s,l,d){s>>>=0,l>>>=0,d||te(s,l,this.length);for(var S=this[s],U=1,Z=0;++Z<l&&(U*=256);)S+=this[s+Z]*U;return S>=(U*=128)&&(S-=Math.pow(2,8*l)),S},p.prototype.readIntBE=function(s,l,d){s>>>=0,l>>>=0,d||te(s,l,this.length);for(var S=l,U=1,Z=this[s+--S];S>0&&(U*=256);)Z+=this[s+--S]*U;return Z>=(U*=128)&&(Z-=Math.pow(2,8*l)),Z},p.prototype.readInt8=function(s,l){return s>>>=0,l||te(s,1,this.length),128&this[s]?-1*(255-this[s]+1):this[s]},p.prototype.readInt16LE=function(s,l){s>>>=0,l||te(s,2,this.length);var d=this[s]|this[s+1]<<8;return 32768&d?4294901760|d:d},p.prototype.readInt16BE=function(s,l){s>>>=0,l||te(s,2,this.length);var d=this[s+1]|this[s]<<8;return 32768&d?4294901760|d:d},p.prototype.readInt32LE=function(s,l){return s>>>=0,l||te(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},p.prototype.readInt32BE=function(s,l){return s>>>=0,l||te(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},p.prototype.readFloatLE=function(s,l){return s>>>=0,l||te(s,4,this.length),_.read(this,s,!0,23,4)},p.prototype.readFloatBE=function(s,l){return s>>>=0,l||te(s,4,this.length),_.read(this,s,!1,23,4)},p.prototype.readDoubleLE=function(s,l){return s>>>=0,l||te(s,8,this.length),_.read(this,s,!0,52,8)},p.prototype.readDoubleBE=function(s,l){return s>>>=0,l||te(s,8,this.length),_.read(this,s,!1,52,8)},p.prototype.writeUIntLE=function(s,l,d,S){s=+s,l>>>=0,d>>>=0,S||j(this,s,l,d,Math.pow(2,8*d)-1,0);var U=1,Z=0;for(this[l]=255&s;++Z<d&&(U*=256);)this[l+Z]=s/U&255;return l+d},p.prototype.writeUIntBE=function(s,l,d,S){s=+s,l>>>=0,d>>>=0,S||j(this,s,l,d,Math.pow(2,8*d)-1,0);var U=d-1,Z=1;for(this[l+U]=255&s;--U>=0&&(Z*=256);)this[l+U]=s/Z&255;return l+d},p.prototype.writeUInt8=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,1,255,0),this[l]=255&s,l+1},p.prototype.writeUInt16LE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,2,65535,0),this[l]=255&s,this[l+1]=s>>>8,l+2},p.prototype.writeUInt16BE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,2,65535,0),this[l]=s>>>8,this[l+1]=255&s,l+2},p.prototype.writeUInt32LE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,4,4294967295,0),this[l+3]=s>>>24,this[l+2]=s>>>16,this[l+1]=s>>>8,this[l]=255&s,l+4},p.prototype.writeUInt32BE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,4,4294967295,0),this[l]=s>>>24,this[l+1]=s>>>16,this[l+2]=s>>>8,this[l+3]=255&s,l+4},p.prototype.writeIntLE=function(s,l,d,S){if(s=+s,l>>>=0,!S){var U=Math.pow(2,8*d-1);j(this,s,l,d,U-1,-U)}var Z=0,K=1,le=0;for(this[l]=255&s;++Z<d&&(K*=256);)s<0&&0===le&&0!==this[l+Z-1]&&(le=1),this[l+Z]=(s/K>>0)-le&255;return l+d},p.prototype.writeIntBE=function(s,l,d,S){if(s=+s,l>>>=0,!S){var U=Math.pow(2,8*d-1);j(this,s,l,d,U-1,-U)}var Z=d-1,K=1,le=0;for(this[l+Z]=255&s;--Z>=0&&(K*=256);)s<0&&0===le&&0!==this[l+Z+1]&&(le=1),this[l+Z]=(s/K>>0)-le&255;return l+d},p.prototype.writeInt8=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,1,127,-128),s<0&&(s=255+s+1),this[l]=255&s,l+1},p.prototype.writeInt16LE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,2,32767,-32768),this[l]=255&s,this[l+1]=s>>>8,l+2},p.prototype.writeInt16BE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,2,32767,-32768),this[l]=s>>>8,this[l+1]=255&s,l+2},p.prototype.writeInt32LE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,4,2147483647,-2147483648),this[l]=255&s,this[l+1]=s>>>8,this[l+2]=s>>>16,this[l+3]=s>>>24,l+4},p.prototype.writeInt32BE=function(s,l,d){return s=+s,l>>>=0,d||j(this,s,l,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[l]=s>>>24,this[l+1]=s>>>16,this[l+2]=s>>>8,this[l+3]=255&s,l+4},p.prototype.writeFloatLE=function(s,l,d){return G(this,s,l,!0,d)},p.prototype.writeFloatBE=function(s,l,d){return G(this,s,l,!1,d)},p.prototype.writeDoubleLE=function(s,l,d){return J(this,s,l,!0,d)},p.prototype.writeDoubleBE=function(s,l,d){return J(this,s,l,!1,d)},p.prototype.copy=function(s,l,d,S){if(!p.isBuffer(s))throw new TypeError("argument should be a Buffer");if(d||(d=0),S||0===S||(S=this.length),l>=s.length&&(l=s.length),l||(l=0),S>0&&S<d&&(S=d),S===d||0===s.length||0===this.length)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length),s.length-l<S-d&&(S=s.length-l+d);var U=S-d;if(this===s&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(l,d,S);else if(this===s&&d<l&&l<S)for(var Z=U-1;Z>=0;--Z)s[Z+l]=this[Z+d];else Uint8Array.prototype.set.call(s,this.subarray(d,S),l);return U},p.prototype.fill=function(s,l,d,S){if("string"==typeof s){if("string"==typeof l?(S=l,l=0,d=this.length):"string"==typeof d&&(S=d,d=this.length),void 0!==S&&"string"!=typeof S)throw new TypeError("encoding must be a string");if("string"==typeof S&&!p.isEncoding(S))throw new TypeError("Unknown encoding: "+S);if(1===s.length){var U=s.charCodeAt(0);("utf8"===S&&U<128||"latin1"===S)&&(s=U)}}else"number"==typeof s&&(s&=255);if(l<0||this.length<l||this.length<d)throw new RangeError("Out of range index");if(d<=l)return this;var Z;if(l>>>=0,d=void 0===d?this.length:d>>>0,s||(s=0),"number"==typeof s)for(Z=l;Z<d;++Z)this[Z]=s;else{var K=p.isBuffer(s)?s:p.from(s,S),le=K.length;if(0===le)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(Z=0;Z<d-l;++Z)this[Z+l]=K[Z%le]}return this};var m=/[^+/0-9A-Za-z-_]/g;function w(s){return s<16?"0"+s.toString(16):s.toString(16)}function B(s,l){var d;l=l||1/0;for(var S=s.length,U=null,Z=[],K=0;K<S;++K){if((d=s.charCodeAt(K))>55295&&d<57344){if(!U){if(d>56319){(l-=3)>-1&&Z.push(239,191,189);continue}if(K+1===S){(l-=3)>-1&&Z.push(239,191,189);continue}U=d;continue}if(d<56320){(l-=3)>-1&&Z.push(239,191,189),U=d;continue}d=65536+(U-55296<<10|d-56320)}else U&&(l-=3)>-1&&Z.push(239,191,189);if(U=null,d<128){if((l-=1)<0)break;Z.push(d)}else if(d<2048){if((l-=2)<0)break;Z.push(d>>6|192,63&d|128)}else if(d<65536){if((l-=3)<0)break;Z.push(d>>12|224,d>>6&63|128,63&d|128)}else{if(!(d<1114112))throw new Error("Invalid code point");if((l-=4)<0)break;Z.push(d>>18|240,d>>12&63|128,d>>6&63|128,63&d|128)}}return Z}function D(s){return b.toByteArray(function(l){if((l=(l=l.split("=")[0]).trim().replace(m,"")).length<2)return"";for(;l.length%4!=0;)l+="=";return l}(s))}function $(s,l,d,S){for(var U=0;U<S&&!(U+d>=l.length||U>=s.length);++U)l[U+d]=s[U];return U}function ne(s,l){return s instanceof l||null!=s&&null!=s.constructor&&null!=s.constructor.name&&s.constructor.name===l.name}function ee(s){return s!=s}}).call(this,T("buffer").Buffer)},{"base64-js":10,buffer:12,ieee754:28}],13:[function(T,t,Q){(function(x){function b(_){return Object.prototype.toString.call(_)}Q.isArray=function(_){return Array.isArray?Array.isArray(_):"[object Array]"===b(_)},Q.isBoolean=function(_){return"boolean"==typeof _},Q.isNull=function(_){return null===_},Q.isNullOrUndefined=function(_){return null==_},Q.isNumber=function(_){return"number"==typeof _},Q.isString=function(_){return"string"==typeof _},Q.isSymbol=function(_){return"symbol"==typeof _},Q.isUndefined=function(_){return void 0===_},Q.isRegExp=function(_){return"[object RegExp]"===b(_)},Q.isObject=function(_){return"object"==typeof _&&null!==_},Q.isDate=function(_){return"[object Date]"===b(_)},Q.isError=function(_){return"[object Error]"===b(_)||_ instanceof Error},Q.isFunction=function(_){return"function"==typeof _},Q.isPrimitive=function(_){return null===_||"boolean"==typeof _||"number"==typeof _||"string"==typeof _||"symbol"==typeof _||void 0===_},Q.isBuffer=x.isBuffer}).call(this,{isBuffer:T("../../is-buffer/index.js")})},{"../../is-buffer/index.js":30}],14:[function(T,t,Q){(function(x){Q.log=function(..._){return"object"==typeof console&&console.log&&console.log(..._)},Q.formatArgs=function(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;_.splice(1,0,c,"color: inherit");let h=0,p=0;_[0].replace(/%[a-zA-Z%]/g,C=>{"%%"!==C&&"%c"===C&&(p=++h)}),_.splice(p,0,c)},Q.save=function(_){try{_?Q.storage.setItem("debug",_):Q.storage.removeItem("debug")}catch{}},Q.load=function(){let _;try{_=Q.storage.getItem("debug")}catch{}return!_&&void 0!==x&&"env"in x&&(_=x.env.DEBUG),_},Q.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},Q.storage=function(){try{return localStorage}catch{}}(),Q.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=T("./common")(Q);const{formatters:b}=t.exports;b.j=function(_){try{return JSON.stringify(_)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}}).call(this,T("_process"))},{"./common":15,_process:44}],15:[function(T,t,Q){t.exports=function(x){function b(C){let f=0;for(let y=0;y<C.length;y++)f=(f<<5)-f+C.charCodeAt(y),f|=0;return _.colors[Math.abs(f)%_.colors.length]}function _(C){let f;function y(...M){if(!y.enabled)return;const g=y,u=Number(new Date);g.diff=u-(f||u),g.prev=f,g.curr=u,f=u,M[0]=_.coerce(M[0]),"string"!=typeof M[0]&&M.unshift("%O");let L=0;M[0]=M[0].replace(/%([a-zA-Z%])/g,(k,H)=>{if("%%"===k)return k;L++;const z=_.formatters[H];return"function"==typeof z&&(k=z.call(g,M[L]),M.splice(L,1),L--),k}),_.formatArgs.call(g,M),(g.log||_.log).apply(g,M)}return y.namespace=C,y.enabled=_.enabled(C),y.useColors=_.useColors(),y.color=b(C),y.destroy=c,y.extend=h,"function"==typeof _.init&&_.init(y),_.instances.push(y),y}function c(){const C=_.instances.indexOf(this);return-1!==C&&(_.instances.splice(C,1),!0)}function h(C,f){const y=_(this.namespace+(void 0===f?":":f)+C);return y.log=this.log,y}function p(C){return C.toString().substring(2,C.toString().length-2).replace(/\.\*\?$/,"*")}return _.debug=_,_.default=_,_.coerce=function(C){return C instanceof Error?C.stack||C.message:C},_.disable=function(){const C=[..._.names.map(p),..._.skips.map(p).map(f=>"-"+f)].join(",");return _.enable(""),C},_.enable=function(C){let f;_.save(C),_.names=[],_.skips=[];const y=("string"==typeof C?C:"").split(/[\s,]+/),M=y.length;for(f=0;f<M;f++)y[f]&&("-"===(C=y[f].replace(/\*/g,".*?"))[0]?_.skips.push(new RegExp("^"+C.substr(1)+"$")):_.names.push(new RegExp("^"+C+"$")));for(f=0;f<_.instances.length;f++){const g=_.instances[f];g.enabled=_.enabled(g.namespace)}},_.enabled=function(C){if("*"===C[C.length-1])return!0;let f,y;for(f=0,y=_.skips.length;f<y;f++)if(_.skips[f].test(C))return!1;for(f=0,y=_.names.length;f<y;f++)if(_.names[f].test(C))return!0;return!1},_.humanize=T("ms"),Object.keys(x).forEach(C=>{_[C]=x[C]}),_.instances=[],_.names=[],_.skips=[],_.formatters={},_.selectColor=b,_.enable(_.load()),_}},{ms:41}],16:[function(T,t,Q){(function(x,b){var _=T("readable-stream"),c=T("end-of-stream"),h=T("inherits"),p=T("stream-shift"),C=b.from&&b.from!==Uint8Array.from?b.from([0]):new b([0]),f=function(g,u){g._corked?g.once("uncork",u):u()},y=function(g,u){return function(O){var L;O?(L=g)._autoDestroy&&L.destroy("premature close"===O.message?null:O):u&&!g._ended&&g.end()}},M=function(g,u,O){if(!(this instanceof M))return new M(g,u,O);_.Duplex.call(this,O),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!O||!1!==O.autoDestroy,this._forwardDestroy=!O||!1!==O.destroy,this._forwardEnd=!O||!1!==O.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,g&&this.setWritable(g),u&&this.setReadable(u)};h(M,_.Duplex),M.obj=function(g,u,O){return O||(O={}),O.objectMode=!0,O.highWaterMark=16,new M(g,u,O)},M.prototype.cork=function(){1==++this._corked&&this.emit("cork")},M.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},M.prototype.setWritable=function(g){if(this._unwrite&&this._unwrite(),this.destroyed)g&&g.destroy&&g.destroy();else if(null!==g&&!1!==g){var u=this,O=c(g,{writable:!0,readable:!1},y(this,this._forwardEnd)),L=function(){var k=u._ondrain;u._ondrain=null,k&&k()};this._unwrite&&x.nextTick(L),this._writable=g,this._writable.on("drain",L),this._unwrite=function(){u._writable.removeListener("drain",L),O()},this.uncork()}else this.end()},M.prototype.setReadable=function(g){if(this._unread&&this._unread(),this.destroyed)g&&g.destroy&&g.destroy();else{if(null===g||!1===g)return this.push(null),void this.resume();var u,O=this,L=c(g,{writable:!1,readable:!0},y(this)),k=function(){O._forward()},H=function(){O.push(null)};this._drained=!0,this._readable=g,this._readable2=g._readableState?g:(u=g,new _.Readable({objectMode:!0,highWaterMark:16}).wrap(u)),this._readable2.on("readable",k),this._readable2.on("end",H),this._unread=function(){O._readable2.removeListener("readable",k),O._readable2.removeListener("end",H),L()},this._forward()}},M.prototype._read=function(){this._drained=!0,this._forward()},M.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var g;for(this._forwarding=!0;this._drained&&null!==(g=p(this._readable2));)this.destroyed||(this._drained=this.push(g));this._forwarding=!1}},M.prototype.destroy=function(g){if(!this.destroyed){this.destroyed=!0;var u=this;x.nextTick(function(){u._destroy(g)})}},M.prototype._destroy=function(g){if(g){var u=this._ondrain;this._ondrain=null,u?u(g):this.emit("error",g)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},M.prototype._write=function(g,u,O){return this.destroyed?O():this._corked?f(this,this._write.bind(this,g,u,O)):g===C?this._finish(O):this._writable?void(!1===this._writable.write(g)?this._ondrain=O:O()):O()},M.prototype._finish=function(g){var u=this;this.emit("preend"),f(this,function(){var O,L;L=function(){!1===u._writableState.prefinished&&(u._writableState.prefinished=!0),u.emit("prefinish"),f(u,g)},(O=u._forwardEnd&&u._writable)?O._writableState&&O._writableState.finished?L():O._writableState?O.end(L):(O.end(),L()):L()})},M.prototype.end=function(g,u,O){return"function"==typeof g?this.end(null,null,g):"function"==typeof u?this.end(g,null,u):(this._ended=!0,g&&this.write(g),this._writableState.ending||this.write(C),_.Writable.prototype.end.call(this,O))},t.exports=M}).call(this,T("_process"),T("buffer").Buffer)},{_process:44,buffer:12,"end-of-stream":26,inherits:29,"readable-stream":25,"stream-shift":66}],17:[function(T,t,Q){"use strict";var x=T("process-nextick-args"),b=Object.keys||function(u){var O=[];for(var L in u)O.push(L);return O};t.exports=y;var _=Object.create(T("core-util-is"));_.inherits=T("inherits");var c=T("./_stream_readable"),h=T("./_stream_writable");_.inherits(y,c);for(var p=b(h.prototype),C=0;C<p.length;C++){var f=p[C];y.prototype[f]||(y.prototype[f]=h.prototype[f])}function y(u){if(!(this instanceof y))return new y(u);c.call(this,u),h.call(this,u),u&&!1===u.readable&&(this.readable=!1),u&&!1===u.writable&&(this.writable=!1),this.allowHalfOpen=!0,u&&!1===u.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",M)}function M(){this.allowHalfOpen||this._writableState.ended||x.nextTick(g,this)}function g(u){u.end()}Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(u){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),y.prototype._destroy=function(u,O){this.push(null),this.end(),x.nextTick(O,u)}},{"./_stream_readable":19,"./_stream_writable":21,"core-util-is":13,inherits:29,"process-nextick-args":43}],18:[function(T,t,Q){"use strict";t.exports=_;var x=T("./_stream_transform"),b=Object.create(T("core-util-is"));function _(c){if(!(this instanceof _))return new _(c);x.call(this,c)}b.inherits=T("inherits"),b.inherits(_,x),_.prototype._transform=function(c,h,p){p(null,c)}},{"./_stream_transform":20,"core-util-is":13,inherits:29}],19:[function(T,t,Q){(function(x,b){"use strict";var _=T("process-nextick-args");t.exports=A;var c,h=T("isarray");A.ReadableState=z,T("events");var p=function(m,w){return m.listeners(w).length},C=T("./internal/streams/stream"),f=T("safe-buffer").Buffer,y=b.Uint8Array||function(){},M=Object.create(T("core-util-is"));M.inherits=T("inherits");var g=T("util"),u=void 0;u=g&&g.debuglog?g.debuglog("stream"):function(){};var O,L=T("./internal/streams/BufferList"),k=T("./internal/streams/destroy");M.inherits(A,C);var H=["error","close","destroy","pause","resume"];function z(m,w){var B=w instanceof(c=c||T("./_stream_duplex"));this.objectMode=!!(m=m||{}).objectMode,B&&(this.objectMode=this.objectMode||!!m.readableObjectMode);var D=m.highWaterMark,$=m.readableHighWaterMark;this.highWaterMark=D||0===D?D:B&&($||0===$)?$:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new L,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=m.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,m.encoding&&(O||(O=T("string_decoder/").StringDecoder),this.decoder=new O(m.encoding),this.encoding=m.encoding)}function A(m){if(c=c||T("./_stream_duplex"),!(this instanceof A))return new A(m);this._readableState=new z(m,this),this.readable=!0,m&&("function"==typeof m.read&&(this._read=m.read),"function"==typeof m.destroy&&(this._destroy=m.destroy)),C.call(this)}function oe(m,w,B,D,$){var ne,s,l,d,S,ee=m._readableState;return null===w?(ee.reading=!1,function(s,l){if(!l.ended){if(l.decoder){var d=l.decoder.end();d&&d.length&&(l.buffer.push(d),l.length+=l.objectMode?1:d.length)}l.ended=!0,W(s)}}(m,ee)):($||(s=ee,f.isBuffer(S=l=w)||S instanceof y||"string"==typeof l||void 0===l||s.objectMode||(d=new TypeError("Invalid non-string/buffer chunk")),ne=d),ne?m.emit("error",ne):ee.objectMode||w&&w.length>0?("string"==typeof w||ee.objectMode||Object.getPrototypeOf(w)===f.prototype||(w=function(s){return f.from(s)}(w)),D?ee.endEmitted?m.emit("error",new Error("stream.unshift() after end event")):I(m,ee,w,!0):ee.ended?m.emit("error",new Error("stream.push() after EOF")):(ee.reading=!1,ee.decoder&&!B?(w=ee.decoder.write(w),ee.objectMode||0!==w.length?I(m,ee,w,!1):V(m,ee)):I(m,ee,w,!1))):D||(ee.reading=!1)),function(s){return!s.ended&&(s.needReadable||s.length<s.highWaterMark||0===s.length)}(ee)}function I(m,w,B,D){w.flowing&&0===w.length&&!w.sync?(m.emit("data",B),m.read(0)):(w.length+=w.objectMode?1:B.length,D?w.buffer.unshift(B):w.buffer.push(B),w.needReadable&&W(m)),V(m,w)}Object.defineProperty(A.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(m){this._readableState&&(this._readableState.destroyed=m)}}),A.prototype.destroy=k.destroy,A.prototype._undestroy=k.undestroy,A.prototype._destroy=function(m,w){this.push(null),w(m)},A.prototype.push=function(m,w){var B,D=this._readableState;return D.objectMode?B=!0:"string"==typeof m&&((w=w||D.defaultEncoding)!==D.encoding&&(m=f.from(m,w),w=""),B=!0),oe(this,m,w,!1,B)},A.prototype.unshift=function(m){return oe(this,m,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(m){return O||(O=T("string_decoder/").StringDecoder),this._readableState.decoder=new O(m),this._readableState.encoding=m,this};var R=8388608;function F(m,w){return m<=0||0===w.length&&w.ended?0:w.objectMode?1:m!=m?w.flowing&&w.length?w.buffer.head.data.length:w.length:(m>w.highWaterMark&&(w.highWaterMark=((B=m)>=R?B=R:(B--,B|=B>>>1,B|=B>>>2,B|=B>>>4,B|=B>>>8,B|=B>>>16,B++),B)),m<=w.length?m:w.ended?w.length:(w.needReadable=!0,0));var B}function W(m){var w=m._readableState;w.needReadable=!1,w.emittedReadable||(u("emitReadable",w.flowing),w.emittedReadable=!0,w.sync?_.nextTick(E,m):E(m))}function E(m){u("emit readable"),m.emit("readable"),te(m)}function V(m,w){w.readingMore||(w.readingMore=!0,_.nextTick(q,m,w))}function q(m,w){for(var B=w.length;!w.reading&&!w.flowing&&!w.ended&&w.length<w.highWaterMark&&(u("maybeReadMore read 0"),m.read(0),B!==w.length);)B=w.length;w.readingMore=!1}function ie(m){u("readable nexttick read 0"),m.read(0)}function re(m,w){w.reading||(u("resume read 0"),m.read(0)),w.resumeScheduled=!1,w.awaitDrain=0,m.emit("resume"),te(m),w.flowing&&!w.reading&&m.read(0)}function te(m){var w=m._readableState;for(u("flow",w.flowing);w.flowing&&null!==m.read(););}function j(m,w){return 0===w.length?null:(w.objectMode?B=w.buffer.shift():!m||m>=w.length?(B=w.decoder?w.buffer.join(""):1===w.buffer.length?w.buffer.head.data:w.buffer.concat(w.length),w.buffer.clear()):(ne=w.decoder,(D=m)<($=w.buffer).head.data.length?(ee=$.head.data.slice(0,D),$.head.data=$.head.data.slice(D)):ee=D===$.head.data.length?$.shift():ne?function(s,l){var d=l.head,S=1,U=d.data;for(s-=U.length;d=d.next;){var Z=d.data,K=s>Z.length?Z.length:s;if(U+=K===Z.length?Z:Z.slice(0,s),0==(s-=K)){K===Z.length?(++S,l.head=d.next?d.next:l.tail=null):(l.head=d,d.data=Z.slice(K));break}++S}return l.length-=S,U}(D,$):function(s,l){var d=f.allocUnsafe(s),S=l.head,U=1;for(S.data.copy(d),s-=S.data.length;S=S.next;){var Z=S.data,K=s>Z.length?Z.length:s;if(Z.copy(d,d.length-s,0,K),0==(s-=K)){K===Z.length?(++U,l.head=S.next?S.next:l.tail=null):(l.head=S,S.data=Z.slice(K));break}++U}return l.length-=U,d}(D,$),B=ee),B);var D,$,ne,ee,B}function N(m){var w=m._readableState;if(w.length>0)throw new Error('"endReadable()" called on non-empty stream');w.endEmitted||(w.ended=!0,_.nextTick(G,w,m))}function G(m,w){m.endEmitted||0!==m.length||(m.endEmitted=!0,w.readable=!1,w.emit("end"))}function J(m,w){for(var B=0,D=m.length;B<D;B++)if(m[B]===w)return B;return-1}A.prototype.read=function(m){u("read",m),m=parseInt(m,10);var w=this._readableState,B=m;if(0!==m&&(w.emittedReadable=!1),0===m&&w.needReadable&&(w.length>=w.highWaterMark||w.ended))return u("read: emitReadable",w.length,w.ended),0===w.length&&w.ended?N(this):W(this),null;if(0===(m=F(m,w))&&w.ended)return 0===w.length&&N(this),null;var D,$=w.needReadable;return u("need readable",$),(0===w.length||w.length-m<w.highWaterMark)&&u("length less than watermark",$=!0),w.ended||w.reading?u("reading or ended",$=!1):$&&(u("do read"),w.reading=!0,w.sync=!0,0===w.length&&(w.needReadable=!0),this._read(w.highWaterMark),w.sync=!1,w.reading||(m=F(B,w))),null===(D=m>0?j(m,w):null)?(w.needReadable=!0,m=0):w.length-=m,0===w.length&&(w.ended||(w.needReadable=!0),B!==m&&w.ended&&N(this)),null!==D&&this.emit("data",D),D},A.prototype._read=function(m){this.emit("error",new Error("_read() is not implemented"))},A.prototype.pipe=function(m,w){var B=this,D=this._readableState;switch(D.pipesCount){case 0:D.pipes=m;break;case 1:D.pipes=[D.pipes,m];break;default:D.pipes.push(m)}D.pipesCount+=1,u("pipe count=%d opts=%j",D.pipesCount,w);var $=w&&!1===w.end||m===x.stdout||m===x.stderr?le:ee;function ee(){u("onend"),m.end()}D.endEmitted?_.nextTick($):B.once("end",$),m.on("unpipe",function ne(se,he){u("onunpipe"),se===B&&he&&!1===he.hasUnpiped&&(he.hasUnpiped=!0,u("cleanup"),m.removeListener("close",Z),m.removeListener("finish",K),m.removeListener("drain",s),m.removeListener("error",U),m.removeListener("unpipe",ne),B.removeListener("end",ee),B.removeListener("end",le),B.removeListener("data",S),l=!0,!D.awaitDrain||m._writableState&&!m._writableState.needDrain||s())});var se,s=(se=B,function(){var he=se._readableState;u("pipeOnDrain",he.awaitDrain),he.awaitDrain&&he.awaitDrain--,0===he.awaitDrain&&p(se,"data")&&(he.flowing=!0,te(se))});m.on("drain",s);var l=!1,d=!1;function S(se){u("ondata"),d=!1,!1!==m.write(se)||d||((1===D.pipesCount&&D.pipes===m||D.pipesCount>1&&-1!==J(D.pipes,m))&&!l&&(u("false write response, pause",B._readableState.awaitDrain),B._readableState.awaitDrain++,d=!0),B.pause())}function U(se){u("onerror",se),le(),m.removeListener("error",U),0===p(m,"error")&&m.emit("error",se)}function Z(){m.removeListener("finish",K),le()}function K(){u("onfinish"),m.removeListener("close",Z),le()}function le(){u("unpipe"),B.unpipe(m)}return B.on("data",S),function(se,he,pe){if("function"==typeof se.prependListener)return se.prependListener(he,pe);se._events&&se._events[he]?h(se._events[he])?se._events[he].unshift(pe):se._events[he]=[pe,se._events[he]]:se.on(he,pe)}(m,"error",U),m.once("close",Z),m.once("finish",K),m.emit("pipe",B),D.flowing||(u("pipe resume"),B.resume()),m},A.prototype.unpipe=function(m){var w=this._readableState,B={hasUnpiped:!1};if(0===w.pipesCount)return this;if(1===w.pipesCount)return m&&m!==w.pipes||(m||(m=w.pipes),w.pipes=null,w.pipesCount=0,w.flowing=!1,m&&m.emit("unpipe",this,B)),this;if(!m){var D=w.pipes,$=w.pipesCount;w.pipes=null,w.pipesCount=0,w.flowing=!1;for(var ne=0;ne<$;ne++)D[ne].emit("unpipe",this,B);return this}var ee=J(w.pipes,m);return-1===ee||(w.pipes.splice(ee,1),w.pipesCount-=1,1===w.pipesCount&&(w.pipes=w.pipes[0]),m.emit("unpipe",this,B)),this},A.prototype.addListener=A.prototype.on=function(m,w){var B=C.prototype.on.call(this,m,w);if("data"===m)!1!==this._readableState.flowing&&this.resume();else if("readable"===m){var D=this._readableState;D.endEmitted||D.readableListening||(D.readableListening=D.needReadable=!0,D.emittedReadable=!1,D.reading?D.length&&W(this):_.nextTick(ie,this))}return B},A.prototype.resume=function(){var B,m=this._readableState;return m.flowing||(u("resume"),m.flowing=!0,this,(B=m).resumeScheduled||(B.resumeScheduled=!0,_.nextTick(re,this,B))),this},A.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this},A.prototype.wrap=function(m){var w=this,B=this._readableState,D=!1;for(var $ in m.on("end",function(){if(u("wrapped end"),B.decoder&&!B.ended){var ee=B.decoder.end();ee&&ee.length&&w.push(ee)}w.push(null)}),m.on("data",function(ee){u("wrapped data"),B.decoder&&(ee=B.decoder.write(ee)),(!B.objectMode||null!=ee)&&(B.objectMode||ee&&ee.length)&&(w.push(ee)||(D=!0,m.pause()))}),m)void 0===this[$]&&"function"==typeof m[$]&&(this[$]=function(ee){return function(){return m[ee].apply(m,arguments)}}($));for(var ne=0;ne<H.length;ne++)m.on(H[ne],this.emit.bind(this,H[ne]));return this._read=function(ee){u("wrapped _read",ee),D&&(D=!1,m.resume())},this},Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),A._fromList=j}).call(this,T("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":17,"./internal/streams/BufferList":22,"./internal/streams/destroy":23,"./internal/streams/stream":24,_process:44,"core-util-is":13,events:27,inherits:29,isarray:31,"process-nextick-args":43,"safe-buffer":65,"string_decoder/":67,util:11}],20:[function(T,t,Q){"use strict";t.exports=_;var x=T("./_stream_duplex"),b=Object.create(T("core-util-is"));function _(p){if(!(this instanceof _))return new _(p);x.call(this,p),this._transformState={afterTransform:function(C,f){var y=this._transformState;y.transforming=!1;var M=y.writecb;if(!M)return this.emit("error",new Error("write callback called multiple times"));y.writechunk=null,y.writecb=null,null!=f&&this.push(f),M(C);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&("function"==typeof p.transform&&(this._transform=p.transform),"function"==typeof p.flush&&(this._flush=p.flush)),this.on("prefinish",c)}function c(){var p=this;"function"==typeof this._flush?this._flush(function(C,f){h(p,C,f)}):h(this,null,null)}function h(p,C,f){if(C)return p.emit("error",C);if(null!=f&&p.push(f),p._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(p._transformState.transforming)throw new Error("Calling transform done when still transforming");return p.push(null)}b.inherits=T("inherits"),b.inherits(_,x),_.prototype.push=function(p,C){return this._transformState.needTransform=!1,x.prototype.push.call(this,p,C)},_.prototype._transform=function(p,C,f){throw new Error("_transform() is not implemented")},_.prototype._write=function(p,C,f){var y=this._transformState;if(y.writecb=f,y.writechunk=p,y.writeencoding=C,!y.transforming){var M=this._readableState;(y.needTransform||M.needReadable||M.length<M.highWaterMark)&&this._read(M.highWaterMark)}},_.prototype._read=function(p){var C=this._transformState;null!==C.writechunk&&C.writecb&&!C.transforming?(C.transforming=!0,this._transform(C.writechunk,C.writeencoding,C.afterTransform)):C.needTransform=!0},_.prototype._destroy=function(p,C){var f=this;x.prototype._destroy.call(this,p,function(y){C(y),f.emit("close")})}},{"./_stream_duplex":17,"core-util-is":13,inherits:29}],21:[function(T,t,Q){(function(x,b,_){"use strict";var c=T("process-nextick-args");function h(E){var V=this;this.next=null,this.entry=null,this.finish=function(){!function(q,ie,re){var te=q.entry;for(q.entry=null;te;){var j=te.callback;ie.pendingcb--,j(undefined),te=te.next}ie.corkedRequestsFree?ie.corkedRequestsFree.next=q:ie.corkedRequestsFree=q}(V,E)}}t.exports=z;var p,C=!x.browser&&["v0.10","v0.9."].indexOf(x.version.slice(0,5))>-1?_:c.nextTick;z.WritableState=H;var f=Object.create(T("core-util-is"));f.inherits=T("inherits");var O,y={deprecate:T("util-deprecate")},M=T("./internal/streams/stream"),g=T("safe-buffer").Buffer,u=b.Uint8Array||function(){},L=T("./internal/streams/destroy");function k(){}function H(E,V){p=p||T("./_stream_duplex");var q=V instanceof p;this.objectMode=!!(E=E||{}).objectMode,q&&(this.objectMode=this.objectMode||!!E.writableObjectMode);var ie=E.highWaterMark,re=E.writableHighWaterMark;this.highWaterMark=ie||0===ie?ie:q&&(re||0===re)?re:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===E.decodeStrings),this.defaultEncoding=E.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(N){!function(G,J){var $,m=G._writableState,w=m.sync,B=m.writecb;if(($=m).writing=!1,$.writecb=null,$.length-=$.writelen,$.writelen=0,J)!function($,ne,ee,s,l){--ne.pendingcb,ee?(c.nextTick(l,s),c.nextTick(W,$,ne),$._writableState.errorEmitted=!0,$.emit("error",s)):(l(s),$._writableState.errorEmitted=!0,$.emit("error",s),W($,ne))}(G,m,w,J,B);else{var D=R(m);D||m.corked||m.bufferProcessing||!m.bufferedRequest||I(G,m),w?C(oe,G,m,D,B):oe(G,m,D,B)}}(V,N)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function z(E){if(p=p||T("./_stream_duplex"),!(O.call(z,this)||this instanceof p))return new z(E);this._writableState=new H(E,this),this.writable=!0,E&&("function"==typeof E.write&&(this._write=E.write),"function"==typeof E.writev&&(this._writev=E.writev),"function"==typeof E.destroy&&(this._destroy=E.destroy),"function"==typeof E.final&&(this._final=E.final)),M.call(this)}function A(E,V,q,ie,re,te,j){V.writelen=ie,V.writecb=j,V.writing=!0,V.sync=!0,q?E._writev(re,V.onwrite):E._write(re,te,V.onwrite),V.sync=!1}function oe(E,V,q,ie){var re,te;q||(re=E,0===(te=V).length&&te.needDrain&&(te.needDrain=!1,re.emit("drain"))),V.pendingcb--,ie(),W(E,V)}function I(E,V){V.bufferProcessing=!0;var q=V.bufferedRequest;if(E._writev&&q&&q.next){var re=new Array(V.bufferedRequestCount),te=V.corkedRequestsFree;te.entry=q;for(var j=0,N=!0;q;)re[j]=q,q.isBuf||(N=!1),q=q.next,j+=1;re.allBuffers=N,A(E,V,!0,V.length,re,"",te.finish),V.pendingcb++,V.lastBufferedRequest=null,te.next?(V.corkedRequestsFree=te.next,te.next=null):V.corkedRequestsFree=new h(V),V.bufferedRequestCount=0}else{for(;q;){var G=q.chunk;if(A(E,V,!1,V.objectMode?1:G.length,G,q.encoding,q.callback),q=q.next,V.bufferedRequestCount--,V.writing)break}null===q&&(V.lastBufferedRequest=null)}V.bufferedRequest=q,V.bufferProcessing=!1}function R(E){return E.ending&&0===E.length&&null===E.bufferedRequest&&!E.finished&&!E.writing}function F(E,V){E._final(function(q){V.pendingcb--,q&&E.emit("error",q),V.prefinished=!0,E.emit("prefinish"),W(E,V)})}function W(E,V){var ie,re,q=R(V);return q&&(ie=E,(re=V).prefinished||re.finalCalled||("function"==typeof ie._final?(re.pendingcb++,re.finalCalled=!0,c.nextTick(F,ie,re)):(re.prefinished=!0,ie.emit("prefinish"))),0===V.pendingcb&&(V.finished=!0,E.emit("finish"))),q}f.inherits(z,M),H.prototype.getBuffer=function(){for(var E=this.bufferedRequest,V=[];E;)V.push(E),E=E.next;return V},function(){try{Object.defineProperty(H.prototype,"buffer",{get:y.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(z,Symbol.hasInstance,{value:function(E){return!!O.call(this,E)||this===z&&E&&E._writableState instanceof H}})):O=function(E){return E instanceof this},z.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},z.prototype.write=function(E,V,q){var ie,N,G,J,re=this._writableState,te=!1,j=!re.objectMode&&(g.isBuffer(ie=E)||ie instanceof u);return j&&!g.isBuffer(E)&&(E=g.from(E)),"function"==typeof V&&(q=V,V=null),j?V="buffer":V||(V=re.defaultEncoding),"function"!=typeof q&&(q=k),re.ended?(N=this,G=q,J=new Error("write after end"),N.emit("error",J),c.nextTick(G,J)):(j||function(N,G,J,m){var w=!0,B=!1;return null===J?B=new TypeError("May not write null values to stream"):"string"==typeof J||void 0===J||G.objectMode||(B=new TypeError("Invalid non-string/buffer chunk")),B&&(N.emit("error",B),c.nextTick(m,B),w=!1),w}(this,re,E,q))&&(re.pendingcb++,te=function(N,G,J,m,w,B){if(!J){var D=(l=m,(s=G).objectMode||!1===s.decodeStrings||"string"!=typeof l||(l=g.from(l,w)),l);m!==D&&(J=!0,w="buffer",m=D)}var s,l,$=G.objectMode?1:m.length;G.length+=$;var ne=G.length<G.highWaterMark;if(ne||(G.needDrain=!0),G.writing||G.corked){var ee=G.lastBufferedRequest;G.lastBufferedRequest={chunk:m,encoding:w,isBuf:J,callback:B,next:null},ee?ee.next=G.lastBufferedRequest:G.bufferedRequest=G.lastBufferedRequest,G.bufferedRequestCount+=1}else A(N,G,!1,$,m,w,B);return ne}(this,re,j,E,V,q)),te},z.prototype.cork=function(){this._writableState.corked++},z.prototype.uncork=function(){var E=this._writableState;E.corked&&(E.corked--,E.writing||E.corked||E.finished||E.bufferProcessing||!E.bufferedRequest||I(this,E))},z.prototype.setDefaultEncoding=function(E){if("string"==typeof E&&(E=E.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((E+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+E);return this._writableState.defaultEncoding=E,this},Object.defineProperty(z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),z.prototype._write=function(E,V,q){q(new Error("_write() is not implemented"))},z.prototype._writev=null,z.prototype.end=function(E,V,q){var te,j,ie=this._writableState;"function"==typeof E?(q=E,E=null,V=null):"function"==typeof V&&(q=V,V=null),null!=E&&this.write(E,V),ie.corked&&(ie.corked=1,this.uncork()),ie.ending||ie.finished||(this,j=q,(te=ie).ending=!0,W(this,te),j&&(te.finished?c.nextTick(j):this.once("finish",j)),te.ended=!0,this.writable=!1)},Object.defineProperty(z.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(E){this._writableState&&(this._writableState.destroyed=E)}}),z.prototype.destroy=L.destroy,z.prototype._undestroy=L.undestroy,z.prototype._destroy=function(E,V){this.end(),V(E)}}).call(this,T("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},T("timers").setImmediate)},{"./_stream_duplex":17,"./internal/streams/destroy":23,"./internal/streams/stream":24,_process:44,"core-util-is":13,inherits:29,"process-nextick-args":43,"safe-buffer":65,timers:68,"util-deprecate":71}],22:[function(T,t,Q){"use strict";var x=T("safe-buffer").Buffer,b=T("util");t.exports=function(){function _(){(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,_),this.head=null,this.tail=null,this.length=0}return _.prototype.push=function(c){var h={data:c,next:null};this.length>0?this.tail.next=h:this.head=h,this.tail=h,++this.length},_.prototype.unshift=function(c){var h={data:c,next:this.head};0===this.length&&(this.tail=h),this.head=h,++this.length},_.prototype.shift=function(){if(0!==this.length){var c=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,c}},_.prototype.clear=function(){this.head=this.tail=null,this.length=0},_.prototype.join=function(c){if(0===this.length)return"";for(var h=this.head,p=""+h.data;h=h.next;)p+=c+h.data;return p},_.prototype.concat=function(c){if(0===this.length)return x.alloc(0);if(1===this.length)return this.head.data;for(var f=x.allocUnsafe(c>>>0),y=this.head,M=0;y;)y.data.copy(f,M),M+=y.data.length,y=y.next;return f},_}(),b&&b.inspect&&b.inspect.custom&&(t.exports.prototype[b.inspect.custom]=function(){var _=b.inspect({length:this.length});return this.constructor.name+" "+_})},{"safe-buffer":65,util:11}],23:[function(T,t,Q){"use strict";var x=T("process-nextick-args");function b(_,c){_.emit("error",c)}t.exports={destroy:function(_,c){var h=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(c?c(_):!_||this._writableState&&this._writableState.errorEmitted||x.nextTick(b,this,_),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(_||null,function(f){!c&&f?(x.nextTick(b,h,f),h._writableState&&(h._writableState.errorEmitted=!0)):c&&c(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":43}],24:[function(T,t,Q){t.exports=T("events").EventEmitter},{events:27}],25:[function(T,t,Q){(Q=t.exports=T("./lib/_stream_readable.js")).Stream=Q,Q.Readable=Q,Q.Writable=T("./lib/_stream_writable.js"),Q.Duplex=T("./lib/_stream_duplex.js"),Q.Transform=T("./lib/_stream_transform.js"),Q.PassThrough=T("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":17,"./lib/_stream_passthrough.js":18,"./lib/_stream_readable.js":19,"./lib/_stream_transform.js":20,"./lib/_stream_writable.js":21}],26:[function(T,t,Q){(function(x){var b=T("once"),_=function(){},c=function(h,p,C){if("function"==typeof p)return c(h,null,p);p||(p={}),C=b(C||_);var R,f=h._writableState,y=h._readableState,M=p.readable||!1!==p.readable&&h.readable,g=p.writable||!1!==p.writable&&h.writable,u=!1,O=function(){h.writable||L()},L=function(){g=!1,M||C.call(h)},k=function(){M=!1,g||C.call(h)},H=function(R){C.call(h,R?new Error("exited with error code: "+R):null)},z=function(R){C.call(h,R)},A=function(){x.nextTick(oe)},oe=function(){if(!u)return(!M||y&&y.ended&&!y.destroyed)&&(!g||f&&f.ended&&!f.destroyed)?void 0:C.call(h,new Error("premature close"))},I=function(){h.req.on("finish",L)};return(R=h).setHeader&&"function"==typeof R.abort?(h.on("complete",L),h.on("abort",A),h.req?I():h.on("request",I)):g&&!f&&(h.on("end",O),h.on("close",O)),function(R){return R.stdio&&Array.isArray(R.stdio)&&3===R.stdio.length}(h)&&h.on("exit",H),h.on("end",k),h.on("finish",L),!1!==p.error&&h.on("error",z),h.on("close",A),function(){u=!0,h.removeListener("complete",L),h.removeListener("abort",A),h.removeListener("request",I),h.req&&h.req.removeListener("finish",L),h.removeListener("end",O),h.removeListener("close",O),h.removeListener("finish",L),h.removeListener("exit",H),h.removeListener("end",k),h.removeListener("error",z),h.removeListener("close",A)}};t.exports=c}).call(this,T("_process"))},{_process:44,once:42}],27:[function(T,t,Q){var x=Object.create||function(k){var H=function(){};return H.prototype=k,new H},b=Object.keys||function(k){var H=[];for(var z in k)Object.prototype.hasOwnProperty.call(k,z)&&H.push(z);return z},_=Function.prototype.bind||function(k){var H=this;return function(){return H.apply(k,arguments)}};function c(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=x(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0;var h,p=10;try{var C={};Object.defineProperty&&Object.defineProperty(C,"x",{value:0}),h=0===C.x}catch{h=!1}function f(k){return void 0===k._maxListeners?c.defaultMaxListeners:k._maxListeners}function y(k,H,z,A){var oe,I,R;if("function"!=typeof z)throw new TypeError('"listener" argument must be a function');if((I=k._events)?(I.newListener&&(k.emit("newListener",H,z.listener?z.listener:z),I=k._events),R=I[H]):(I=k._events=x(null),k._eventsCount=0),R){if("function"==typeof R?R=I[H]=A?[z,R]:[R,z]:A?R.unshift(z):R.push(z),!R.warned&&(oe=f(k))&&oe>0&&R.length>oe){R.warned=!0;var F=new Error("Possible EventEmitter memory leak detected. "+R.length+' "'+String(H)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');F.name="MaxListenersExceededWarning",F.emitter=k,F.type=H,F.count=R.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",F.name,F.message)}}else R=I[H]=z,++k._eventsCount;return k}function M(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var k=new Array(arguments.length),H=0;H<k.length;++H)k[H]=arguments[H];this.listener.apply(this.target,k)}}function g(k,H,z){var A={fired:!1,wrapFn:void 0,target:k,type:H,listener:z},oe=_.call(M,A);return oe.listener=z,A.wrapFn=oe,oe}function u(k,H,z){var A=k._events;if(!A)return[];var oe=A[H];return oe?"function"==typeof oe?z?[oe.listener||oe]:[oe]:z?function(I){for(var R=new Array(I.length),F=0;F<R.length;++F)R[F]=I[F].listener||I[F];return R}(oe):L(oe,oe.length):[]}function O(k){var H=this._events;if(H){var z=H[k];if("function"==typeof z)return 1;if(z)return z.length}return 0}function L(k,H){for(var z=new Array(H),A=0;A<H;++A)z[A]=k[A];return z}h?Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(k){if("number"!=typeof k||k<0||k!=k)throw new TypeError('"defaultMaxListeners" must be a positive number');p=k}}):c.defaultMaxListeners=p,c.prototype.setMaxListeners=function(k){if("number"!=typeof k||k<0||isNaN(k))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=k,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(k){var H,z,A,oe,I,R,F="error"===k;if(R=this._events)F=F&&null==R.error;else if(!F)return!1;if(F){if(arguments.length>1&&(H=arguments[1]),H instanceof Error)throw H;var W=new Error('Unhandled "error" event. ('+H+")");throw W.context=H,W}if(!(z=R[k]))return!1;var E="function"==typeof z;switch(A=arguments.length){case 1:!function(V,q,ie){if(q)V.call(ie);else for(var re=V.length,te=L(V,re),j=0;j<re;++j)te[j].call(ie)}(z,E,this);break;case 2:!function(V,q,ie,re){if(q)V.call(ie,re);else for(var te=V.length,j=L(V,te),N=0;N<te;++N)j[N].call(ie,re)}(z,E,this,arguments[1]);break;case 3:!function(V,q,ie,re,te){if(q)V.call(ie,re,te);else for(var j=V.length,N=L(V,j),G=0;G<j;++G)N[G].call(ie,re,te)}(z,E,this,arguments[1],arguments[2]);break;case 4:!function(V,q,ie,re,te,j){if(q)V.call(ie,re,te,j);else for(var N=V.length,G=L(V,N),J=0;J<N;++J)G[J].call(ie,re,te,j)}(z,E,this,arguments[1],arguments[2],arguments[3]);break;default:for(oe=new Array(A-1),I=1;I<A;I++)oe[I-1]=arguments[I];!function(V,q,ie,re){if(q)V.apply(ie,re);else for(var te=V.length,j=L(V,te),N=0;N<te;++N)j[N].apply(ie,re)}(z,E,this,oe)}return!0},c.prototype.on=c.prototype.addListener=function(k,H){return y(this,k,H,!1)},c.prototype.prependListener=function(k,H){return y(this,k,H,!0)},c.prototype.once=function(k,H){if("function"!=typeof H)throw new TypeError('"listener" argument must be a function');return this.on(k,g(this,k,H)),this},c.prototype.prependOnceListener=function(k,H){if("function"!=typeof H)throw new TypeError('"listener" argument must be a function');return this.prependListener(k,g(this,k,H)),this},c.prototype.removeListener=function(k,H){var z,A,oe,I,R;if("function"!=typeof H)throw new TypeError('"listener" argument must be a function');if(!(A=this._events))return this;if(!(z=A[k]))return this;if(z===H||z.listener===H)0==--this._eventsCount?this._events=x(null):(delete A[k],A.removeListener&&this.emit("removeListener",k,z.listener||H));else if("function"!=typeof z){for(oe=-1,I=z.length-1;I>=0;I--)if(z[I]===H||z[I].listener===H){R=z[I].listener,oe=I;break}if(oe<0)return this;0===oe?z.shift():function(F,W){for(var E=W,V=E+1,q=F.length;V<q;E+=1,V+=1)F[E]=F[V];F.pop()}(z,oe),1===z.length&&(A[k]=z[0]),A.removeListener&&this.emit("removeListener",k,R||H)}return this},c.prototype.removeAllListeners=function(k){var H,z,A;if(!(z=this._events))return this;if(!z.removeListener)return 0===arguments.length?(this._events=x(null),this._eventsCount=0):z[k]&&(0==--this._eventsCount?this._events=x(null):delete z[k]),this;if(0===arguments.length){var oe,I=b(z);for(A=0;A<I.length;++A)"removeListener"!==(oe=I[A])&&this.removeAllListeners(oe);return this.removeAllListeners("removeListener"),this._events=x(null),this._eventsCount=0,this}if("function"==typeof(H=z[k]))this.removeListener(k,H);else if(H)for(A=H.length-1;A>=0;A--)this.removeListener(k,H[A]);return this},c.prototype.listeners=function(k){return u(this,k,!0)},c.prototype.rawListeners=function(k){return u(this,k,!1)},c.listenerCount=function(k,H){return"function"==typeof k.listenerCount?k.listenerCount(H):O.call(k,H)},c.prototype.listenerCount=O,c.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],28:[function(T,t,Q){Q.read=function(x,b,_,c,h){var p,C,f=8*h-c-1,y=(1<<f)-1,M=y>>1,g=-7,u=_?h-1:0,O=_?-1:1,L=x[b+u];for(u+=O,p=L&(1<<-g)-1,L>>=-g,g+=f;g>0;p=256*p+x[b+u],u+=O,g-=8);for(C=p&(1<<-g)-1,p>>=-g,g+=c;g>0;C=256*C+x[b+u],u+=O,g-=8);if(0===p)p=1-M;else{if(p===y)return C?NaN:1/0*(L?-1:1);C+=Math.pow(2,c),p-=M}return(L?-1:1)*C*Math.pow(2,p-c)},Q.write=function(x,b,_,c,h,p){var C,f,y,M=8*p-h-1,g=(1<<M)-1,u=g>>1,O=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,L=c?0:p-1,k=c?1:-1,H=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(f=isNaN(b)?1:0,C=g):(C=Math.floor(Math.log(b)/Math.LN2),b*(y=Math.pow(2,-C))<1&&(C--,y*=2),(b+=C+u>=1?O/y:O*Math.pow(2,1-u))*y>=2&&(C++,y/=2),C+u>=g?(f=0,C=g):C+u>=1?(f=(b*y-1)*Math.pow(2,h),C+=u):(f=b*Math.pow(2,u-1)*Math.pow(2,h),C=0));h>=8;x[_+L]=255&f,L+=k,f/=256,h-=8);for(C=C<<h|f,M+=h;M>0;x[_+L]=255&C,L+=k,C/=256,M-=8);x[_+L-k]|=128*H}},{}],29:[function(T,t,Q){t.exports="function"==typeof Object.create?function(x,b){b&&(x.super_=b,x.prototype=Object.create(b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}))}:function(x,b){if(b){x.super_=b;var _=function(){};_.prototype=b.prototype,x.prototype=new _,x.prototype.constructor=x}}},{}],30:[function(T,t,Q){function x(b){return!!b.constructor&&"function"==typeof b.constructor.isBuffer&&b.constructor.isBuffer(b)}t.exports=function(b){return null!=b&&(x(b)||"function"==typeof(_=b).readFloatLE&&"function"==typeof _.slice&&x(_.slice(0,0))||!!b._isBuffer);var _}},{}],31:[function(T,t,Q){var x={}.toString;t.exports=Array.isArray||function(b){return"[object Array]"==x.call(b)}},{}],32:[function(T,t,Q){(function(x){const b=t.exports;b.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},b.codes={};for(const c in b.types)b.codes[b.types[c]]=c;b.CMD_SHIFT=4,b.CMD_MASK=240,b.DUP_MASK=8,b.QOS_MASK=3,b.QOS_SHIFT=1,b.RETAIN_MASK=1,b.VARBYTEINT_MASK=127,b.VARBYTEINT_FIN_MASK=128,b.SESSIONPRESENT_MASK=1,b.SESSIONPRESENT_HEADER=x.from([b.SESSIONPRESENT_MASK]),b.CONNACK_HEADER=x.from([b.codes.connack<<b.CMD_SHIFT]),b.USERNAME_MASK=128,b.PASSWORD_MASK=64,b.WILL_RETAIN_MASK=32,b.WILL_QOS_MASK=24,b.WILL_QOS_SHIFT=3,b.WILL_FLAG_MASK=4,b.CLEAN_SESSION_MASK=2,b.CONNECT_HEADER=x.from([b.codes.connect<<b.CMD_SHIFT]),b.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},b.propertiesCodes={};for(const c in b.properties)b.propertiesCodes[b.properties[c]]=c;function _(c){return[0,1,2].map(h=>[0,1].map(p=>[0,1].map(C=>{const f=x.alloc(1);return f.writeUInt8(b.codes[c]<<b.CMD_SHIFT|(p?b.DUP_MASK:0)|h<<b.QOS_SHIFT|C,0,!0),f})))}b.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},b.PUBLISH_HEADER=_("publish"),b.SUBSCRIBE_HEADER=_("subscribe"),b.SUBSCRIBE_OPTIONS_QOS_MASK=3,b.SUBSCRIBE_OPTIONS_NL_MASK=1,b.SUBSCRIBE_OPTIONS_NL_SHIFT=2,b.SUBSCRIBE_OPTIONS_RAP_MASK=1,b.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,b.SUBSCRIBE_OPTIONS_RH_MASK=3,b.SUBSCRIBE_OPTIONS_RH_SHIFT=4,b.SUBSCRIBE_OPTIONS_RH=[0,16,32],b.SUBSCRIBE_OPTIONS_NL=4,b.SUBSCRIBE_OPTIONS_RAP=8,b.SUBSCRIBE_OPTIONS_QOS=[0,1,2],b.UNSUBSCRIBE_HEADER=_("unsubscribe"),b.ACKS={unsuback:_("unsuback"),puback:_("puback"),pubcomp:_("pubcomp"),pubrel:_("pubrel"),pubrec:_("pubrec")},b.SUBACK_HEADER=x.from([b.codes.suback<<b.CMD_SHIFT]),b.VERSION3=x.from([3]),b.VERSION4=x.from([4]),b.VERSION5=x.from([5]),b.QOS=[0,1,2].map(c=>x.from([c])),b.EMPTY={pingreq:x.from([b.codes.pingreq<<4,0]),pingresp:x.from([b.codes.pingresp<<4,0]),disconnect:x.from([b.codes.disconnect<<4,0])}}).call(this,T("buffer").Buffer)},{buffer:12}],33:[function(T,t,Q){(function(x){const b=T("./writeToStream"),_=T("events");class c extends _{constructor(){super(),this._array=new Array(20),this._i=0}write(p){return this._array[this._i++]=p,!0}concat(){let p=0;const C=new Array(this._array.length),f=this._array;let y,M=0;for(y=0;y<f.length&&void 0!==f[y];y++)C[y]="string"!=typeof f[y]?f[y].length:x.byteLength(f[y]),p+=C[y];const g=x.allocUnsafe(p);for(y=0;y<f.length&&void 0!==f[y];y++)"string"!=typeof f[y]?(f[y].copy(g,M),M+=C[y]):(g.write(f[y],M),M+=C[y]);return g}}t.exports=function(h,p){const C=new c;return b(h,C,p),C.concat()}}).call(this,T("buffer").Buffer)},{"./writeToStream":40,buffer:12,events:27}],34:[function(T,t,Q){Q.parser=T("./parser").parser,Q.generate=T("./generate"),Q.writeToStream=T("./writeToStream")},{"./generate":33,"./parser":39,"./writeToStream":40}],35:[function(T,t,Q){"use strict";const{Buffer:x}=T("buffer"),b=Symbol.for("BufferList");function _(c){if(!(this instanceof _))return new _(c);_._init.call(this,c)}_._init=function(c){Object.defineProperty(this,b,{value:!0}),this._bufs=[],this.length=0,c&&this.append(c)},_.prototype._new=function(c){return new _(c)},_.prototype._offset=function(c){if(0===c)return[0,0];let h=0;for(let p=0;p<this._bufs.length;p++){const C=h+this._bufs[p].length;if(c<C||p===this._bufs.length-1)return[p,c-h];h=C}},_.prototype._reverseOffset=function(c){const h=c[0];let p=c[1];for(let C=0;C<h;C++)p+=this._bufs[C].length;return p},_.prototype.get=function(c){if(c>this.length||c<0)return;const h=this._offset(c);return this._bufs[h[0]][h[1]]},_.prototype.slice=function(c,h){return"number"==typeof c&&c<0&&(c+=this.length),"number"==typeof h&&h<0&&(h+=this.length),this.copy(null,0,c,h)},_.prototype.copy=function(c,h,p,C){if(("number"!=typeof p||p<0)&&(p=0),("number"!=typeof C||C>this.length)&&(C=this.length),p>=this.length||C<=0)return c||x.alloc(0);const f=!!c,y=this._offset(p),M=C-p;let g=M,u=f&&h||0,O=y[1];if(0===p&&C===this.length){if(!f)return 1===this._bufs.length?this._bufs[0]:x.concat(this._bufs,this.length);for(let L=0;L<this._bufs.length;L++)this._bufs[L].copy(c,u),u+=this._bufs[L].length;return c}if(g<=this._bufs[y[0]].length-O)return f?this._bufs[y[0]].copy(c,h,O,O+g):this._bufs[y[0]].slice(O,O+g);f||(c=x.allocUnsafe(M));for(let L=y[0];L<this._bufs.length;L++){const k=this._bufs[L].length-O;if(!(g>k)){this._bufs[L].copy(c,u,O,O+g),u+=k;break}this._bufs[L].copy(c,u,O),u+=k,g-=k,O&&(O=0)}return c.length>u?c.slice(0,u):c},_.prototype.shallowSlice=function(c,h){if((c=c||0)<0&&(c+=this.length),(h="number"!=typeof h?this.length:h)<0&&(h+=this.length),c===h)return this._new();const p=this._offset(c),C=this._offset(h),f=this._bufs.slice(p[0],C[0]+1);return 0===C[1]?f.pop():f[f.length-1]=f[f.length-1].slice(0,C[1]),0!==p[1]&&(f[0]=f[0].slice(p[1])),this._new(f)},_.prototype.toString=function(c,h,p){return this.slice(h,p).toString(c)},_.prototype.consume=function(c){if(c=Math.trunc(c),Number.isNaN(c)||c<=0)return this;for(;this._bufs.length;){if(!(c>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(c),this.length-=c;break}c-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},_.prototype.duplicate=function(){const c=this._new();for(let h=0;h<this._bufs.length;h++)c.append(this._bufs[h]);return c},_.prototype.append=function(c){if(null==c)return this;if(c.buffer)this._appendBuffer(x.from(c.buffer,c.byteOffset,c.byteLength));else if(Array.isArray(c))for(let h=0;h<c.length;h++)this.append(c[h]);else if(this._isBufferList(c))for(let h=0;h<c._bufs.length;h++)this.append(c._bufs[h]);else"number"==typeof c&&(c=c.toString()),this._appendBuffer(x.from(c));return this},_.prototype._appendBuffer=function(c){this._bufs.push(c),this.length+=c.length},_.prototype.indexOf=function(c,h,p){if(void 0===p&&"string"==typeof h&&(p=h,h=void 0),"function"==typeof c||Array.isArray(c))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof c?c=x.from([c]):"string"==typeof c?c=x.from(c,p):this._isBufferList(c)?c=c.slice():Array.isArray(c.buffer)?c=x.from(c.buffer,c.byteOffset,c.byteLength):x.isBuffer(c)||(c=x.from(c)),h=Number(h||0),isNaN(h)&&(h=0),h<0&&(h=this.length+h),h<0&&(h=0),0===c.length)return h>this.length?this.length:h;const C=this._offset(h);let f=C[0],y=C[1];for(;f<this._bufs.length;f++){const M=this._bufs[f];for(;y<M.length;)if(M.length-y>=c.length){const g=M.indexOf(c,y);if(-1!==g)return this._reverseOffset([f,g]);y=M.length-c.length+1}else{const g=this._reverseOffset([f,y]);if(this._match(g,c))return g;y++}y=0}return-1},_.prototype._match=function(c,h){if(this.length-c<h.length)return!1;for(let p=0;p<h.length;p++)if(this.get(c+p)!==h[p])return!1;return!0},function(){const c={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const h in c)!function(p){_.prototype[p]=null===c[p]?function(C,f){return this.slice(C,C+f)[p](0,f)}:function(C){return this.slice(C,C+c[p])[p](0)}}(h)}(),_.prototype._isBufferList=function(c){return c instanceof _||_.isBufferList(c)},_.isBufferList=function(c){return null!=c&&c[b]},t.exports=_},{buffer:12}],36:[function(T,t,Q){"use strict";const x=T("readable-stream").Duplex,b=T("inherits"),_=T("./BufferList");function c(h){if(!(this instanceof c))return new c(h);if("function"==typeof h){this._callback=h;const p=function(C){this._callback&&(this._callback(C),this._callback=null)}.bind(this);this.on("pipe",function(C){C.on("error",p)}),this.on("unpipe",function(C){C.removeListener("error",p)}),h=null}_._init.call(this,h),x.call(this)}b(c,x),Object.assign(c.prototype,_.prototype),c.prototype._new=function(h){return new c(h)},c.prototype._write=function(h,p,C){this._appendBuffer(h),"function"==typeof C&&C()},c.prototype._read=function(h){if(!this.length)return this.push(null);h=Math.min(h,this.length),this.push(this.slice(0,h)),this.consume(h)},c.prototype.end=function(h){x.prototype.end.call(this,h),this._callback&&(this._callback(null,this.slice()),this._callback=null)},c.prototype._destroy=function(h,p){this._bufs.length=0,this.length=0,p(h)},c.prototype._isBufferList=function(h){return h instanceof c||h instanceof _||c.isBufferList(h)},c.isBufferList=_.isBufferList,t.exports=c,t.exports.BufferListStream=c,t.exports.BufferList=_},{"./BufferList":35,inherits:29,"readable-stream":63}],37:[function(T,t,Q){(function(x){const _={},c=x.isBuffer(x.from([1,2]).subarray(0,1));function h(p){const C=x.allocUnsafe(2);return C.writeUInt8(p>>8,0),C.writeUInt8(255&p,1),C}t.exports={cache:_,generateCache:function(){for(let p=0;p<65536;p++)_[p]=h(p)},generateNumber:h,genBufVariableByteInt:function(p){let C=0,f=0;const y=x.allocUnsafe(4);do{C=p%128|0,(p=p/128|0)>0&&(C|=128),y.writeUInt8(C,f++)}while(p>0&&f<4);return p>0&&(f=0),c?y.subarray(0,f):y.slice(0,f)},generate4ByteBuffer:function(p){const C=x.allocUnsafe(4);return C.writeUInt32BE(p,0),C}}}).call(this,T("buffer").Buffer)},{buffer:12}],38:[function(T,t,Q){t.exports=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}}},{}],39:[function(T,t,Q){const x=T("bl"),b=T("events"),_=T("./packet"),c=T("./constants"),h=T("debug")("mqtt-packet:parser");class p extends b{constructor(){super(),this.parser=this.constructor.parser}static parser(f){return this instanceof p?(this.settings=f||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):(new p).parser(f)}_resetState(){h("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new _,this.error=null,this._list=x(),this._stateCounter=0}parse(f){for(this.error&&this._resetState(),this._list.append(f),h("parse: current state: %s",this._states[this._stateCounter]);(-1!==this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,h("parse: state complete. _stateCounter is now: %d",this._stateCounter),h("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return h("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){const f=this._list.readUInt8(0);return this.packet.cmd=c.types[f>>c.CMD_SHIFT],this.packet.retain=0!=(f&c.RETAIN_MASK),this.packet.qos=f>>c.QOS_SHIFT&c.QOS_MASK,this.packet.dup=0!=(f&c.DUP_MASK),h("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0}_parseLength(){const f=this._parseVarByteNum(!0);return f?(this.packet.length=f.value,this._list.consume(f.bytes)):this._emitError(new Error("Invalid length")),h("_parseLength %d",f.value),!!f}_parsePayload(){h("_parsePayload: payload %O",this._list);let f=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}f=!0}return h("_parsePayload complete result: %s",f),f}_parseConnect(){let f,y,M,g;h("_parseConnect");const u={},O=this.packet,L=this._parseString();if(null===L)return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==L&&"MQIsdp"!==L)return this._emitError(new Error("Invalid protocolId"));if(O.protocolId=L,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(O.protocolVersion=this._list.readUInt8(this._pos),3!==O.protocolVersion&&4!==O.protocolVersion&&5!==O.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(u.username=this._list.readUInt8(this._pos)&c.USERNAME_MASK,u.password=this._list.readUInt8(this._pos)&c.PASSWORD_MASK,u.will=this._list.readUInt8(this._pos)&c.WILL_FLAG_MASK,u.will&&(O.will={},O.will.retain=0!=(this._list.readUInt8(this._pos)&c.WILL_RETAIN_MASK),O.will.qos=(this._list.readUInt8(this._pos)&c.WILL_QOS_MASK)>>c.WILL_QOS_SHIFT),O.clean=0!=(this._list.readUInt8(this._pos)&c.CLEAN_SESSION_MASK),this._pos++,O.keepalive=this._parseNum(),-1===O.keepalive)return this._emitError(new Error("Packet too short"));if(5===O.protocolVersion){const H=this._parseProperties();Object.getOwnPropertyNames(H).length&&(O.properties=H)}const k=this._parseString();if(null===k)return this._emitError(new Error("Packet too short"));if(O.clientId=k,h("_parseConnect: packet.clientId: %s",O.clientId),u.will){if(5===O.protocolVersion){const H=this._parseProperties();Object.getOwnPropertyNames(H).length&&(O.will.properties=H)}if(null===(f=this._parseString()))return this._emitError(new Error("Cannot parse will topic"));if(O.will.topic=f,h("_parseConnect: packet.will.topic: %s",O.will.topic),null===(y=this._parseBuffer()))return this._emitError(new Error("Cannot parse will payload"));O.will.payload=y,h("_parseConnect: packet.will.paylaod: %s",O.will.payload)}if(u.username){if(null===(g=this._parseString()))return this._emitError(new Error("Cannot parse username"));O.username=g,h("_parseConnect: packet.username: %s",O.username)}if(u.password){if(null===(M=this._parseBuffer()))return this._emitError(new Error("Cannot parse password"));O.password=M}return this.settings=O,h("_parseConnect: complete"),O}_parseConnack(){h("_parseConnack");const f=this.packet;if(this._list.length<2)return null;if(f.sessionPresent=!!(this._list.readUInt8(this._pos++)&c.SESSIONPRESENT_MASK),5===this.settings.protocolVersion?f.reasonCode=this._list.readUInt8(this._pos++):f.returnCode=this._list.readUInt8(this._pos++),-1===f.returnCode||-1===f.reasonCode)return this._emitError(new Error("Cannot parse return code"));if(5===this.settings.protocolVersion){const y=this._parseProperties();Object.getOwnPropertyNames(y).length&&(f.properties=y)}h("_parseConnack: complete")}_parsePublish(){h("_parsePublish");const f=this.packet;if(f.topic=this._parseString(),null===f.topic)return this._emitError(new Error("Cannot parse topic"));if(!(f.qos>0)||this._parseMessageId()){if(5===this.settings.protocolVersion){const y=this._parseProperties();Object.getOwnPropertyNames(y).length&&(f.properties=y)}f.payload=this._list.slice(this._pos,f.length),h("_parsePublish: payload from buffer list: %o",f.payload)}}_parseSubscribe(){h("_parseSubscribe");const f=this.packet;let y,M,g,u,O,L,k;if(1!==f.qos)return this._emitError(new Error("Wrong subscribe header"));if(f.subscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const H=this._parseProperties();Object.getOwnPropertyNames(H).length&&(f.properties=H)}for(;this._pos<f.length;){if(null===(y=this._parseString()))return this._emitError(new Error("Cannot parse topic"));if(this._pos>=f.length)return this._emitError(new Error("Malformed Subscribe Payload"));g=(M=this._parseByte())&c.SUBSCRIBE_OPTIONS_QOS_MASK,L=0!=(M>>c.SUBSCRIBE_OPTIONS_NL_SHIFT&c.SUBSCRIBE_OPTIONS_NL_MASK),O=0!=(M>>c.SUBSCRIBE_OPTIONS_RAP_SHIFT&c.SUBSCRIBE_OPTIONS_RAP_MASK),u=M>>c.SUBSCRIBE_OPTIONS_RH_SHIFT&c.SUBSCRIBE_OPTIONS_RH_MASK,k={topic:y,qos:g},5===this.settings.protocolVersion&&(k.nl=L,k.rap=O,k.rh=u),h("_parseSubscribe: push subscription `%s` to subscription",k),f.subscriptions.push(k)}}}_parseSuback(){h("_parseSuback");const f=this.packet;if(this.packet.granted=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const y=this._parseProperties();Object.getOwnPropertyNames(y).length&&(f.properties=y)}for(;this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}}_parseUnsubscribe(){h("_parseUnsubscribe");const f=this.packet;if(f.unsubscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){const y=this._parseProperties();Object.getOwnPropertyNames(y).length&&(f.properties=y)}for(;this._pos<f.length;){const y=this._parseString();if(null===y)return this._emitError(new Error("Cannot parse topic"));h("_parseUnsubscribe: push topic `%s` to unsubscriptions",y),f.unsubscriptions.push(y)}}}_parseUnsuback(){h("_parseUnsuback");const f=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if(5===this.settings.protocolVersion){const y=this._parseProperties();for(Object.getOwnPropertyNames(y).length&&(f.properties=y),f.granted=[];this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}}_parseConfirmation(){h("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);const f=this.packet;if(this._parseMessageId(),5===this.settings.protocolVersion&&(f.length>2&&(f.reasonCode=this._parseByte(),h("_parseConfirmation: packet.reasonCode `%d`",f.reasonCode)),f.length>3)){const y=this._parseProperties();Object.getOwnPropertyNames(y).length&&(f.properties=y)}return!0}_parseDisconnect(){const f=this.packet;if(h("_parseDisconnect"),5===this.settings.protocolVersion){f.reasonCode=this._parseByte();const y=this._parseProperties();Object.getOwnPropertyNames(y).length&&(f.properties=y)}return h("_parseDisconnect result: true"),!0}_parseAuth(){h("_parseAuth");const f=this.packet;if(5!==this.settings.protocolVersion)return this._emitError(new Error("Not supported auth packet for this version MQTT"));f.reasonCode=this._parseByte();const y=this._parseProperties();return Object.getOwnPropertyNames(y).length&&(f.properties=y),h("_parseAuth: result: true"),!0}_parseMessageId(){const f=this.packet;return f.messageId=this._parseNum(),null===f.messageId?(this._emitError(new Error("Cannot parse messageId")),!1):(h("_parseMessageId: packet.messageId %d",f.messageId),!0)}_parseString(f){const y=this._parseNum(),M=y+this._pos;if(-1===y||M>this._list.length||M>this.packet.length)return null;const g=this._list.toString("utf8",this._pos,M);return this._pos+=y,h("_parseString: result: %s",g),g}_parseStringPair(){return h("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){const f=this._parseNum(),y=f+this._pos;if(-1===f||y>this._list.length||y>this.packet.length)return null;const M=this._list.slice(this._pos,y);return this._pos+=f,h("_parseBuffer: result: %o",M),M}_parseNum(){if(this._list.length-this._pos<2)return-1;const f=this._list.readUInt16BE(this._pos);return this._pos+=2,h("_parseNum: result: %s",f),f}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;const f=this._list.readUInt32BE(this._pos);return this._pos+=4,h("_parse4ByteNum: result: %s",f),f}_parseVarByteNum(f){h("_parseVarByteNum");let y,M=0,g=1,u=0,O=!1;const L=this._pos?this._pos:0;for(;M<5;){if(u+=g*((y=this._list.readUInt8(L+M++))&c.VARBYTEINT_MASK),g*=128,0==(y&c.VARBYTEINT_FIN_MASK)){O=!0;break}if(this._list.length<=M)break}return L&&(this._pos+=M),h("_parseVarByteNum: result: %o",O=!!O&&(f?{bytes:M,value:u}:u)),O}_parseByte(){const f=this._list.readUInt8(this._pos);return this._pos++,h("_parseByte: result: %o",f),f}_parseByType(f){switch(h("_parseByType: type: %s",f),f){case"byte":return 0!==this._parseByte();case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){h("_parseProperties");const f=this._parseVarByteNum(),y=this._pos+f,M={};for(;this._pos<y;){const g=this._parseByte(),u=c.propertiesCodes[g];if(!u)return this._emitError(new Error("Unknown property")),!1;if("userProperties"!==u)M[u]?(Array.isArray(M[u])||(M[u]=[M[u]]),M[u].push(this._parseByType(c.propertiesTypes[u]))):M[u]=this._parseByType(c.propertiesTypes[u]);else{M[u]||(M[u]=Object.create(null));const O=this._parseByType(c.propertiesTypes[u]);M[u][O.name]?(Array.isArray(M[u][O.name])||(M[u][O.name]=[M[u][O.name]]),M[u][O.name].push(O.value)):M[u][O.name]=O.value}}return M}_newPacket(){return h("_newPacket"),this.packet&&(this._list.consume(this.packet.length),h("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),h("_newPacket: new packet"),this.packet=new _,this._pos=0,!0}_emitError(f){h("_emitError"),this.error=f,this.emit("error",f)}}t.exports=p},{"./constants":32,"./packet":38,bl:36,debug:14,events:27}],40:[function(T,t,Q){(function(x){const b=T("./constants"),_=x.allocUnsafe(0),c=x.from([0]),h=T("./numbers"),p=T("process-nextick-args").nextTick,C=T("debug")("mqtt-packet:writeToStream"),f=h.cache,y=h.generateNumber,M=h.generateCache,g=h.genBufVariableByteInt,u=h.generate4ByteBuffer;let O=R,L=!0;function k(j,N,G){switch(C("generate called"),N.cork&&(N.cork(),p(H,N)),L&&(L=!1,M()),C("generate: packet.cmd: %s",j.cmd),j.cmd){case"connect":return function(J,m,w){const B=J||{},D=B.protocolId||"MQTT",$=B.protocolVersion||4,ne=B.will;let ee=B.clean;const s=B.keepalive||0,l=B.clientId||"",d=B.username,S=B.password,U=B.properties;void 0===ee&&(ee=!0);let Z=0;if(!D||"string"!=typeof D&&!x.isBuffer(D))return m.emit("error",new Error("Invalid protocolId")),!1;if(Z+=D.length+2,3!==$&&4!==$&&5!==$)return m.emit("error",new Error("Invalid protocol version")),!1;if(Z+=1,"string"!=typeof l&&!x.isBuffer(l)||!l&&4!==$||!l&&!ee){if($<4)return m.emit("error",new Error("clientId must be supplied before 3.1.1")),!1;if(1*ee==0)return m.emit("error",new Error("clientId must be given if cleanSession set to 0")),!1}else Z+=l.length+2;if("number"!=typeof s||s<0||s>65535||s%1!=0)return m.emit("error",new Error("Invalid keepalive")),!1;if(Z+=2,Z+=1,5===$){var K=E(m,U);if(!K)return!1;Z+=K.length}if(ne){if("object"!=typeof ne)return m.emit("error",new Error("Invalid will")),!1;if(!ne.topic||"string"!=typeof ne.topic)return m.emit("error",new Error("Invalid will topic")),!1;if(Z+=x.byteLength(ne.topic)+2,Z+=2,ne.payload){if(!(ne.payload.length>=0))return m.emit("error",new Error("Invalid will payload")),!1;Z+="string"==typeof ne.payload?x.byteLength(ne.payload):ne.payload.length}var le={};if(5===$){if(!(le=E(m,ne.properties)))return!1;Z+=le.length}}let se=!1;if(null!=d){if(!te(d))return m.emit("error",new Error("Invalid username")),!1;se=!0,Z+=x.byteLength(d)+2}if(null!=S){if(!se)return m.emit("error",new Error("Username is required to use password")),!1;if(!te(S))return m.emit("error",new Error("Invalid password")),!1;Z+=re(S)+2}m.write(b.CONNECT_HEADER),A(m,Z),W(m,D),m.write(4===$?b.VERSION4:5===$?b.VERSION5:b.VERSION3);let he=0;return he|=null!=d?b.USERNAME_MASK:0,he|=null!=S?b.PASSWORD_MASK:0,he|=ne&&ne.retain?b.WILL_RETAIN_MASK:0,he|=ne&&ne.qos?ne.qos<<b.WILL_QOS_SHIFT:0,he|=ne?b.WILL_FLAG_MASK:0,he|=ee?b.CLEAN_SESSION_MASK:0,m.write(x.from([he])),O(m,s),5===$&&K.write(),W(m,l),ne&&(5===$&&le.write(),oe(m,ne.topic),W(m,ne.payload)),null!=d&&W(m,d),null!=S&&W(m,S),!0}(j,N);case"connack":return function(J,m,w){const B=w?w.protocolVersion:4,D=J||{},$=5===B?D.reasonCode:D.returnCode,ne=D.properties;let ee=2;if("number"!=typeof $)return m.emit("error",new Error("Invalid return code")),!1;let s=null;if(5===B){if(!(s=E(m,ne)))return!1;ee+=s.length}return m.write(b.CONNACK_HEADER),A(m,ee),m.write(D.sessionPresent?b.SESSIONPRESENT_HEADER:c),m.write(x.from([$])),s?.write(),!0}(j,N,G);case"publish":return function(J,m,w){C("publish: packet: %o",J);const B=w?w.protocolVersion:4,D=J||{},$=D.qos||0,ne=D.retain?b.RETAIN_MASK:0,ee=D.topic,s=D.payload||_,l=D.messageId,d=D.properties;let S=0;if("string"==typeof ee)S+=x.byteLength(ee)+2;else{if(!x.isBuffer(ee))return m.emit("error",new Error("Invalid topic")),!1;S+=ee.length+2}if(x.isBuffer(s)?S+=s.length:S+=x.byteLength(s),$&&"number"!=typeof l)return m.emit("error",new Error("Invalid messageId")),!1;$&&(S+=2);let U=null;if(5===B){if(!(U=E(m,d)))return!1;S+=U.length}return m.write(b.PUBLISH_HEADER[$][D.dup?1:0][ne?1:0]),A(m,S),O(m,re(ee)),m.write(ee),$>0&&O(m,l),U?.write(),C("publish: payload: %o",s),m.write(s)}(j,N,G);case"puback":case"pubrec":case"pubrel":case"pubcomp":return function(J,m,w){const B=w?w.protocolVersion:4,D=J||{},$=D.cmd||"puback",ne=D.messageId,ee=D.dup&&"pubrel"===$?b.DUP_MASK:0;let s=0;const l=D.reasonCode,d=D.properties;let S=5===B?3:2;if("pubrel"===$&&(s=1),"number"!=typeof ne)return m.emit("error",new Error("Invalid messageId")),!1;let U=null;if(5===B&&"object"==typeof d){if(!(U=V(m,d,w,S)))return!1;S+=U.length}return m.write(b.ACKS[$][s][ee][0]),A(m,S),O(m,ne),5===B&&m.write(x.from([l])),null!==U&&U.write(),!0}(j,N,G);case"subscribe":return function(J,m,w){C("subscribe: packet: ");const B=w?w.protocolVersion:4,D=J||{},$=D.dup?b.DUP_MASK:0,ne=D.messageId,ee=D.subscriptions,s=D.properties;let l=0;if("number"!=typeof ne)return m.emit("error",new Error("Invalid messageId")),!1;l+=2;let d=null;if(5===B){if(!(d=E(m,s)))return!1;l+=d.length}if("object"!=typeof ee||!ee.length)return m.emit("error",new Error("Invalid subscriptions")),!1;for(let U=0;U<ee.length;U+=1){const Z=ee[U].topic,K=ee[U].qos;if("string"!=typeof Z)return m.emit("error",new Error("Invalid subscriptions - invalid topic")),!1;if("number"!=typeof K)return m.emit("error",new Error("Invalid subscriptions - invalid qos")),!1;if(5===B){if("boolean"!=typeof(ee[U].nl||!1))return m.emit("error",new Error("Invalid subscriptions - invalid No Local")),!1;if("boolean"!=typeof(ee[U].rap||!1))return m.emit("error",new Error("Invalid subscriptions - invalid Retain as Published")),!1;const he=ee[U].rh||0;if("number"!=typeof he||he>2)return m.emit("error",new Error("Invalid subscriptions - invalid Retain Handling")),!1}l+=x.byteLength(Z)+2+1}C("subscribe: writing to stream: %o",b.SUBSCRIBE_HEADER),m.write(b.SUBSCRIBE_HEADER[1][$?1:0][0]),A(m,l),O(m,ne),null!==d&&d.write();let S=!0;for(const U of ee){const K=U.qos,le=+U.nl,se=+U.rap,he=U.rh;let pe;oe(m,U.topic),pe=b.SUBSCRIBE_OPTIONS_QOS[K],5===B&&(pe|=le?b.SUBSCRIBE_OPTIONS_NL:0,pe|=se?b.SUBSCRIBE_OPTIONS_RAP:0,pe|=he?b.SUBSCRIBE_OPTIONS_RH[he]:0),S=m.write(x.from([pe]))}return S}(j,N,G);case"suback":return function(J,m,w){const B=w?w.protocolVersion:4,D=J||{},$=D.messageId,ne=D.granted,ee=D.properties;let s=0;if("number"!=typeof $)return m.emit("error",new Error("Invalid messageId")),!1;if(s+=2,"object"!=typeof ne||!ne.length)return m.emit("error",new Error("Invalid qos vector")),!1;for(let d=0;d<ne.length;d+=1){if("number"!=typeof ne[d])return m.emit("error",new Error("Invalid qos vector")),!1;s+=1}let l=null;if(5===B){if(!(l=V(m,ee,w,s)))return!1;s+=l.length}return m.write(b.SUBACK_HEADER),A(m,s),O(m,$),null!==l&&l.write(),m.write(x.from(ne))}(j,N,G);case"unsubscribe":return function(J,m,w){const B=w?w.protocolVersion:4,D=J||{},$=D.messageId,ne=D.dup?b.DUP_MASK:0,ee=D.unsubscriptions,s=D.properties;let l=0;if("number"!=typeof $)return m.emit("error",new Error("Invalid messageId")),!1;if(l+=2,"object"!=typeof ee||!ee.length)return m.emit("error",new Error("Invalid unsubscriptions")),!1;for(let U=0;U<ee.length;U+=1){if("string"!=typeof ee[U])return m.emit("error",new Error("Invalid unsubscriptions")),!1;l+=x.byteLength(ee[U])+2}let d=null;if(5===B){if(!(d=E(m,s)))return!1;l+=d.length}m.write(b.UNSUBSCRIBE_HEADER[1][ne?1:0][0]),A(m,l),O(m,$),null!==d&&d.write();let S=!0;for(let U=0;U<ee.length;U++)S=oe(m,ee[U]);return S}(j,N,G);case"unsuback":return function(J,m,w){const B=w?w.protocolVersion:4,D=J||{},$=D.messageId,ne=D.dup?b.DUP_MASK:0,ee=D.granted,s=D.properties,l=D.cmd;let d=2;if("number"!=typeof $)return m.emit("error",new Error("Invalid messageId")),!1;if(5===B){if("object"!=typeof ee||!ee.length)return m.emit("error",new Error("Invalid qos vector")),!1;for(let U=0;U<ee.length;U+=1){if("number"!=typeof ee[U])return m.emit("error",new Error("Invalid qos vector")),!1;d+=1}}let S=null;if(5===B){if(!(S=V(m,s,w,d)))return!1;d+=S.length}return m.write(b.ACKS[l][0][ne][0]),A(m,d),O(m,$),null!==S&&S.write(),5===B&&m.write(x.from(ee)),!0}(j,N,G);case"pingreq":case"pingresp":return N.write(b.EMPTY[j.cmd]);case"disconnect":return function(J,m,w){const B=w?w.protocolVersion:4,D=J||{},$=D.reasonCode;let ee=5===B?1:0,s=null;if(5===B){if(!(s=V(m,D.properties,w,ee)))return!1;ee+=s.length}return m.write(x.from([b.codes.disconnect<<4])),A(m,ee),5===B&&m.write(x.from([$])),null!==s&&s.write(),!0}(j,N,G);case"auth":return function(J,m,w){const B=w?w.protocolVersion:4,D=J||{},$=D.reasonCode,ne=D.properties;let ee=5===B?1:0;5!==B&&m.emit("error",new Error("Invalid mqtt version for auth packet"));const s=V(m,ne,w,ee);return!!s&&(ee+=s.length,m.write(x.from([b.codes.auth<<4])),A(m,ee),m.write(x.from([$])),null!==s&&s.write(),!0)}(j,N,G);default:return N.emit("error",new Error("Unknown command")),!1}}function H(j){j.uncork()}Object.defineProperty(k,"cacheNumbers",{get:()=>O===R,set(j){j?(f&&0!==Object.keys(f).length||(L=!0),O=R):(L=!1,O=F)}});const z={};function A(j,N){let G=z[N];G||(G=g(N),N<16384&&(z[N]=G)),C("writeVarByteInt: writing to stream: %o",G),j.write(G)}function oe(j,N){const G=x.byteLength(N);return O(j,G),C("writeString: %s",N),j.write(N,"utf8")}function I(j,N,G){oe(j,N),oe(j,G)}function R(j,N){return C("writeNumberCached: number: %d",N),C("writeNumberCached: %o",f[N]),j.write(f[N])}function F(j,N){const G=y(N);return C("writeNumberGenerated: %o",G),j.write(G)}function W(j,N){"string"==typeof N?oe(j,N):N?(O(j,N.length),j.write(N)):O(j,0)}function E(j,N){if("object"!=typeof N||null!=N.length)return{length:1,write(){ie(j,{},0)}};let G=0;function J(m,w){let B=0;switch(b.propertiesTypes[m]){case"byte":if("boolean"!=typeof w)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=2;break;case"int8":if("number"!=typeof w||w<0||w>255)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=2;break;case"binary":if(w&&null===w)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=1+x.byteLength(w)+2;break;case"int16":if("number"!=typeof w||w<0||w>65535)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=3;break;case"int32":if("number"!=typeof w||w<0||w>4294967295)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=5;break;case"var":if("number"!=typeof w||w<0||w>268435455)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=1+x.byteLength(g(w));break;case"string":if("string"!=typeof w)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=3+x.byteLength(w.toString());break;case"pair":if("object"!=typeof w)return j.emit("error",new Error(`Invalid ${m}: ${w}`)),!1;B+=Object.getOwnPropertyNames(w).reduce((D,$)=>{const ne=w[$];return Array.isArray(ne)?D+=ne.reduce((ee,s)=>ee+(3+x.byteLength($.toString())+2+x.byteLength(s.toString())),0):D+=3+x.byteLength($.toString())+2+x.byteLength(w[$].toString()),D},0);break;default:return j.emit("error",new Error(`Invalid property ${m}: ${w}`)),!1}return B}if(N)for(const m in N){let w=0,B=0;const D=N[m];if(Array.isArray(D))for(let $=0;$<D.length;$++){if(!(B=J(m,D[$])))return!1;w+=B}else{if(!(B=J(m,D)))return!1;w=B}if(!w)return!1;G+=w}return{length:x.byteLength(g(G))+G,write(){ie(j,N,G)}}}function V(j,N,G,J){const m=["reasonString","userProperties"],w=G&&G.properties&&G.properties.maximumPacketSize?G.properties.maximumPacketSize:0;let B=E(j,N);if(w)for(;J+B.length>w;){const D=m.shift();if(!D||!N[D])return!1;delete N[D],B=E(j,N)}return B}function q(j,N,G){switch(b.propertiesTypes[N]){case"byte":j.write(x.from([b.properties[N]])),j.write(x.from([+G]));break;case"int8":j.write(x.from([b.properties[N]])),j.write(x.from([G]));break;case"binary":j.write(x.from([b.properties[N]])),W(j,G);break;case"int16":j.write(x.from([b.properties[N]])),O(j,G);break;case"int32":j.write(x.from([b.properties[N]])),function(J,m){const w=u(m);C("write4ByteNumber: %o",w),J.write(w)}(j,G);break;case"var":j.write(x.from([b.properties[N]])),A(j,G);break;case"string":j.write(x.from([b.properties[N]])),oe(j,G);break;case"pair":Object.getOwnPropertyNames(G).forEach(J=>{const m=G[J];Array.isArray(m)?m.forEach(w=>{j.write(x.from([b.properties[N]])),I(j,J.toString(),w.toString())}):(j.write(x.from([b.properties[N]])),I(j,J.toString(),m.toString()))});break;default:return j.emit("error",new Error(`Invalid property ${N} value: ${G}`)),!1}}function ie(j,N,G){A(j,G);for(const J in N)if(Object.prototype.hasOwnProperty.call(N,J)&&null!==N[J]){const m=N[J];if(Array.isArray(m))for(let w=0;w<m.length;w++)q(j,J,m[w]);else q(j,J,m)}}function re(j){return j?j instanceof x?j.length:x.byteLength(j):0}function te(j){return"string"==typeof j||j instanceof x}t.exports=k}).call(this,T("buffer").Buffer)},{"./constants":32,"./numbers":37,buffer:12,debug:14,"process-nextick-args":43}],41:[function(T,t,Q){var x=1e3,b=60*x,_=60*b,c=24*_;function C(f,y,M,g){var u=y>=1.5*M;return Math.round(f/M)+" "+g+(u?"s":"")}t.exports=function(f,y){y=y||{};var g,u,M=typeof f;if("string"===M&&f.length>0)return function(g){if(!((g=String(g)).length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(g);if(u){var O=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*O;case"weeks":case"week":case"w":return 6048e5*O;case"days":case"day":case"d":return O*c;case"hours":case"hour":case"hrs":case"hr":case"h":return O*_;case"minutes":case"minute":case"mins":case"min":case"m":return O*b;case"seconds":case"second":case"secs":case"sec":case"s":return O*x;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return O;default:return}}}}(f);if("number"===M&&isFinite(f))return y.long?(g=f,(u=Math.abs(g))>=c?C(g,u,c,"day"):u>=_?C(g,u,_,"hour"):u>=b?C(g,u,b,"minute"):u>=x?C(g,u,x,"second"):g+" ms"):function(g){var u=Math.abs(g);return u>=c?Math.round(g/c)+"d":u>=_?Math.round(g/_)+"h":u>=b?Math.round(g/b)+"m":u>=x?Math.round(g/x)+"s":g+"ms"}(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],42:[function(T,t,Q){var x=T("wrappy");function b(c){var h=function(){return h.called?h.value:(h.called=!0,h.value=c.apply(this,arguments))};return h.called=!1,h}function _(c){var h=function(){if(h.called)throw new Error(h.onceError);return h.called=!0,h.value=c.apply(this,arguments)};return h.onceError=(c.name||"Function wrapped with `once`")+" shouldn't be called more than once",h.called=!1,h}t.exports=x(b),t.exports.strict=x(_),b.proto=b(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return b(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return _(this)},configurable:!0})})},{wrappy:72}],43:[function(T,t,Q){(function(x){"use strict";t.exports=void 0===x||!x.version||0===x.version.indexOf("v0.")||0===x.version.indexOf("v1.")&&0!==x.version.indexOf("v1.8.")?{nextTick:function(b,_,c,h){if("function"!=typeof b)throw new TypeError('"callback" argument must be a function');var p,C,f=arguments.length;switch(f){case 0:case 1:return x.nextTick(b);case 2:return x.nextTick(function(){b.call(null,_)});case 3:return x.nextTick(function(){b.call(null,_,c)});case 4:return x.nextTick(function(){b.call(null,_,c,h)});default:for(p=new Array(f-1),C=0;C<p.length;)p[C++]=arguments[C];return x.nextTick(function(){b.apply(null,p)})}}}:x}).call(this,T("_process"))},{_process:44}],44:[function(T,t,Q){var x,b,_=t.exports={};function c(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function p(k){if(x===setTimeout)return setTimeout(k,0);if((x===c||!x)&&setTimeout)return x=setTimeout,setTimeout(k,0);try{return x(k,0)}catch{try{return x.call(null,k,0)}catch{return x.call(this,k,0)}}}!function(){try{x="function"==typeof setTimeout?setTimeout:c}catch{x=c}try{b="function"==typeof clearTimeout?clearTimeout:h}catch{b=h}}();var C,f=[],y=!1,M=-1;function g(){y&&C&&(y=!1,C.length?f=C.concat(f):M=-1,f.length&&u())}function u(){if(!y){var k=p(g);y=!0;for(var H=f.length;H;){for(C=f,f=[];++M<H;)C&&C[M].run();M=-1,H=f.length}C=null,y=!1,function(z){if(b===clearTimeout)return clearTimeout(z);if((b===h||!b)&&clearTimeout)return b=clearTimeout,clearTimeout(z);try{b(z)}catch{try{return b.call(null,z)}catch{return b.call(this,z)}}}(k)}}function O(k,H){this.fun=k,this.array=H}function L(){}_.nextTick=function(k){var H=new Array(arguments.length-1);if(arguments.length>1)for(var z=1;z<arguments.length;z++)H[z-1]=arguments[z];f.push(new O(k,H)),1!==f.length||y||p(u)},O.prototype.run=function(){this.fun.apply(null,this.array)},_.title="browser",_.browser=!0,_.env={},_.argv=[],_.version="",_.versions={},_.on=L,_.addListener=L,_.once=L,_.off=L,_.removeListener=L,_.removeAllListeners=L,_.emit=L,_.prependListener=L,_.prependOnceListener=L,_.listeners=function(k){return[]},_.binding=function(k){throw new Error("process.binding is not supported")},_.cwd=function(){return"/"},_.chdir=function(k){throw new Error("process.chdir is not supported")},_.umask=function(){return 0}},{}],45:[function(T,t,Q){(function(x){!function(b){var _="object"==typeof Q&&Q&&!Q.nodeType&&Q,c="object"==typeof t&&t&&!t.nodeType&&t,h="object"==typeof x&&x;h.global!==h&&h.window!==h&&h.self!==h||(b=h);var p,C,f=2147483647,y=36,z=/^xn--/,A=/[^\x20-\x7E]/,oe=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},F=Math.floor,W=String.fromCharCode;function E(J){throw new RangeError(I[J])}function V(J,m){for(var w=J.length,B=[];w--;)B[w]=m(J[w]);return B}function q(J,m){var w=J.split("@"),B="";return w.length>1&&(B=w[0]+"@",J=w[1]),B+V((J=J.replace(oe,".")).split("."),m).join(".")}function ie(J){for(var m,w,B=[],D=0,$=J.length;D<$;)(m=J.charCodeAt(D++))>=55296&&m<=56319&&D<$?56320==(64512&(w=J.charCodeAt(D++)))?B.push(((1023&m)<<10)+(1023&w)+65536):(B.push(m),D--):B.push(m);return B}function re(J){return V(J,function(m){var w="";return m>65535&&(w+=W((m-=65536)>>>10&1023|55296),m=56320|1023&m),w+W(m)}).join("")}function te(J,m){return J+22+75*(J<26)-((0!=m)<<5)}function j(J,m,w){var B=0;for(J=w?F(J/700):J>>1,J+=F(J/m);J>455;B+=y)J=F(J/35);return F(B+36*J/(J+38))}function N(J){var m,w,B,D,$,ne,ee,s,l,d,S,U=[],Z=J.length,K=0,le=128,se=72;for((w=J.lastIndexOf("-"))<0&&(w=0),B=0;B<w;++B)J.charCodeAt(B)>=128&&E("not-basic"),U.push(J.charCodeAt(B));for(D=w>0?w+1:0;D<Z;){for($=K,ne=1,ee=y;D>=Z&&E("invalid-input"),((s=(S=J.charCodeAt(D++))-48<10?S-22:S-65<26?S-65:S-97<26?S-97:y)>=y||s>F((f-K)/ne))&&E("overflow"),K+=s*ne,!(s<(l=ee<=se?1:ee>=se+26?26:ee-se));ee+=y)ne>F(f/(d=y-l))&&E("overflow"),ne*=d;se=j(K-$,m=U.length+1,0==$),F(K/m)>f-le&&E("overflow"),le+=F(K/m),K%=m,U.splice(K++,0,le)}return re(U)}function G(J){var m,w,B,D,$,ne,ee,s,l,d,S,U,Z,K,le,se=[];for(U=(J=ie(J)).length,m=128,w=0,$=72,ne=0;ne<U;++ne)(S=J[ne])<128&&se.push(W(S));for(B=D=se.length,D&&se.push("-");B<U;){for(ee=f,ne=0;ne<U;++ne)(S=J[ne])>=m&&S<ee&&(ee=S);for(ee-m>F((f-w)/(Z=B+1))&&E("overflow"),w+=(ee-m)*Z,m=ee,ne=0;ne<U;++ne)if((S=J[ne])<m&&++w>f&&E("overflow"),S==m){for(s=w,l=y;!(s<(d=l<=$?1:l>=$+26?26:l-$));l+=y)se.push(W(te(d+(le=s-d)%(K=y-d),0))),s=F(le/K);se.push(W(te(s,0))),$=j(w,Z,B==D),w=0,++B}++w,++m}return se.join("")}if(p={version:"1.4.1",ucs2:{decode:ie,encode:re},decode:N,encode:G,toASCII:function(J){return q(J,function(m){return A.test(m)?"xn--"+G(m):m})},toUnicode:function(J){return q(J,function(m){return z.test(m)?N(m.slice(4).toLowerCase()):m})}},_&&c)if(t.exports==_)c.exports=p;else for(C in p)p.hasOwnProperty(C)&&(_[C]=p[C]);else b.punycode=p}(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],46:[function(T,t,Q){"use strict";function x(_,c){return Object.prototype.hasOwnProperty.call(_,c)}t.exports=function(_,c,h,p){h=h||"=";var C={};if("string"!=typeof _||0===_.length)return C;var f=/\+/g;_=_.split(c=c||"&");var y=1e3;p&&"number"==typeof p.maxKeys&&(y=p.maxKeys);var M=_.length;y>0&&M>y&&(M=y);for(var g=0;g<M;++g){var u,O,L,k,H=_[g].replace(f,"%20"),z=H.indexOf(h);z>=0?(u=H.substr(0,z),O=H.substr(z+1)):(u=H,O=""),L=decodeURIComponent(u),k=decodeURIComponent(O),x(C,L)?b(C[L])?C[L].push(k):C[L]=[C[L],k]:C[L]=k}return C};var b=Array.isArray||function(_){return"[object Array]"===Object.prototype.toString.call(_)}},{}],47:[function(T,t,Q){"use strict";var x=function(h){switch(typeof h){case"string":return h;case"boolean":return h?"true":"false";case"number":return isFinite(h)?h:"";default:return""}};t.exports=function(h,p,C,f){return p=p||"&",C=C||"=",null===h&&(h=void 0),"object"==typeof h?_(c(h),function(y){var M=encodeURIComponent(x(y))+C;return b(h[y])?_(h[y],function(g){return M+encodeURIComponent(x(g))}).join(p):M+encodeURIComponent(x(h[y]))}).join(p):f?encodeURIComponent(x(f))+C+encodeURIComponent(x(h)):""};var b=Array.isArray||function(h){return"[object Array]"===Object.prototype.toString.call(h)};function _(h,p){if(h.map)return h.map(p);for(var C=[],f=0;f<h.length;f++)C.push(p(h[f],f));return C}var c=Object.keys||function(h){var p=[];for(var C in h)Object.prototype.hasOwnProperty.call(h,C)&&p.push(C);return p}},{}],48:[function(T,t,Q){"use strict";Q.decode=Q.parse=T("./decode"),Q.encode=Q.stringify=T("./encode")},{"./decode":46,"./encode":47}],49:[function(T,t,Q){"use strict";var x={};function b(c,h,p){p||(p=Error);var C=function(f){var y,M;function g(u,O,L){return f.call(this,"string"==typeof h?h:h(u,O,L))||this}return M=f,(y=g).prototype=Object.create(M.prototype),y.prototype.constructor=y,y.__proto__=M,g}(p);C.prototype.name=p.name,C.prototype.code=c,x[c]=C}function _(c,h){if(Array.isArray(c)){var p=c.length;return c=c.map(function(C){return String(C)}),p>2?"one of ".concat(h," ").concat(c.slice(0,p-1).join(", "),", or ")+c[p-1]:2===p?"one of ".concat(h," ").concat(c[0]," or ").concat(c[1]):"of ".concat(h," ").concat(c[0])}return"of ".concat(h," ").concat(String(c))}b("ERR_INVALID_OPT_VALUE",function(c,h){return'The value "'+h+'" is invalid for option "'+c+'"'},TypeError),b("ERR_INVALID_ARG_TYPE",function(c,h,p){var C,M,u,L;if("string"==typeof h&&"not "===h.substr(0,"not ".length)?(C="must not be",h=h.replace(/^not /,"")):C="must be",u=c,(void 0===L||L>u.length)&&(L=u.length)," argument"===u.substring(L-" argument".length,L))M="The ".concat(c," ").concat(C," ").concat(_(h,"type"));else{var g=function(u,O,L){return"number"!=typeof L&&(L=0),!(L+".".length>u.length)&&-1!==u.indexOf(".",L)}(c)?"property":"argument";M='The "'.concat(c,'" ').concat(g," ").concat(C," ").concat(_(h,"type"))}return M+". Received type ".concat(typeof p)},TypeError),b("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),b("ERR_METHOD_NOT_IMPLEMENTED",function(c){return"The "+c+" method is not implemented"}),b("ERR_STREAM_PREMATURE_CLOSE","Premature close"),b("ERR_STREAM_DESTROYED",function(c){return"Cannot call "+c+" after a stream was destroyed"}),b("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),b("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),b("ERR_STREAM_WRITE_AFTER_END","write after end"),b("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),b("ERR_UNKNOWN_ENCODING",function(c){return"Unknown encoding: "+c},TypeError),b("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=x},{}],50:[function(T,t,Q){(function(x){"use strict";var b=Object.keys||function(g){var u=[];for(var O in g)u.push(O);return u};t.exports=f;var _=T("./_stream_readable"),c=T("./_stream_writable");T("inherits")(f,_);for(var h=b(c.prototype),p=0;p<h.length;p++){var C=h[p];f.prototype[C]||(f.prototype[C]=c.prototype[C])}function f(g){if(!(this instanceof f))return new f(g);_.call(this,g),c.call(this,g),this.allowHalfOpen=!0,g&&(!1===g.readable&&(this.readable=!1),!1===g.writable&&(this.writable=!1),!1===g.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",y)))}function y(){this._writableState.ended||x.nextTick(M,this)}function M(g){g.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this,T("_process"))},{"./_stream_readable":52,"./_stream_writable":54,_process:44,inherits:29}],51:[function(T,t,Q){"use strict";t.exports=b;var x=T("./_stream_transform");function b(_){if(!(this instanceof b))return new b(_);x.call(this,_)}T("inherits")(b,x),b.prototype._transform=function(_,c,h){h(null,_)}},{"./_stream_transform":53,inherits:29}],52:[function(T,t,Q){(function(x,b){"use strict";var _;t.exports=E,E.ReadableState=W,T("events");var f,c=function(s,l){return s.listeners(l).length},h=T("./internal/streams/stream"),p=T("buffer").Buffer,C=b.Uint8Array||function(){},y=T("util");f=y&&y.debuglog?y.debuglog("stream"):function(){};var M,g,u,O=T("./internal/streams/buffer_list"),L=T("./internal/streams/destroy"),k=T("./internal/streams/state").getHighWaterMark,H=T("../errors").codes,z=H.ERR_INVALID_ARG_TYPE,A=H.ERR_STREAM_PUSH_AFTER_EOF,oe=H.ERR_METHOD_NOT_IMPLEMENTED,I=H.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;T("inherits")(E,h);var R=L.errorOrDestroy,F=["error","close","destroy","pause","resume"];function W(s,l,d){_=_||T("./_stream_duplex"),"boolean"!=typeof d&&(d=l instanceof _),this.objectMode=!!(s=s||{}).objectMode,d&&(this.objectMode=this.objectMode||!!s.readableObjectMode),this.highWaterMark=k(this,s,"readableHighWaterMark",d),this.buffer=new O,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==s.emitClose,this.autoDestroy=!!s.autoDestroy,this.destroyed=!1,this.defaultEncoding=s.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,s.encoding&&(M||(M=T("string_decoder/").StringDecoder),this.decoder=new M(s.encoding),this.encoding=s.encoding)}function E(s){if(_=_||T("./_stream_duplex"),!(this instanceof E))return new E(s);this._readableState=new W(s,this,this instanceof _),this.readable=!0,s&&("function"==typeof s.read&&(this._read=s.read),"function"==typeof s.destroy&&(this._destroy=s.destroy)),h.call(this)}function V(s,l,d,S,U){f("readableAddChunk",l);var Z,le,se,he,pe,K=s._readableState;if(null===l)K.reading=!1,function(le,se){if(f("onEofChunk"),!se.ended){if(se.decoder){var he=se.decoder.end();he&&he.length&&(se.buffer.push(he),se.length+=se.objectMode?1:he.length)}se.ended=!0,se.sync?te(le):(se.needReadable=!1,se.emittedReadable||(se.emittedReadable=!0,j(le)))}}(s,K);else if(U||(le=K,p.isBuffer(pe=se=l)||pe instanceof C||"string"==typeof se||void 0===se||le.objectMode||(he=new z("chunk",["string","Buffer","Uint8Array"],se)),Z=he),Z)R(s,Z);else if(K.objectMode||l&&l.length>0)if("string"==typeof l||K.objectMode||Object.getPrototypeOf(l)===p.prototype||(l=function(le){return p.from(le)}(l)),S)K.endEmitted?R(s,new I):q(s,K,l,!0);else if(K.ended)R(s,new A);else{if(K.destroyed)return!1;K.reading=!1,K.decoder&&!d?(l=K.decoder.write(l),K.objectMode||0!==l.length?q(s,K,l,!1):N(s,K)):q(s,K,l,!1)}else S||(K.reading=!1,N(s,K));return!K.ended&&(K.length<K.highWaterMark||0===K.length)}function q(s,l,d,S){l.flowing&&0===l.length&&!l.sync?(l.awaitDrain=0,s.emit("data",d)):(l.length+=l.objectMode?1:d.length,S?l.buffer.unshift(d):l.buffer.push(d),l.needReadable&&te(s)),N(s,l)}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(s){this._readableState&&(this._readableState.destroyed=s)}}),E.prototype.destroy=L.destroy,E.prototype._undestroy=L.undestroy,E.prototype._destroy=function(s,l){l(s)},E.prototype.push=function(s,l){var d,S=this._readableState;return S.objectMode?d=!0:"string"==typeof s&&((l=l||S.defaultEncoding)!==S.encoding&&(s=p.from(s,l),l=""),d=!0),V(this,s,l,!1,d)},E.prototype.unshift=function(s){return V(this,s,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(s){M||(M=T("string_decoder/").StringDecoder);var l=new M(s);this._readableState.decoder=l,this._readableState.encoding=this._readableState.decoder.encoding;for(var d=this._readableState.buffer.head,S="";null!==d;)S+=l.write(d.data),d=d.next;return this._readableState.buffer.clear(),""!==S&&this._readableState.buffer.push(S),this._readableState.length=S.length,this};var ie=1073741824;function re(s,l){return s<=0||0===l.length&&l.ended?0:l.objectMode?1:s!=s?l.flowing&&l.length?l.buffer.head.data.length:l.length:(s>l.highWaterMark&&(l.highWaterMark=((d=s)>=ie?d=ie:(d--,d|=d>>>1,d|=d>>>2,d|=d>>>4,d|=d>>>8,d|=d>>>16,d++),d)),s<=l.length?s:l.ended?l.length:(l.needReadable=!0,0));var d}function te(s){var l=s._readableState;f("emitReadable",l.needReadable,l.emittedReadable),l.needReadable=!1,l.emittedReadable||(f("emitReadable",l.flowing),l.emittedReadable=!0,x.nextTick(j,s))}function j(s){var l=s._readableState;f("emitReadable_",l.destroyed,l.length,l.ended),l.destroyed||!l.length&&!l.ended||(s.emit("readable"),l.emittedReadable=!1),l.needReadable=!l.flowing&&!l.ended&&l.length<=l.highWaterMark,B(s)}function N(s,l){l.readingMore||(l.readingMore=!0,x.nextTick(G,s,l))}function G(s,l){for(;!l.reading&&!l.ended&&(l.length<l.highWaterMark||l.flowing&&0===l.length);){var d=l.length;if(f("maybeReadMore read 0"),s.read(0),d===l.length)break}l.readingMore=!1}function J(s){var l=s._readableState;l.readableListening=s.listenerCount("readable")>0,l.resumeScheduled&&!l.paused?l.flowing=!0:s.listenerCount("data")>0&&s.resume()}function m(s){f("readable nexttick read 0"),s.read(0)}function w(s,l){f("resume",l.reading),l.reading||s.read(0),l.resumeScheduled=!1,s.emit("resume"),B(s),l.flowing&&!l.reading&&s.read(0)}function B(s){var l=s._readableState;for(f("flow",l.flowing);l.flowing&&null!==s.read(););}function D(s,l){return 0===l.length?null:(l.objectMode?d=l.buffer.shift():!s||s>=l.length?(d=l.decoder?l.buffer.join(""):1===l.buffer.length?l.buffer.first():l.buffer.concat(l.length),l.buffer.clear()):d=l.buffer.consume(s,l.decoder),d);var d}function $(s){var l=s._readableState;f("endReadable",l.endEmitted),l.endEmitted||(l.ended=!0,x.nextTick(ne,l,s))}function ne(s,l){if(f("endReadableNT",s.endEmitted,s.length),!s.endEmitted&&0===s.length&&(s.endEmitted=!0,l.readable=!1,l.emit("end"),s.autoDestroy)){var d=l._writableState;(!d||d.autoDestroy&&d.finished)&&l.destroy()}}function ee(s,l){for(var d=0,S=s.length;d<S;d++)if(s[d]===l)return d;return-1}E.prototype.read=function(s){f("read",s),s=parseInt(s,10);var l=this._readableState,d=s;if(0!==s&&(l.emittedReadable=!1),0===s&&l.needReadable&&((0!==l.highWaterMark?l.length>=l.highWaterMark:l.length>0)||l.ended))return f("read: emitReadable",l.length,l.ended),0===l.length&&l.ended?$(this):te(this),null;if(0===(s=re(s,l))&&l.ended)return 0===l.length&&$(this),null;var S,U=l.needReadable;return f("need readable",U),(0===l.length||l.length-s<l.highWaterMark)&&f("length less than watermark",U=!0),l.ended||l.reading?f("reading or ended",U=!1):U&&(f("do read"),l.reading=!0,l.sync=!0,0===l.length&&(l.needReadable=!0),this._read(l.highWaterMark),l.sync=!1,l.reading||(s=re(d,l))),null===(S=s>0?D(s,l):null)?(l.needReadable=l.length<=l.highWaterMark,s=0):(l.length-=s,l.awaitDrain=0),0===l.length&&(l.ended||(l.needReadable=!0),d!==s&&l.ended&&$(this)),null!==S&&this.emit("data",S),S},E.prototype._read=function(s){R(this,new oe("_read()"))},E.prototype.pipe=function(s,l){var d=this,S=this._readableState;switch(S.pipesCount){case 0:S.pipes=s;break;case 1:S.pipes=[S.pipes,s];break;default:S.pipes.push(s)}S.pipesCount+=1,f("pipe count=%d opts=%j",S.pipesCount,l);var U=l&&!1===l.end||s===x.stdout||s===x.stderr?De:K;function K(){f("onend"),s.end()}S.endEmitted?x.nextTick(U):d.once("end",U),s.on("unpipe",function Z(xe,Te){f("onunpipe"),xe===d&&Te&&!1===Te.hasUnpiped&&(Te.hasUnpiped=!0,f("cleanup"),s.removeListener("close",Ue),s.removeListener("finish",Be),s.removeListener("drain",le),s.removeListener("error",pe),s.removeListener("unpipe",Z),d.removeListener("end",K),d.removeListener("end",De),d.removeListener("data",he),se=!0,!S.awaitDrain||s._writableState&&!s._writableState.needDrain||le())});var xe,le=(xe=d,function(){var Te=xe._readableState;f("pipeOnDrain",Te.awaitDrain),Te.awaitDrain&&Te.awaitDrain--,0===Te.awaitDrain&&c(xe,"data")&&(Te.flowing=!0,B(xe))});s.on("drain",le);var se=!1;function he(xe){f("ondata");var Te=s.write(xe);f("dest.write",Te),!1===Te&&((1===S.pipesCount&&S.pipes===s||S.pipesCount>1&&-1!==ee(S.pipes,s))&&!se&&(f("false write response, pause",S.awaitDrain),S.awaitDrain++),d.pause())}function pe(xe){f("onerror",xe),De(),s.removeListener("error",pe),0===c(s,"error")&&R(s,xe)}function Ue(){s.removeListener("finish",Be),De()}function Be(){f("onfinish"),s.removeListener("close",Ue),De()}function De(){f("unpipe"),d.unpipe(s)}return d.on("data",he),function(xe,Te,Ae){if("function"==typeof xe.prependListener)return xe.prependListener(Te,Ae);xe._events&&xe._events[Te]?Array.isArray(xe._events[Te])?xe._events[Te].unshift(Ae):xe._events[Te]=[Ae,xe._events[Te]]:xe.on(Te,Ae)}(s,"error",pe),s.once("close",Ue),s.once("finish",Be),s.emit("pipe",d),S.flowing||(f("pipe resume"),d.resume()),s},E.prototype.unpipe=function(s){var l=this._readableState,d={hasUnpiped:!1};if(0===l.pipesCount)return this;if(1===l.pipesCount)return s&&s!==l.pipes||(s||(s=l.pipes),l.pipes=null,l.pipesCount=0,l.flowing=!1,s&&s.emit("unpipe",this,d)),this;if(!s){var S=l.pipes,U=l.pipesCount;l.pipes=null,l.pipesCount=0,l.flowing=!1;for(var Z=0;Z<U;Z++)S[Z].emit("unpipe",this,{hasUnpiped:!1});return this}var K=ee(l.pipes,s);return-1===K||(l.pipes.splice(K,1),l.pipesCount-=1,1===l.pipesCount&&(l.pipes=l.pipes[0]),s.emit("unpipe",this,d)),this},E.prototype.addListener=E.prototype.on=function(s,l){var d=h.prototype.on.call(this,s,l),S=this._readableState;return"data"===s?(S.readableListening=this.listenerCount("readable")>0,!1!==S.flowing&&this.resume()):"readable"===s&&(S.endEmitted||S.readableListening||(S.readableListening=S.needReadable=!0,S.flowing=!1,S.emittedReadable=!1,f("on readable",S.length,S.reading),S.length?te(this):S.reading||x.nextTick(m,this))),d},E.prototype.removeListener=function(s,l){var d=h.prototype.removeListener.call(this,s,l);return"readable"===s&&x.nextTick(J,this),d},E.prototype.removeAllListeners=function(s){var l=h.prototype.removeAllListeners.apply(this,arguments);return"readable"!==s&&void 0!==s||x.nextTick(J,this),l},E.prototype.resume=function(){var d,s=this._readableState;return s.flowing||(f("resume"),s.flowing=!s.readableListening,this,(d=s).resumeScheduled||(d.resumeScheduled=!0,x.nextTick(w,this,d))),s.paused=!1,this},E.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(s){var l=this,d=this._readableState,S=!1;for(var U in s.on("end",function(){if(f("wrapped end"),d.decoder&&!d.ended){var K=d.decoder.end();K&&K.length&&l.push(K)}l.push(null)}),s.on("data",function(K){f("wrapped data"),d.decoder&&(K=d.decoder.write(K)),(!d.objectMode||null!=K)&&(d.objectMode||K&&K.length)&&(l.push(K)||(S=!0,s.pause()))}),s)void 0===this[U]&&"function"==typeof s[U]&&(this[U]=function(K){return function(){return s[K].apply(s,arguments)}}(U));for(var Z=0;Z<F.length;Z++)s.on(F[Z],this.emit.bind(this,F[Z]));return this._read=function(K){f("wrapped _read",K),S&&(S=!1,s.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return void 0===g&&(g=T("./internal/streams/async_iterator")),g(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(s){this._readableState&&(this._readableState.flowing=s)}}),E._fromList=D,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(E.from=function(s,l){return void 0===u&&(u=T("./internal/streams/from")),u(E,s,l)})}).call(this,T("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":49,"./_stream_duplex":50,"./internal/streams/async_iterator":55,"./internal/streams/buffer_list":56,"./internal/streams/destroy":57,"./internal/streams/from":59,"./internal/streams/state":61,"./internal/streams/stream":62,_process:44,buffer:12,events:27,inherits:29,"string_decoder/":67,util:11}],53:[function(T,t,Q){"use strict";t.exports=C;var x=T("../errors").codes,b=x.ERR_METHOD_NOT_IMPLEMENTED,_=x.ERR_MULTIPLE_CALLBACK,c=x.ERR_TRANSFORM_ALREADY_TRANSFORMING,h=x.ERR_TRANSFORM_WITH_LENGTH_0,p=T("./_stream_duplex");function C(M){if(!(this instanceof C))return new C(M);p.call(this,M),this._transformState={afterTransform:function(g,u){var O=this._transformState;O.transforming=!1;var L=O.writecb;if(null===L)return this.emit("error",new _);O.writechunk=null,O.writecb=null,null!=u&&this.push(u),L(g);var k=this._readableState;k.reading=!1,(k.needReadable||k.length<k.highWaterMark)&&this._read(k.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,M&&("function"==typeof M.transform&&(this._transform=M.transform),"function"==typeof M.flush&&(this._flush=M.flush)),this.on("prefinish",f)}function f(){var M=this;"function"!=typeof this._flush||this._readableState.destroyed?y(this,null,null):this._flush(function(g,u){y(M,g,u)})}function y(M,g,u){if(g)return M.emit("error",g);if(null!=u&&M.push(u),M._writableState.length)throw new h;if(M._transformState.transforming)throw new c;return M.push(null)}T("inherits")(C,p),C.prototype.push=function(M,g){return this._transformState.needTransform=!1,p.prototype.push.call(this,M,g)},C.prototype._transform=function(M,g,u){u(new b("_transform()"))},C.prototype._write=function(M,g,u){var O=this._transformState;if(O.writecb=u,O.writechunk=M,O.writeencoding=g,!O.transforming){var L=this._readableState;(O.needTransform||L.needReadable||L.length<L.highWaterMark)&&this._read(L.highWaterMark)}},C.prototype._read=function(M){var g=this._transformState;null===g.writechunk||g.transforming?g.needTransform=!0:(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform))},C.prototype._destroy=function(M,g){p.prototype._destroy.call(this,M,function(u){g(u)})}},{"../errors":49,"./_stream_duplex":50,inherits:29}],54:[function(T,t,Q){(function(x,b){"use strict";function _(N){var G=this;this.next=null,this.entry=null,this.finish=function(){!function(J,m,w){var B=J.entry;for(J.entry=null;B;){var D=B.callback;m.pendingcb--,D(undefined),B=B.next}m.corkedRequestsFree.next=J}(G,N)}}var c;t.exports=E,E.WritableState=W;var y,h={deprecate:T("util-deprecate")},p=T("./internal/streams/stream"),C=T("buffer").Buffer,f=b.Uint8Array||function(){},M=T("./internal/streams/destroy"),g=T("./internal/streams/state").getHighWaterMark,u=T("../errors").codes,O=u.ERR_INVALID_ARG_TYPE,L=u.ERR_METHOD_NOT_IMPLEMENTED,k=u.ERR_MULTIPLE_CALLBACK,H=u.ERR_STREAM_CANNOT_PIPE,z=u.ERR_STREAM_DESTROYED,A=u.ERR_STREAM_NULL_VALUES,oe=u.ERR_STREAM_WRITE_AFTER_END,I=u.ERR_UNKNOWN_ENCODING,R=M.errorOrDestroy;function F(){}function W(N,G,J){c=c||T("./_stream_duplex"),"boolean"!=typeof J&&(J=G instanceof c),this.objectMode=!!(N=N||{}).objectMode,J&&(this.objectMode=this.objectMode||!!N.writableObjectMode),this.highWaterMark=g(this,N,"writableHighWaterMark",J),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===N.decodeStrings),this.defaultEncoding=N.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(w){!function(B,D){var l,$=B._writableState,ne=$.sync,ee=$.writecb;if("function"!=typeof ee)throw new k;if((l=$).writing=!1,l.writecb=null,l.length-=l.writelen,l.writelen=0,D)!function(l,d,S,U,Z){--d.pendingcb,S?(x.nextTick(Z,U),x.nextTick(j,l,d),l._writableState.errorEmitted=!0,R(l,U)):(Z(U),l._writableState.errorEmitted=!0,R(l,U),j(l,d))}(B,$,ne,D,ee);else{var s=re($)||B.destroyed;s||$.corked||$.bufferProcessing||!$.bufferedRequest||ie(B,$),ne?x.nextTick(q,B,$,s,ee):q(B,$,s,ee)}}(G,w)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==N.emitClose,this.autoDestroy=!!N.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new _(this)}function E(N){var G=this instanceof(c=c||T("./_stream_duplex"));if(!G&&!y.call(E,this))return new E(N);this._writableState=new W(N,this,G),this.writable=!0,N&&("function"==typeof N.write&&(this._write=N.write),"function"==typeof N.writev&&(this._writev=N.writev),"function"==typeof N.destroy&&(this._destroy=N.destroy),"function"==typeof N.final&&(this._final=N.final)),p.call(this)}function V(N,G,J,m,w,B,D){G.writelen=m,G.writecb=D,G.writing=!0,G.sync=!0,G.destroyed?G.onwrite(new z("write")):J?N._writev(w,G.onwrite):N._write(w,B,G.onwrite),G.sync=!1}function q(N,G,J,m){var w,B;J||(w=N,0===(B=G).length&&B.needDrain&&(B.needDrain=!1,w.emit("drain"))),G.pendingcb--,m(),j(N,G)}function ie(N,G){G.bufferProcessing=!0;var J=G.bufferedRequest;if(N._writev&&J&&J.next){var w=new Array(G.bufferedRequestCount),B=G.corkedRequestsFree;B.entry=J;for(var D=0,$=!0;J;)w[D]=J,J.isBuf||($=!1),J=J.next,D+=1;w.allBuffers=$,V(N,G,!0,G.length,w,"",B.finish),G.pendingcb++,G.lastBufferedRequest=null,B.next?(G.corkedRequestsFree=B.next,B.next=null):G.corkedRequestsFree=new _(G),G.bufferedRequestCount=0}else{for(;J;){var ne=J.chunk;if(V(N,G,!1,G.objectMode?1:ne.length,ne,J.encoding,J.callback),J=J.next,G.bufferedRequestCount--,G.writing)break}null===J&&(G.lastBufferedRequest=null)}G.bufferedRequest=J,G.bufferProcessing=!1}function re(N){return N.ending&&0===N.length&&null===N.bufferedRequest&&!N.finished&&!N.writing}function te(N,G){N._final(function(J){G.pendingcb--,J&&R(N,J),G.prefinished=!0,N.emit("prefinish"),j(N,G)})}function j(N,G){var w,B,J=re(G);if(J&&(w=N,(B=G).prefinished||B.finalCalled||("function"!=typeof w._final||B.destroyed?(B.prefinished=!0,w.emit("prefinish")):(B.pendingcb++,B.finalCalled=!0,x.nextTick(te,w,B))),0===G.pendingcb&&(G.finished=!0,N.emit("finish"),G.autoDestroy))){var m=N._readableState;(!m||m.autoDestroy&&m.endEmitted)&&N.destroy()}return J}T("inherits")(E,p),W.prototype.getBuffer=function(){for(var N=this.bufferedRequest,G=[];N;)G.push(N),N=N.next;return G},function(){try{Object.defineProperty(W.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(y=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(N){return!!y.call(this,N)||this===E&&N&&N._writableState instanceof W}})):y=function(N){return N instanceof this},E.prototype.pipe=function(){R(this,new H)},E.prototype.write=function(N,G,J){var m,$,ne,ee,w=this._writableState,B=!1,D=!w.objectMode&&(C.isBuffer(m=N)||m instanceof f);return D&&!C.isBuffer(N)&&(N=C.from(N)),"function"==typeof G&&(J=G,G=null),D?G="buffer":G||(G=w.defaultEncoding),"function"!=typeof J&&(J=F),w.ending?($=this,ne=J,ee=new oe,R($,ee),x.nextTick(ne,ee)):(D||function($,ne,ee,s){var l;return null===ee?l=new A:"string"==typeof ee||ne.objectMode||(l=new O("chunk",["string","Buffer"],ee)),!l||(R($,l),x.nextTick(s,l),!1)}(this,w,N,J))&&(w.pendingcb++,B=function($,ne,ee,s,l,d){if(!ee){var S=(se=s,(le=ne).objectMode||!1===le.decodeStrings||"string"!=typeof se||(se=C.from(se,l)),se);s!==S&&(ee=!0,l="buffer",s=S)}var le,se,U=ne.objectMode?1:s.length;ne.length+=U;var Z=ne.length<ne.highWaterMark;if(Z||(ne.needDrain=!0),ne.writing||ne.corked){var K=ne.lastBufferedRequest;ne.lastBufferedRequest={chunk:s,encoding:l,isBuf:ee,callback:d,next:null},K?K.next=ne.lastBufferedRequest:ne.bufferedRequest=ne.lastBufferedRequest,ne.bufferedRequestCount+=1}else V($,ne,!1,U,s,l,d);return Z}(this,w,D,N,G,J)),B},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var N=this._writableState;N.corked&&(N.corked--,N.writing||N.corked||N.bufferProcessing||!N.bufferedRequest||ie(this,N))},E.prototype.setDefaultEncoding=function(N){if("string"==typeof N&&(N=N.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((N+"").toLowerCase())>-1))throw new I(N);return this._writableState.defaultEncoding=N,this},Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(N,G,J){J(new L("_write()"))},E.prototype._writev=null,E.prototype.end=function(N,G,J){var w,B,D,m=this._writableState;return"function"==typeof N?(J=N,N=null,G=null):"function"==typeof G&&(J=G,G=null),null!=N&&this.write(N,G),m.corked&&(m.corked=1,this.uncork()),m.ending||(w=this,D=J,(B=m).ending=!0,j(w,B),D&&(B.finished?x.nextTick(D):w.once("finish",D)),B.ended=!0,w.writable=!1),this},Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(N){this._writableState&&(this._writableState.destroyed=N)}}),E.prototype.destroy=M.destroy,E.prototype._undestroy=M.undestroy,E.prototype._destroy=function(N,G){G(N)}}).call(this,T("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":49,"./_stream_duplex":50,"./internal/streams/destroy":57,"./internal/streams/state":61,"./internal/streams/stream":62,_process:44,buffer:12,inherits:29,"util-deprecate":71}],55:[function(T,t,Q){(function(x){"use strict";var b;function _(H,z,A){return z in H?Object.defineProperty(H,z,{value:A,enumerable:!0,configurable:!0,writable:!0}):H[z]=A,H}var c=T("./end-of-stream"),h=Symbol("lastResolve"),p=Symbol("lastReject"),C=Symbol("error"),f=Symbol("ended"),y=Symbol("lastPromise"),M=Symbol("handlePromise"),g=Symbol("stream");function u(H,z){return{value:H,done:z}}function O(H){var z=H[h];if(null!==z){var A=H[g].read();null!==A&&(H[y]=null,H[h]=null,H[p]=null,z(u(A,!1)))}}var L=Object.getPrototypeOf(function(){}),k=Object.setPrototypeOf((_(b={get stream(){return this[g]},next:function(){var H=this,z=this[C];if(null!==z)return Promise.reject(z);if(this[f])return Promise.resolve(u(void 0,!0));if(this[g].destroyed)return new Promise(function(R,F){x.nextTick(function(){H[C]?F(H[C]):R(u(void 0,!0))})});var A,R,F,oe=this[y];if(oe)A=new Promise((R=oe,F=this,function(W,E){R.then(function(){F[f]?W(u(void 0,!0)):F[M](W,E)},E)}));else{var I=this[g].read();if(null!==I)return Promise.resolve(u(I,!1));A=new Promise(this[M])}return this[y]=A,A}},Symbol.asyncIterator,function(){return this}),_(b,"return",function(){var H=this;return new Promise(function(z,A){H[g].destroy(null,function(oe){oe?A(oe):z(u(void 0,!0))})})}),b),L);t.exports=function(H){var z,A=Object.create(k,(_(z={},g,{value:H,writable:!0}),_(z,h,{value:null,writable:!0}),_(z,p,{value:null,writable:!0}),_(z,C,{value:null,writable:!0}),_(z,f,{value:H._readableState.endEmitted,writable:!0}),_(z,M,{value:function(oe,I){var R=A[g].read();R?(A[y]=null,A[h]=null,A[p]=null,oe(u(R,!1))):(A[h]=oe,A[p]=I)},writable:!0}),z));return A[y]=null,c(H,function(oe){if(oe&&"ERR_STREAM_PREMATURE_CLOSE"!==oe.code){var I=A[p];return null!==I&&(A[y]=null,A[h]=null,A[p]=null,I(oe)),void(A[C]=oe)}var R=A[h];null!==R&&(A[y]=null,A[h]=null,A[p]=null,R(u(void 0,!0))),A[f]=!0}),H.on("readable",function(oe){x.nextTick(O,oe)}.bind(null,A)),A}}).call(this,T("_process"))},{"./end-of-stream":58,_process:44}],56:[function(T,t,Q){"use strict";function x(C,f){var y=Object.keys(C);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(C);f&&(M=M.filter(function(g){return Object.getOwnPropertyDescriptor(C,g).enumerable})),y.push.apply(y,M)}return y}function b(C,f,y){return f in C?Object.defineProperty(C,f,{value:y,enumerable:!0,configurable:!0,writable:!0}):C[f]=y,C}function _(C,f){for(var y=0;y<f.length;y++){var M=f[y];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(C,M.key,M)}}var c=T("buffer").Buffer,h=T("util").inspect,p=h&&h.custom||"inspect";t.exports=function(){function C(){(function(g,u){if(!(g instanceof u))throw new TypeError("Cannot call a class as a function")})(this,C),this.head=null,this.tail=null,this.length=0}var f,y;return f=C,(y=[{key:"push",value:function(g){var u={data:g,next:null};this.length>0?this.tail.next=u:this.head=u,this.tail=u,++this.length}},{key:"unshift",value:function(g){var u={data:g,next:this.head};0===this.length&&(this.tail=u),this.head=u,++this.length}},{key:"shift",value:function(){if(0!==this.length){var g=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(0===this.length)return"";for(var u=this.head,O=""+u.data;u=u.next;)O+=g+u.data;return O}},{key:"concat",value:function(g){if(0===this.length)return c.alloc(0);for(var k=c.allocUnsafe(g>>>0),H=this.head,z=0;H;)c.prototype.copy.call(H.data,k,z),z+=H.data.length,H=H.next;return k}},{key:"consume",value:function(g,u){var O;return g<this.head.data.length?(O=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):O=g===this.head.data.length?this.shift():u?this._getString(g):this._getBuffer(g),O}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var u=this.head,O=1,L=u.data;for(g-=L.length;u=u.next;){var k=u.data,H=g>k.length?k.length:g;if(L+=H===k.length?k:k.slice(0,g),0==(g-=H)){H===k.length?(++O,this.head=u.next?u.next:this.tail=null):(this.head=u,u.data=k.slice(H));break}++O}return this.length-=O,L}},{key:"_getBuffer",value:function(g){var u=c.allocUnsafe(g),O=this.head,L=1;for(O.data.copy(u),g-=O.data.length;O=O.next;){var k=O.data,H=g>k.length?k.length:g;if(k.copy(u,u.length-g,0,H),0==(g-=H)){H===k.length?(++L,this.head=O.next?O.next:this.tail=null):(this.head=O,O.data=k.slice(H));break}++L}return this.length-=L,u}},{key:p,value:function(g,u){return h(this,function(O){for(var L=1;L<arguments.length;L++){var k=null!=arguments[L]?arguments[L]:{};L%2?x(Object(k),!0).forEach(function(H){b(O,H,k[H])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(k)):x(Object(k)).forEach(function(H){Object.defineProperty(O,H,Object.getOwnPropertyDescriptor(k,H))})}return O}({},u,{depth:0,customInspect:!1}))}}])&&_(f.prototype,y),C}()},{buffer:12,util:11}],57:[function(T,t,Q){(function(x){"use strict";function b(h,p){c(h,p),_(h)}function _(h){h._writableState&&!h._writableState.emitClose||h._readableState&&!h._readableState.emitClose||h.emit("close")}function c(h,p){h.emit("error",p)}t.exports={destroy:function(h,p){var C=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(p?p(h):h&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,x.nextTick(c,this,h)):x.nextTick(c,this,h)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(h||null,function(M){!p&&M?C._writableState?C._writableState.errorEmitted?x.nextTick(_,C):(C._writableState.errorEmitted=!0,x.nextTick(b,C,M)):x.nextTick(b,C,M):p?(x.nextTick(_,C),p(M)):x.nextTick(_,C)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(h,p){var C=h._readableState,f=h._writableState;C&&C.autoDestroy||f&&f.autoDestroy?h.destroy(p):h.emit("error",p)}}}).call(this,T("_process"))},{_process:44}],58:[function(T,t,Q){"use strict";var x=T("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function b(){}t.exports=function _(c,h,p){if("function"==typeof h)return _(c,null,h);var z,A;h||(h={}),z=p||b,A=!1,p=function(){if(!A){A=!0;for(var oe=arguments.length,I=new Array(oe),R=0;R<oe;R++)I[R]=arguments[R];z.apply(this,I)}};var C=h.readable||!1!==h.readable&&c.readable,f=h.writable||!1!==h.writable&&c.writable,y=function(){c.writable||g()},M=c._writableState&&c._writableState.finished,g=function(){f=!1,M=!0,C||p.call(c)},u=c._readableState&&c._readableState.endEmitted,O=function(){C=!1,u=!0,f||p.call(c)},L=function(z){p.call(c,z)},k=function(){var z;return C&&!u?(c._readableState&&c._readableState.ended||(z=new x),p.call(c,z)):f&&!M?(c._writableState&&c._writableState.ended||(z=new x),p.call(c,z)):void 0},H=function(){c.req.on("finish",g)};return function(z){return z.setHeader&&"function"==typeof z.abort}(c)?(c.on("complete",g),c.on("abort",k),c.req?H():c.on("request",H)):f&&!c._writableState&&(c.on("end",y),c.on("close",y)),c.on("end",O),c.on("finish",g),!1!==h.error&&c.on("error",L),c.on("close",k),function(){c.removeListener("complete",g),c.removeListener("abort",k),c.removeListener("request",H),c.req&&c.req.removeListener("finish",g),c.removeListener("end",y),c.removeListener("close",y),c.removeListener("finish",g),c.removeListener("end",O),c.removeListener("error",L),c.removeListener("close",k)}}},{"../../../errors":49}],59:[function(T,t,Q){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],60:[function(T,t,Q){"use strict";var x,b=T("../../../errors").codes,_=b.ERR_MISSING_ARGS,c=b.ERR_STREAM_DESTROYED;function h(f){if(f)throw f}function p(f){f()}function C(f,y){return f.pipe(y)}t.exports=function(){for(var f=arguments.length,y=new Array(f),M=0;M<f;M++)y[M]=arguments[M];var g,L,u=(L=y).length?"function"!=typeof L[L.length-1]?h:L.pop():h;if(Array.isArray(y[0])&&(y=y[0]),y.length<2)throw new _("streams");var O=y.map(function(L,k){var H=k<y.length-1;return function(z,A,oe,I){var W,E;W=I,E=!1,I=function(){E||(E=!0,W.apply(void 0,arguments))};var R=!1;z.on("close",function(){R=!0}),void 0===x&&(x=T("./end-of-stream")),x(z,{readable:A,writable:oe},function(W){if(W)return I(W);R=!0,I()});var F=!1;return function(W){if(!R&&!F)return F=!0,function(E){return E.setHeader&&"function"==typeof E.abort}(z)?z.abort():"function"==typeof z.destroy?z.destroy():void I(W||new c("pipe"))}}(L,H,k>0,function(z){g||(g=z),z&&O.forEach(p),H||(O.forEach(p),u(g))})});return y.reduce(C)}},{"../../../errors":49,"./end-of-stream":58}],61:[function(T,t,Q){"use strict";var x=T("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(b,_,c,h){var C,p=null!=(C=_).highWaterMark?C.highWaterMark:h?C[c]:null;if(null!=p){if(!isFinite(p)||Math.floor(p)!==p||p<0)throw new x(h?c:"highWaterMark",p);return Math.floor(p)}return b.objectMode?16:16384}}},{"../../../errors":49}],62:[function(T,t,Q){arguments[4][24][0].apply(Q,arguments)},{dup:24,events:27}],63:[function(T,t,Q){(Q=t.exports=T("./lib/_stream_readable.js")).Stream=Q,Q.Readable=Q,Q.Writable=T("./lib/_stream_writable.js"),Q.Duplex=T("./lib/_stream_duplex.js"),Q.Transform=T("./lib/_stream_transform.js"),Q.PassThrough=T("./lib/_stream_passthrough.js"),Q.finished=T("./lib/internal/streams/end-of-stream.js"),Q.pipeline=T("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":50,"./lib/_stream_passthrough.js":51,"./lib/_stream_readable.js":52,"./lib/_stream_transform.js":53,"./lib/_stream_writable.js":54,"./lib/internal/streams/end-of-stream.js":58,"./lib/internal/streams/pipeline.js":60}],64:[function(T,t,Q){"use strict";t.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("interval needed");var x;if(arguments.length>0){x=new Array(arguments.length-2);for(var b=0;b<x.length;b++)x[b]=arguments[b+2]}return new function(_,c,h){var p=this;this._callback=_,this._args=h,this._interval=setInterval(_,c,this._args),this.reschedule=function(C){C||(C=p._interval),p._interval&&clearInterval(p._interval),p._interval=setInterval(p._callback,C,p._args)},this.clear=function(){p._interval&&(clearInterval(p._interval),p._interval=void 0)},this.destroy=function(){p._interval&&clearInterval(p._interval),p._callback=void 0,p._interval=void 0,p._args=void 0}}(arguments[0],arguments[1],x)}},{}],65:[function(T,t,Q){var x=T("buffer"),b=x.Buffer;function _(h,p){for(var C in h)p[C]=h[C]}function c(h,p,C){return b(h,p,C)}b.from&&b.alloc&&b.allocUnsafe&&b.allocUnsafeSlow?t.exports=x:(_(x,Q),Q.Buffer=c),_(b,c),c.from=function(h,p,C){if("number"==typeof h)throw new TypeError("Argument must not be a number");return b(h,p,C)},c.alloc=function(h,p,C){if("number"!=typeof h)throw new TypeError("Argument must be a number");var f=b(h);return void 0!==p?"string"==typeof C?f.fill(p,C):f.fill(p):f.fill(0),f},c.allocUnsafe=function(h){if("number"!=typeof h)throw new TypeError("Argument must be a number");return b(h)},c.allocUnsafeSlow=function(h){if("number"!=typeof h)throw new TypeError("Argument must be a number");return x.SlowBuffer(h)}},{buffer:12}],66:[function(T,t,Q){t.exports=function(x){var _,b=x._readableState;return b?b.objectMode||"number"==typeof x._duplexState?x.read():x.read((_=b).buffer.length?_.buffer.head?_.buffer.head.data.length:_.buffer[0].length:_.length):null}},{}],67:[function(T,t,Q){"use strict";var x=T("safe-buffer").Buffer,b=x.isEncoding||function(u){switch((u=""+u)&&u.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _(u){var O;switch(this.encoding=function(L){var k=function(H){if(!H)return"utf8";for(var z;;)switch(H){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return H;default:if(z)return;H=(""+H).toLowerCase(),z=!0}}(L);if("string"!=typeof k&&(x.isEncoding===b||!b(L)))throw new Error("Unknown encoding: "+L);return k||L}(u),this.encoding){case"utf16le":this.text=p,this.end=C,O=4;break;case"utf8":this.fillLast=h,O=4;break;case"base64":this.text=f,this.end=y,O=3;break;default:return this.write=M,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=x.allocUnsafe(O)}function c(u){return u<=127?0:u>>5==6?2:u>>4==14?3:u>>3==30?4:u>>6==2?-1:-2}function h(u){var O=this.lastTotal-this.lastNeed,L=function(k,H,z){if(128!=(192&H[0]))return k.lastNeed=0,"\ufffd";if(k.lastNeed>1&&H.length>1){if(128!=(192&H[1]))return k.lastNeed=1,"\ufffd";if(k.lastNeed>2&&H.length>2&&128!=(192&H[2]))return k.lastNeed=2,"\ufffd"}}(this,u);return void 0!==L?L:this.lastNeed<=u.length?(u.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(u.copy(this.lastChar,O,0,u.length),void(this.lastNeed-=u.length))}function p(u,O){if((u.length-O)%2==0){var L=u.toString("utf16le",O);if(L){var k=L.charCodeAt(L.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1],L.slice(0,-1)}return L}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=u[u.length-1],u.toString("utf16le",O,u.length-1)}function C(u){var O=u&&u.length?this.write(u):"";return this.lastNeed?O+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):O}function f(u,O){var L=(u.length-O)%3;return 0===L?u.toString("base64",O):(this.lastNeed=3-L,this.lastTotal=3,1===L?this.lastChar[0]=u[u.length-1]:(this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1]),u.toString("base64",O,u.length-L))}function y(u){var O=u&&u.length?this.write(u):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function M(u){return u.toString(this.encoding)}function g(u){return u&&u.length?this.write(u):""}Q.StringDecoder=_,_.prototype.write=function(u){if(0===u.length)return"";var O,L;if(this.lastNeed){if(void 0===(O=this.fillLast(u)))return"";L=this.lastNeed,this.lastNeed=0}else L=0;return L<u.length?O?O+this.text(u,L):this.text(u,L):O||""},_.prototype.end=function(u){var O=u&&u.length?this.write(u):"";return this.lastNeed?O+"\ufffd":O},_.prototype.text=function(u,O){var L=function(H,z,A){var oe=z.length-1;if(oe<A)return 0;var I=c(z[oe]);return I>=0?(I>0&&(H.lastNeed=I-1),I):--oe<A||-2===I?0:(I=c(z[oe]))>=0?(I>0&&(H.lastNeed=I-2),I):--oe<A||-2===I?0:(I=c(z[oe]))>=0?(I>0&&(2===I?I=0:H.lastNeed=I-3),I):0}(this,u,O);if(!this.lastNeed)return u.toString("utf8",O);this.lastTotal=L;var k=u.length-(L-this.lastNeed);return u.copy(this.lastChar,0,k),u.toString("utf8",O,k)},_.prototype.fillLast=function(u){if(this.lastNeed<=u.length)return u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,u.length),this.lastNeed-=u.length}},{"safe-buffer":65}],68:[function(T,t,Q){(function(x,b){var _=T("process/browser.js").nextTick,c=Function.prototype.apply,h=Array.prototype.slice,p={},C=0;function f(y,M){this._id=y,this._clearFn=M}Q.setTimeout=function(){return new f(c.call(setTimeout,window,arguments),clearTimeout)},Q.setInterval=function(){return new f(c.call(setInterval,window,arguments),clearInterval)},Q.clearTimeout=Q.clearInterval=function(y){y.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},Q.enroll=function(y,M){clearTimeout(y._idleTimeoutId),y._idleTimeout=M},Q.unenroll=function(y){clearTimeout(y._idleTimeoutId),y._idleTimeout=-1},Q._unrefActive=Q.active=function(y){clearTimeout(y._idleTimeoutId);var M=y._idleTimeout;M>=0&&(y._idleTimeoutId=setTimeout(function(){y._onTimeout&&y._onTimeout()},M))},Q.setImmediate="function"==typeof x?x:function(y){var M=C++,g=!(arguments.length<2)&&h.call(arguments,1);return p[M]=!0,_(function(){p[M]&&(g?y.apply(null,g):y.call(null),Q.clearImmediate(M))}),M},Q.clearImmediate="function"==typeof b?b:function(y){delete p[y]}}).call(this,T("timers").setImmediate,T("timers").clearImmediate)},{"process/browser.js":44,timers:68}],69:[function(T,t,Q){"use strict";var x=T("punycode"),b=T("./util");function _(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}Q.parse=z,Q.resolve=function(A,oe){return z(A,!1,!0).resolve(oe)},Q.resolveObject=function(A,oe){return A?z(A,!1,!0).resolveObject(oe):oe},Q.format=function(A){return b.isString(A)&&(A=z(A)),A instanceof _?A.format():_.prototype.format.call(A)},Q.Url=_;var c=/^([a-z0-9.+-]+:)/i,h=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,C=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),f=["'"].concat(C),y=["%","/","?",";","#"].concat(f),M=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,u=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,O={javascript:!0,"javascript:":!0},L={javascript:!0,"javascript:":!0},k={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},H=T("querystring");function z(A,oe,I){if(A&&b.isObject(A)&&A instanceof _)return A;var R=new _;return R.parse(A,oe,I),R}_.prototype.parse=function(A,oe,I){if(!b.isString(A))throw new TypeError("Parameter 'url' must be a string, not "+typeof A);var R=A.indexOf("?"),F=-1!==R&&R<A.indexOf("#")?"?":"#",W=A.split(F);W[0]=W[0].replace(/\\/g,"/");var E=A=W.join(F);if(E=E.trim(),!I&&1===A.split("#").length){var V=p.exec(E);if(V)return this.path=E,this.href=E,this.pathname=V[1],V[2]?(this.search=V[2],this.query=oe?H.parse(this.search.substr(1)):this.search.substr(1)):oe&&(this.search="",this.query={}),this}var q=c.exec(E);if(q){var ie=(q=q[0]).toLowerCase();this.protocol=ie,E=E.substr(q.length)}if(I||q||E.match(/^\/\/[^@\/]+@[^@\/]+/)){var re="//"===E.substr(0,2);!re||q&&L[q]||(E=E.substr(2),this.slashes=!0)}if(!L[q]&&(re||q&&!k[q])){for(var te,j,N=-1,G=0;G<M.length;G++)-1!==(J=E.indexOf(M[G]))&&(-1===N||J<N)&&(N=J);for(-1!==(j=-1===N?E.lastIndexOf("@"):E.lastIndexOf("@",N))&&(te=E.slice(0,j),E=E.slice(j+1),this.auth=decodeURIComponent(te)),N=-1,G=0;G<y.length;G++){var J;-1!==(J=E.indexOf(y[G]))&&(-1===N||J<N)&&(N=J)}-1===N&&(N=E.length),this.host=E.slice(0,N),E=E.slice(N),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var w=this.hostname.split(/\./),B=(G=0,w.length);G<B;G++){var D=w[G];if(D&&!D.match(g)){for(var $="",ne=0,ee=D.length;ne<ee;ne++)D.charCodeAt(ne)>127?$+="x":$+=D[ne];if(!$.match(g)){var s=w.slice(0,G),l=w.slice(G+1),d=D.match(u);d&&(s.push(d[1]),l.unshift(d[2])),l.length&&(E="/"+l.join(".")+E),this.hostname=s.join(".");break}}}this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),m||(this.hostname=x.toASCII(this.hostname));var S=this.port?":"+this.port:"";this.host=(this.hostname||"")+S,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==E[0]&&(E="/"+E))}if(!O[ie])for(G=0,B=f.length;G<B;G++){var Z=f[G];if(-1!==E.indexOf(Z)){var K=encodeURIComponent(Z);K===Z&&(K=escape(Z)),E=E.split(Z).join(K)}}var le=E.indexOf("#");-1!==le&&(this.hash=E.substr(le),E=E.slice(0,le));var se=E.indexOf("?");return-1!==se?(this.search=E.substr(se),this.query=E.substr(se+1),oe&&(this.query=H.parse(this.query)),E=E.slice(0,se)):oe&&(this.search="",this.query={}),E&&(this.pathname=E),k[ie]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(S=this.pathname||"")+(this.search||"")),this.href=this.format(),this},_.prototype.format=function(){var A=this.auth||"";A&&(A=(A=encodeURIComponent(A)).replace(/%3A/i,":"),A+="@");var oe=this.protocol||"",I=this.pathname||"",R=this.hash||"",F=!1,W="";this.host?F=A+this.host:this.hostname&&(F=A+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(F+=":"+this.port)),this.query&&b.isObject(this.query)&&Object.keys(this.query).length&&(W=H.stringify(this.query));var E=this.search||W&&"?"+W||"";return oe&&":"!==oe.substr(-1)&&(oe+=":"),this.slashes||(!oe||k[oe])&&!1!==F?(F="//"+(F||""),I&&"/"!==I.charAt(0)&&(I="/"+I)):F||(F=""),R&&"#"!==R.charAt(0)&&(R="#"+R),E&&"?"!==E.charAt(0)&&(E="?"+E),oe+F+(I=I.replace(/[?#]/g,function(V){return encodeURIComponent(V)}))+(E=E.replace("#","%23"))+R},_.prototype.resolve=function(A){return this.resolveObject(z(A,!1,!0)).format()},_.prototype.resolveObject=function(A){if(b.isString(A)){var oe=new _;oe.parse(A,!1,!0),A=oe}for(var I=new _,R=Object.keys(this),F=0;F<R.length;F++){var W=R[F];I[W]=this[W]}if(I.hash=A.hash,""===A.href)return I.href=I.format(),I;if(A.slashes&&!A.protocol){for(var E=Object.keys(A),V=0;V<E.length;V++){var q=E[V];"protocol"!==q&&(I[q]=A[q])}return k[I.protocol]&&I.hostname&&!I.pathname&&(I.path=I.pathname="/"),I.href=I.format(),I}if(A.protocol&&A.protocol!==I.protocol){if(!k[A.protocol]){for(var ie=Object.keys(A),re=0;re<ie.length;re++){var te=ie[re];I[te]=A[te]}return I.href=I.format(),I}if(I.protocol=A.protocol,A.host||L[A.protocol])I.pathname=A.pathname;else{for(var j=(A.pathname||"").split("/");j.length&&!(A.host=j.shift()););A.host||(A.host=""),A.hostname||(A.hostname=""),""!==j[0]&&j.unshift(""),j.length<2&&j.unshift(""),I.pathname=j.join("/")}return I.search=A.search,I.query=A.query,I.host=A.host||"",I.auth=A.auth,I.hostname=A.hostname||A.host,I.port=A.port,(I.pathname||I.search)&&(I.path=(I.pathname||"")+(I.search||"")),I.slashes=I.slashes||A.slashes,I.href=I.format(),I}var J=I.pathname&&"/"===I.pathname.charAt(0),m=A.host||A.pathname&&"/"===A.pathname.charAt(0),w=m||J||I.host&&A.pathname,B=w,D=I.pathname&&I.pathname.split("/")||[],$=(j=A.pathname&&A.pathname.split("/")||[],I.protocol&&!k[I.protocol]);if($&&(I.hostname="",I.port=null,I.host&&(""===D[0]?D[0]=I.host:D.unshift(I.host)),I.host="",A.protocol&&(A.hostname=null,A.port=null,A.host&&(""===j[0]?j[0]=A.host:j.unshift(A.host)),A.host=null),w=w&&(""===j[0]||""===D[0])),m)I.host=A.host||""===A.host?A.host:I.host,I.hostname=A.hostname||""===A.hostname?A.hostname:I.hostname,I.search=A.search,I.query=A.query,D=j;else if(j.length)D||(D=[]),D.pop(),D=D.concat(j),I.search=A.search,I.query=A.query;else if(!b.isNullOrUndefined(A.search))return $&&(I.hostname=I.host=D.shift(),(d=!!(I.host&&I.host.indexOf("@")>0)&&I.host.split("@"))&&(I.auth=d.shift(),I.host=I.hostname=d.shift())),I.search=A.search,I.query=A.query,b.isNull(I.pathname)&&b.isNull(I.search)||(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.href=I.format(),I;if(!D.length)return I.pathname=null,I.path=I.search?"/"+I.search:null,I.href=I.format(),I;for(var ne=D.slice(-1)[0],ee=(I.host||A.host||D.length>1)&&("."===ne||".."===ne)||""===ne,s=0,l=D.length;l>=0;l--)"."===(ne=D[l])?D.splice(l,1):".."===ne?(D.splice(l,1),s++):s&&(D.splice(l,1),s--);if(!w&&!B)for(;s--;s)D.unshift("..");!w||""===D[0]||D[0]&&"/"===D[0].charAt(0)||D.unshift(""),ee&&"/"!==D.join("/").substr(-1)&&D.push("");var d,S=""===D[0]||D[0]&&"/"===D[0].charAt(0);return $&&(I.hostname=I.host=S?"":D.length?D.shift():"",(d=!!(I.host&&I.host.indexOf("@")>0)&&I.host.split("@"))&&(I.auth=d.shift(),I.host=I.hostname=d.shift())),(w=w||I.host&&D.length)&&!S&&D.unshift(""),D.length?I.pathname=D.join("/"):(I.pathname=null,I.path=null),b.isNull(I.pathname)&&b.isNull(I.search)||(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.auth=A.auth||I.auth,I.slashes=I.slashes||A.slashes,I.href=I.format(),I},_.prototype.parseHost=function(){var A=this.host,oe=h.exec(A);oe&&(":"!==(oe=oe[0])&&(this.port=oe.substr(1)),A=A.substr(0,A.length-oe.length)),A&&(this.hostname=A)}},{"./util":70,punycode:45,querystring:48}],70:[function(T,t,Q){"use strict";t.exports={isString:function(x){return"string"==typeof x},isObject:function(x){return"object"==typeof x&&null!==x},isNull:function(x){return null===x},isNullOrUndefined:function(x){return null==x}}},{}],71:[function(T,t,Q){(function(x){function b(_){try{if(!x.localStorage)return!1}catch{return!1}var c=x.localStorage[_];return null!=c&&"true"===String(c).toLowerCase()}t.exports=function(_,c){if(b("noDeprecation"))return _;var h=!1;return function(){if(!h){if(b("throwDeprecation"))throw new Error(c);b("traceDeprecation")?console.trace(c):console.warn(c),h=!0}return _.apply(this,arguments)}}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],72:[function(T,t,Q){t.exports=function x(b,_){if(b&&_)return x(b)(_);if("function"!=typeof b)throw new TypeError("need wrapper function");return Object.keys(b).forEach(function(h){c[h]=b[h]}),c;function c(){for(var h=new Array(arguments.length),p=0;p<h.length;p++)h[p]=arguments[p];var C=b.apply(this,h),f=h[h.length-1];return"function"==typeof C&&C!==f&&Object.keys(f).forEach(function(y){C[y]=f[y]}),C}}},{}],73:[function(T,t,Q){"use strict";t.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}],74:[function(T,t,Q){t.exports=function(){for(var b={},_=0;_<arguments.length;_++){var c=arguments[_];for(var h in c)x.call(c,h)&&(b[h]=c[h])}return b};var x=Object.prototype.hasOwnProperty},{}]},{},[9])(9)},6700:(He,gt,_e)=>{var T={"./af":7088,"./af.js":7088,"./ar":7038,"./ar-dz":2502,"./ar-dz.js":2502,"./ar-kw":128,"./ar-kw.js":128,"./ar-ly":4519,"./ar-ly.js":4519,"./ar-ma":5443,"./ar-ma.js":5443,"./ar-sa":7642,"./ar-sa.js":7642,"./ar-tn":8592,"./ar-tn.js":8592,"./ar.js":7038,"./az":1213,"./az.js":1213,"./be":9191,"./be.js":9191,"./bg":322,"./bg.js":322,"./bm":8042,"./bm.js":8042,"./bn":9620,"./bn-bd":5903,"./bn-bd.js":5903,"./bn.js":9620,"./bo":9645,"./bo.js":9645,"./br":5020,"./br.js":5020,"./bs":4792,"./bs.js":4792,"./ca":7980,"./ca.js":7980,"./cs":7322,"./cs.js":7322,"./cv":365,"./cv.js":365,"./cy":2092,"./cy.js":2092,"./da":7387,"./da.js":7387,"./de":4307,"./de-at":9459,"./de-at.js":9459,"./de-ch":3694,"./de-ch.js":3694,"./de.js":4307,"./dv":9659,"./dv.js":9659,"./el":3460,"./el.js":3460,"./en-au":4369,"./en-au.js":4369,"./en-ca":530,"./en-ca.js":530,"./en-gb":9998,"./en-gb.js":9998,"./en-ie":3391,"./en-ie.js":3391,"./en-il":5414,"./en-il.js":5414,"./en-in":9615,"./en-in.js":9615,"./en-nz":1248,"./en-nz.js":1248,"./en-sg":3767,"./en-sg.js":3767,"./eo":4530,"./eo.js":4530,"./es":6866,"./es-do":8944,"./es-do.js":8944,"./es-mx":9116,"./es-mx.js":9116,"./es-us":3609,"./es-us.js":3609,"./es.js":6866,"./et":6725,"./et.js":6725,"./eu":7931,"./eu.js":7931,"./fa":6417,"./fa.js":6417,"./fi":944,"./fi.js":944,"./fil":1766,"./fil.js":1766,"./fo":5867,"./fo.js":5867,"./fr":1636,"./fr-ca":6848,"./fr-ca.js":6848,"./fr-ch":7773,"./fr-ch.js":7773,"./fr.js":1636,"./fy":4940,"./fy.js":4940,"./ga":1402,"./ga.js":1402,"./gd":6924,"./gd.js":6924,"./gl":6398,"./gl.js":6398,"./gom-deva":2457,"./gom-deva.js":2457,"./gom-latn":2545,"./gom-latn.js":2545,"./gu":2641,"./gu.js":2641,"./he":7536,"./he.js":7536,"./hi":6335,"./hi.js":6335,"./hr":7458,"./hr.js":7458,"./hu":6540,"./hu.js":6540,"./hy-am":5283,"./hy-am.js":5283,"./id":8780,"./id.js":8780,"./is":4205,"./is.js":4205,"./it":4211,"./it-ch":9985,"./it-ch.js":9985,"./it.js":4211,"./ja":1003,"./ja.js":1003,"./jv":420,"./jv.js":420,"./ka":851,"./ka.js":851,"./kk":6074,"./kk.js":6074,"./km":3343,"./km.js":3343,"./kn":4799,"./kn.js":4799,"./ko":3549,"./ko.js":3549,"./ku":1037,"./ku.js":1037,"./ky":3125,"./ky.js":3125,"./lb":9586,"./lb.js":9586,"./lo":2349,"./lo.js":2349,"./lt":2400,"./lt.js":2400,"./lv":9991,"./lv.js":9991,"./me":8477,"./me.js":8477,"./mi":5118,"./mi.js":5118,"./mk":5943,"./mk.js":5943,"./ml":3849,"./ml.js":3849,"./mn":1977,"./mn.js":1977,"./mr":6184,"./mr.js":6184,"./ms":485,"./ms-my":4524,"./ms-my.js":4524,"./ms.js":485,"./mt":6681,"./mt.js":6681,"./my":2024,"./my.js":2024,"./nb":2688,"./nb.js":2688,"./ne":8914,"./ne.js":8914,"./nl":1758,"./nl-be":2272,"./nl-be.js":2272,"./nl.js":1758,"./nn":1510,"./nn.js":1510,"./oc-lnc":2797,"./oc-lnc.js":2797,"./pa-in":7944,"./pa-in.js":7944,"./pl":1605,"./pl.js":1605,"./pt":4225,"./pt-br":3840,"./pt-br.js":3840,"./pt.js":4225,"./ro":5128,"./ro.js":5128,"./ru":5127,"./ru.js":5127,"./sd":2525,"./sd.js":2525,"./se":9893,"./se.js":9893,"./si":3123,"./si.js":3123,"./sk":9635,"./sk.js":9635,"./sl":8106,"./sl.js":8106,"./sq":8799,"./sq.js":8799,"./sr":7949,"./sr-cyrl":2872,"./sr-cyrl.js":2872,"./sr.js":7949,"./ss":6167,"./ss.js":6167,"./sv":9713,"./sv.js":9713,"./sw":1982,"./sw.js":1982,"./ta":2732,"./ta.js":2732,"./te":3636,"./te.js":3636,"./tet":2115,"./tet.js":2115,"./tg":9801,"./tg.js":9801,"./th":2868,"./th.js":2868,"./tk":1310,"./tk.js":1310,"./tl-ph":2360,"./tl-ph.js":2360,"./tlh":6645,"./tlh.js":6645,"./tr":8374,"./tr.js":8374,"./tzl":256,"./tzl.js":256,"./tzm":1595,"./tzm-latn":1631,"./tzm-latn.js":1631,"./tzm.js":1595,"./ug-cn":6050,"./ug-cn.js":6050,"./uk":5610,"./uk.js":5610,"./ur":6077,"./ur.js":6077,"./uz":2862,"./uz-latn":2207,"./uz-latn.js":2207,"./uz.js":2862,"./vi":8093,"./vi.js":8093,"./x-pseudo":5590,"./x-pseudo.js":5590,"./yo":9058,"./yo.js":9058,"./zh-cn":7908,"./zh-cn.js":7908,"./zh-hk":8867,"./zh-hk.js":8867,"./zh-mo":1133,"./zh-mo.js":1133,"./zh-tw":3291,"./zh-tw.js":3291};function t(x){var b=Q(x);return _e(b)}function Q(x){if(!_e.o(T,x)){var b=new Error("Cannot find module '"+x+"'");throw b.code="MODULE_NOT_FOUND",b}return T[x]}t.keys=function(){return Object.keys(T)},t.resolve=Q,He.exports=t,t.id=6700},4147:He=>{"use strict";He.exports={i8:"5.0.53-rc.1"}}},He=>{He.O(0,[736],()=>He(He.s=764)),He.O()}]);